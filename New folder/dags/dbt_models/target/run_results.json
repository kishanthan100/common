{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.9.2", "generated_at": "2025-02-04T07:20:18.597065Z", "invocation_id": "efa21a7e-0b62-404b-a6d7-983fad127fa5", "env": {}}, "results": [{"status": "error", "timing": [{"name": "compile", "started_at": "2025-02-04T07:20:10.523819Z", "completed_at": "2025-02-04T07:20:10.792304Z"}, {"name": "execute", "started_at": "2025-02-04T07:20:10.815373Z", "completed_at": "2025-02-04T07:20:12.283617Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.996758222579956, "adapter_response": {}, "message": "Runtime Error in model dim_company (models/dimensions/dim_company.sql)\n  Catalog Error: Table with name sales does not exist!\n  Did you mean \"sqlite_master\"?\n  LINE 9:     FROM \"sales_database\".\"main\".\"sales\"\n                   ^", "failures": null, "unique_id": "model.my_dbt_project.dim_company", "compiled": true, "compiled_code": "WITH companies AS (\n    SELECT DISTINCT\n        company AS company_id,\n        company\n    FROM \"sales_database\".\"main\".\"sales\"\n)\n\nSELECT * FROM companies", "relation_name": "\"sales_database\".\"main\".\"dim_company\"", "batch_results": null}, {"status": "error", "timing": [{"name": "compile", "started_at": "2025-02-04T07:20:12.635111Z", "completed_at": "2025-02-04T07:20:12.716407Z"}, {"name": "execute", "started_at": "2025-02-04T07:20:12.719034Z", "completed_at": "2025-02-04T07:20:13.315312Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.7997539043426514, "adapter_response": {}, "message": "Runtime Error in model dim_currency (models/dimensions/dim_currency.sql)\n  Catalog Error: Table with name sales does not exist!\n  Did you mean \"sqlite_master\"?\n  LINE 10:     FROM \"sales_database\".\"main\".\"sales\"\n                    ^", "failures": null, "unique_id": "model.my_dbt_project.dim_currency", "compiled": true, "compiled_code": "WITH currency_data AS (\n    SELECT DISTINCT\n        currency AS currency_id,\n        currency,\n        conversion_rate\n    FROM \"sales_database\".\"main\".\"sales\"\n)\n\nSELECT * FROM currency_data", "relation_name": "\"sales_database\".\"main\".\"dim_currency\"", "batch_results": null}, {"status": "error", "timing": [{"name": "compile", "started_at": "2025-02-04T07:20:13.465110Z", "completed_at": "2025-02-04T07:20:13.574922Z"}, {"name": "execute", "started_at": "2025-02-04T07:20:13.577674Z", "completed_at": "2025-02-04T07:20:14.190288Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.8228969573974609, "adapter_response": {}, "message": "Runtime Error in model dim_customer (models/dimensions/dim_customer.sql)\n  Catalog Error: Table with name sales does not exist!\n  Did you mean \"sqlite_master\"?\n  LINE 29:     FROM \"sales_database\".\"main\".\"sales\"\n                    ^", "failures": null, "unique_id": "model.my_dbt_project.dim_customer", "compiled": true, "compiled_code": "-- WITH sales AS (\n--     SELECT * FROM \"sales_database\".\"main\".\"sales\"\n-- )\n\n-- SELECT\n--     DISTINCT\n--     customer AS customer_id,\n--     customer_name,\n--     customer_address,\n--     customer_group,\n--     territory,\n--     language AS customer_language\n-- FROM sales\n-- WHERE customer IS NOT NULL\n\n\n\n\nWITH customers AS (\n    SELECT DISTINCT\n        customer AS customer_id,\n        customer_name,\n        customer_group,\n        territory\n    FROM \"sales_database\".\"main\".\"sales\"\n)\n\nSELECT * FROM customers", "relation_name": "\"sales_database\".\"main\".\"dim_customer\"", "batch_results": null}, {"status": "error", "timing": [{"name": "compile", "started_at": "2025-02-04T07:20:14.373272Z", "completed_at": "2025-02-04T07:20:14.485134Z"}, {"name": "execute", "started_at": "2025-02-04T07:20:14.496132Z", "completed_at": "2025-02-04T07:20:15.056894Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.8361985683441162, "adapter_response": {}, "message": "Runtime Error in model dim_date (models/dimensions/dim_date.sql)\n  Catalog Error: Table with name sales does not exist!\n  Did you mean \"sqlite_master\"?\n  LINE 28:     FROM \"sales_database\".\"main\".\"sales\"\n                    ^", "failures": null, "unique_id": "model.my_dbt_project.dim_date", "compiled": true, "compiled_code": "-- WITH sales AS (\n--     SELECT * FROM \"sales_database\".\"main\".\"sales\"\n-- )\n-- SELECT\n--     transaction_date,\n--     strftime(transaction_date, '%Y-%m-%d') AS date_id,  -- Change the format to YYYY-MM-DD\n--     strftime(transaction_date, '%A') AS weekday_name,\n--     strftime(transaction_date, '%m') AS month,\n--     strftime(transaction_date, '%Y') AS year,\n--     strftime(transaction_date, '%d') AS day,\n--     EXTRACT(QUARTER FROM transaction_date) AS quarter\n-- FROM sales\n-- WHERE transaction_date IS NOT NULL\n\n\nWITH date_data AS (\n    SELECT DISTINCT\n        transaction_date AS date_id,\n        EXTRACT(YEAR FROM transaction_date) AS year,\n        EXTRACT(MONTH FROM transaction_date) AS month,\n        EXTRACT(DAY FROM transaction_date) AS day,\n        EXTRACT(WEEK FROM transaction_date) AS week_of_year,\n        EXTRACT(QUARTER FROM transaction_date) AS quarter\n    FROM \"sales_database\".\"main\".\"sales\"\n)\n\nSELECT * FROM date_data", "relation_name": "\"sales_database\".\"main\".\"dim_date\"", "batch_results": null}, {"status": "error", "timing": [{"name": "compile", "started_at": "2025-02-04T07:20:15.284035Z", "completed_at": "2025-02-04T07:20:15.443067Z"}, {"name": "execute", "started_at": "2025-02-04T07:20:15.445233Z", "completed_at": "2025-02-04T07:20:16.325348Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.1535933017730713, "adapter_response": {}, "message": "Runtime Error in model dim_produt (models/dimensions/dim_produt.sql)\n  Catalog Error: Table with name sales does not exist!\n  Did you mean \"sqlite_master\"?\n  LINE 26:     FROM \"sales_database\".\"main\".\"sales\"\n                    ^", "failures": null, "unique_id": "model.my_dbt_project.dim_produt", "compiled": true, "compiled_code": "-- WITH sales AS (\n--     SELECT * \n--     FROM \"sales_database\".\"main\".\"sales\"\n-- )\n\n-- SELECT \n--     sales.name,\n--     json_extract(items, '$[0].name') AS product_name,  -- Example to extract the first element's \"name\" field from JSON array\n--     json_extract(items, '$[0].item_code') AS product_item_code\n-- FROM sales\n-- WHERE json_extract(items, '$[0].name') IS NOT NULL  -- Filter to only keep rows with a non-null product name\n\n\n\nWITH exploded_items AS (\n    SELECT\n        name AS sales_order_id,\n        JSON_EXTRACT(items, '$[*].item_code') AS product_code,\n        JSON_EXTRACT(items, '$[*].item_name') AS product_name,\n        JSON_EXTRACT(items, '$[*].qty') AS quantity_sold,\n        JSON_EXTRACT(items, '$[*].rate') AS unit_price\n    FROM \"sales_database\".\"main\".\"sales\"\n)\n\nSELECT \n    sales_order_id,\n    UNNEST(product_code) AS product_id,\n    UNNEST(product_name) AS product_name,\n    UNNEST(quantity_sold) AS quantity_sold,\n    UNNEST(unit_price) AS unit_price\nFROM exploded_items", "relation_name": "\"sales_database\".\"main\".\"dim_produt\"", "batch_results": null}, {"status": "error", "timing": [{"name": "compile", "started_at": "2025-02-04T07:20:16.489757Z", "completed_at": "2025-02-04T07:20:16.604434Z"}, {"name": "execute", "started_at": "2025-02-04T07:20:16.606664Z", "completed_at": "2025-02-04T07:20:17.121655Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.7760157585144043, "adapter_response": {}, "message": "Runtime Error in model dim_sales_team (models/dimensions/dim_sales_team.sql)\n  Catalog Error: Table with name sales does not exist!\n  Did you mean \"sqlite_master\"?\n  LINE 6:     SELECT * FROM \"sales_database\".\"main\".\"sales\"\n                            ^", "failures": null, "unique_id": "model.my_dbt_project.dim_sales_team", "compiled": true, "compiled_code": "WITH sales AS (\n    SELECT * FROM \"sales_database\".\"main\".\"sales\"\n)\n\nSELECT\n    DISTINCT\n    sales_team->>'name' AS sales_team_id,\n    sales_team->>'region' AS sales_team_region\nFROM sales\nWHERE sales_team IS NOT NULL", "relation_name": "\"sales_database\".\"main\".\"dim_sales_team\"", "batch_results": null}, {"status": "error", "timing": [{"name": "compile", "started_at": "2025-02-04T07:20:17.315982Z", "completed_at": "2025-02-04T07:20:17.410822Z"}, {"name": "execute", "started_at": "2025-02-04T07:20:17.425712Z", "completed_at": "2025-02-04T07:20:18.153520Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.9455194473266602, "adapter_response": {}, "message": "Runtime Error in model fact_sales (models/facts/fact_sales.sql)\n  Catalog Error: Table with name sales does not exist!\n  Did you mean \"sqlite_master\"?\n  LINE 26:     FROM \"sales_database\".\"main\".\"sales\"\n                    ^", "failures": null, "unique_id": "model.my_dbt_project.fact_sales", "compiled": true, "compiled_code": "WITH sales_data AS (\n    SELECT\n        name AS sales_order_id,\n        transaction_date,\n        customer,\n        company,\n        total AS sales_amount,\n        net_total,\n        discount_amount,\n        base_total_taxes_and_charges AS tax_amount,\n        grand_total,\n        currency,\n        conversion_rate,\n        items, -- JSON field with product details\n        taxes -- JSON field with tax details\n    FROM \"sales_database\".\"main\".\"sales\"\n)\n\nSELECT * FROM sales_data", "relation_name": "\"sales_database\".\"main\".\"fact_sales\"", "batch_results": null}], "elapsed_time": 56.461366176605225, "args": {"which": "run", "write_json": true, "log_level_file": "debug", "require_batched_execution_for_custom_microbatch_strategy": false, "populate_cache": true, "print": true, "require_resource_names_without_spaces": false, "cache_selected_only": false, "require_explicit_package_overrides_for_builtin_materializations": true, "invocation_command": "dbt run --profiles-dir /opt/airflow/dbt/profiles.yml --target dev", "skip_nodes_if_on_run_start_fails": false, "state_modified_compare_more_unrendered_values": false, "partial_parse": true, "static_parser": true, "target": "dev", "log_format": "default", "macro_debugging": false, "strict_mode": false, "require_yaml_configuration_for_mf_time_spines": false, "indirect_selection": "eager", "send_anonymous_usage_stats": true, "log_level": "info", "exclude": [], "printer_width": 80, "version_check": true, "log_format_file": "debug", "introspect": true, "profiles_dir": "/opt/airflow/dbt/profiles.yml", "quiet": false, "source_freshness_run_project_hooks": false, "require_nested_cumulative_type_params": false, "defer": false, "project_dir": "/opt/airflow/dags/dbt_models", "vars": {}, "select": [], "warn_error_options": {"include": [], "exclude": []}, "favor_state": false, "use_colors": true, "empty": false, "partial_parse_file_diff": true, "show_resource_report": false, "state_modified_compare_vars": false, "use_colors_file": true, "log_file_max_bytes": 10485760, "log_path": "/opt/airflow/dags/dbt_models/logs"}}