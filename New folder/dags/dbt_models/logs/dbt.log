[0m12:32:54.675560 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 12:32:54.698430 | 8bb39c0d-fb18-458f-af54-44fa4acb95fc ==============================
[0m12:32:54.698430 [info ] [MainThread]: Running with dbt=1.9.1
[0m12:32:54.700892 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/.dbt --target dev', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:32:54.707179 [error] [MainThread]: Encountered an error:
Runtime Error
  dbt_project.yml does not parse to a dictionary
[0m12:32:54.715840 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.36455566, "process_in_blocks": "32376", "process_kernel_time": 0.50978, "process_mem_max_rss": "97252", "process_out_blocks": "0", "process_user_time": 4.857911}
[0m12:32:54.717714 [debug] [MainThread]: Command `dbt run` failed at 12:32:54.717416 after 0.37 seconds
[0m12:32:54.719063 [debug] [MainThread]: Flushing usage events
[0m12:37:50.375186 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 12:37:50.836343 | bbc64432-c316-4837-8dfa-283cfa01fe7f ==============================
[0m12:37:50.836343 [info ] [MainThread]: Running with dbt=1.9.1
[0m12:37:50.838687 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dags/dbt_models/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/.dbt --target dev', 'send_anonymous_usage_stats': 'True'}
[0m12:37:52.398669 [error] [MainThread]: Encountered an error:
Runtime Error
  Credentials in profile "my_dbt_profile", target "dev" invalid: Runtime Error
    Inconsistency detected between 'path' and 'database' fields in profile; the 'database' property must be set to 'memory' to match the 'path'
[0m12:37:52.410059 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 21.541767, "process_in_blocks": "649632", "process_kernel_time": 3.719983, "process_mem_max_rss": "115148", "process_out_blocks": "0", "process_user_time": 7.716987}
[0m12:37:52.412725 [debug] [MainThread]: Command `dbt run` failed at 12:37:52.412294 after 21.55 seconds
[0m12:37:52.416074 [debug] [MainThread]: Flushing usage events
[0m12:43:50.462031 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 12:43:50.780703 | 12138195-efe6-44dc-95ff-9b85b8da7fb0 ==============================
[0m12:43:50.780703 [info ] [MainThread]: Running with dbt=1.9.1
[0m12:43:50.784003 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/.dbt', 'log_path': '/opt/airflow/dags/dbt_models/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/.dbt --target dev', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:43:52.502672 [error] [MainThread]: Encountered an error:
Runtime Error
  Credentials in profile "my_dbt_profile", target "dev" invalid: Runtime Error
    Inconsistency detected between 'path' and 'database' fields in profile; the 'database' property must be set to 'memory' to match the 'path'
[0m12:43:52.518548 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.48072, "process_in_blocks": "177592", "process_kernel_time": 2.506121, "process_mem_max_rss": "101332", "process_out_blocks": "0", "process_user_time": 8.157374}
[0m12:43:52.528422 [debug] [MainThread]: Command `dbt run` failed at 12:43:52.528010 after 2.49 seconds
[0m12:43:52.530704 [debug] [MainThread]: Flushing usage events
[0m12:44:43.285159 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 12:44:43.335974 | d4cf35d8-266c-422d-8611-912291fde120 ==============================
[0m12:44:43.335974 [info ] [MainThread]: Running with dbt=1.9.1
[0m12:44:43.337516 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dags/dbt_models/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/.dbt --target dev', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:44:43.701398 [error] [MainThread]: Encountered an error:
Runtime Error
  Credentials in profile "my_dbt_profile", target "dev" invalid: Runtime Error
    Inconsistency detected between 'path' and 'database' fields in profile; the 'database' property must be set to 'memory' to match the 'path'
[0m12:44:43.704839 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.58380497, "process_in_blocks": "174664", "process_kernel_time": 1.33842, "process_mem_max_rss": "118732", "process_out_blocks": "0", "process_user_time": 5.723245}
[0m12:44:43.706381 [debug] [MainThread]: Command `dbt run` failed at 12:44:43.706173 after 0.59 seconds
[0m12:44:43.707682 [debug] [MainThread]: Flushing usage events
[0m12:50:43.536218 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 12:50:43.566305 | 7aaf435a-7068-4cba-81d9-9635083706dc ==============================
[0m12:50:43.566305 [info ] [MainThread]: Running with dbt=1.9.1
[0m12:50:43.568780 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/dags/dbt_models/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/.dbt --target dev', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:50:44.090419 [error] [MainThread]: Encountered an error:
Runtime Error
  Credentials in profile "my_dbt_profile", target "dev" invalid: Runtime Error
    Inconsistency detected between 'path' and 'database' fields in profile; the 'database' property must be set to 'database' to match the 'path'
[0m12:50:44.094633 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.81756806, "process_in_blocks": "112792", "process_kernel_time": 0.931957, "process_mem_max_rss": "125496", "process_out_blocks": "0", "process_user_time": 6.632759}
[0m12:50:44.097070 [debug] [MainThread]: Command `dbt run` failed at 12:50:44.096587 after 0.82 seconds
[0m12:50:44.098805 [debug] [MainThread]: Flushing usage events
[0m12:57:06.857195 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 12:57:07.395425 | c0c14c49-0992-4537-864a-18a7f4459c2a ==============================
[0m12:57:07.395425 [info ] [MainThread]: Running with dbt=1.9.1
[0m12:57:07.405518 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/.dbt', 'log_path': '/opt/airflow/dags/dbt_models/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/.dbt --target dev', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:57:10.159706 [error] [MainThread]: Encountered an error:
Runtime Error
  Credentials in profile "my_dbt_profile", target "dev" invalid: Runtime Error
    Inconsistency detected between 'path' and 'database' fields in profile; the 'database' property must be set to 'database' to match the 'path'
[0m12:57:10.184675 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 4.2200565, "process_in_blocks": "669864", "process_kernel_time": 3.179747, "process_mem_max_rss": "111620", "process_out_blocks": "0", "process_user_time": 6.507162}
[0m12:57:10.197014 [debug] [MainThread]: Command `dbt run` failed at 12:57:10.196537 after 4.24 seconds
[0m12:57:10.202012 [debug] [MainThread]: Flushing usage events
[0m12:57:13.398653 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 12:57:13.506863 | f313cf31-e4cb-498e-baa5-fcaa3296eb07 ==============================
[0m12:57:13.506863 [info ] [MainThread]: Running with dbt=1.9.1
[0m12:57:13.522502 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dags/dbt_models/logs', 'profiles_dir': '/opt/airflow/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/.dbt --target dev', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:57:14.162189 [error] [MainThread]: Encountered an error:
Runtime Error
  Credentials in profile "my_dbt_profile", target "dev" invalid: Runtime Error
    Inconsistency detected between 'path' and 'database' fields in profile; the 'database' property must be set to 'database' to match the 'path'
[0m12:57:14.178339 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.4290541, "process_in_blocks": "515608", "process_kernel_time": 3.47345, "process_mem_max_rss": "116976", "process_out_blocks": "0", "process_user_time": 7.400818}
[0m12:57:14.185886 [debug] [MainThread]: Command `dbt run` failed at 12:57:14.185505 after 1.44 seconds
[0m12:57:14.191856 [debug] [MainThread]: Flushing usage events
[0m13:20:12.103216 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 13:20:12.174834 | bd26b248-4267-4932-817a-58768b858e82 ==============================
[0m13:20:12.174834 [info ] [MainThread]: Running with dbt=1.9.1
[0m13:20:12.185025 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dags/dbt_models/logs', 'profiles_dir': '/opt/airflow/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/.dbt --target dev', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:20:15.363743 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m13:20:16.630060 [debug] [MainThread]: checksum: cac3b9519010e47bfbeb71ca6efb4867dae2858687671594dc23fefc94ecf25d, vars: {}, profile: , target: dev, version: 1.9.1
[0m13:20:16.678906 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m13:20:20.295649 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_dbt_project
[0m13:20:20.915226 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m13:20:20.988219 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m13:20:21.252779 [info ] [MainThread]: Found 424 macros
[0m13:20:21.257263 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m13:20:21.260286 [debug] [MainThread]: Command end result
[0m13:20:21.510294 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m13:20:21.528041 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m13:20:21.564423 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dags/dbt_models/target/run_results.json
[0m13:20:21.570916 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.240201, "process_in_blocks": "1192472", "process_kernel_time": 6.204935, "process_mem_max_rss": "116500", "process_out_blocks": "1968", "process_user_time": 14.857597}
[0m13:20:21.573650 [debug] [MainThread]: Command `dbt run` succeeded at 13:20:21.573273 after 10.24 seconds
[0m13:20:21.575562 [debug] [MainThread]: Flushing usage events
[0m13:28:43.268641 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 13:28:43.298027 | 4750e6cb-1676-463f-b192-6e2970558f8d ==============================
[0m13:28:43.298027 [info ] [MainThread]: Running with dbt=1.9.1
[0m13:28:43.300275 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dags/dbt_models/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/.dbt --target dev', 'send_anonymous_usage_stats': 'True'}
[0m13:28:44.466136 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m13:28:44.964237 [debug] [MainThread]: checksum: cac3b9519010e47bfbeb71ca6efb4867dae2858687671594dc23fefc94ecf25d, vars: {}, profile: , target: dev, version: 1.9.1
[0m13:28:45.596892 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:28:45.598769 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:28:45.602126 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_dbt_project
[0m13:28:46.043922 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m13:28:46.082902 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m13:28:46.415127 [info ] [MainThread]: Found 424 macros
[0m13:28:46.452952 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m13:28:46.469635 [debug] [MainThread]: Command end result
[0m13:28:46.824207 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m13:28:46.849865 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m13:28:46.878565 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dags/dbt_models/target/run_results.json
[0m13:28:46.889285 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.8106122, "process_in_blocks": "153928", "process_kernel_time": 1.140873, "process_mem_max_rss": "130284", "process_out_blocks": "0", "process_user_time": 7.13294}
[0m13:28:46.891801 [debug] [MainThread]: Command `dbt run` succeeded at 13:28:46.891270 after 3.82 seconds
[0m13:28:46.893408 [debug] [MainThread]: Flushing usage events
[0m13:33:25.315730 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 13:33:25.364142 | 0a1156fa-42f0-46be-b970-38cb42ba3ba7 ==============================
[0m13:33:25.364142 [info ] [MainThread]: Running with dbt=1.9.1
[0m13:33:25.370320 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dags/dbt_models/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/.dbt --target dev', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:33:26.681201 [error] [MainThread]: Encountered an error:
Runtime Error
  Credentials in profile "my_dbt_profile", target "dev" invalid: Runtime Error
    Inconsistency detected between 'path' and 'database' fields in profile; the 'database' property must be set to 'my_duckdb_database' to match the 'path'
[0m13:33:26.687073 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.9232686, "process_in_blocks": "912176", "process_kernel_time": 4.743633, "process_mem_max_rss": "117132", "process_out_blocks": "0", "process_user_time": 7.821949}
[0m13:33:26.701616 [debug] [MainThread]: Command `dbt run` failed at 13:33:26.701220 after 1.94 seconds
[0m13:33:26.711250 [debug] [MainThread]: Flushing usage events
[0m13:38:59.090110 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 13:38:59.139087 | c1dc0bd0-cf71-4744-b3fa-f92d5eae3215 ==============================
[0m13:38:59.139087 [info ] [MainThread]: Running with dbt=1.9.1
[0m13:38:59.150574 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dags/dbt_models/logs', 'profiles_dir': '/opt/airflow/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/.dbt --target dev', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:38:59.749938 [error] [MainThread]: Encountered an error:
Runtime Error
  Credentials in profile "my_dbt_profile", target "dev" invalid: Runtime Error
    Inconsistency detected between 'path' and 'database' fields in profile; the 'database' property must be set to 'my_duckdb_database' to match the 'path'
[0m13:38:59.753967 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.2250253, "process_in_blocks": "114048", "process_kernel_time": 0.764989, "process_mem_max_rss": "125920", "process_out_blocks": "0", "process_user_time": 6.447766}
[0m13:38:59.755664 [debug] [MainThread]: Command `dbt run` failed at 13:38:59.755387 after 1.23 seconds
[0m13:38:59.757083 [debug] [MainThread]: Flushing usage events
[0m14:08:38.758214 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 14:08:40.207428 | 154107dc-4c7e-4cbd-8002-d67094ffe062 ==============================
[0m14:08:40.207428 [info ] [MainThread]: Running with dbt=1.9.1
[0m14:08:41.285919 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dags/dbt_models/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/.dbt --target dev', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:09:05.940309 [error] [MainThread]: Encountered an error:
Runtime Error
  Credentials in profile "my_dbt_profile", target "dev" invalid: Runtime Error
    Inconsistency detected between 'path' and 'database' fields in profile; the 'database' property must be set to 'my_duckdb_database' to match the 'path'
[0m14:09:05.971190 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 28.426216, "process_in_blocks": "1318360", "process_kernel_time": 3.5985, "process_mem_max_rss": "115460", "process_out_blocks": "0", "process_user_time": 6.69557}
[0m14:09:06.016414 [debug] [MainThread]: Command `dbt run` failed at 14:09:06.015989 after 28.48 seconds
[0m14:09:06.019643 [debug] [MainThread]: Flushing usage events
[0m14:15:31.147451 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 14:15:31.361041 | 0ff01614-092c-4a26-91c0-e7f3c97e7fc2 ==============================
[0m14:15:31.361041 [info ] [MainThread]: Running with dbt=1.9.1
[0m14:15:31.367168 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dags/dbt_models/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/.dbt --target dev', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:15:35.722259 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m14:15:37.265081 [debug] [MainThread]: checksum: cac3b9519010e47bfbeb71ca6efb4867dae2858687671594dc23fefc94ecf25d, vars: {}, profile: , target: dev, version: 1.9.1
[0m14:15:37.757189 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m14:15:43.451325 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_dbt_project
[0m14:15:44.077583 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m14:15:44.131098 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m14:15:44.520370 [info ] [MainThread]: Found 424 macros
[0m14:15:44.528840 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m14:15:44.533065 [debug] [MainThread]: Command end result
[0m14:15:44.813492 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m14:15:44.833113 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m14:15:44.980097 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dags/dbt_models/target/run_results.json
[0m14:15:44.996001 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 14.356719, "process_in_blocks": "186472", "process_kernel_time": 4.783389, "process_mem_max_rss": "118820", "process_out_blocks": "0", "process_user_time": 14.614822}
[0m14:15:45.120142 [debug] [MainThread]: Command `dbt run` succeeded at 14:15:45.118552 after 14.49 seconds
[0m14:15:45.130658 [debug] [MainThread]: Flushing usage events
[0m14:15:53.181111 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 14:15:53.309162 | 48ddd625-4a01-412a-80b1-3eae2b7b05d7 ==============================
[0m14:15:53.309162 [info ] [MainThread]: Running with dbt=1.9.1
[0m14:15:53.313197 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/.dbt', 'log_path': '/opt/airflow/dags/dbt_models/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/.dbt --target dev', 'send_anonymous_usage_stats': 'True'}
[0m14:15:56.763960 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m14:15:57.799895 [debug] [MainThread]: checksum: cac3b9519010e47bfbeb71ca6efb4867dae2858687671594dc23fefc94ecf25d, vars: {}, profile: , target: dev, version: 1.9.1
[0m14:15:58.386527 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:15:58.387562 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:15:58.392081 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_dbt_project
[0m14:15:58.783053 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m14:15:58.806851 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m14:15:59.008147 [info ] [MainThread]: Found 424 macros
[0m14:15:59.014556 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m14:15:59.019718 [debug] [MainThread]: Command end result
[0m14:15:59.157804 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m14:15:59.175302 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m14:15:59.216445 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dags/dbt_models/target/run_results.json
[0m14:15:59.225198 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.578321, "process_in_blocks": "114632", "process_kernel_time": 2.60888, "process_mem_max_rss": "127184", "process_out_blocks": "0", "process_user_time": 9.731224}
[0m14:15:59.229298 [debug] [MainThread]: Command `dbt run` succeeded at 14:15:59.228948 after 6.58 seconds
[0m14:15:59.230912 [debug] [MainThread]: Flushing usage events
[0m14:37:00.279068 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 14:37:00.317330 | 69b59360-2409-488b-b58b-2b1833f4b695 ==============================
[0m14:37:00.317330 [info ] [MainThread]: Running with dbt=1.9.1
[0m14:37:00.319606 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dags/dbt_models/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/.dbt --target dev', 'send_anonymous_usage_stats': 'True'}
[0m14:37:02.917038 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m14:37:03.660569 [debug] [MainThread]: checksum: cac3b9519010e47bfbeb71ca6efb4867dae2858687671594dc23fefc94ecf25d, vars: {}, profile: , target: dev, version: 1.9.1
[0m14:37:04.472840 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:37:04.474470 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:37:04.477103 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_dbt_project
[0m14:37:04.725105 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m14:37:04.744505 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m14:37:04.894254 [info ] [MainThread]: Found 424 macros
[0m14:37:04.898653 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m14:37:04.908385 [debug] [MainThread]: Command end result
[0m14:37:05.167751 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m14:37:05.195494 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m14:37:05.242893 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dags/dbt_models/target/run_results.json
[0m14:37:05.250633 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.294411, "process_in_blocks": "151408", "process_kernel_time": 1.538303, "process_mem_max_rss": "123516", "process_out_blocks": "0", "process_user_time": 7.95123}
[0m14:37:05.254830 [debug] [MainThread]: Command `dbt run` succeeded at 14:37:05.254451 after 5.30 seconds
[0m14:37:05.259142 [debug] [MainThread]: Flushing usage events
[0m06:12:22.940298 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 06:12:22.972770 | 42c0a701-bf67-4296-ae4f-24170bb91b73 ==============================
[0m06:12:22.972770 [info ] [MainThread]: Running with dbt=1.9.1
[0m06:12:22.976981 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dags/dbt_models/logs', 'profiles_dir': '/opt/airflow/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/.dbt --target dev', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:12:24.261414 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m06:12:24.594882 [debug] [MainThread]: checksum: cac3b9519010e47bfbeb71ca6efb4867dae2858687671594dc23fefc94ecf25d, vars: {}, profile: , target: dev, version: 1.9.1
[0m06:12:24.913811 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:12:24.914808 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:12:24.916159 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_dbt_project
[0m06:12:25.107171 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m06:12:25.128019 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m06:12:25.243524 [info ] [MainThread]: Found 424 macros
[0m06:12:25.249423 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m06:12:25.256538 [debug] [MainThread]: Command end result
[0m06:12:25.377738 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m06:12:25.394553 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m06:12:25.418906 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dags/dbt_models/target/run_results.json
[0m06:12:25.421957 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.6937864, "process_in_blocks": "38368", "process_kernel_time": 0.439758, "process_mem_max_rss": "137748", "process_out_blocks": "0", "process_user_time": 5.492089}
[0m06:12:25.424244 [debug] [MainThread]: Command `dbt run` succeeded at 06:12:25.423918 after 2.70 seconds
[0m06:12:25.426074 [debug] [MainThread]: Flushing usage events
[0m06:40:19.049149 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 06:40:19.111831 | a70efbab-9f16-4e2c-811e-1ff3757c56e3 ==============================
[0m06:40:19.111831 [info ] [MainThread]: Running with dbt=1.9.1
[0m06:40:19.114220 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dags/dbt_models/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/.dbt --target dev', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:40:20.844832 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m06:40:21.603179 [debug] [MainThread]: checksum: cac3b9519010e47bfbeb71ca6efb4867dae2858687671594dc23fefc94ecf25d, vars: {}, profile: , target: dev, version: 1.9.1
[0m06:40:22.207149 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:40:22.216678 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:40:22.219315 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_dbt_project
[0m06:40:22.548987 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m06:40:22.601070 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m06:40:22.986783 [info ] [MainThread]: Found 424 macros
[0m06:40:23.050379 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m06:40:23.065887 [debug] [MainThread]: Command end result
[0m06:40:23.398922 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m06:40:23.470699 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m06:40:23.524760 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dags/dbt_models/target/run_results.json
[0m06:40:23.539897 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.736452, "process_in_blocks": "250544", "process_kernel_time": 1.326193, "process_mem_max_rss": "113148", "process_out_blocks": "0", "process_user_time": 7.323753}
[0m06:40:23.558729 [debug] [MainThread]: Command `dbt run` succeeded at 06:40:23.558198 after 4.76 seconds
[0m06:40:23.572200 [debug] [MainThread]: Flushing usage events
[0m07:07:30.917700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3405072d20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3405072e70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3404d1ed20>]}


============================== 07:07:30.974372 | aba28f5e-0510-4aee-a3b9-7b05c60f3f1b ==============================
[0m07:07:30.974372 [info ] [MainThread]: Running with dbt=1.9.1
[0m07:07:30.978412 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dags/dbt_models/logs', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt/profiles.yml/', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt/profiles.yml/ --target dev', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:07:34.717451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aba28f5e-0510-4aee-a3b9-7b05c60f3f1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34046ff080>]}
[0m07:07:35.221703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aba28f5e-0510-4aee-a3b9-7b05c60f3f1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3404a0a4e0>]}
[0m07:07:35.312855 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m07:07:36.683636 [debug] [MainThread]: checksum: cac3b9519010e47bfbeb71ca6efb4867dae2858687671594dc23fefc94ecf25d, vars: {}, profile: , target: dev, version: 1.9.1
[0m07:07:37.022712 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:07:37.024369 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:07:37.026866 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_dbt_project
[0m07:07:37.046925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aba28f5e-0510-4aee-a3b9-7b05c60f3f1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33feb11ee0>]}
[0m07:07:37.350116 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m07:07:37.384790 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m07:07:37.774547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aba28f5e-0510-4aee-a3b9-7b05c60f3f1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33fe674e00>]}
[0m07:07:37.777089 [info ] [MainThread]: Found 424 macros
[0m07:07:37.783215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aba28f5e-0510-4aee-a3b9-7b05c60f3f1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33fe50b710>]}
[0m07:07:37.787978 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m07:07:37.800937 [debug] [MainThread]: Command end result
[0m07:07:38.058995 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m07:07:38.083110 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m07:07:38.118254 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dags/dbt_models/target/run_results.json
[0m07:07:38.126451 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.253323, "process_in_blocks": "159488", "process_kernel_time": 1.906913, "process_mem_max_rss": "117664", "process_out_blocks": "1968", "process_user_time": 8.491723}
[0m07:07:38.130451 [debug] [MainThread]: Command `dbt run` succeeded at 07:07:38.129931 after 8.26 seconds
[0m07:07:38.133957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3408037140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3404e6c680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3404504890>]}
[0m07:07:38.140899 [debug] [MainThread]: Flushing usage events
[0m07:07:49.051742 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:08:03.268075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f09ce5af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f09ce5b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f09ce60c0>]}


============================== 07:08:03.423951 | 41fbbb6a-6858-4333-bd5f-dcc27d1d468e ==============================
[0m07:08:03.423951 [info ] [MainThread]: Running with dbt=1.9.1
[0m07:08:03.439631 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dags/dbt_models/logs', 'profiles_dir': '/opt/airflow/dbt/profiles.yml/', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt/profiles.yml/ --target dev', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:08:07.835358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '41fbbb6a-6858-4333-bd5f-dcc27d1d468e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f0a2c2cf0>]}
[0m07:08:08.193690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '41fbbb6a-6858-4333-bd5f-dcc27d1d468e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f0b4de990>]}
[0m07:08:08.213507 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m07:08:08.826014 [debug] [MainThread]: checksum: cac3b9519010e47bfbeb71ca6efb4867dae2858687671594dc23fefc94ecf25d, vars: {}, profile: , target: dev, version: 1.9.1
[0m07:08:09.331721 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:08:09.341235 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:08:09.362656 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_dbt_project
[0m07:08:09.397652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '41fbbb6a-6858-4333-bd5f-dcc27d1d468e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f09ce5b80>]}
[0m07:08:09.904375 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m07:08:09.973744 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m07:08:10.443760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '41fbbb6a-6858-4333-bd5f-dcc27d1d468e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f03760d40>]}
[0m07:08:10.446135 [info ] [MainThread]: Found 424 macros
[0m07:08:10.455691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '41fbbb6a-6858-4333-bd5f-dcc27d1d468e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f03d969f0>]}
[0m07:08:10.487684 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m07:08:10.579928 [debug] [MainThread]: Command end result
[0m07:08:11.015469 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m07:08:11.047914 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m07:08:11.082975 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dags/dbt_models/target/run_results.json
[0m07:08:11.108316 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.227047, "process_in_blocks": "494880", "process_kernel_time": 4.830728, "process_mem_max_rss": "121784", "process_out_blocks": "0", "process_user_time": 10.717245}
[0m07:08:11.111476 [debug] [MainThread]: Command `dbt run` succeeded at 07:08:11.110121 after 10.24 seconds
[0m07:08:11.113585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f09a115b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f0a235670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f0963daf0>]}
[0m07:08:11.115634 [debug] [MainThread]: Flushing usage events
[0m07:08:13.988766 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:24:47.507010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39bd5d1cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39bd5d1940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39bd0623f0>]}


============================== 07:24:47.602434 | 77f17abe-8854-42bc-9a31-7182fec7b9b6 ==============================
[0m07:24:47.602434 [info ] [MainThread]: Running with dbt=1.9.1
[0m07:24:47.640683 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/profiles.yml', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dags/dbt_models/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt/profiles.yml --target dev', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m07:24:51.839783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '77f17abe-8854-42bc-9a31-7182fec7b9b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39beefb200>]}
[0m07:24:52.380644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '77f17abe-8854-42bc-9a31-7182fec7b9b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39bcbb8800>]}
[0m07:24:52.416843 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m07:24:53.642179 [debug] [MainThread]: checksum: cac3b9519010e47bfbeb71ca6efb4867dae2858687671594dc23fefc94ecf25d, vars: {}, profile: , target: dev, version: 1.9.1
[0m07:24:54.461470 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:24:54.477535 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:24:54.522802 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_dbt_project
[0m07:24:54.616582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '77f17abe-8854-42bc-9a31-7182fec7b9b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39b9532480>]}
[0m07:24:55.486188 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m07:24:55.560015 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m07:24:55.797507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '77f17abe-8854-42bc-9a31-7182fec7b9b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39b6eac9e0>]}
[0m07:24:55.799398 [info ] [MainThread]: Found 424 macros
[0m07:24:55.804318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '77f17abe-8854-42bc-9a31-7182fec7b9b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39b7351580>]}
[0m07:24:55.817892 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m07:24:55.828353 [debug] [MainThread]: Command end result
[0m07:24:56.388299 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m07:24:56.421955 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m07:24:56.482153 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dags/dbt_models/target/run_results.json
[0m07:24:56.485981 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.926724, "process_in_blocks": "1460176", "process_kernel_time": 7.495375, "process_mem_max_rss": "126008", "process_out_blocks": "0", "process_user_time": 11.701557}
[0m07:24:56.490248 [debug] [MainThread]: Command `dbt run` succeeded at 07:24:56.489784 after 9.93 seconds
[0m07:24:56.492508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39bd1a66c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39bcb34f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39b6e97290>]}
[0m07:24:56.508088 [debug] [MainThread]: Flushing usage events
[0m07:24:58.098046 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:34:52.665931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4dc91a6f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4dcf024b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4dc871f70>]}


============================== 07:34:52.683696 | 03b30eed-4e28-4bfa-abb2-b7d20e28f9bc ==============================
[0m07:34:52.683696 [info ] [MainThread]: Running with dbt=1.9.1
[0m07:34:52.685489 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/profiles.yml', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dags/dbt_models/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt/profiles.yml --target dev', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m07:34:53.914443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '03b30eed-4e28-4bfa-abb2-b7d20e28f9bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4de5cabd0>]}
[0m07:34:54.226172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '03b30eed-4e28-4bfa-abb2-b7d20e28f9bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4dc2a5370>]}
[0m07:34:54.275227 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m07:34:55.402247 [debug] [MainThread]: checksum: cac3b9519010e47bfbeb71ca6efb4867dae2858687671594dc23fefc94ecf25d, vars: {}, profile: , target: dev, version: 1.9.1
[0m07:34:55.618727 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m07:34:55.624624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '03b30eed-4e28-4bfa-abb2-b7d20e28f9bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4dd0ce8d0>]}
[0m07:35:03.760727 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.my_dbt_project.transform_users' (models/transform_users.sql) depends on a source named 'my_dbt_profile.users' which was not found
[0m07:35:03.771139 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 11.355144, "process_in_blocks": "243680", "process_kernel_time": 1.956696, "process_mem_max_rss": "126180", "process_out_blocks": "0", "process_user_time": 12.878256}
[0m07:35:03.781222 [debug] [MainThread]: Command `dbt run` failed at 07:35:03.780824 after 11.37 seconds
[0m07:35:03.785009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4dc396450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4d67106e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4d5b02000>]}
[0m07:35:03.787137 [debug] [MainThread]: Flushing usage events
[0m07:35:05.042576 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:35:50.127932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22d09613a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22cffd1400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22d02c8f20>]}


============================== 07:35:50.212859 | d46ee1b3-3c71-4018-b6d3-85f657328051 ==============================
[0m07:35:50.212859 [info ] [MainThread]: Running with dbt=1.9.1
[0m07:35:50.228480 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/profiles.yml', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dags/dbt_models/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt/profiles.yml --target dev', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:35:52.894080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd46ee1b3-3c71-4018-b6d3-85f657328051', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22d1e6de20>]}
[0m07:35:53.804613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd46ee1b3-3c71-4018-b6d3-85f657328051', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22cfaf6150>]}
[0m07:35:54.286828 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m07:36:22.205767 [debug] [MainThread]: checksum: cac3b9519010e47bfbeb71ca6efb4867dae2858687671594dc23fefc94ecf25d, vars: {}, profile: , target: dev, version: 1.9.1
[0m07:36:22.571342 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m07:36:22.580493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd46ee1b3-3c71-4018-b6d3-85f657328051', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22c9d243e0>]}
[0m07:36:32.080351 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.my_dbt_project.transform_users' (models/transform_users.sql) depends on a source named 'my_dbt_profile.users' which was not found
[0m07:36:32.098505 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 42.66815, "process_in_blocks": "850960", "process_kernel_time": 5.167064, "process_mem_max_rss": "115008", "process_out_blocks": "0", "process_user_time": 14.746005}
[0m07:36:32.110884 [debug] [MainThread]: Command `dbt run` failed at 07:36:32.110330 after 42.68 seconds
[0m07:36:32.112875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22d03d6510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22c9cdf8c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22c9cedfd0>]}
[0m07:36:32.118946 [debug] [MainThread]: Flushing usage events
[0m07:36:33.908746 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:10:30.978523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a26635ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a280bc0e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a25f3ff20>]}


============================== 08:10:31.003820 | 30325306-52d8-4d54-be48-74e5ab697aa1 ==============================
[0m08:10:31.003820 [info ] [MainThread]: Running with dbt=1.9.1
[0m08:10:31.006119 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/profiles.yml', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dags/dbt_models/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt/profiles.yml --target dev', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:10:32.594533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '30325306-52d8-4d54-be48-74e5ab697aa1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a25d1daf0>]}
[0m08:10:32.791055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '30325306-52d8-4d54-be48-74e5ab697aa1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a25a7dbe0>]}
[0m08:10:32.809004 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m08:10:33.054938 [debug] [MainThread]: checksum: cac3b9519010e47bfbeb71ca6efb4867dae2858687671594dc23fefc94ecf25d, vars: {}, profile: , target: dev, version: 1.9.1
[0m08:10:33.185179 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m08:10:33.186680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '30325306-52d8-4d54-be48-74e5ab697aa1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a1bd50170>]}
[0m08:10:35.909025 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.my_dbt_project.transform_users' (models/transform_users.sql) depends on a source named 'my_dbt_profile.users' which was not found
[0m08:10:35.916424 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 5.149707, "process_in_blocks": "132472", "process_kernel_time": 1.128223, "process_mem_max_rss": "133000", "process_out_blocks": "1512", "process_user_time": 9.37217}
[0m08:10:35.920284 [debug] [MainThread]: Command `dbt run` failed at 08:10:35.919865 after 5.15 seconds
[0m08:10:35.922673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a26015160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a1bd73530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a2017ebd0>]}
[0m08:10:35.924718 [debug] [MainThread]: Flushing usage events
[0m08:10:37.516137 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:13:59.101382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb625616240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6256c9730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb624ee9e20>]}


============================== 08:13:59.391544 | 76513574-9a3d-4358-b71f-70225f76b769 ==============================
[0m08:13:59.391544 [info ] [MainThread]: Running with dbt=1.9.1
[0m08:13:59.401769 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dags/dbt_models/logs', 'profiles_dir': '/opt/airflow/dbt/profiles.yml', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt/profiles.yml --target dev', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:14:25.567301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '76513574-9a3d-4358-b71f-70225f76b769', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb61f750800>]}
[0m08:14:26.028317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '76513574-9a3d-4358-b71f-70225f76b769', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb624d84f80>]}
[0m08:14:26.075611 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m08:14:27.628256 [debug] [MainThread]: checksum: cac3b9519010e47bfbeb71ca6efb4867dae2858687671594dc23fefc94ecf25d, vars: {}, profile: , target: dev, version: 1.9.1
[0m08:14:28.059729 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m08:14:28.069368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '76513574-9a3d-4358-b71f-70225f76b769', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb62563e6f0>]}
[0m08:14:34.925703 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.my_dbt_project.transform_users' (models/transform_users.sql) depends on a source named 'my_dbt_profile.users' which was not found
[0m08:14:34.932542 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 37.706642, "process_in_blocks": "3798904", "process_kernel_time": 3.752807, "process_mem_max_rss": "116604", "process_out_blocks": "0", "process_user_time": 15.011228}
[0m08:14:34.937052 [debug] [MainThread]: Command `dbt run` failed at 08:14:34.936649 after 37.71 seconds
[0m08:14:34.939046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb62588cb00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb61f0e38f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb61f0f2060>]}
[0m08:14:34.941066 [debug] [MainThread]: Flushing usage events
[0m08:14:37.888548 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:16:30.072394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29e1d36a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29e2612930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29e2611c40>]}


============================== 08:16:30.205757 | a428b46e-7558-4d9c-99d8-b9114de49a95 ==============================
[0m08:16:30.205757 [info ] [MainThread]: Running with dbt=1.9.1
[0m08:16:30.244195 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/profiles.yml', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dags/dbt_models/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt/profiles.yml --target dev', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m08:16:34.214720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a428b46e-7558-4d9c-99d8-b9114de49a95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29e17cb320>]}
[0m08:16:34.742404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a428b46e-7558-4d9c-99d8-b9114de49a95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29dbf1f3b0>]}
[0m08:16:34.830201 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m08:16:36.532187 [debug] [MainThread]: checksum: cac3b9519010e47bfbeb71ca6efb4867dae2858687671594dc23fefc94ecf25d, vars: {}, profile: , target: dev, version: 1.9.1
[0m08:16:36.862022 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m08:16:36.870684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a428b46e-7558-4d9c-99d8-b9114de49a95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29e1d36450>]}
[0m08:16:45.296409 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.my_dbt_project.transform_users' (models/transform_users.sql) depends on a source named 'my_dbt_profile.users' which was not found
[0m08:16:45.335509 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 17.633501, "process_in_blocks": "956400", "process_kernel_time": 6.214924, "process_mem_max_rss": "112960", "process_out_blocks": "0", "process_user_time": 13.823195}
[0m08:16:45.377549 [debug] [MainThread]: Command `dbt run` failed at 08:16:45.375026 after 17.67 seconds
[0m08:16:45.380284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29e552b140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29db960a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29db8f1df0>]}
[0m08:16:45.382392 [debug] [MainThread]: Flushing usage events
[0m08:16:46.644179 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:19:51.442723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb7a144f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb7a88aab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb7a144f50>]}


============================== 08:19:51.453355 | 5087a271-0484-4f20-bf75-15a86c6f7c25 ==============================
[0m08:19:51.453355 [info ] [MainThread]: Running with dbt=1.9.1
[0m08:19:51.454879 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dags/dbt_models/logs', 'profiles_dir': '/opt/airflow/dbt/profiles.yml', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt/profiles.yml --target dev', 'send_anonymous_usage_stats': 'True'}
[0m08:19:52.198098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5087a271-0484-4f20-bf75-15a86c6f7c25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb79c48680>]}
[0m08:19:52.354513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5087a271-0484-4f20-bf75-15a86c6f7c25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb7a9fd5e0>]}
[0m08:19:52.367668 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m08:19:52.590182 [debug] [MainThread]: checksum: cac3b9519010e47bfbeb71ca6efb4867dae2858687671594dc23fefc94ecf25d, vars: {}, profile: , target: dev, version: 1.9.1
[0m08:19:52.689724 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m08:19:52.690994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5087a271-0484-4f20-bf75-15a86c6f7c25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb7a306570>]}
[0m08:19:55.544135 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.my_dbt_project.transform_users' (models/transform_users.sql) depends on a source named 'my_dbt_profile.users' which was not found
[0m08:19:55.547365 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 4.3115335, "process_in_blocks": "39848", "process_kernel_time": 0.613598, "process_mem_max_rss": "139192", "process_out_blocks": "0", "process_user_time": 7.884742}
[0m08:19:55.549454 [debug] [MainThread]: Command `dbt run` failed at 08:19:55.549095 after 4.31 seconds
[0m08:19:55.551203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb7a44b860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb7431a4e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb743d60f0>]}
[0m08:19:55.552899 [debug] [MainThread]: Flushing usage events
[0m08:19:56.674658 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:21:18.192877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9bfd238890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9bfd0b2810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9bfd7b4830>]}


============================== 08:21:18.218489 | 21f908aa-5cf1-4b74-8b93-c29d1b26b8af ==============================
[0m08:21:18.218489 [info ] [MainThread]: Running with dbt=1.9.1
[0m08:21:18.221052 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dags/dbt_models/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt/profiles.yml', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt/profiles.yml --target dev', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m08:21:19.721120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '21f908aa-5cf1-4b74-8b93-c29d1b26b8af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9bfeb80230>]}
[0m08:21:19.862543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '21f908aa-5cf1-4b74-8b93-c29d1b26b8af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9bfd9559d0>]}
[0m08:21:19.875552 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m08:21:20.176846 [debug] [MainThread]: checksum: cac3b9519010e47bfbeb71ca6efb4867dae2858687671594dc23fefc94ecf25d, vars: {}, profile: , target: dev, version: 1.9.1
[0m08:21:20.527261 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m08:21:20.536445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '21f908aa-5cf1-4b74-8b93-c29d1b26b8af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9bfd23a390>]}
[0m08:21:25.457798 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.my_dbt_project.transform_users' (models/transform_users.sql) depends on a source named 'my_dbt_profile.users' which was not found
[0m08:21:25.476831 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 7.5200343, "process_in_blocks": "179760", "process_kernel_time": 1.772103, "process_mem_max_rss": "128708", "process_out_blocks": "0", "process_user_time": 11.583752}
[0m08:21:25.488683 [debug] [MainThread]: Command `dbt run` failed at 08:21:25.488140 after 7.53 seconds
[0m08:21:25.492003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c0082b140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9bf6c96720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9bf6e40710>]}
[0m08:21:25.496399 [debug] [MainThread]: Flushing usage events
[0m08:21:26.998932 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:26:37.737972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02b9d2ddc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02bad8f890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02b9d2d5e0>]}


============================== 08:26:37.749643 | 057e1121-d847-4950-b143-a7495ac72498 ==============================
[0m08:26:37.749643 [info ] [MainThread]: Running with dbt=1.9.1
[0m08:26:37.751215 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/profiles.yml', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dags/dbt_models/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt/profiles.yml --target dev', 'send_anonymous_usage_stats': 'True'}
[0m08:26:38.299458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '057e1121-d847-4950-b143-a7495ac72498', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02b8f37e60>]}
[0m08:26:38.411357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '057e1121-d847-4950-b143-a7495ac72498', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02b8f0f620>]}
[0m08:26:38.424181 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m08:26:38.638446 [debug] [MainThread]: checksum: cac3b9519010e47bfbeb71ca6efb4867dae2858687671594dc23fefc94ecf25d, vars: {}, profile: , target: dev, version: 1.9.1
[0m08:26:38.746880 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m08:26:38.748533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '057e1121-d847-4950-b143-a7495ac72498', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02b322fe90>]}
[0m08:26:41.346609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '057e1121-d847-4950-b143-a7495ac72498', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02ba0c23c0>]}
[0m08:26:43.749423 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m08:26:43.860342 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m08:26:44.725689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '057e1121-d847-4950-b143-a7495ac72498', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02b31c6b40>]}
[0m08:26:44.727852 [info ] [MainThread]: Found 1 model, 1 source, 424 macros
[0m08:26:44.738372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '057e1121-d847-4950-b143-a7495ac72498', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02b32f3620>]}
[0m08:26:44.756289 [info ] [MainThread]: 
[0m08:26:44.759565 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:26:44.765772 [info ] [MainThread]: 
[0m08:26:44.773334 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m08:26:44.785133 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_my_duckdb_database'
[0m08:26:45.204134 [debug] [ThreadPool]: Using duckdb connection "list_my_duckdb_database"
[0m08:26:45.208105 [debug] [ThreadPool]: On list_my_duckdb_database: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "list_my_duckdb_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"my_duckdb_database"'
    
  
  
[0m08:26:45.213047 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:26:45.663980 [debug] [ThreadPool]: SQL status: OK in 0.440 seconds
[0m08:26:45.747926 [debug] [ThreadPool]: On list_my_duckdb_database: Close
[0m08:26:45.876630 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_duckdb_database, now create_my_duckdb_database_main)
[0m08:26:45.890911 [debug] [ThreadPool]: Creating schema "database: "my_duckdb_database"
schema: "main"
"
[0m08:26:45.967631 [debug] [ThreadPool]: Using duckdb connection "create_my_duckdb_database_main"
[0m08:26:45.982651 [debug] [ThreadPool]: On create_my_duckdb_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "create_my_duckdb_database_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='my_duckdb_database'
        and type='sqlite'
    
  
[0m08:26:45.987675 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:27:14.663405 [debug] [ThreadPool]: SQL status: OK in 28.659 seconds
[0m08:27:14.737810 [debug] [ThreadPool]: Using duckdb connection "create_my_duckdb_database_main"
[0m08:27:14.740193 [debug] [ThreadPool]: On create_my_duckdb_database_main: BEGIN
[0m08:27:14.829248 [debug] [ThreadPool]: SQL status: OK in 0.084 seconds
[0m08:27:14.837502 [debug] [ThreadPool]: Using duckdb connection "create_my_duckdb_database_main"
[0m08:27:14.840426 [debug] [ThreadPool]: On create_my_duckdb_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "create_my_duckdb_database_main"} */

    
    
        create schema if not exists "my_duckdb_database"."main"
    
[0m08:27:14.877638 [debug] [ThreadPool]: SQL status: OK in 0.034 seconds
[0m08:27:14.888955 [debug] [ThreadPool]: On create_my_duckdb_database_main: COMMIT
[0m08:27:14.890887 [debug] [ThreadPool]: Using duckdb connection "create_my_duckdb_database_main"
[0m08:27:14.892680 [debug] [ThreadPool]: On create_my_duckdb_database_main: COMMIT
[0m08:27:14.899837 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m08:27:14.902421 [debug] [ThreadPool]: On create_my_duckdb_database_main: Close
[0m08:27:14.939402 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_my_duckdb_database_main'
[0m08:27:14.975264 [debug] [ThreadPool]: Using duckdb connection "list_my_duckdb_database_main"
[0m08:27:14.983016 [debug] [ThreadPool]: On list_my_duckdb_database_main: BEGIN
[0m08:27:14.986182 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:27:15.447959 [debug] [ThreadPool]: SQL status: OK in 0.461 seconds
[0m08:27:15.466922 [debug] [ThreadPool]: Using duckdb connection "list_my_duckdb_database_main"
[0m08:27:15.485473 [debug] [ThreadPool]: On list_my_duckdb_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "list_my_duckdb_database_main"} */
select
      'my_duckdb_database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'my_duckdb_database'
  
[0m08:27:16.175588 [debug] [ThreadPool]: SQL status: OK in 0.653 seconds
[0m08:27:16.181301 [debug] [ThreadPool]: On list_my_duckdb_database_main: ROLLBACK
[0m08:27:16.203379 [debug] [ThreadPool]: Failed to rollback 'list_my_duckdb_database_main'
[0m08:27:16.206442 [debug] [ThreadPool]: On list_my_duckdb_database_main: Close
[0m08:27:16.258171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '057e1121-d847-4950-b143-a7495ac72498', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02b31892b0>]}
[0m08:27:16.280468 [debug] [MainThread]: Using duckdb connection "master"
[0m08:27:16.288908 [debug] [MainThread]: On master: BEGIN
[0m08:27:16.292975 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:27:16.369727 [debug] [MainThread]: SQL status: OK in 0.077 seconds
[0m08:27:16.371261 [debug] [MainThread]: On master: COMMIT
[0m08:27:16.385758 [debug] [MainThread]: Using duckdb connection "master"
[0m08:27:16.389089 [debug] [MainThread]: On master: COMMIT
[0m08:27:16.401040 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m08:27:16.411721 [debug] [MainThread]: On master: Close
[0m08:27:16.444298 [debug] [Thread-1 (]: Began running node model.my_dbt_project.transform_users
[0m08:27:16.448095 [info ] [Thread-1 (]: 1 of 1 START sql table model main.transform_users .............................. [RUN]
[0m08:27:16.456027 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.my_dbt_project.transform_users'
[0m08:27:16.459792 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.transform_users
[0m08:27:16.523178 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.transform_users"
[0m08:27:16.606710 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.transform_users
[0m08:27:17.059286 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.transform_users"
[0m08:27:17.281795 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users"
[0m08:27:17.284816 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users: BEGIN
[0m08:27:17.286589 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m08:27:17.610987 [debug] [Thread-1 (]: SQL status: OK in 0.312 seconds
[0m08:27:17.629439 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users"
[0m08:27:17.667663 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_users"} */

  
    
    

    create  table
      "my_duckdb_database"."main"."transform_users__dbt_tmp"
  
    as (
      -- /opt/airflow/dags/dbt_models/transform_users.sql


WITH users AS (
    SELECT * FROM "my_duckdb_database"."public"."users"
)

SELECT
    id,
    name,
    username,
    email,
    address_street,
    address_suite,
    address_city,
    address_zipcode,
    phone,
    website,
    company_name
FROM users
WHERE address_city = 'Gwenborough'
    );
  
  
[0m08:27:18.598241 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_users"} */

  
    
    

    create  table
      "my_duckdb_database"."main"."transform_users__dbt_tmp"
  
    as (
      -- /opt/airflow/dags/dbt_models/transform_users.sql


WITH users AS (
    SELECT * FROM "my_duckdb_database"."public"."users"
)

SELECT
    id,
    name,
    username,
    email,
    address_street,
    address_suite,
    address_city,
    address_zipcode,
    phone,
    website,
    company_name
FROM users
WHERE address_city = 'Gwenborough'
    );
  
  
[0m08:27:18.616750 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m08:27:18.633557 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users: ROLLBACK
[0m08:27:18.723729 [debug] [Thread-1 (]: Failed to rollback 'model.my_dbt_project.transform_users'
[0m08:27:18.742128 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users: Close
[0m08:27:18.795945 [debug] [Thread-1 (]: Runtime Error in model transform_users (models/transform_users.sql)
  Catalog Error: Table with name users does not exist!
  Did you mean "my_duckdb_database.users"?
  LINE 15:     SELECT * FROM "my_duckdb_database"."public"."users"
                             ^
[0m08:27:18.830584 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '057e1121-d847-4950-b143-a7495ac72498', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02b9d002f0>]}
[0m08:27:18.837713 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model main.transform_users ..................... [[31mERROR[0m in 2.36s]
[0m08:27:18.869896 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.transform_users
[0m08:27:18.885945 [debug] [Thread-4 (]: Marking all children of 'model.my_dbt_project.transform_users' to be skipped because of status 'error'.  Reason: Runtime Error in model transform_users (models/transform_users.sql)
  Catalog Error: Table with name users does not exist!
  Did you mean "my_duckdb_database.users"?
  LINE 15:     SELECT * FROM "my_duckdb_database"."public"."users"
                             ^.
[0m08:27:18.935333 [debug] [MainThread]: Using duckdb connection "master"
[0m08:27:18.979566 [debug] [MainThread]: On master: BEGIN
[0m08:27:18.995665 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:27:19.229748 [debug] [MainThread]: SQL status: OK in 0.234 seconds
[0m08:27:19.236150 [debug] [MainThread]: On master: COMMIT
[0m08:27:19.300809 [debug] [MainThread]: Using duckdb connection "master"
[0m08:27:19.348029 [debug] [MainThread]: On master: COMMIT
[0m08:27:19.364869 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m08:27:19.367409 [debug] [MainThread]: On master: Close
[0m08:27:19.427181 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:27:19.440231 [debug] [MainThread]: Connection 'create_my_duckdb_database_main' was properly closed.
[0m08:27:19.447487 [debug] [MainThread]: Connection 'list_my_duckdb_database_main' was properly closed.
[0m08:27:19.463609 [debug] [MainThread]: Connection 'model.my_dbt_project.transform_users' was properly closed.
[0m08:27:19.479700 [info ] [MainThread]: 
[0m08:27:19.503984 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 34.71 seconds (34.71s).
[0m08:27:19.526262 [debug] [MainThread]: Command end result
[0m08:27:20.170763 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m08:27:20.224118 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m08:27:20.362331 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dags/dbt_models/target/run_results.json
[0m08:27:20.365382 [info ] [MainThread]: 
[0m08:27:20.379858 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m08:27:20.388851 [info ] [MainThread]: 
[0m08:27:20.414269 [error] [MainThread]:   Runtime Error in model transform_users (models/transform_users.sql)
  Catalog Error: Table with name users does not exist!
  Did you mean "my_duckdb_database.users"?
  LINE 15:     SELECT * FROM "my_duckdb_database"."public"."users"
                             ^
[0m08:27:20.437593 [info ] [MainThread]: 
[0m08:27:20.454894 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m08:27:20.482473 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 42.92076, "process_in_blocks": "2417864", "process_kernel_time": 5.89849, "process_mem_max_rss": "138088", "process_out_blocks": "456", "process_user_time": 8.797748}
[0m08:27:20.494624 [debug] [MainThread]: Command `dbt run` failed at 08:27:20.487411 after 42.93 seconds
[0m08:27:20.498840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02b9672600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02b9d8a990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02b941f2f0>]}
[0m08:27:20.512731 [debug] [MainThread]: Flushing usage events
[0m08:27:21.805449 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:30:21.993573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0583d86b40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0585b7c0b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0583d86c90>]}


============================== 08:30:22.037251 | 13eef8fa-759f-44b0-9e2d-aa5a5847f816 ==============================
[0m08:30:22.037251 [info ] [MainThread]: Running with dbt=1.9.1
[0m08:30:22.048996 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/profiles.yml', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dags/dbt_models/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt/profiles.yml --target dev', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m08:30:25.167370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '13eef8fa-759f-44b0-9e2d-aa5a5847f816', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f058587b050>]}
[0m08:30:25.752460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '13eef8fa-759f-44b0-9e2d-aa5a5847f816', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0583ddda30>]}
[0m08:30:25.800298 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m08:30:26.748963 [debug] [MainThread]: checksum: cac3b9519010e47bfbeb71ca6efb4867dae2858687671594dc23fefc94ecf25d, vars: {}, profile: , target: dev, version: 1.9.1
[0m08:30:27.985227 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:30:27.991198 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:30:28.140399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '13eef8fa-759f-44b0-9e2d-aa5a5847f816', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f057dd10e60>]}
[0m08:30:28.403527 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m08:30:28.484160 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m08:30:28.897053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '13eef8fa-759f-44b0-9e2d-aa5a5847f816', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f057d91b7d0>]}
[0m08:30:28.902295 [info ] [MainThread]: Found 1 model, 1 source, 424 macros
[0m08:30:28.907396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '13eef8fa-759f-44b0-9e2d-aa5a5847f816', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0583698d10>]}
[0m08:30:28.928680 [info ] [MainThread]: 
[0m08:30:28.934117 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:30:28.941859 [info ] [MainThread]: 
[0m08:30:28.957906 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m08:30:28.970737 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_my_duckdb_database'
[0m08:30:29.420709 [debug] [ThreadPool]: Using duckdb connection "list_my_duckdb_database"
[0m08:30:29.431500 [debug] [ThreadPool]: On list_my_duckdb_database: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "list_my_duckdb_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"my_duckdb_database"'
    
  
  
[0m08:30:29.433388 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:30:30.222057 [debug] [ThreadPool]: SQL status: OK in 0.783 seconds
[0m08:30:30.312888 [debug] [ThreadPool]: On list_my_duckdb_database: Close
[0m08:30:30.501005 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_duckdb_database, now create_my_duckdb_database_main)
[0m08:30:30.522433 [debug] [ThreadPool]: Creating schema "database: "my_duckdb_database"
schema: "main"
"
[0m08:30:30.602473 [debug] [ThreadPool]: Using duckdb connection "create_my_duckdb_database_main"
[0m08:30:30.610787 [debug] [ThreadPool]: On create_my_duckdb_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "create_my_duckdb_database_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='my_duckdb_database'
        and type='sqlite'
    
  
[0m08:30:30.616457 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:31:13.597434 [debug] [ThreadPool]: SQL status: OK in 42.971 seconds
[0m08:31:13.611960 [debug] [ThreadPool]: Using duckdb connection "create_my_duckdb_database_main"
[0m08:31:13.614276 [debug] [ThreadPool]: On create_my_duckdb_database_main: BEGIN
[0m08:31:13.653077 [debug] [ThreadPool]: SQL status: OK in 0.033 seconds
[0m08:31:13.661654 [debug] [ThreadPool]: Using duckdb connection "create_my_duckdb_database_main"
[0m08:31:13.670126 [debug] [ThreadPool]: On create_my_duckdb_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "create_my_duckdb_database_main"} */

    
    
        create schema if not exists "my_duckdb_database"."main"
    
[0m08:31:13.697488 [debug] [ThreadPool]: SQL status: OK in 0.025 seconds
[0m08:31:13.707932 [debug] [ThreadPool]: On create_my_duckdb_database_main: COMMIT
[0m08:31:13.716625 [debug] [ThreadPool]: Using duckdb connection "create_my_duckdb_database_main"
[0m08:31:13.727513 [debug] [ThreadPool]: On create_my_duckdb_database_main: COMMIT
[0m08:31:13.732691 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m08:31:13.737018 [debug] [ThreadPool]: On create_my_duckdb_database_main: Close
[0m08:31:13.866237 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_my_duckdb_database_main'
[0m08:31:13.950403 [debug] [ThreadPool]: Using duckdb connection "list_my_duckdb_database_main"
[0m08:31:13.952472 [debug] [ThreadPool]: On list_my_duckdb_database_main: BEGIN
[0m08:31:13.970349 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:31:14.244756 [debug] [ThreadPool]: SQL status: OK in 0.274 seconds
[0m08:31:14.249072 [debug] [ThreadPool]: Using duckdb connection "list_my_duckdb_database_main"
[0m08:31:14.251572 [debug] [ThreadPool]: On list_my_duckdb_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "list_my_duckdb_database_main"} */
select
      'my_duckdb_database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'my_duckdb_database'
  
[0m08:31:14.693107 [debug] [ThreadPool]: SQL status: OK in 0.428 seconds
[0m08:31:14.709667 [debug] [ThreadPool]: On list_my_duckdb_database_main: ROLLBACK
[0m08:31:14.732867 [debug] [ThreadPool]: Failed to rollback 'list_my_duckdb_database_main'
[0m08:31:14.734726 [debug] [ThreadPool]: On list_my_duckdb_database_main: Close
[0m08:31:14.761962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '13eef8fa-759f-44b0-9e2d-aa5a5847f816', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0583543a70>]}
[0m08:31:14.782493 [debug] [MainThread]: Using duckdb connection "master"
[0m08:31:14.802768 [debug] [MainThread]: On master: BEGIN
[0m08:31:14.807081 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:31:15.152521 [debug] [MainThread]: SQL status: OK in 0.334 seconds
[0m08:31:15.157658 [debug] [MainThread]: On master: COMMIT
[0m08:31:15.165210 [debug] [MainThread]: Using duckdb connection "master"
[0m08:31:15.183265 [debug] [MainThread]: On master: COMMIT
[0m08:31:15.204715 [debug] [MainThread]: SQL status: OK in 0.012 seconds
[0m08:31:15.218793 [debug] [MainThread]: On master: Close
[0m08:31:15.307089 [debug] [Thread-1 (]: Began running node model.my_dbt_project.transform_users
[0m08:31:15.315336 [info ] [Thread-1 (]: 1 of 1 START sql table model main.transform_users .............................. [RUN]
[0m08:31:15.341504 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.my_dbt_project.transform_users'
[0m08:31:15.394408 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.transform_users
[0m08:31:15.603269 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.transform_users"
[0m08:31:15.933913 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.transform_users
[0m08:31:16.646237 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.transform_users"
[0m08:31:16.819041 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users"
[0m08:31:16.823255 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users: BEGIN
[0m08:31:16.838463 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m08:31:17.370427 [debug] [Thread-1 (]: SQL status: OK in 0.532 seconds
[0m08:31:17.395917 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users"
[0m08:31:17.412733 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_users"} */

  
    
    

    create  table
      "my_duckdb_database"."main"."transform_users__dbt_tmp"
  
    as (
      -- /opt/airflow/dags/dbt_models/transform_users.sql


WITH users AS (
    SELECT * FROM "my_duckdb_database"."public"."users"
)

SELECT
    id,
    name,
    username,
    email,
    address_street,
    address_suite,
    address_city,
    address_zipcode,
    phone,
    website,
    company_name
FROM users
WHERE address_city = 'Gwenborough'
    );
  
  
[0m08:31:17.908796 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_users"} */

  
    
    

    create  table
      "my_duckdb_database"."main"."transform_users__dbt_tmp"
  
    as (
      -- /opt/airflow/dags/dbt_models/transform_users.sql


WITH users AS (
    SELECT * FROM "my_duckdb_database"."public"."users"
)

SELECT
    id,
    name,
    username,
    email,
    address_street,
    address_suite,
    address_city,
    address_zipcode,
    phone,
    website,
    company_name
FROM users
WHERE address_city = 'Gwenborough'
    );
  
  
[0m08:31:17.934104 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m08:31:17.938085 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users: ROLLBACK
[0m08:31:18.078246 [debug] [Thread-1 (]: Failed to rollback 'model.my_dbt_project.transform_users'
[0m08:31:18.086135 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users: Close
[0m08:31:18.160978 [debug] [Thread-1 (]: Runtime Error in model transform_users (models/transform_users.sql)
  Catalog Error: Table with name users does not exist!
  Did you mean "my_duckdb_database.users"?
  LINE 15:     SELECT * FROM "my_duckdb_database"."public"."users"
                             ^
[0m08:31:18.184267 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '13eef8fa-759f-44b0-9e2d-aa5a5847f816', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05842d4380>]}
[0m08:31:18.219269 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model main.transform_users ..................... [[31mERROR[0m in 2.84s]
[0m08:31:18.233908 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.transform_users
[0m08:31:18.260074 [debug] [Thread-4 (]: Marking all children of 'model.my_dbt_project.transform_users' to be skipped because of status 'error'.  Reason: Runtime Error in model transform_users (models/transform_users.sql)
  Catalog Error: Table with name users does not exist!
  Did you mean "my_duckdb_database.users"?
  LINE 15:     SELECT * FROM "my_duckdb_database"."public"."users"
                             ^.
[0m08:31:18.316816 [debug] [MainThread]: Using duckdb connection "master"
[0m08:31:18.335398 [debug] [MainThread]: On master: BEGIN
[0m08:31:18.342352 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:31:18.403560 [debug] [MainThread]: SQL status: OK in 0.061 seconds
[0m08:31:18.412739 [debug] [MainThread]: On master: COMMIT
[0m08:31:18.414710 [debug] [MainThread]: Using duckdb connection "master"
[0m08:31:18.417194 [debug] [MainThread]: On master: COMMIT
[0m08:31:18.419446 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m08:31:18.434856 [debug] [MainThread]: On master: Close
[0m08:31:18.458150 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:31:18.459752 [debug] [MainThread]: Connection 'create_my_duckdb_database_main' was properly closed.
[0m08:31:18.469798 [debug] [MainThread]: Connection 'list_my_duckdb_database_main' was properly closed.
[0m08:31:18.472036 [debug] [MainThread]: Connection 'model.my_dbt_project.transform_users' was properly closed.
[0m08:31:18.475729 [info ] [MainThread]: 
[0m08:31:18.501668 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 49.52 seconds (49.52s).
[0m08:31:18.534849 [debug] [MainThread]: Command end result
[0m08:31:19.190701 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m08:31:19.268445 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m08:31:19.366692 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dags/dbt_models/target/run_results.json
[0m08:31:19.369601 [info ] [MainThread]: 
[0m08:31:19.372677 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m08:31:19.375348 [info ] [MainThread]: 
[0m08:31:19.388593 [error] [MainThread]:   Runtime Error in model transform_users (models/transform_users.sql)
  Catalog Error: Table with name users does not exist!
  Did you mean "my_duckdb_database.users"?
  LINE 15:     SELECT * FROM "my_duckdb_database"."public"."users"
                             ^
[0m08:31:19.428734 [info ] [MainThread]: 
[0m08:31:19.449106 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m08:31:19.465661 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 58.271614, "process_in_blocks": "3736600", "process_kernel_time": 10.950403, "process_mem_max_rss": "125664", "process_out_blocks": "0", "process_user_time": 14.03391}
[0m08:31:19.471603 [debug] [MainThread]: Command `dbt run` failed at 08:31:19.470505 after 58.28 seconds
[0m08:31:19.484854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f058735f140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0583567e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0583567fe0>]}
[0m08:31:19.509492 [debug] [MainThread]: Flushing usage events
[0m08:31:21.059590 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:37:48.372418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd4d8f63c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd4d8f6180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd4d8f5a90>]}


============================== 08:37:48.535527 | 6e0e72ae-bc1a-429c-a150-27f2332b41da ==============================
[0m08:37:48.535527 [info ] [MainThread]: Running with dbt=1.9.1
[0m08:37:48.539452 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/profiles.yml', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dags/dbt_models/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt/profiles.yml --target dev', 'send_anonymous_usage_stats': 'True'}
[0m08:37:52.865187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6e0e72ae-bc1a-429c-a150-27f2332b41da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd4d7d08c0>]}
[0m08:37:53.494455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6e0e72ae-bc1a-429c-a150-27f2332b41da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd4811b620>]}
[0m08:37:53.598650 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m08:37:55.350222 [debug] [MainThread]: checksum: cac3b9519010e47bfbeb71ca6efb4867dae2858687671594dc23fefc94ecf25d, vars: {}, profile: , target: dev, version: 1.9.1
[0m08:37:56.725272 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:37:56.730782 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/sources.yml
[0m08:38:00.270174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6e0e72ae-bc1a-429c-a150-27f2332b41da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd3b107050>]}
[0m08:38:01.338537 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m08:38:01.448116 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m08:38:02.495344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6e0e72ae-bc1a-429c-a150-27f2332b41da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd3bc98140>]}
[0m08:38:02.746722 [info ] [MainThread]: Found 1 model, 1 source, 424 macros
[0m08:38:02.824743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6e0e72ae-bc1a-429c-a150-27f2332b41da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd3bbddcd0>]}
[0m08:38:02.985769 [info ] [MainThread]: 
[0m08:38:03.119019 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:38:03.156776 [info ] [MainThread]: 
[0m08:38:03.285548 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m08:38:03.548615 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_my_duckdb_database'
[0m08:38:44.134933 [debug] [ThreadPool]: Using duckdb connection "list_my_duckdb_database"
[0m08:38:44.139699 [debug] [ThreadPool]: On list_my_duckdb_database: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "list_my_duckdb_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"my_duckdb_database"'
    
  
  
[0m08:38:44.142423 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:38:44.897780 [debug] [ThreadPool]: SQL status: OK in 0.760 seconds
[0m08:38:44.925659 [debug] [ThreadPool]: On list_my_duckdb_database: Close
[0m08:38:44.965755 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_duckdb_database, now create_my_duckdb_database_main)
[0m08:38:45.011829 [debug] [ThreadPool]: Creating schema "database: "my_duckdb_database"
schema: "main"
"
[0m08:38:45.303077 [debug] [ThreadPool]: Using duckdb connection "create_my_duckdb_database_main"
[0m08:38:45.310177 [debug] [ThreadPool]: On create_my_duckdb_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "create_my_duckdb_database_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='my_duckdb_database'
        and type='sqlite'
    
  
[0m08:38:45.330084 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:38:45.854996 [debug] [ThreadPool]: SQL status: OK in 0.525 seconds
[0m08:38:45.908240 [debug] [ThreadPool]: Using duckdb connection "create_my_duckdb_database_main"
[0m08:38:45.925861 [debug] [ThreadPool]: On create_my_duckdb_database_main: BEGIN
[0m08:38:45.950914 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m08:38:45.967175 [debug] [ThreadPool]: Using duckdb connection "create_my_duckdb_database_main"
[0m08:38:45.974168 [debug] [ThreadPool]: On create_my_duckdb_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "create_my_duckdb_database_main"} */

    
    
        create schema if not exists "my_duckdb_database"."main"
    
[0m08:38:46.078393 [debug] [ThreadPool]: SQL status: OK in 0.039 seconds
[0m08:38:46.084810 [debug] [ThreadPool]: On create_my_duckdb_database_main: COMMIT
[0m08:38:46.087225 [debug] [ThreadPool]: Using duckdb connection "create_my_duckdb_database_main"
[0m08:38:46.099020 [debug] [ThreadPool]: On create_my_duckdb_database_main: COMMIT
[0m08:38:46.116744 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m08:38:46.141069 [debug] [ThreadPool]: On create_my_duckdb_database_main: Close
[0m08:38:46.229974 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_my_duckdb_database_main'
[0m08:38:46.391855 [debug] [ThreadPool]: Using duckdb connection "list_my_duckdb_database_main"
[0m08:38:46.397334 [debug] [ThreadPool]: On list_my_duckdb_database_main: BEGIN
[0m08:38:46.411352 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:38:46.925937 [debug] [ThreadPool]: SQL status: OK in 0.514 seconds
[0m08:38:46.955859 [debug] [ThreadPool]: Using duckdb connection "list_my_duckdb_database_main"
[0m08:38:46.972995 [debug] [ThreadPool]: On list_my_duckdb_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "list_my_duckdb_database_main"} */
select
      'my_duckdb_database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'my_duckdb_database'
  
[0m08:38:48.221775 [debug] [ThreadPool]: SQL status: OK in 1.220 seconds
[0m08:38:48.257854 [debug] [ThreadPool]: On list_my_duckdb_database_main: ROLLBACK
[0m08:38:48.364602 [debug] [ThreadPool]: Failed to rollback 'list_my_duckdb_database_main'
[0m08:38:48.383226 [debug] [ThreadPool]: On list_my_duckdb_database_main: Close
[0m08:38:48.631098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6e0e72ae-bc1a-429c-a150-27f2332b41da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd3bd5ba70>]}
[0m08:38:48.643977 [debug] [MainThread]: Using duckdb connection "master"
[0m08:38:48.688463 [debug] [MainThread]: On master: BEGIN
[0m08:38:48.705233 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:38:49.274627 [debug] [MainThread]: SQL status: OK in 0.579 seconds
[0m08:38:49.278336 [debug] [MainThread]: On master: COMMIT
[0m08:38:49.294076 [debug] [MainThread]: Using duckdb connection "master"
[0m08:38:49.309784 [debug] [MainThread]: On master: COMMIT
[0m08:38:49.319735 [debug] [MainThread]: SQL status: OK in 0.006 seconds
[0m08:38:49.342877 [debug] [MainThread]: On master: Close
[0m08:38:49.405380 [debug] [Thread-1 (]: Began running node model.my_dbt_project.transform_users
[0m08:38:49.414350 [info ] [Thread-1 (]: 1 of 1 START sql table model main.transform_users .............................. [RUN]
[0m08:38:49.418810 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.my_dbt_project.transform_users'
[0m08:38:49.428988 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.transform_users
[0m08:38:49.502660 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.transform_users"
[0m08:38:49.536169 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.transform_users
[0m08:38:49.753580 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.transform_users"
[0m08:38:49.779730 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users"
[0m08:38:49.781850 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users: BEGIN
[0m08:38:49.784285 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m08:38:50.050345 [debug] [Thread-1 (]: SQL status: OK in 0.264 seconds
[0m08:38:50.054154 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users"
[0m08:38:50.056745 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_users"} */

  
    
    

    create  table
      "my_duckdb_database"."main"."transform_users__dbt_tmp"
  
    as (
      -- /opt/airflow/dags/dbt_models/transform_users.sql


WITH users AS (
    SELECT * FROM "my_duckdb_database"."apidata"."users"
)

SELECT
    id,
    name,
    username,
    email,
    address_street,
    address_suite,
    address_city,
    address_zipcode,
    phone,
    website,
    company_name
FROM users
WHERE address_city = 'Gwenborough'
    );
  
  
[0m08:38:50.269324 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_users"} */

  
    
    

    create  table
      "my_duckdb_database"."main"."transform_users__dbt_tmp"
  
    as (
      -- /opt/airflow/dags/dbt_models/transform_users.sql


WITH users AS (
    SELECT * FROM "my_duckdb_database"."apidata"."users"
)

SELECT
    id,
    name,
    username,
    email,
    address_street,
    address_suite,
    address_city,
    address_zipcode,
    phone,
    website,
    company_name
FROM users
WHERE address_city = 'Gwenborough'
    );
  
  
[0m08:38:50.275367 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m08:38:50.282954 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users: ROLLBACK
[0m08:38:50.327326 [debug] [Thread-1 (]: Failed to rollback 'model.my_dbt_project.transform_users'
[0m08:38:50.331988 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users: Close
[0m08:38:50.372796 [debug] [Thread-1 (]: Runtime Error in model transform_users (models/transform_users.sql)
  Catalog Error: Table with name users does not exist!
  Did you mean "my_duckdb_database.users"?
  LINE 15:     SELECT * FROM "my_duckdb_database"."apidata"."users"
                             ^
[0m08:38:50.395064 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e0e72ae-bc1a-429c-a150-27f2332b41da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd3ba328d0>]}
[0m08:38:50.398270 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model main.transform_users ..................... [[31mERROR[0m in 0.96s]
[0m08:38:50.401687 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.transform_users
[0m08:38:50.405841 [debug] [Thread-4 (]: Marking all children of 'model.my_dbt_project.transform_users' to be skipped because of status 'error'.  Reason: Runtime Error in model transform_users (models/transform_users.sql)
  Catalog Error: Table with name users does not exist!
  Did you mean "my_duckdb_database.users"?
  LINE 15:     SELECT * FROM "my_duckdb_database"."apidata"."users"
                             ^.
[0m08:38:50.413727 [debug] [MainThread]: Using duckdb connection "master"
[0m08:38:50.416488 [debug] [MainThread]: On master: BEGIN
[0m08:38:50.418138 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:38:50.584151 [debug] [MainThread]: SQL status: OK in 0.166 seconds
[0m08:38:50.586123 [debug] [MainThread]: On master: COMMIT
[0m08:38:50.587899 [debug] [MainThread]: Using duckdb connection "master"
[0m08:38:50.589402 [debug] [MainThread]: On master: COMMIT
[0m08:38:50.592399 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m08:38:50.594579 [debug] [MainThread]: On master: Close
[0m08:38:50.606377 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:38:50.608124 [debug] [MainThread]: Connection 'create_my_duckdb_database_main' was properly closed.
[0m08:38:50.609979 [debug] [MainThread]: Connection 'list_my_duckdb_database_main' was properly closed.
[0m08:38:50.611938 [debug] [MainThread]: Connection 'model.my_dbt_project.transform_users' was properly closed.
[0m08:38:50.618121 [info ] [MainThread]: 
[0m08:38:50.620249 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 47.40 seconds (47.40s).
[0m08:38:50.628646 [debug] [MainThread]: Command end result
[0m08:38:50.805383 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m08:38:50.841602 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m08:38:50.883365 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dags/dbt_models/target/run_results.json
[0m08:38:50.885040 [info ] [MainThread]: 
[0m08:38:50.887279 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m08:38:50.889873 [info ] [MainThread]: 
[0m08:38:50.892133 [error] [MainThread]:   Runtime Error in model transform_users (models/transform_users.sql)
  Catalog Error: Table with name users does not exist!
  Did you mean "my_duckdb_database.users"?
  LINE 15:     SELECT * FROM "my_duckdb_database"."apidata"."users"
                             ^
[0m08:38:50.894679 [info ] [MainThread]: 
[0m08:38:50.901093 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m08:38:50.942301 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 63.820404, "process_in_blocks": "1264512", "process_kernel_time": 7.829948, "process_mem_max_rss": "122328", "process_out_blocks": "0", "process_user_time": 13.47664}
[0m08:38:50.946597 [debug] [MainThread]: Command `dbt run` failed at 08:38:50.946143 after 63.84 seconds
[0m08:38:50.955083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd4d8f5fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd3a566600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd3b1d7e30>]}
[0m08:38:50.958468 [debug] [MainThread]: Flushing usage events
[0m08:38:55.983948 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:40:54.109699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5d321dbb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5d53f6390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5d37f56a0>]}


============================== 08:40:54.128551 | ec602438-dded-4fb3-a267-042849db0773 ==============================
[0m08:40:54.128551 [info ] [MainThread]: Running with dbt=1.9.1
[0m08:40:54.130911 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt/profiles.yml', 'log_path': '/opt/airflow/dags/dbt_models/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt/profiles.yml --target dev', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:40:57.392821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ec602438-dded-4fb3-a267-042849db0773', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5d303a0f0>]}
[0m08:40:57.564474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ec602438-dded-4fb3-a267-042849db0773', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5d33a9b80>]}
[0m08:40:57.733746 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m08:40:58.955429 [debug] [MainThread]: checksum: cac3b9519010e47bfbeb71ca6efb4867dae2858687671594dc23fefc94ecf25d, vars: {}, profile: , target: dev, version: 1.9.1
[0m08:40:59.522282 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:40:59.523949 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:40:59.671512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ec602438-dded-4fb3-a267-042849db0773', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5cced0f50>]}
[0m08:41:00.035087 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m08:41:00.131127 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m08:41:00.364119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ec602438-dded-4fb3-a267-042849db0773', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5d2b40bf0>]}
[0m08:41:00.366352 [info ] [MainThread]: Found 1 model, 1 source, 424 macros
[0m08:41:00.368062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ec602438-dded-4fb3-a267-042849db0773', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5cd31ba70>]}
[0m08:41:00.376196 [info ] [MainThread]: 
[0m08:41:00.380328 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:41:00.385182 [info ] [MainThread]: 
[0m08:41:00.392401 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m08:41:00.397139 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_my_duckdb_database'
[0m08:41:00.646799 [debug] [ThreadPool]: Using duckdb connection "list_my_duckdb_database"
[0m08:41:00.650735 [debug] [ThreadPool]: On list_my_duckdb_database: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "list_my_duckdb_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"my_duckdb_database"'
    
  
  
[0m08:41:00.652929 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:41:01.602130 [debug] [ThreadPool]: SQL status: OK in 0.949 seconds
[0m08:41:01.606711 [debug] [ThreadPool]: On list_my_duckdb_database: Close
[0m08:41:01.617114 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_duckdb_database, now create_my_duckdb_database_main)
[0m08:41:01.618753 [debug] [ThreadPool]: Creating schema "database: "my_duckdb_database"
schema: "main"
"
[0m08:41:01.639012 [debug] [ThreadPool]: Using duckdb connection "create_my_duckdb_database_main"
[0m08:41:01.640150 [debug] [ThreadPool]: On create_my_duckdb_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "create_my_duckdb_database_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='my_duckdb_database'
        and type='sqlite'
    
  
[0m08:41:01.642525 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:41:01.667185 [debug] [ThreadPool]: SQL status: OK in 0.025 seconds
[0m08:41:01.670659 [debug] [ThreadPool]: Using duckdb connection "create_my_duckdb_database_main"
[0m08:41:01.672179 [debug] [ThreadPool]: On create_my_duckdb_database_main: BEGIN
[0m08:41:01.679463 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m08:41:01.681196 [debug] [ThreadPool]: Using duckdb connection "create_my_duckdb_database_main"
[0m08:41:01.683190 [debug] [ThreadPool]: On create_my_duckdb_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "create_my_duckdb_database_main"} */

    
    
        create schema if not exists "my_duckdb_database"."main"
    
[0m08:41:01.686019 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m08:41:01.688981 [debug] [ThreadPool]: On create_my_duckdb_database_main: COMMIT
[0m08:41:01.690721 [debug] [ThreadPool]: Using duckdb connection "create_my_duckdb_database_main"
[0m08:41:01.692838 [debug] [ThreadPool]: On create_my_duckdb_database_main: COMMIT
[0m08:41:01.695281 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m08:41:01.697086 [debug] [ThreadPool]: On create_my_duckdb_database_main: Close
[0m08:41:01.706168 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_my_duckdb_database_main, now list_my_duckdb_database_main)
[0m08:41:01.731074 [debug] [ThreadPool]: Using duckdb connection "list_my_duckdb_database_main"
[0m08:41:01.732766 [debug] [ThreadPool]: On list_my_duckdb_database_main: BEGIN
[0m08:41:01.736510 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:41:01.763840 [debug] [ThreadPool]: SQL status: OK in 0.027 seconds
[0m08:41:01.766032 [debug] [ThreadPool]: Using duckdb connection "list_my_duckdb_database_main"
[0m08:41:01.767684 [debug] [ThreadPool]: On list_my_duckdb_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "list_my_duckdb_database_main"} */
select
      'my_duckdb_database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'my_duckdb_database'
  
[0m08:41:01.904158 [debug] [ThreadPool]: SQL status: OK in 0.135 seconds
[0m08:41:01.907352 [debug] [ThreadPool]: On list_my_duckdb_database_main: ROLLBACK
[0m08:41:01.920497 [debug] [ThreadPool]: Failed to rollback 'list_my_duckdb_database_main'
[0m08:41:01.926457 [debug] [ThreadPool]: On list_my_duckdb_database_main: Close
[0m08:41:01.937942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ec602438-dded-4fb3-a267-042849db0773', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5cced3e30>]}
[0m08:41:01.940438 [debug] [MainThread]: Using duckdb connection "master"
[0m08:41:01.942972 [debug] [MainThread]: On master: BEGIN
[0m08:41:01.944878 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:41:01.972589 [debug] [MainThread]: SQL status: OK in 0.028 seconds
[0m08:41:01.975893 [debug] [MainThread]: On master: COMMIT
[0m08:41:01.977696 [debug] [MainThread]: Using duckdb connection "master"
[0m08:41:01.979645 [debug] [MainThread]: On master: COMMIT
[0m08:41:01.982589 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m08:41:01.983755 [debug] [MainThread]: On master: Close
[0m08:41:01.994219 [debug] [Thread-1 (]: Began running node model.my_dbt_project.transform_users
[0m08:41:01.996364 [info ] [Thread-1 (]: 1 of 1 START sql table model main.transform_users .............................. [RUN]
[0m08:41:01.999684 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.my_dbt_project.transform_users'
[0m08:41:02.001688 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.transform_users
[0m08:41:02.032322 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.transform_users"
[0m08:41:02.055078 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.transform_users
[0m08:41:02.181573 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.transform_users"
[0m08:41:02.203999 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users"
[0m08:41:02.205449 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users: BEGIN
[0m08:41:02.206705 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m08:41:02.235861 [debug] [Thread-1 (]: SQL status: OK in 0.029 seconds
[0m08:41:02.237121 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users"
[0m08:41:02.238460 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_users"} */

  
    
    

    create  table
      "my_duckdb_database"."main"."transform_users__dbt_tmp"
  
    as (
      -- /opt/airflow/dags/dbt_models/transform_users.sql


WITH users AS (
    SELECT * FROM "my_duckdb_database"."apidata"."users"
)

SELECT
    id,
    name,
    username,
    email,
    address_street,
    address_suite,
    address_city,
    address_zipcode,
    phone,
    website,
    company_name
FROM users
WHERE address_city = 'Gwenborough'
    );
  
  
[0m08:41:02.329664 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_users"} */

  
    
    

    create  table
      "my_duckdb_database"."main"."transform_users__dbt_tmp"
  
    as (
      -- /opt/airflow/dags/dbt_models/transform_users.sql


WITH users AS (
    SELECT * FROM "my_duckdb_database"."apidata"."users"
)

SELECT
    id,
    name,
    username,
    email,
    address_street,
    address_suite,
    address_city,
    address_zipcode,
    phone,
    website,
    company_name
FROM users
WHERE address_city = 'Gwenborough'
    );
  
  
[0m08:41:02.331461 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m08:41:02.333202 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users: ROLLBACK
[0m08:41:02.353597 [debug] [Thread-1 (]: Failed to rollback 'model.my_dbt_project.transform_users'
[0m08:41:02.355446 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users: Close
[0m08:41:02.371539 [debug] [Thread-1 (]: Runtime Error in model transform_users (models/transform_users.sql)
  Catalog Error: Table with name users does not exist!
  Did you mean "my_duckdb_database.users"?
  LINE 15:     SELECT * FROM "my_duckdb_database"."apidata"."users"
                             ^
[0m08:41:02.379820 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec602438-dded-4fb3-a267-042849db0773', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5d394caa0>]}
[0m08:41:02.382300 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model main.transform_users ..................... [[31mERROR[0m in 0.37s]
[0m08:41:02.385084 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.transform_users
[0m08:41:02.387538 [debug] [Thread-4 (]: Marking all children of 'model.my_dbt_project.transform_users' to be skipped because of status 'error'.  Reason: Runtime Error in model transform_users (models/transform_users.sql)
  Catalog Error: Table with name users does not exist!
  Did you mean "my_duckdb_database.users"?
  LINE 15:     SELECT * FROM "my_duckdb_database"."apidata"."users"
                             ^.
[0m08:41:02.396109 [debug] [MainThread]: Using duckdb connection "master"
[0m08:41:02.398050 [debug] [MainThread]: On master: BEGIN
[0m08:41:02.399817 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:41:02.427795 [debug] [MainThread]: SQL status: OK in 0.028 seconds
[0m08:41:02.429287 [debug] [MainThread]: On master: COMMIT
[0m08:41:02.430881 [debug] [MainThread]: Using duckdb connection "master"
[0m08:41:02.432565 [debug] [MainThread]: On master: COMMIT
[0m08:41:02.435001 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m08:41:02.436569 [debug] [MainThread]: On master: Close
[0m08:41:02.443323 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:41:02.445027 [debug] [MainThread]: Connection 'list_my_duckdb_database_main' was properly closed.
[0m08:41:02.446360 [debug] [MainThread]: Connection 'model.my_dbt_project.transform_users' was properly closed.
[0m08:41:02.447933 [info ] [MainThread]: 
[0m08:41:02.450664 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.06 seconds (2.06s).
[0m08:41:02.454866 [debug] [MainThread]: Command end result
[0m08:41:02.574135 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m08:41:02.586995 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m08:41:02.639284 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dags/dbt_models/target/run_results.json
[0m08:41:02.644146 [info ] [MainThread]: 
[0m08:41:02.647803 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m08:41:02.650399 [info ] [MainThread]: 
[0m08:41:02.653748 [error] [MainThread]:   Runtime Error in model transform_users (models/transform_users.sql)
  Catalog Error: Table with name users does not exist!
  Did you mean "my_duckdb_database.users"?
  LINE 15:     SELECT * FROM "my_duckdb_database"."apidata"."users"
                             ^
[0m08:41:02.659032 [info ] [MainThread]: 
[0m08:41:02.672354 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m08:41:02.705627 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 8.856885, "process_in_blocks": "181320", "process_kernel_time": 1.64873, "process_mem_max_rss": "129796", "process_out_blocks": "0", "process_user_time": 8.973091}
[0m08:41:02.720065 [debug] [MainThread]: Command `dbt run` failed at 08:41:02.719650 after 8.87 seconds
[0m08:41:02.722074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5d321dbb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5cf521250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5cf521e50>]}
[0m08:41:02.726718 [debug] [MainThread]: Flushing usage events
[0m08:41:04.002869 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:45:53.103312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9398db4290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93978a4b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93978a4830>]}


============================== 08:45:53.123129 | bb20273c-0c9d-43da-8fb2-1c1fbc3873e6 ==============================
[0m08:45:53.123129 [info ] [MainThread]: Running with dbt=1.9.1
[0m08:45:53.130421 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/profiles.yml', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dags/dbt_models/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt/profiles.yml --target dev', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m08:45:53.825021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bb20273c-0c9d-43da-8fb2-1c1fbc3873e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f939792d3a0>]}
[0m08:45:53.932108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bb20273c-0c9d-43da-8fb2-1c1fbc3873e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9396b5ee10>]}
[0m08:45:53.944959 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m08:45:54.276709 [debug] [MainThread]: checksum: cac3b9519010e47bfbeb71ca6efb4867dae2858687671594dc23fefc94ecf25d, vars: {}, profile: , target: dev, version: 1.9.1
[0m08:45:54.618147 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:45:54.619829 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/sources.yml
[0m08:45:55.254241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bb20273c-0c9d-43da-8fb2-1c1fbc3873e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93903295e0>]}
[0m08:45:55.485198 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m08:45:55.498981 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m08:45:55.580773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bb20273c-0c9d-43da-8fb2-1c1fbc3873e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9390308290>]}
[0m08:45:55.582030 [info ] [MainThread]: Found 1 model, 1 source, 424 macros
[0m08:45:55.583589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bb20273c-0c9d-43da-8fb2-1c1fbc3873e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9396ab2db0>]}
[0m08:45:55.586695 [info ] [MainThread]: 
[0m08:45:55.588000 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:45:55.589239 [info ] [MainThread]: 
[0m08:45:55.590999 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m08:45:55.594193 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_my_duckdb_database'
[0m08:45:55.694121 [debug] [ThreadPool]: Using duckdb connection "list_my_duckdb_database"
[0m08:45:55.695349 [debug] [ThreadPool]: On list_my_duckdb_database: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "list_my_duckdb_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"my_duckdb_database"'
    
  
  
[0m08:45:55.696454 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:45:55.744668 [debug] [ThreadPool]: SQL status: OK in 0.048 seconds
[0m08:45:55.747645 [debug] [ThreadPool]: On list_my_duckdb_database: Close
[0m08:45:55.753962 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_duckdb_database, now create_my_duckdb_database_main)
[0m08:45:55.755675 [debug] [ThreadPool]: Creating schema "database: "my_duckdb_database"
schema: "main"
"
[0m08:45:55.768704 [debug] [ThreadPool]: Using duckdb connection "create_my_duckdb_database_main"
[0m08:45:55.769898 [debug] [ThreadPool]: On create_my_duckdb_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "create_my_duckdb_database_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='my_duckdb_database'
        and type='sqlite'
    
  
[0m08:45:55.770950 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:45:55.797303 [debug] [ThreadPool]: SQL status: OK in 0.026 seconds
[0m08:45:55.800004 [debug] [ThreadPool]: Using duckdb connection "create_my_duckdb_database_main"
[0m08:45:55.801196 [debug] [ThreadPool]: On create_my_duckdb_database_main: BEGIN
[0m08:45:55.803075 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m08:45:55.804615 [debug] [ThreadPool]: Using duckdb connection "create_my_duckdb_database_main"
[0m08:45:55.805792 [debug] [ThreadPool]: On create_my_duckdb_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "create_my_duckdb_database_main"} */

    
    
        create schema if not exists "my_duckdb_database"."main"
    
[0m08:45:55.808990 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m08:45:55.811572 [debug] [ThreadPool]: On create_my_duckdb_database_main: COMMIT
[0m08:45:55.812775 [debug] [ThreadPool]: Using duckdb connection "create_my_duckdb_database_main"
[0m08:45:55.813947 [debug] [ThreadPool]: On create_my_duckdb_database_main: COMMIT
[0m08:45:55.815838 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m08:45:55.817119 [debug] [ThreadPool]: On create_my_duckdb_database_main: Close
[0m08:45:55.823532 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_my_duckdb_database_main, now list_my_duckdb_database_main)
[0m08:45:55.836098 [debug] [ThreadPool]: Using duckdb connection "list_my_duckdb_database_main"
[0m08:45:55.837410 [debug] [ThreadPool]: On list_my_duckdb_database_main: BEGIN
[0m08:45:55.838758 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:45:55.864687 [debug] [ThreadPool]: SQL status: OK in 0.026 seconds
[0m08:45:55.866296 [debug] [ThreadPool]: Using duckdb connection "list_my_duckdb_database_main"
[0m08:45:55.867566 [debug] [ThreadPool]: On list_my_duckdb_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "list_my_duckdb_database_main"} */
select
      'my_duckdb_database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'my_duckdb_database'
  
[0m08:45:55.925428 [debug] [ThreadPool]: SQL status: OK in 0.056 seconds
[0m08:45:55.929788 [debug] [ThreadPool]: On list_my_duckdb_database_main: ROLLBACK
[0m08:45:55.933374 [debug] [ThreadPool]: Failed to rollback 'list_my_duckdb_database_main'
[0m08:45:55.934676 [debug] [ThreadPool]: On list_my_duckdb_database_main: Close
[0m08:45:55.942983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bb20273c-0c9d-43da-8fb2-1c1fbc3873e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9396af5d90>]}
[0m08:45:55.944434 [debug] [MainThread]: Using duckdb connection "master"
[0m08:45:55.945612 [debug] [MainThread]: On master: BEGIN
[0m08:45:55.946874 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:45:55.968587 [debug] [MainThread]: SQL status: OK in 0.022 seconds
[0m08:45:55.969770 [debug] [MainThread]: On master: COMMIT
[0m08:45:55.970935 [debug] [MainThread]: Using duckdb connection "master"
[0m08:45:55.972037 [debug] [MainThread]: On master: COMMIT
[0m08:45:55.973946 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m08:45:55.976510 [debug] [MainThread]: On master: Close
[0m08:45:55.982911 [debug] [Thread-1 (]: Began running node model.my_dbt_project.transform_users
[0m08:45:55.984342 [info ] [Thread-1 (]: 1 of 1 START sql table model main.transform_users .............................. [RUN]
[0m08:45:55.986188 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.my_dbt_project.transform_users'
[0m08:45:55.988103 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.transform_users
[0m08:45:56.013532 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.transform_users"
[0m08:45:56.031967 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.transform_users
[0m08:45:56.112539 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.transform_users"
[0m08:45:56.136979 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users"
[0m08:45:56.139556 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users: BEGIN
[0m08:45:56.141567 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m08:45:56.171675 [debug] [Thread-1 (]: SQL status: OK in 0.030 seconds
[0m08:45:56.174639 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users"
[0m08:45:56.183376 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_users"} */

  
    
    

    create  table
      "my_duckdb_database"."main"."transform_users__dbt_tmp"
  
    as (
      -- /opt/airflow/dags/dbt_models/transform_users.sql


WITH users AS (
    SELECT * FROM "my_duckdb_database"."main"."users"
)

SELECT
    id,
    name,
    username,
    email,
    address_street,
    address_suite,
    address_city,
    address_zipcode,
    phone,
    website,
    company_name
FROM users
WHERE address_city = 'Gwenborough'
    );
  
  
[0m08:45:56.216641 [debug] [Thread-1 (]: SQL status: OK in 0.030 seconds
[0m08:45:56.248718 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users"
[0m08:45:56.250727 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_users"} */
alter table "my_duckdb_database"."main"."transform_users__dbt_tmp" rename to "transform_users"
[0m08:45:56.253575 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:45:56.325202 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users: COMMIT
[0m08:45:56.329084 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users"
[0m08:45:56.331446 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users: COMMIT
[0m08:45:56.361327 [debug] [Thread-1 (]: SQL status: OK in 0.027 seconds
[0m08:45:56.396697 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users"
[0m08:45:56.402938 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_users"} */
drop table if exists "my_duckdb_database"."main"."transform_users__dbt_backup" cascade
[0m08:45:56.410188 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:45:56.419229 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users: Close
[0m08:45:56.490854 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb20273c-0c9d-43da-8fb2-1c1fbc3873e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9371b14710>]}
[0m08:45:56.497177 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main.transform_users ......................... [[32mOK[0m in 0.50s]
[0m08:45:56.501165 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.transform_users
[0m08:45:56.505181 [debug] [MainThread]: Using duckdb connection "master"
[0m08:45:56.507197 [debug] [MainThread]: On master: BEGIN
[0m08:45:56.510451 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:45:56.539105 [debug] [MainThread]: SQL status: OK in 0.029 seconds
[0m08:45:56.541211 [debug] [MainThread]: On master: COMMIT
[0m08:45:56.545242 [debug] [MainThread]: Using duckdb connection "master"
[0m08:45:56.549669 [debug] [MainThread]: On master: COMMIT
[0m08:45:56.553650 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m08:45:56.562818 [debug] [MainThread]: On master: Close
[0m08:45:56.573785 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:45:56.576405 [debug] [MainThread]: Connection 'list_my_duckdb_database_main' was properly closed.
[0m08:45:56.578176 [debug] [MainThread]: Connection 'model.my_dbt_project.transform_users' was properly closed.
[0m08:45:56.579824 [info ] [MainThread]: 
[0m08:45:56.582812 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.99 seconds (0.99s).
[0m08:45:56.586951 [debug] [MainThread]: Command end result
[0m08:45:56.774049 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m08:45:56.862884 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m08:45:56.944572 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dags/dbt_models/target/run_results.json
[0m08:45:56.946827 [info ] [MainThread]: 
[0m08:45:56.956378 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:45:56.959967 [info ] [MainThread]: 
[0m08:45:56.963778 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m08:45:56.970253 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.171771, "process_in_blocks": "101992", "process_kernel_time": 0.863226, "process_mem_max_rss": "149284", "process_out_blocks": "0", "process_user_time": 7.917867}
[0m08:45:56.972472 [debug] [MainThread]: Command `dbt run` succeeded at 08:45:56.972142 after 4.17 seconds
[0m08:45:56.974135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9397707080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93913d7950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93970069f0>]}
[0m08:45:56.978248 [debug] [MainThread]: Flushing usage events
[0m08:45:58.397832 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:49:34.513462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87882def90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87882df260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87882dfa70>]}


============================== 09:49:34.529716 | 17094c0a-9226-4b7d-89a8-b4fd4e5d794c ==============================
[0m09:49:34.529716 [info ] [MainThread]: Running with dbt=1.9.1
[0m09:49:34.531258 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dags/dbt_models/logs', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt/profiles.yml', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt/profiles.yml --target dev', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:49:35.348621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '17094c0a-9226-4b7d-89a8-b4fd4e5d794c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8782337110>]}
[0m09:49:35.493715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '17094c0a-9226-4b7d-89a8-b4fd4e5d794c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f878842a060>]}
[0m09:49:35.507222 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m09:49:35.791080 [debug] [MainThread]: checksum: cac3b9519010e47bfbeb71ca6efb4867dae2858687671594dc23fefc94ecf25d, vars: {}, profile: , target: dev, version: 1.9.1
[0m09:49:36.228103 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:49:36.229470 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:49:36.340187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '17094c0a-9226-4b7d-89a8-b4fd4e5d794c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8782393fe0>]}
[0m09:49:36.801838 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m09:49:36.836810 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m09:49:37.023081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '17094c0a-9226-4b7d-89a8-b4fd4e5d794c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8781efffb0>]}
[0m09:49:37.024627 [info ] [MainThread]: Found 1 model, 1 source, 424 macros
[0m09:49:37.026049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '17094c0a-9226-4b7d-89a8-b4fd4e5d794c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87883763c0>]}
[0m09:49:37.029433 [info ] [MainThread]: 
[0m09:49:37.030785 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:49:37.032142 [info ] [MainThread]: 
[0m09:49:37.033928 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m09:49:37.036347 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_my_duckdb_database'
[0m09:49:37.130751 [debug] [ThreadPool]: Using duckdb connection "list_my_duckdb_database"
[0m09:49:37.131876 [debug] [ThreadPool]: On list_my_duckdb_database: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "list_my_duckdb_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"my_duckdb_database"'
    
  
  
[0m09:49:37.132955 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:49:37.181142 [debug] [ThreadPool]: SQL status: OK in 0.048 seconds
[0m09:49:37.185349 [debug] [ThreadPool]: On list_my_duckdb_database: Close
[0m09:49:37.202182 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_duckdb_database, now create_my_duckdb_database_main)
[0m09:49:37.208252 [debug] [ThreadPool]: Creating schema "database: "my_duckdb_database"
schema: "main"
"
[0m09:49:37.240586 [debug] [ThreadPool]: Using duckdb connection "create_my_duckdb_database_main"
[0m09:49:37.242241 [debug] [ThreadPool]: On create_my_duckdb_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "create_my_duckdb_database_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='my_duckdb_database'
        and type='sqlite'
    
  
[0m09:49:37.243460 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:49:37.267593 [debug] [ThreadPool]: SQL status: OK in 0.024 seconds
[0m09:49:37.273795 [debug] [ThreadPool]: Using duckdb connection "create_my_duckdb_database_main"
[0m09:49:37.275502 [debug] [ThreadPool]: On create_my_duckdb_database_main: BEGIN
[0m09:49:37.278018 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:49:37.279613 [debug] [ThreadPool]: Using duckdb connection "create_my_duckdb_database_main"
[0m09:49:37.281297 [debug] [ThreadPool]: On create_my_duckdb_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "create_my_duckdb_database_main"} */

    
    
        create schema if not exists "my_duckdb_database"."main"
    
[0m09:49:37.284613 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m09:49:37.287661 [debug] [ThreadPool]: On create_my_duckdb_database_main: COMMIT
[0m09:49:37.289714 [debug] [ThreadPool]: Using duckdb connection "create_my_duckdb_database_main"
[0m09:49:37.291219 [debug] [ThreadPool]: On create_my_duckdb_database_main: COMMIT
[0m09:49:37.292977 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:49:37.294161 [debug] [ThreadPool]: On create_my_duckdb_database_main: Close
[0m09:49:37.300441 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_my_duckdb_database_main, now list_my_duckdb_database_main)
[0m09:49:37.315486 [debug] [ThreadPool]: Using duckdb connection "list_my_duckdb_database_main"
[0m09:49:37.318212 [debug] [ThreadPool]: On list_my_duckdb_database_main: BEGIN
[0m09:49:37.323313 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:49:37.349743 [debug] [ThreadPool]: SQL status: OK in 0.029 seconds
[0m09:49:37.351241 [debug] [ThreadPool]: Using duckdb connection "list_my_duckdb_database_main"
[0m09:49:37.352722 [debug] [ThreadPool]: On list_my_duckdb_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "list_my_duckdb_database_main"} */
select
      'my_duckdb_database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'my_duckdb_database'
  
[0m09:49:37.409854 [debug] [ThreadPool]: SQL status: OK in 0.056 seconds
[0m09:49:37.412671 [debug] [ThreadPool]: On list_my_duckdb_database_main: ROLLBACK
[0m09:49:37.416330 [debug] [ThreadPool]: Failed to rollback 'list_my_duckdb_database_main'
[0m09:49:37.417521 [debug] [ThreadPool]: On list_my_duckdb_database_main: Close
[0m09:49:37.427513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '17094c0a-9226-4b7d-89a8-b4fd4e5d794c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8787d615b0>]}
[0m09:49:37.429583 [debug] [MainThread]: Using duckdb connection "master"
[0m09:49:37.431128 [debug] [MainThread]: On master: BEGIN
[0m09:49:37.432231 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:49:37.454731 [debug] [MainThread]: SQL status: OK in 0.022 seconds
[0m09:49:37.456719 [debug] [MainThread]: On master: COMMIT
[0m09:49:37.457932 [debug] [MainThread]: Using duckdb connection "master"
[0m09:49:37.459378 [debug] [MainThread]: On master: COMMIT
[0m09:49:37.461264 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m09:49:37.462715 [debug] [MainThread]: On master: Close
[0m09:49:37.470113 [debug] [Thread-1 (]: Began running node model.my_dbt_project.transform_users
[0m09:49:37.472070 [info ] [Thread-1 (]: 1 of 1 START sql table model main.transform_users .............................. [RUN]
[0m09:49:37.474429 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.my_dbt_project.transform_users'
[0m09:49:37.476077 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.transform_users
[0m09:49:37.493854 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.transform_users"
[0m09:49:37.511340 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.transform_users
[0m09:49:37.618367 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.transform_users"
[0m09:49:37.643675 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users"
[0m09:49:37.646866 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users: BEGIN
[0m09:49:37.665539 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m09:49:37.713451 [debug] [Thread-1 (]: SQL status: OK in 0.048 seconds
[0m09:49:37.723491 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users"
[0m09:49:37.725703 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_users"} */

  
    
    

    create  table
      "my_duckdb_database"."main"."transform_users__dbt_tmp"
  
    as (
      -- /opt/airflow/dags/dbt_models/transform_users.sql


WITH users AS (
    SELECT * FROM "my_duckdb_database"."main"."users"
)

SELECT
    id,
    name,
    username,
    email,
    address_street,
    address_suite,
    address_city,
    address_zipcode,
    phone,
    website,
    company_name
FROM users
WHERE address_city = 'Gwenborough'
    );
  
  
[0m09:49:37.742484 [debug] [Thread-1 (]: SQL status: OK in 0.015 seconds
[0m09:49:37.766458 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users"
[0m09:49:37.768378 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_users"} */
alter table "my_duckdb_database"."main"."transform_users__dbt_tmp" rename to "transform_users"
[0m09:49:37.774920 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m09:49:37.827378 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users: COMMIT
[0m09:49:37.832299 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users"
[0m09:49:37.834298 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users: COMMIT
[0m09:49:37.861860 [debug] [Thread-1 (]: SQL status: OK in 0.025 seconds
[0m09:49:37.877036 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users"
[0m09:49:37.878454 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_users"} */
drop table if exists "my_duckdb_database"."main"."transform_users__dbt_backup" cascade
[0m09:49:37.880653 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:49:37.885473 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users: Close
[0m09:49:37.985283 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17094c0a-9226-4b7d-89a8-b4fd4e5d794c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8781058e90>]}
[0m09:49:37.989345 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main.transform_users ......................... [[32mOK[0m in 0.51s]
[0m09:49:37.993023 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.transform_users
[0m09:49:37.996924 [debug] [MainThread]: Using duckdb connection "master"
[0m09:49:37.998182 [debug] [MainThread]: On master: BEGIN
[0m09:49:37.999458 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:49:38.019094 [debug] [MainThread]: SQL status: OK in 0.020 seconds
[0m09:49:38.020316 [debug] [MainThread]: On master: COMMIT
[0m09:49:38.021721 [debug] [MainThread]: Using duckdb connection "master"
[0m09:49:38.023434 [debug] [MainThread]: On master: COMMIT
[0m09:49:38.025059 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m09:49:38.026087 [debug] [MainThread]: On master: Close
[0m09:49:38.029673 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:49:38.030679 [debug] [MainThread]: Connection 'list_my_duckdb_database_main' was properly closed.
[0m09:49:38.031525 [debug] [MainThread]: Connection 'model.my_dbt_project.transform_users' was properly closed.
[0m09:49:38.032429 [info ] [MainThread]: 
[0m09:49:38.033652 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.00 seconds (1.00s).
[0m09:49:38.035340 [debug] [MainThread]: Command end result
[0m09:49:38.100757 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m09:49:38.114171 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m09:49:38.137327 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dags/dbt_models/target/run_results.json
[0m09:49:38.139568 [info ] [MainThread]: 
[0m09:49:38.141050 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:49:38.142673 [info ] [MainThread]: 
[0m09:49:38.144064 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m09:49:38.146625 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.8341699, "process_in_blocks": "71304", "process_kernel_time": 1.363542, "process_mem_max_rss": "146412", "process_out_blocks": "1968", "process_user_time": 9.331109}
[0m09:49:38.148292 [debug] [MainThread]: Command `dbt run` succeeded at 09:49:38.147942 after 3.84 seconds
[0m09:49:38.149600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8787f1e7b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8787d45d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8787d45c40>]}
[0m09:49:38.150819 [debug] [MainThread]: Flushing usage events
[0m09:49:39.683815 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:43:04.218536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a75145940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a7583e8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a7583e810>]}


============================== 10:43:04.237764 | 18f2c7c9-1a78-4551-a70f-9cf7352e15fe ==============================
[0m10:43:04.237764 [info ] [MainThread]: Running with dbt=1.9.1
[0m10:43:04.239881 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/profiles.yml', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dags/dbt_models/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt/profiles.yml --target dev', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:43:05.384195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '18f2c7c9-1a78-4551-a70f-9cf7352e15fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a76c37140>]}
[0m10:43:05.577971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '18f2c7c9-1a78-4551-a70f-9cf7352e15fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a753db2c0>]}
[0m10:43:05.590399 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m10:43:06.060387 [debug] [MainThread]: checksum: cac3b9519010e47bfbeb71ca6efb4867dae2858687671594dc23fefc94ecf25d, vars: {}, profile: , target: dev, version: 1.9.1
[0m10:43:06.377918 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m10:43:06.380589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '18f2c7c9-1a78-4551-a70f-9cf7352e15fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a751461b0>]}
[0m10:43:09.589896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '18f2c7c9-1a78-4551-a70f-9cf7352e15fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a6ebcc890>]}
[0m10:43:09.862548 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m10:43:09.879989 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m10:43:10.106674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '18f2c7c9-1a78-4551-a70f-9cf7352e15fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a6eb74410>]}
[0m10:43:10.110349 [info ] [MainThread]: Found 2 models, 1 source, 424 macros
[0m10:43:10.111931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '18f2c7c9-1a78-4551-a70f-9cf7352e15fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a6edeaba0>]}
[0m10:43:10.117275 [info ] [MainThread]: 
[0m10:43:10.119324 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:43:10.123325 [info ] [MainThread]: 
[0m10:43:10.127094 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m10:43:10.137315 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_my_duckdb_database'
[0m10:43:10.332615 [debug] [ThreadPool]: Using duckdb connection "list_my_duckdb_database"
[0m10:43:10.334320 [debug] [ThreadPool]: On list_my_duckdb_database: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "list_my_duckdb_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"my_duckdb_database"'
    
  
  
[0m10:43:10.335969 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:43:10.387343 [debug] [ThreadPool]: SQL status: OK in 0.051 seconds
[0m10:43:10.394022 [debug] [ThreadPool]: On list_my_duckdb_database: Close
[0m10:43:10.401108 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_duckdb_database, now create_my_duckdb_database_main)
[0m10:43:10.403150 [debug] [ThreadPool]: Creating schema "database: "my_duckdb_database"
schema: "main"
"
[0m10:43:10.442607 [debug] [ThreadPool]: Using duckdb connection "create_my_duckdb_database_main"
[0m10:43:10.449807 [debug] [ThreadPool]: On create_my_duckdb_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "create_my_duckdb_database_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='my_duckdb_database'
        and type='sqlite'
    
  
[0m10:43:10.455399 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:43:10.548187 [debug] [ThreadPool]: SQL status: OK in 0.093 seconds
[0m10:43:10.555159 [debug] [ThreadPool]: Using duckdb connection "create_my_duckdb_database_main"
[0m10:43:10.557133 [debug] [ThreadPool]: On create_my_duckdb_database_main: BEGIN
[0m10:43:10.562463 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m10:43:10.564371 [debug] [ThreadPool]: Using duckdb connection "create_my_duckdb_database_main"
[0m10:43:10.566230 [debug] [ThreadPool]: On create_my_duckdb_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "create_my_duckdb_database_main"} */

    
    
        create schema if not exists "my_duckdb_database"."main"
    
[0m10:43:10.569431 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:43:10.573438 [debug] [ThreadPool]: On create_my_duckdb_database_main: COMMIT
[0m10:43:10.576760 [debug] [ThreadPool]: Using duckdb connection "create_my_duckdb_database_main"
[0m10:43:10.578465 [debug] [ThreadPool]: On create_my_duckdb_database_main: COMMIT
[0m10:43:10.590296 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m10:43:10.595762 [debug] [ThreadPool]: On create_my_duckdb_database_main: Close
[0m10:43:10.626773 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_my_duckdb_database_main, now list_my_duckdb_database_main)
[0m10:43:10.654264 [debug] [ThreadPool]: Using duckdb connection "list_my_duckdb_database_main"
[0m10:43:10.666900 [debug] [ThreadPool]: On list_my_duckdb_database_main: BEGIN
[0m10:43:10.668473 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:43:10.746792 [debug] [ThreadPool]: SQL status: OK in 0.078 seconds
[0m10:43:10.752949 [debug] [ThreadPool]: Using duckdb connection "list_my_duckdb_database_main"
[0m10:43:10.755404 [debug] [ThreadPool]: On list_my_duckdb_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "list_my_duckdb_database_main"} */
select
      'my_duckdb_database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'my_duckdb_database'
  
[0m10:43:10.963728 [debug] [ThreadPool]: SQL status: OK in 0.204 seconds
[0m10:43:10.973274 [debug] [ThreadPool]: On list_my_duckdb_database_main: ROLLBACK
[0m10:43:10.984535 [debug] [ThreadPool]: Failed to rollback 'list_my_duckdb_database_main'
[0m10:43:10.987301 [debug] [ThreadPool]: On list_my_duckdb_database_main: Close
[0m10:43:11.014799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '18f2c7c9-1a78-4551-a70f-9cf7352e15fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a6eb74290>]}
[0m10:43:11.017205 [debug] [MainThread]: Using duckdb connection "master"
[0m10:43:11.019381 [debug] [MainThread]: On master: BEGIN
[0m10:43:11.021250 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:43:11.063214 [debug] [MainThread]: SQL status: OK in 0.033 seconds
[0m10:43:11.065842 [debug] [MainThread]: On master: COMMIT
[0m10:43:11.067876 [debug] [MainThread]: Using duckdb connection "master"
[0m10:43:11.069792 [debug] [MainThread]: On master: COMMIT
[0m10:43:11.072368 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m10:43:11.074267 [debug] [MainThread]: On master: Close
[0m10:43:11.097912 [debug] [Thread-1 (]: Began running node model.my_dbt_project.transform_users
[0m10:43:11.106055 [info ] [Thread-1 (]: 1 of 2 START sql table model main.transform_users .............................. [RUN]
[0m10:43:11.110712 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.my_dbt_project.transform_users'
[0m10:43:11.116263 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.transform_users
[0m10:43:11.170501 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.transform_users"
[0m10:43:11.195029 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.transform_users
[0m10:43:11.437138 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.transform_users"
[0m10:43:11.460477 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users"
[0m10:43:11.462272 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users: BEGIN
[0m10:43:11.464560 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:43:11.545871 [debug] [Thread-1 (]: SQL status: OK in 0.081 seconds
[0m10:43:11.548250 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users"
[0m10:43:11.550834 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_users"} */

  
    
    

    create  table
      "my_duckdb_database"."main"."transform_users__dbt_tmp"
  
    as (
      -- /opt/airflow/dags/dbt_models/transform_users.sql


WITH users AS (
    SELECT * FROM "my_duckdb_database"."main"."users"
)

SELECT
    id,
    name,
    username,
    email,
    address_street,
    address_suite,
    address_city,
    address_zipcode,
    phone,
    website,
    company_name
FROM users
WHERE address_city = 'Gwenborough'
    );
  
  
[0m10:43:11.583593 [debug] [Thread-1 (]: SQL status: OK in 0.029 seconds
[0m10:43:11.613970 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users"
[0m10:43:11.616287 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_users"} */
alter table "my_duckdb_database"."main"."transform_users__dbt_tmp" rename to "transform_users"
[0m10:43:11.619926 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:43:11.673950 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users: COMMIT
[0m10:43:11.677177 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users"
[0m10:43:11.679586 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users: COMMIT
[0m10:43:11.701587 [debug] [Thread-1 (]: SQL status: OK in 0.020 seconds
[0m10:43:11.732962 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users"
[0m10:43:11.734807 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_users"} */
drop table if exists "my_duckdb_database"."main"."transform_users__dbt_backup" cascade
[0m10:43:11.740109 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:43:11.759191 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users: Close
[0m10:43:11.935977 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18f2c7c9-1a78-4551-a70f-9cf7352e15fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a6edeae70>]}
[0m10:43:11.950764 [info ] [Thread-1 (]: 1 of 2 OK created sql table model main.transform_users ......................... [[32mOK[0m in 0.82s]
[0m10:43:11.966451 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.transform_users
[0m10:43:11.981871 [debug] [Thread-1 (]: Began running node model.my_dbt_project.transform_users2
[0m10:43:11.985290 [info ] [Thread-1 (]: 2 of 2 START sql table model main.transform_users2 ............................. [RUN]
[0m10:43:12.000326 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.transform_users, now model.my_dbt_project.transform_users2)
[0m10:43:12.003051 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.transform_users2
[0m10:43:12.043787 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.transform_users2"
[0m10:43:12.082767 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.transform_users2
[0m10:43:12.130329 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.transform_users2"
[0m10:43:12.175060 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users2"
[0m10:43:12.176825 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users2: BEGIN
[0m10:43:12.178555 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:43:12.249800 [debug] [Thread-1 (]: SQL status: OK in 0.071 seconds
[0m10:43:12.268220 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users2"
[0m10:43:12.291162 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users2: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_users2"} */

  
    
    

    create  table
      "my_duckdb_database"."main"."transform_users2__dbt_tmp"
  
    as (
      -- /opt/airflow/dags/dbt_models/transform_users.sql


WITH users AS (
    SELECT * FROM "my_duckdb_database"."main"."users"
)

SELECT
    id,
    name,
    username,
    email,
    address_street,
    address_suite,
    address_city,
    address_zipcode,
    phone,
    website,
    company_name
FROM users
WHERE address_city = 'Wisokyburgh'
    );
  
  
[0m10:43:12.345218 [debug] [Thread-1 (]: SQL status: OK in 0.049 seconds
[0m10:43:12.378699 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users2"
[0m10:43:12.392656 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users2: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_users2"} */
alter table "my_duckdb_database"."main"."transform_users2__dbt_tmp" rename to "transform_users2"
[0m10:43:12.397183 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m10:43:12.414503 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users2: COMMIT
[0m10:43:12.416642 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users2"
[0m10:43:12.419249 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users2: COMMIT
[0m10:43:12.490865 [debug] [Thread-1 (]: SQL status: OK in 0.054 seconds
[0m10:43:12.505697 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users2"
[0m10:43:12.507629 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users2: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_users2"} */
drop table if exists "my_duckdb_database"."main"."transform_users2__dbt_backup" cascade
[0m10:43:12.511304 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:43:12.516568 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users2: Close
[0m10:43:12.610768 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18f2c7c9-1a78-4551-a70f-9cf7352e15fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a6d7c7c20>]}
[0m10:43:12.624799 [info ] [Thread-1 (]: 2 of 2 OK created sql table model main.transform_users2 ........................ [[32mOK[0m in 0.61s]
[0m10:43:12.643987 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.transform_users2
[0m10:43:12.648972 [debug] [MainThread]: Using duckdb connection "master"
[0m10:43:12.651894 [debug] [MainThread]: On master: BEGIN
[0m10:43:12.656604 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:43:12.737566 [debug] [MainThread]: SQL status: OK in 0.081 seconds
[0m10:43:12.745695 [debug] [MainThread]: On master: COMMIT
[0m10:43:12.760277 [debug] [MainThread]: Using duckdb connection "master"
[0m10:43:12.764642 [debug] [MainThread]: On master: COMMIT
[0m10:43:12.769840 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m10:43:12.779908 [debug] [MainThread]: On master: Close
[0m10:43:12.811683 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:43:12.813802 [debug] [MainThread]: Connection 'list_my_duckdb_database_main' was properly closed.
[0m10:43:12.826838 [debug] [MainThread]: Connection 'model.my_dbt_project.transform_users2' was properly closed.
[0m10:43:12.828743 [info ] [MainThread]: 
[0m10:43:12.832027 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 2.70 seconds (2.70s).
[0m10:43:12.839727 [debug] [MainThread]: Command end result
[0m10:43:13.158455 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m10:43:13.181494 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m10:43:13.228117 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dags/dbt_models/target/run_results.json
[0m10:43:13.230396 [info ] [MainThread]: 
[0m10:43:13.233362 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:43:13.241227 [info ] [MainThread]: 
[0m10:43:13.243227 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m10:43:13.252078 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.426802, "process_in_blocks": "141352", "process_kernel_time": 1.533448, "process_mem_max_rss": "154964", "process_out_blocks": "0", "process_user_time": 13.054223}
[0m10:43:13.256909 [debug] [MainThread]: Command `dbt run` succeeded at 10:43:13.256503 after 9.43 seconds
[0m10:43:13.258664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a749be150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a6ecedb20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a6eb758e0>]}
[0m10:43:13.260693 [debug] [MainThread]: Flushing usage events
[0m10:43:14.899670 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:33:55.973060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92af56a2a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92af4e3260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92af1be270>]}


============================== 06:33:55.983690 | 74417f49-c88c-4b5e-aaea-e1a31e574e55 ==============================
[0m06:33:55.983690 [info ] [MainThread]: Running with dbt=1.9.1
[0m06:33:55.985283 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt/profiles.yml', 'log_path': '/opt/airflow/dags/dbt_models/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt/profiles.yml --target dev', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:33:56.608683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '74417f49-c88c-4b5e-aaea-e1a31e574e55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92b105fcb0>]}
[0m06:33:56.783773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '74417f49-c88c-4b5e-aaea-e1a31e574e55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92aef716a0>]}
[0m06:33:56.820327 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m06:33:57.098501 [debug] [MainThread]: checksum: cac3b9519010e47bfbeb71ca6efb4867dae2858687671594dc23fefc94ecf25d, vars: {}, profile: , target: dev, version: 1.9.1
[0m06:33:57.272365 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m06:33:57.273508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '74417f49-c88c-4b5e-aaea-e1a31e574e55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92af4e2900>]}
[0m06:34:00.436527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '74417f49-c88c-4b5e-aaea-e1a31e574e55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92a851b740>]}
[0m06:34:00.751949 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m06:34:00.769481 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m06:34:01.271452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '74417f49-c88c-4b5e-aaea-e1a31e574e55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92a90eea20>]}
[0m06:34:01.274370 [info ] [MainThread]: Found 2 models, 1 source, 424 macros
[0m06:34:01.277032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '74417f49-c88c-4b5e-aaea-e1a31e574e55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92a90ff0e0>]}
[0m06:34:01.286593 [info ] [MainThread]: 
[0m06:34:01.292546 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:34:01.297226 [info ] [MainThread]: 
[0m06:34:01.303098 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:34:01.335969 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_my_duckdb_database'
[0m06:34:01.717446 [debug] [ThreadPool]: Using duckdb connection "list_my_duckdb_database"
[0m06:34:01.720424 [debug] [ThreadPool]: On list_my_duckdb_database: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "list_my_duckdb_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"my_duckdb_database"'
    
  
  
[0m06:34:01.723074 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:34:01.900226 [debug] [ThreadPool]: SQL status: OK in 0.177 seconds
[0m06:34:01.909405 [debug] [ThreadPool]: On list_my_duckdb_database: Close
[0m06:34:01.935559 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_duckdb_database, now create_my_duckdb_database_main)
[0m06:34:01.946464 [debug] [ThreadPool]: Creating schema "database: "my_duckdb_database"
schema: "main"
"
[0m06:34:02.001035 [debug] [ThreadPool]: Using duckdb connection "create_my_duckdb_database_main"
[0m06:34:02.008667 [debug] [ThreadPool]: On create_my_duckdb_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "create_my_duckdb_database_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='my_duckdb_database'
        and type='sqlite'
    
  
[0m06:34:02.010870 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:34:02.085703 [debug] [ThreadPool]: SQL status: OK in 0.075 seconds
[0m06:34:02.094167 [debug] [ThreadPool]: Using duckdb connection "create_my_duckdb_database_main"
[0m06:34:02.099301 [debug] [ThreadPool]: On create_my_duckdb_database_main: BEGIN
[0m06:34:02.103443 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m06:34:02.120161 [debug] [ThreadPool]: Using duckdb connection "create_my_duckdb_database_main"
[0m06:34:02.121910 [debug] [ThreadPool]: On create_my_duckdb_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "create_my_duckdb_database_main"} */

    
    
        create schema if not exists "my_duckdb_database"."main"
    
[0m06:34:02.127114 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m06:34:02.134746 [debug] [ThreadPool]: On create_my_duckdb_database_main: COMMIT
[0m06:34:02.136388 [debug] [ThreadPool]: Using duckdb connection "create_my_duckdb_database_main"
[0m06:34:02.141194 [debug] [ThreadPool]: On create_my_duckdb_database_main: COMMIT
[0m06:34:02.147686 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m06:34:02.154671 [debug] [ThreadPool]: On create_my_duckdb_database_main: Close
[0m06:34:02.186400 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_my_duckdb_database_main, now list_my_duckdb_database_main)
[0m06:34:02.248459 [debug] [ThreadPool]: Using duckdb connection "list_my_duckdb_database_main"
[0m06:34:02.250149 [debug] [ThreadPool]: On list_my_duckdb_database_main: BEGIN
[0m06:34:02.261379 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:34:02.302319 [debug] [ThreadPool]: SQL status: OK in 0.041 seconds
[0m06:34:02.303877 [debug] [ThreadPool]: Using duckdb connection "list_my_duckdb_database_main"
[0m06:34:02.308942 [debug] [ThreadPool]: On list_my_duckdb_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "list_my_duckdb_database_main"} */
select
      'my_duckdb_database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'my_duckdb_database'
  
[0m06:34:02.575776 [debug] [ThreadPool]: SQL status: OK in 0.265 seconds
[0m06:34:02.581207 [debug] [ThreadPool]: On list_my_duckdb_database_main: ROLLBACK
[0m06:34:02.599700 [debug] [ThreadPool]: Failed to rollback 'list_my_duckdb_database_main'
[0m06:34:02.610959 [debug] [ThreadPool]: On list_my_duckdb_database_main: Close
[0m06:34:02.633805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '74417f49-c88c-4b5e-aaea-e1a31e574e55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92a8519d90>]}
[0m06:34:02.636814 [debug] [MainThread]: Using duckdb connection "master"
[0m06:34:02.646489 [debug] [MainThread]: On master: BEGIN
[0m06:34:02.648019 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:34:02.688484 [debug] [MainThread]: SQL status: OK in 0.040 seconds
[0m06:34:02.725581 [debug] [MainThread]: On master: COMMIT
[0m06:34:02.727277 [debug] [MainThread]: Using duckdb connection "master"
[0m06:34:02.728886 [debug] [MainThread]: On master: COMMIT
[0m06:34:02.730938 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m06:34:02.737114 [debug] [MainThread]: On master: Close
[0m06:34:02.770254 [debug] [Thread-1 (]: Began running node model.my_dbt_project.transform_users
[0m06:34:02.777246 [info ] [Thread-1 (]: 1 of 2 START sql table model main.transform_users .............................. [RUN]
[0m06:34:02.784597 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.my_dbt_project.transform_users'
[0m06:34:02.786498 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.transform_users
[0m06:34:02.856554 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.transform_users"
[0m06:34:02.891402 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.transform_users
[0m06:34:03.099939 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.transform_users"
[0m06:34:03.140805 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users"
[0m06:34:03.143157 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users: BEGIN
[0m06:34:03.144946 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m06:34:03.205884 [debug] [Thread-1 (]: SQL status: OK in 0.061 seconds
[0m06:34:03.210951 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users"
[0m06:34:03.212784 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_users"} */

  
    
    

    create  table
      "my_duckdb_database"."main"."transform_users__dbt_tmp"
  
    as (
      -- /opt/airflow/dags/dbt_models/transform_users.sql


WITH users AS (
    SELECT * FROM "my_duckdb_database"."main"."users"
)

SELECT
    id,
    name,
    username,
    email,
    address_street,
    address_suite,
    address_city,
    address_zipcode,
    phone,
    website,
    company_name
FROM users
WHERE address_city = 'Gwenborough'
    );
  
  
[0m06:34:03.229008 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m06:34:03.284142 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users"
[0m06:34:03.291412 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_users"} */
alter table "my_duckdb_database"."main"."transform_users__dbt_tmp" rename to "transform_users"
[0m06:34:03.294560 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m06:34:03.393919 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users: COMMIT
[0m06:34:03.396265 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users"
[0m06:34:03.401261 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users: COMMIT
[0m06:34:03.412364 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m06:34:03.429711 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users"
[0m06:34:03.432107 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_users"} */
drop table if exists "my_duckdb_database"."main"."transform_users__dbt_backup" cascade
[0m06:34:03.437123 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m06:34:03.447420 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users: Close
[0m06:34:03.515054 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '74417f49-c88c-4b5e-aaea-e1a31e574e55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92aece1a00>]}
[0m06:34:03.517433 [info ] [Thread-1 (]: 1 of 2 OK created sql table model main.transform_users ......................... [[32mOK[0m in 0.73s]
[0m06:34:03.521092 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.transform_users
[0m06:34:03.522894 [debug] [Thread-1 (]: Began running node model.my_dbt_project.transform_users2
[0m06:34:03.525269 [info ] [Thread-1 (]: 2 of 2 START sql table model main.transform_users2 ............................. [RUN]
[0m06:34:03.528628 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.transform_users, now model.my_dbt_project.transform_users2)
[0m06:34:03.530407 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.transform_users2
[0m06:34:03.554492 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.transform_users2"
[0m06:34:03.682837 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.transform_users2
[0m06:34:03.707319 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.transform_users2"
[0m06:34:03.799637 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users2"
[0m06:34:03.801353 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users2: BEGIN
[0m06:34:03.805681 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:34:03.850363 [debug] [Thread-1 (]: SQL status: OK in 0.045 seconds
[0m06:34:03.852214 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users2"
[0m06:34:03.854603 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users2: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_users2"} */

  
    
    

    create  table
      "my_duckdb_database"."main"."transform_users2__dbt_tmp"
  
    as (
      -- /opt/airflow/dags/dbt_models/transform_users.sql


WITH users AS (
    SELECT * FROM "my_duckdb_database"."main"."users"
)

SELECT
    id,
    name,
    username,
    email,
    address_street,
    address_suite,
    address_city,
    address_zipcode,
    phone,
    website,
    company_name
FROM users
WHERE address_city = 'Wisokyburgh'
    );
  
  
[0m06:34:03.867864 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m06:34:03.894248 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users2"
[0m06:34:03.903066 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users2: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_users2"} */
alter table "my_duckdb_database"."main"."transform_users2__dbt_tmp" rename to "transform_users2"
[0m06:34:03.924537 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m06:34:03.930763 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users2: COMMIT
[0m06:34:03.934895 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users2"
[0m06:34:03.945877 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users2: COMMIT
[0m06:34:03.976341 [debug] [Thread-1 (]: SQL status: OK in 0.028 seconds
[0m06:34:03.996731 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users2"
[0m06:34:04.014053 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users2: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_users2"} */
drop table if exists "my_duckdb_database"."main"."transform_users2__dbt_backup" cascade
[0m06:34:04.024237 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m06:34:04.042360 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users2: Close
[0m06:34:04.330037 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '74417f49-c88c-4b5e-aaea-e1a31e574e55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92a9595fd0>]}
[0m06:34:04.339685 [info ] [Thread-1 (]: 2 of 2 OK created sql table model main.transform_users2 ........................ [[32mOK[0m in 0.80s]
[0m06:34:04.349675 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.transform_users2
[0m06:34:04.359559 [debug] [MainThread]: Using duckdb connection "master"
[0m06:34:04.361034 [debug] [MainThread]: On master: BEGIN
[0m06:34:04.362269 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:34:04.432232 [debug] [MainThread]: SQL status: OK in 0.070 seconds
[0m06:34:04.433770 [debug] [MainThread]: On master: COMMIT
[0m06:34:04.435534 [debug] [MainThread]: Using duckdb connection "master"
[0m06:34:04.438415 [debug] [MainThread]: On master: COMMIT
[0m06:34:04.440400 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m06:34:04.442023 [debug] [MainThread]: On master: Close
[0m06:34:04.449158 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:34:04.458467 [debug] [MainThread]: Connection 'list_my_duckdb_database_main' was properly closed.
[0m06:34:04.460734 [debug] [MainThread]: Connection 'model.my_dbt_project.transform_users2' was properly closed.
[0m06:34:04.462461 [info ] [MainThread]: 
[0m06:34:04.465531 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 3.16 seconds (3.16s).
[0m06:34:04.471032 [debug] [MainThread]: Command end result
[0m06:34:04.776328 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m06:34:04.819705 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m06:34:04.897190 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dags/dbt_models/target/run_results.json
[0m06:34:04.898613 [info ] [MainThread]: 
[0m06:34:04.901233 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:34:04.903911 [info ] [MainThread]: 
[0m06:34:04.908208 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:34:04.911757 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.161053, "process_in_blocks": "46192", "process_kernel_time": 1.028383, "process_mem_max_rss": "158204", "process_out_blocks": "1968", "process_user_time": 9.739393}
[0m06:34:04.926002 [debug] [MainThread]: Command `dbt run` succeeded at 06:34:04.925639 after 9.18 seconds
[0m06:34:04.927775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92af56a2a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92afa4a030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92afa4afc0>]}
[0m06:34:04.930128 [debug] [MainThread]: Flushing usage events
[0m06:34:06.404322 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:50:57.572482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5d05b5be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5d2574530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5d0e89c70>]}


============================== 14:50:57.593707 | b5863d71-f165-4a53-a401-fba6d8eff6c5 ==============================
[0m14:50:57.593707 [info ] [MainThread]: Running with dbt=1.9.1
[0m14:50:57.596160 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/profiles.yml', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dags/dbt_models/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt/profiles.yml --target dev', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:50:58.639276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b5863d71-f165-4a53-a401-fba6d8eff6c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5cff19b20>]}
[0m14:50:58.755582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b5863d71-f165-4a53-a401-fba6d8eff6c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5cc861f70>]}
[0m14:50:58.767546 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m14:50:59.023369 [debug] [MainThread]: checksum: cac3b9519010e47bfbeb71ca6efb4867dae2858687671594dc23fefc94ecf25d, vars: {}, profile: , target: dev, version: 1.9.1
[0m14:50:59.541710 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:50:59.548719 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:50:59.671486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b5863d71-f165-4a53-a401-fba6d8eff6c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5ca7748f0>]}
[0m14:51:00.375215 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m14:51:00.411560 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m14:51:01.105542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b5863d71-f165-4a53-a401-fba6d8eff6c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5ca104c50>]}
[0m14:51:01.127619 [info ] [MainThread]: Found 2 models, 1 source, 424 macros
[0m14:51:01.146117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b5863d71-f165-4a53-a401-fba6d8eff6c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5ca2efe00>]}
[0m14:51:01.192638 [info ] [MainThread]: 
[0m14:51:01.218284 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:51:01.225836 [info ] [MainThread]: 
[0m14:51:01.234742 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:51:01.287324 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_my_duckdb_database'
[0m14:51:01.729709 [debug] [ThreadPool]: Using duckdb connection "list_my_duckdb_database"
[0m14:51:01.742167 [debug] [ThreadPool]: On list_my_duckdb_database: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "list_my_duckdb_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"my_duckdb_database"'
    
  
  
[0m14:51:01.758034 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:51:01.932201 [debug] [ThreadPool]: SQL status: OK in 0.174 seconds
[0m14:51:01.949944 [debug] [ThreadPool]: On list_my_duckdb_database: Close
[0m14:51:01.975350 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_duckdb_database, now create_my_duckdb_database_main)
[0m14:51:01.988371 [debug] [ThreadPool]: Creating schema "database: "my_duckdb_database"
schema: "main"
"
[0m14:51:02.083820 [debug] [ThreadPool]: Using duckdb connection "create_my_duckdb_database_main"
[0m14:51:02.095355 [debug] [ThreadPool]: On create_my_duckdb_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "create_my_duckdb_database_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='my_duckdb_database'
        and type='sqlite'
    
  
[0m14:51:02.098508 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:51:02.254185 [debug] [ThreadPool]: SQL status: OK in 0.156 seconds
[0m14:51:02.272279 [debug] [ThreadPool]: Using duckdb connection "create_my_duckdb_database_main"
[0m14:51:02.328679 [debug] [ThreadPool]: On create_my_duckdb_database_main: BEGIN
[0m14:51:02.333853 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:51:02.345352 [debug] [ThreadPool]: Using duckdb connection "create_my_duckdb_database_main"
[0m14:51:02.348099 [debug] [ThreadPool]: On create_my_duckdb_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "create_my_duckdb_database_main"} */

    
    
        create schema if not exists "my_duckdb_database"."main"
    
[0m14:51:02.360544 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:51:02.364252 [debug] [ThreadPool]: On create_my_duckdb_database_main: COMMIT
[0m14:51:02.370933 [debug] [ThreadPool]: Using duckdb connection "create_my_duckdb_database_main"
[0m14:51:02.379226 [debug] [ThreadPool]: On create_my_duckdb_database_main: COMMIT
[0m14:51:02.393347 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:51:02.396495 [debug] [ThreadPool]: On create_my_duckdb_database_main: Close
[0m14:51:02.441554 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_my_duckdb_database_main, now list_my_duckdb_database_main)
[0m14:51:02.469021 [debug] [ThreadPool]: Using duckdb connection "list_my_duckdb_database_main"
[0m14:51:02.471853 [debug] [ThreadPool]: On list_my_duckdb_database_main: BEGIN
[0m14:51:02.479572 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:51:02.523477 [debug] [ThreadPool]: SQL status: OK in 0.044 seconds
[0m14:51:02.525082 [debug] [ThreadPool]: Using duckdb connection "list_my_duckdb_database_main"
[0m14:51:02.528507 [debug] [ThreadPool]: On list_my_duckdb_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "list_my_duckdb_database_main"} */
select
      'my_duckdb_database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'my_duckdb_database'
  
[0m14:51:02.656839 [debug] [ThreadPool]: SQL status: OK in 0.126 seconds
[0m14:51:02.662166 [debug] [ThreadPool]: On list_my_duckdb_database_main: ROLLBACK
[0m14:51:02.667873 [debug] [ThreadPool]: Failed to rollback 'list_my_duckdb_database_main'
[0m14:51:02.671992 [debug] [ThreadPool]: On list_my_duckdb_database_main: Close
[0m14:51:02.686003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b5863d71-f165-4a53-a401-fba6d8eff6c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5d1d73110>]}
[0m14:51:02.691043 [debug] [MainThread]: Using duckdb connection "master"
[0m14:51:02.696782 [debug] [MainThread]: On master: BEGIN
[0m14:51:02.699838 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:51:02.749759 [debug] [MainThread]: SQL status: OK in 0.050 seconds
[0m14:51:02.751529 [debug] [MainThread]: On master: COMMIT
[0m14:51:02.755941 [debug] [MainThread]: Using duckdb connection "master"
[0m14:51:02.758054 [debug] [MainThread]: On master: COMMIT
[0m14:51:02.763883 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m14:51:02.765764 [debug] [MainThread]: On master: Close
[0m14:51:02.802825 [debug] [Thread-1 (]: Began running node model.my_dbt_project.transform_users
[0m14:51:02.805507 [info ] [Thread-1 (]: 1 of 2 START sql table model main.transform_users .............................. [RUN]
[0m14:51:02.811943 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.my_dbt_project.transform_users'
[0m14:51:02.814545 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.transform_users
[0m14:51:02.857546 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.transform_users"
[0m14:51:02.989158 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.transform_users
[0m14:51:03.219493 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.transform_users"
[0m14:51:03.380901 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users"
[0m14:51:03.397204 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users: BEGIN
[0m14:51:03.421172 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:51:03.507493 [debug] [Thread-1 (]: SQL status: OK in 0.087 seconds
[0m14:51:03.509786 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users"
[0m14:51:03.523968 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_users"} */

  
    
    

    create  table
      "my_duckdb_database"."main"."transform_users__dbt_tmp"
  
    as (
      -- /opt/airflow/dags/dbt_models/transform_users.sql


WITH users AS (
    SELECT * FROM "my_duckdb_database"."main"."users"
)

SELECT
    id,
    name,
    username,
    email,
    address_street,
    address_suite,
    address_city,
    address_zipcode,
    phone,
    website,
    company_name
FROM users
WHERE address_city = 'Gwenborough'
    );
  
  
[0m14:51:03.571804 [debug] [Thread-1 (]: SQL status: OK in 0.046 seconds
[0m14:51:03.649800 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users"
[0m14:51:03.654239 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_users"} */
alter table "my_duckdb_database"."main"."transform_users" rename to "transform_users__dbt_backup"
[0m14:51:03.665407 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:51:03.701418 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users"
[0m14:51:03.712869 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_users"} */
alter table "my_duckdb_database"."main"."transform_users__dbt_tmp" rename to "transform_users"
[0m14:51:03.715872 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:51:03.859779 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users: COMMIT
[0m14:51:03.861728 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users"
[0m14:51:03.874479 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users: COMMIT
[0m14:51:03.942461 [debug] [Thread-1 (]: SQL status: OK in 0.065 seconds
[0m14:51:04.035854 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users"
[0m14:51:04.049950 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_users"} */
drop table if exists "my_duckdb_database"."main"."transform_users__dbt_backup" cascade
[0m14:51:04.297945 [debug] [Thread-1 (]: SQL status: OK in 0.238 seconds
[0m14:51:04.363231 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users: Close
[0m14:51:04.682673 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5863d71-f165-4a53-a401-fba6d8eff6c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5d2266000>]}
[0m14:51:04.693217 [info ] [Thread-1 (]: 1 of 2 OK created sql table model main.transform_users ......................... [[32mOK[0m in 1.78s]
[0m14:51:04.697361 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.transform_users
[0m14:51:04.699546 [debug] [Thread-1 (]: Began running node model.my_dbt_project.transform_users2
[0m14:51:04.701314 [info ] [Thread-1 (]: 2 of 2 START sql table model main.transform_users2 ............................. [RUN]
[0m14:51:04.704178 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.transform_users, now model.my_dbt_project.transform_users2)
[0m14:51:04.711255 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.transform_users2
[0m14:51:04.730674 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.transform_users2"
[0m14:51:04.849447 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.transform_users2
[0m14:51:05.000351 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.transform_users2"
[0m14:51:05.307891 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users2"
[0m14:51:05.316074 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users2: BEGIN
[0m14:51:05.322343 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:51:05.463163 [debug] [Thread-1 (]: SQL status: OK in 0.141 seconds
[0m14:51:05.469285 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users2"
[0m14:51:05.475636 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users2: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_users2"} */

  
    
    

    create  table
      "my_duckdb_database"."main"."transform_users2__dbt_tmp"
  
    as (
      -- /opt/airflow/dags/dbt_models/transform_users.sql


WITH users AS (
    SELECT * FROM "my_duckdb_database"."main"."users"
)

SELECT
    id,
    name,
    username,
    email,
    address_street,
    address_suite,
    address_city,
    address_zipcode,
    phone,
    website,
    company_name
FROM users
WHERE address_city = 'Wisokyburgh'
    );
  
  
[0m14:51:06.076891 [debug] [Thread-1 (]: SQL status: OK in 0.599 seconds
[0m14:51:06.128042 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users2"
[0m14:51:06.132291 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users2: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_users2"} */
alter table "my_duckdb_database"."main"."transform_users2" rename to "transform_users2__dbt_backup"
[0m14:51:06.143020 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m14:51:06.195500 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users2"
[0m14:51:06.217332 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users2: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_users2"} */
alter table "my_duckdb_database"."main"."transform_users2__dbt_tmp" rename to "transform_users2"
[0m14:51:06.251743 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:51:06.262956 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users2: COMMIT
[0m14:51:06.297825 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users2"
[0m14:51:06.308548 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users2: COMMIT
[0m14:51:06.466637 [debug] [Thread-1 (]: SQL status: OK in 0.130 seconds
[0m14:51:06.477791 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users2"
[0m14:51:06.479326 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users2: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_users2"} */
drop table if exists "my_duckdb_database"."main"."transform_users2__dbt_backup" cascade
[0m14:51:06.746777 [debug] [Thread-1 (]: SQL status: OK in 0.266 seconds
[0m14:51:06.763559 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users2: Close
[0m14:51:09.152538 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5863d71-f165-4a53-a401-fba6d8eff6c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5c966d790>]}
[0m14:51:09.220176 [info ] [Thread-1 (]: 2 of 2 OK created sql table model main.transform_users2 ........................ [[32mOK[0m in 4.45s]
[0m14:51:09.258201 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.transform_users2
[0m14:51:09.297272 [debug] [MainThread]: Using duckdb connection "master"
[0m14:51:09.307769 [debug] [MainThread]: On master: BEGIN
[0m14:51:09.315265 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:51:09.665448 [debug] [MainThread]: SQL status: OK in 0.350 seconds
[0m14:51:09.667171 [debug] [MainThread]: On master: COMMIT
[0m14:51:09.668947 [debug] [MainThread]: Using duckdb connection "master"
[0m14:51:09.670765 [debug] [MainThread]: On master: COMMIT
[0m14:51:09.673214 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m14:51:09.674495 [debug] [MainThread]: On master: Close
[0m14:51:09.699682 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:51:09.712689 [debug] [MainThread]: Connection 'list_my_duckdb_database_main' was properly closed.
[0m14:51:09.735622 [debug] [MainThread]: Connection 'model.my_dbt_project.transform_users2' was properly closed.
[0m14:51:09.746637 [info ] [MainThread]: 
[0m14:51:09.753367 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 8.51 seconds (8.51s).
[0m14:51:09.766149 [debug] [MainThread]: Command end result
[0m14:51:10.506407 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m14:51:10.577885 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m14:51:10.817922 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dags/dbt_models/target/run_results.json
[0m14:51:10.825450 [info ] [MainThread]: 
[0m14:51:10.841796 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:51:10.845503 [info ] [MainThread]: 
[0m14:51:10.847526 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:51:10.863834 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 13.53336, "process_in_blocks": "40736", "process_kernel_time": 3.342476, "process_mem_max_rss": "157292", "process_out_blocks": "0", "process_user_time": 11.931372}
[0m14:51:10.896518 [debug] [MainThread]: Command `dbt run` succeeded at 14:51:10.896114 after 13.57 seconds
[0m14:51:10.899940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5d0039e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5cff7b8c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5d03c8830>]}
[0m14:51:10.909395 [debug] [MainThread]: Flushing usage events
[0m14:51:17.119937 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:14:40.911059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4aba6962d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ab795dee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ab94e87a0>]}


============================== 07:14:40.975776 | c6d0d0f3-a349-4fd6-aa84-f30425f400d4 ==============================
[0m07:14:40.975776 [info ] [MainThread]: Running with dbt=1.9.1
[0m07:14:40.980435 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/profiles.yml', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dags/dbt_models/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt/profiles.yml --target dev', 'send_anonymous_usage_stats': 'True'}
[0m07:14:43.343174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c6d0d0f3-a349-4fd6-aa84-f30425f400d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ab71955b0>]}
[0m07:14:43.728993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c6d0d0f3-a349-4fd6-aa84-f30425f400d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ab79a4500>]}
[0m07:14:43.813608 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m07:14:45.363563 [debug] [MainThread]: checksum: cac3b9519010e47bfbeb71ca6efb4867dae2858687671594dc23fefc94ecf25d, vars: {}, profile: , target: dev, version: 1.9.1
[0m07:14:46.187858 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:14:46.194731 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:14:46.418643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c6d0d0f3-a349-4fd6-aa84-f30425f400d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ab17f8560>]}
[0m07:14:46.960164 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m07:14:47.029451 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m07:14:48.583672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c6d0d0f3-a349-4fd6-aa84-f30425f400d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ab1288440>]}
[0m07:14:48.677134 [info ] [MainThread]: Found 2 models, 1 source, 424 macros
[0m07:14:48.685171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c6d0d0f3-a349-4fd6-aa84-f30425f400d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ab102fe00>]}
[0m07:14:48.713086 [info ] [MainThread]: 
[0m07:14:48.716861 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:14:48.719044 [info ] [MainThread]: 
[0m07:14:48.732647 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m07:14:49.267145 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_my_duckdb_database'
[0m07:14:49.946477 [debug] [ThreadPool]: Using duckdb connection "list_my_duckdb_database"
[0m07:14:49.967068 [debug] [ThreadPool]: On list_my_duckdb_database: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "list_my_duckdb_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"my_duckdb_database"'
    
  
  
[0m07:14:49.968968 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:15:23.981115 [debug] [ThreadPool]: SQL status: OK in 34.007 seconds
[0m07:15:23.995014 [debug] [ThreadPool]: On list_my_duckdb_database: Close
[0m07:15:24.034583 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_duckdb_database, now create_my_duckdb_database_main)
[0m07:15:24.039370 [debug] [ThreadPool]: Creating schema "database: "my_duckdb_database"
schema: "main"
"
[0m07:15:24.149659 [debug] [ThreadPool]: Using duckdb connection "create_my_duckdb_database_main"
[0m07:15:24.162869 [debug] [ThreadPool]: On create_my_duckdb_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "create_my_duckdb_database_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='my_duckdb_database'
        and type='sqlite'
    
  
[0m07:15:24.165622 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:15:24.333463 [debug] [ThreadPool]: SQL status: OK in 0.168 seconds
[0m07:15:24.338992 [debug] [ThreadPool]: Using duckdb connection "create_my_duckdb_database_main"
[0m07:15:24.341810 [debug] [ThreadPool]: On create_my_duckdb_database_main: BEGIN
[0m07:15:24.344668 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m07:15:24.346875 [debug] [ThreadPool]: Using duckdb connection "create_my_duckdb_database_main"
[0m07:15:24.349031 [debug] [ThreadPool]: On create_my_duckdb_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "create_my_duckdb_database_main"} */

    
    
        create schema if not exists "my_duckdb_database"."main"
    
[0m07:15:24.354469 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m07:15:24.359076 [debug] [ThreadPool]: On create_my_duckdb_database_main: COMMIT
[0m07:15:24.360807 [debug] [ThreadPool]: Using duckdb connection "create_my_duckdb_database_main"
[0m07:15:24.362702 [debug] [ThreadPool]: On create_my_duckdb_database_main: COMMIT
[0m07:15:24.365116 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m07:15:24.366932 [debug] [ThreadPool]: On create_my_duckdb_database_main: Close
[0m07:15:24.376485 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_my_duckdb_database_main, now list_my_duckdb_database_main)
[0m07:15:24.397535 [debug] [ThreadPool]: Using duckdb connection "list_my_duckdb_database_main"
[0m07:15:24.400211 [debug] [ThreadPool]: On list_my_duckdb_database_main: BEGIN
[0m07:15:24.402990 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:15:24.435751 [debug] [ThreadPool]: SQL status: OK in 0.033 seconds
[0m07:15:24.437776 [debug] [ThreadPool]: Using duckdb connection "list_my_duckdb_database_main"
[0m07:15:24.443510 [debug] [ThreadPool]: On list_my_duckdb_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "list_my_duckdb_database_main"} */
select
      'my_duckdb_database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'my_duckdb_database'
  
[0m07:15:24.653245 [debug] [ThreadPool]: SQL status: OK in 0.207 seconds
[0m07:15:24.660275 [debug] [ThreadPool]: On list_my_duckdb_database_main: ROLLBACK
[0m07:15:24.670885 [debug] [ThreadPool]: Failed to rollback 'list_my_duckdb_database_main'
[0m07:15:24.675679 [debug] [ThreadPool]: On list_my_duckdb_database_main: Close
[0m07:15:24.691005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c6d0d0f3-a349-4fd6-aa84-f30425f400d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ab8ce6ff0>]}
[0m07:15:24.696135 [debug] [MainThread]: Using duckdb connection "master"
[0m07:15:24.699428 [debug] [MainThread]: On master: BEGIN
[0m07:15:24.709903 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:15:24.771714 [debug] [MainThread]: SQL status: OK in 0.062 seconds
[0m07:15:24.776207 [debug] [MainThread]: On master: COMMIT
[0m07:15:24.787733 [debug] [MainThread]: Using duckdb connection "master"
[0m07:15:24.791106 [debug] [MainThread]: On master: COMMIT
[0m07:15:24.794291 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m07:15:24.797028 [debug] [MainThread]: On master: Close
[0m07:15:24.831973 [debug] [Thread-1 (]: Began running node model.my_dbt_project.transform_users
[0m07:15:24.834783 [info ] [Thread-1 (]: 1 of 2 START sql table model main.transform_users .............................. [RUN]
[0m07:15:24.839674 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.my_dbt_project.transform_users'
[0m07:15:24.854293 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.transform_users
[0m07:15:24.947432 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.transform_users"
[0m07:15:25.000704 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.transform_users
[0m07:15:25.448035 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.transform_users"
[0m07:15:25.505074 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users"
[0m07:15:25.508155 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users: BEGIN
[0m07:15:25.519090 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m07:15:25.704213 [debug] [Thread-1 (]: SQL status: OK in 0.186 seconds
[0m07:15:25.713773 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users"
[0m07:15:25.716434 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_users"} */

  
    
    

    create  table
      "my_duckdb_database"."main"."transform_users__dbt_tmp"
  
    as (
      -- /opt/airflow/dags/dbt_models/transform_users.sql


WITH users AS (
    SELECT * FROM "my_duckdb_database"."main"."users"
)

SELECT
    id,
    name,
    username,
    email,
    address_street,
    address_suite,
    address_city,
    address_zipcode,
    phone,
    website,
    company_name
FROM users
WHERE address_city = 'Gwenborough'
    );
  
  
[0m07:15:25.866269 [debug] [Thread-1 (]: SQL status: OK in 0.147 seconds
[0m07:15:25.945749 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users"
[0m07:15:25.948454 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_users"} */
alter table "my_duckdb_database"."main"."transform_users__dbt_tmp" rename to "transform_users"
[0m07:15:25.967099 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m07:15:26.144275 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users: COMMIT
[0m07:15:26.164564 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users"
[0m07:15:26.167832 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users: COMMIT
[0m07:15:26.322747 [debug] [Thread-1 (]: SQL status: OK in 0.108 seconds
[0m07:15:26.388980 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users"
[0m07:15:26.401740 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_users"} */
drop table if exists "my_duckdb_database"."main"."transform_users__dbt_backup" cascade
[0m07:15:26.436301 [debug] [Thread-1 (]: SQL status: OK in 0.032 seconds
[0m07:15:26.480988 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users: Close
[0m07:15:26.807524 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c6d0d0f3-a349-4fd6-aa84-f30425f400d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ab91da2d0>]}
[0m07:15:26.832471 [info ] [Thread-1 (]: 1 of 2 OK created sql table model main.transform_users ......................... [[32mOK[0m in 1.95s]
[0m07:15:26.840934 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.transform_users
[0m07:15:26.846106 [debug] [Thread-1 (]: Began running node model.my_dbt_project.transform_users2
[0m07:15:26.860616 [info ] [Thread-1 (]: 2 of 2 START sql table model main.transform_users2 ............................. [RUN]
[0m07:15:26.865482 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.transform_users, now model.my_dbt_project.transform_users2)
[0m07:15:26.898102 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.transform_users2
[0m07:15:26.935833 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.transform_users2"
[0m07:15:27.017368 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.transform_users2
[0m07:15:27.077847 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.transform_users2"
[0m07:15:27.185096 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users2"
[0m07:15:27.187741 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users2: BEGIN
[0m07:15:27.208699 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:15:27.591884 [debug] [Thread-1 (]: SQL status: OK in 0.394 seconds
[0m07:15:27.612785 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users2"
[0m07:15:27.640589 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users2: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_users2"} */

  
    
    

    create  table
      "my_duckdb_database"."main"."transform_users2__dbt_tmp"
  
    as (
      -- /opt/airflow/dags/dbt_models/transform_users.sql


WITH users AS (
    SELECT * FROM "my_duckdb_database"."main"."users"
)

SELECT
    id,
    name,
    username,
    email,
    address_street,
    address_suite,
    address_city,
    address_zipcode,
    phone,
    website,
    company_name
FROM users
WHERE address_city = 'Wisokyburgh'
    );
  
  
[0m07:15:27.729397 [debug] [Thread-1 (]: SQL status: OK in 0.084 seconds
[0m07:15:27.770176 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users2"
[0m07:15:27.784058 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users2: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_users2"} */
alter table "my_duckdb_database"."main"."transform_users2__dbt_tmp" rename to "transform_users2"
[0m07:15:27.813649 [debug] [Thread-1 (]: SQL status: OK in 0.025 seconds
[0m07:15:27.832354 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users2: COMMIT
[0m07:15:27.835584 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users2"
[0m07:15:27.841183 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users2: COMMIT
[0m07:15:27.901019 [debug] [Thread-1 (]: SQL status: OK in 0.053 seconds
[0m07:15:27.913444 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users2"
[0m07:15:27.927015 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users2: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_users2"} */
drop table if exists "my_duckdb_database"."main"."transform_users2__dbt_backup" cascade
[0m07:15:27.931248 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m07:15:27.957066 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users2: Close
[0m07:15:28.504679 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c6d0d0f3-a349-4fd6-aa84-f30425f400d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ab049dc40>]}
[0m07:15:28.511425 [info ] [Thread-1 (]: 2 of 2 OK created sql table model main.transform_users2 ........................ [[32mOK[0m in 1.63s]
[0m07:15:28.527738 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.transform_users2
[0m07:15:28.551310 [debug] [MainThread]: Using duckdb connection "master"
[0m07:15:28.554134 [debug] [MainThread]: On master: BEGIN
[0m07:15:28.562566 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:15:28.752781 [debug] [MainThread]: SQL status: OK in 0.191 seconds
[0m07:15:28.762792 [debug] [MainThread]: On master: COMMIT
[0m07:15:28.766560 [debug] [MainThread]: Using duckdb connection "master"
[0m07:15:28.769241 [debug] [MainThread]: On master: COMMIT
[0m07:15:28.775760 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m07:15:28.781456 [debug] [MainThread]: On master: Close
[0m07:15:28.798818 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:15:28.817655 [debug] [MainThread]: Connection 'list_my_duckdb_database_main' was properly closed.
[0m07:15:28.825346 [debug] [MainThread]: Connection 'model.my_dbt_project.transform_users2' was properly closed.
[0m07:15:28.833633 [info ] [MainThread]: 
[0m07:15:28.844357 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 40.10 seconds (40.10s).
[0m07:15:28.852627 [debug] [MainThread]: Command end result
[0m07:15:29.195568 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m07:15:29.261288 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m07:15:29.350880 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dags/dbt_models/target/run_results.json
[0m07:15:29.353336 [info ] [MainThread]: 
[0m07:15:29.356902 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:15:29.360536 [info ] [MainThread]: 
[0m07:15:29.367888 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m07:15:29.404078 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 49.39145, "process_in_blocks": "2262064", "process_kernel_time": 6.396821, "process_mem_max_rss": "124440", "process_out_blocks": "1968", "process_user_time": 11.976382}
[0m07:15:29.418523 [debug] [MainThread]: Command `dbt run` succeeded at 07:15:29.415991 after 49.41 seconds
[0m07:15:29.426534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ab7180e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ab1337bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ab7ab21b0>]}
[0m07:15:29.443219 [debug] [MainThread]: Flushing usage events
[0m07:15:35.510163 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:18:47.071032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6479e8b350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6479d45c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6479abce30>]}


============================== 07:18:47.108089 | cc34af6c-fcc5-44af-9e4e-66400ce9cc9a ==============================
[0m07:18:47.108089 [info ] [MainThread]: Running with dbt=1.9.1
[0m07:18:47.117321 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dags/dbt_models/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt/profiles.yml', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt/profiles.yml --target dev', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m07:18:49.336936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cc34af6c-fcc5-44af-9e4e-66400ce9cc9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f647b973290>]}
[0m07:18:49.566552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cc34af6c-fcc5-44af-9e4e-66400ce9cc9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6479cbe210>]}
[0m07:18:49.586059 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m07:18:50.432044 [debug] [MainThread]: checksum: cac3b9519010e47bfbeb71ca6efb4867dae2858687671594dc23fefc94ecf25d, vars: {}, profile: , target: dev, version: 1.9.1
[0m07:18:51.274647 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:18:51.276174 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:18:51.400417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cc34af6c-fcc5-44af-9e4e-66400ce9cc9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64796895e0>]}
[0m07:18:51.775807 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m07:18:51.796080 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m07:18:51.924369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cc34af6c-fcc5-44af-9e4e-66400ce9cc9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6473fa2bd0>]}
[0m07:18:51.926585 [info ] [MainThread]: Found 2 models, 1 source, 424 macros
[0m07:18:51.930240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cc34af6c-fcc5-44af-9e4e-66400ce9cc9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6479e8a990>]}
[0m07:18:51.937347 [info ] [MainThread]: 
[0m07:18:51.939894 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:18:51.948447 [info ] [MainThread]: 
[0m07:18:51.950399 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m07:18:51.965572 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_my_duckdb_database'
[0m07:18:52.187022 [debug] [ThreadPool]: Using duckdb connection "list_my_duckdb_database"
[0m07:18:52.191509 [debug] [ThreadPool]: On list_my_duckdb_database: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "list_my_duckdb_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"my_duckdb_database"'
    
  
  
[0m07:18:52.193319 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:18:52.350931 [debug] [ThreadPool]: SQL status: OK in 0.158 seconds
[0m07:18:52.357516 [debug] [ThreadPool]: On list_my_duckdb_database: Close
[0m07:18:52.370575 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_duckdb_database, now create_my_duckdb_database_main)
[0m07:18:52.374016 [debug] [ThreadPool]: Creating schema "database: "my_duckdb_database"
schema: "main"
"
[0m07:18:52.402234 [debug] [ThreadPool]: Using duckdb connection "create_my_duckdb_database_main"
[0m07:18:52.404210 [debug] [ThreadPool]: On create_my_duckdb_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "create_my_duckdb_database_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='my_duckdb_database'
        and type='sqlite'
    
  
[0m07:18:52.408520 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:18:52.450323 [debug] [ThreadPool]: SQL status: OK in 0.042 seconds
[0m07:18:52.455731 [debug] [ThreadPool]: Using duckdb connection "create_my_duckdb_database_main"
[0m07:18:52.457547 [debug] [ThreadPool]: On create_my_duckdb_database_main: BEGIN
[0m07:18:52.464530 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m07:18:52.466699 [debug] [ThreadPool]: Using duckdb connection "create_my_duckdb_database_main"
[0m07:18:52.468939 [debug] [ThreadPool]: On create_my_duckdb_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "create_my_duckdb_database_main"} */

    
    
        create schema if not exists "my_duckdb_database"."main"
    
[0m07:18:52.471484 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m07:18:52.475199 [debug] [ThreadPool]: On create_my_duckdb_database_main: COMMIT
[0m07:18:52.481154 [debug] [ThreadPool]: Using duckdb connection "create_my_duckdb_database_main"
[0m07:18:52.482761 [debug] [ThreadPool]: On create_my_duckdb_database_main: COMMIT
[0m07:18:52.485802 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m07:18:52.488127 [debug] [ThreadPool]: On create_my_duckdb_database_main: Close
[0m07:18:52.503667 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_my_duckdb_database_main, now list_my_duckdb_database_main)
[0m07:18:52.531128 [debug] [ThreadPool]: Using duckdb connection "list_my_duckdb_database_main"
[0m07:18:52.533962 [debug] [ThreadPool]: On list_my_duckdb_database_main: BEGIN
[0m07:18:52.537858 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:18:52.582517 [debug] [ThreadPool]: SQL status: OK in 0.045 seconds
[0m07:18:52.584255 [debug] [ThreadPool]: Using duckdb connection "list_my_duckdb_database_main"
[0m07:18:52.586031 [debug] [ThreadPool]: On list_my_duckdb_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "list_my_duckdb_database_main"} */
select
      'my_duckdb_database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'my_duckdb_database'
  
[0m07:18:52.688746 [debug] [ThreadPool]: SQL status: OK in 0.101 seconds
[0m07:18:52.693400 [debug] [ThreadPool]: On list_my_duckdb_database_main: ROLLBACK
[0m07:18:52.700028 [debug] [ThreadPool]: Failed to rollback 'list_my_duckdb_database_main'
[0m07:18:52.701857 [debug] [ThreadPool]: On list_my_duckdb_database_main: Close
[0m07:18:52.714145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cc34af6c-fcc5-44af-9e4e-66400ce9cc9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64739204a0>]}
[0m07:18:52.716004 [debug] [MainThread]: Using duckdb connection "master"
[0m07:18:52.717846 [debug] [MainThread]: On master: BEGIN
[0m07:18:52.719422 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:18:52.753319 [debug] [MainThread]: SQL status: OK in 0.034 seconds
[0m07:18:52.755051 [debug] [MainThread]: On master: COMMIT
[0m07:18:52.757096 [debug] [MainThread]: Using duckdb connection "master"
[0m07:18:52.758984 [debug] [MainThread]: On master: COMMIT
[0m07:18:52.763521 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m07:18:52.765205 [debug] [MainThread]: On master: Close
[0m07:18:52.773338 [debug] [Thread-1 (]: Began running node model.my_dbt_project.transform_users
[0m07:18:52.775738 [info ] [Thread-1 (]: 1 of 2 START sql table model main.transform_users .............................. [RUN]
[0m07:18:52.782389 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.my_dbt_project.transform_users'
[0m07:18:52.787788 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.transform_users
[0m07:18:52.810166 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.transform_users"
[0m07:18:52.825592 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.transform_users
[0m07:18:52.940711 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.transform_users"
[0m07:18:52.955904 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users"
[0m07:18:52.957769 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users: BEGIN
[0m07:18:52.959638 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m07:18:52.993096 [debug] [Thread-1 (]: SQL status: OK in 0.033 seconds
[0m07:18:52.996925 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users"
[0m07:18:52.998473 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_users"} */

  
    
    

    create  table
      "my_duckdb_database"."main"."transform_users__dbt_tmp"
  
    as (
      -- /opt/airflow/dags/dbt_models/transform_users.sql


WITH users AS (
    SELECT * FROM "my_duckdb_database"."main"."users"
)

SELECT
    id,
    name,
    username,
    email,
    address_street,
    address_suite,
    address_city,
    address_zipcode,
    phone,
    website,
    company_name
FROM users
WHERE address_city = 'Gwenborough'
    );
  
  
[0m07:18:53.015475 [debug] [Thread-1 (]: SQL status: OK in 0.015 seconds
[0m07:18:53.042349 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users"
[0m07:18:53.046486 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_users"} */
alter table "my_duckdb_database"."main"."transform_users" rename to "transform_users__dbt_backup"
[0m07:18:53.049761 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:18:53.072681 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users"
[0m07:18:53.080121 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_users"} */
alter table "my_duckdb_database"."main"."transform_users__dbt_tmp" rename to "transform_users"
[0m07:18:53.083498 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:18:53.152908 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users: COMMIT
[0m07:18:53.155072 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users"
[0m07:18:53.156909 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users: COMMIT
[0m07:18:53.184676 [debug] [Thread-1 (]: SQL status: OK in 0.026 seconds
[0m07:18:53.202411 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users"
[0m07:18:53.204242 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_users"} */
drop table if exists "my_duckdb_database"."main"."transform_users__dbt_backup" cascade
[0m07:18:53.211130 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m07:18:53.220688 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users: Close
[0m07:18:53.272369 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc34af6c-fcc5-44af-9e4e-66400ce9cc9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6472c2d910>]}
[0m07:18:53.274724 [info ] [Thread-1 (]: 1 of 2 OK created sql table model main.transform_users ......................... [[32mOK[0m in 0.49s]
[0m07:18:53.279440 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.transform_users
[0m07:18:53.281815 [debug] [Thread-1 (]: Began running node model.my_dbt_project.transform_users2
[0m07:18:53.283689 [info ] [Thread-1 (]: 2 of 2 START sql table model main.transform_users2 ............................. [RUN]
[0m07:18:53.285963 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.transform_users, now model.my_dbt_project.transform_users2)
[0m07:18:53.287400 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.transform_users2
[0m07:18:53.293780 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.transform_users2"
[0m07:18:53.310469 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.transform_users2
[0m07:18:53.321823 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.transform_users2"
[0m07:18:53.338054 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users2"
[0m07:18:53.339380 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users2: BEGIN
[0m07:18:53.340636 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:18:53.367681 [debug] [Thread-1 (]: SQL status: OK in 0.027 seconds
[0m07:18:53.369160 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users2"
[0m07:18:53.370651 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users2: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_users2"} */

  
    
    

    create  table
      "my_duckdb_database"."main"."transform_users2__dbt_tmp"
  
    as (
      -- /opt/airflow/dags/dbt_models/transform_users.sql


WITH users AS (
    SELECT * FROM "my_duckdb_database"."main"."users"
)

SELECT
    id,
    name,
    username,
    email,
    address_street,
    address_suite,
    address_city,
    address_zipcode,
    phone,
    website,
    company_name
FROM users
WHERE address_city = 'Wisokyburgh'
    );
  
  
[0m07:18:53.377618 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m07:18:53.385416 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users2"
[0m07:18:53.386734 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users2: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_users2"} */
alter table "my_duckdb_database"."main"."transform_users2" rename to "transform_users2__dbt_backup"
[0m07:18:53.388921 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:18:53.396726 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users2"
[0m07:18:53.398242 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users2: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_users2"} */
alter table "my_duckdb_database"."main"."transform_users2__dbt_tmp" rename to "transform_users2"
[0m07:18:53.400894 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:18:53.406921 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users2: COMMIT
[0m07:18:53.408607 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users2"
[0m07:18:53.410331 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users2: COMMIT
[0m07:18:53.421656 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m07:18:53.431586 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users2"
[0m07:18:53.433533 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users2: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_users2"} */
drop table if exists "my_duckdb_database"."main"."transform_users2__dbt_backup" cascade
[0m07:18:53.438755 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m07:18:53.443016 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users2: Close
[0m07:18:53.489958 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc34af6c-fcc5-44af-9e4e-66400ce9cc9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6472c681d0>]}
[0m07:18:53.492170 [info ] [Thread-1 (]: 2 of 2 OK created sql table model main.transform_users2 ........................ [[32mOK[0m in 0.20s]
[0m07:18:53.496950 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.transform_users2
[0m07:18:53.501441 [debug] [MainThread]: Using duckdb connection "master"
[0m07:18:53.502873 [debug] [MainThread]: On master: BEGIN
[0m07:18:53.504338 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:18:53.527512 [debug] [MainThread]: SQL status: OK in 0.023 seconds
[0m07:18:53.529451 [debug] [MainThread]: On master: COMMIT
[0m07:18:53.530833 [debug] [MainThread]: Using duckdb connection "master"
[0m07:18:53.532634 [debug] [MainThread]: On master: COMMIT
[0m07:18:53.534667 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m07:18:53.536860 [debug] [MainThread]: On master: Close
[0m07:18:53.542506 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:18:53.544466 [debug] [MainThread]: Connection 'list_my_duckdb_database_main' was properly closed.
[0m07:18:53.546275 [debug] [MainThread]: Connection 'model.my_dbt_project.transform_users2' was properly closed.
[0m07:18:53.548771 [info ] [MainThread]: 
[0m07:18:53.551462 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 1.60 seconds (1.60s).
[0m07:18:53.556109 [debug] [MainThread]: Command end result
[0m07:18:53.664420 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m07:18:53.680157 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m07:18:53.707043 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dags/dbt_models/target/run_results.json
[0m07:18:53.708649 [info ] [MainThread]: 
[0m07:18:53.710727 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:18:53.713142 [info ] [MainThread]: 
[0m07:18:53.715278 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m07:18:53.719889 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.1674013, "process_in_blocks": "173864", "process_kernel_time": 1.46054, "process_mem_max_rss": "129576", "process_out_blocks": "0", "process_user_time": 7.302704}
[0m07:18:53.725708 [debug] [MainThread]: Command `dbt run` succeeded at 07:18:53.725359 after 7.17 seconds
[0m07:18:53.727610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6479abce30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f647ab74710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6479e5a780>]}
[0m07:18:53.730094 [debug] [MainThread]: Flushing usage events
[0m07:18:55.397092 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:31:57.720768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19f7edef60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19f8139f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19f82402f0>]}


============================== 07:32:18.104120 | 9ba5899a-074f-44b7-a2d4-042ebc3ad61c ==============================
[0m07:32:18.104120 [info ] [MainThread]: Running with dbt=1.9.1
[0m07:32:40.486979 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/profiles.yml', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dags/dbt_models/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt/profiles.yml --target dev', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m07:32:46.898400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9ba5899a-074f-44b7-a2d4-042ebc3ad61c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19f99f9a30>]}
[0m07:32:47.529475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9ba5899a-074f-44b7-a2d4-042ebc3ad61c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19f84b31a0>]}
[0m07:32:47.573629 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m07:32:49.625119 [debug] [MainThread]: checksum: cac3b9519010e47bfbeb71ca6efb4867dae2858687671594dc23fefc94ecf25d, vars: {}, profile: , target: dev, version: 1.9.1
[0m07:32:50.761539 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:32:50.764227 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:32:50.954966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9ba5899a-074f-44b7-a2d4-042ebc3ad61c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19f7787c80>]}
[0m07:32:51.517169 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m07:32:51.532467 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m07:32:52.006253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9ba5899a-074f-44b7-a2d4-042ebc3ad61c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19f19e49e0>]}
[0m07:32:52.009269 [info ] [MainThread]: Found 2 models, 1 source, 424 macros
[0m07:32:52.011740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9ba5899a-074f-44b7-a2d4-042ebc3ad61c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19f7b0c530>]}
[0m07:32:52.021086 [info ] [MainThread]: 
[0m07:32:52.027390 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:32:52.030881 [info ] [MainThread]: 
[0m07:32:52.035993 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m07:32:52.058056 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_my_duckdb_database'
[0m07:32:52.316273 [debug] [ThreadPool]: Using duckdb connection "list_my_duckdb_database"
[0m07:32:52.320694 [debug] [ThreadPool]: On list_my_duckdb_database: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "list_my_duckdb_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"my_duckdb_database"'
    
  
  
[0m07:32:52.322508 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:32:52.768174 [debug] [ThreadPool]: SQL status: OK in 0.446 seconds
[0m07:32:52.777892 [debug] [ThreadPool]: On list_my_duckdb_database: Close
[0m07:32:52.805050 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_duckdb_database, now create_my_duckdb_database_main)
[0m07:32:52.807995 [debug] [ThreadPool]: Creating schema "database: "my_duckdb_database"
schema: "main"
"
[0m07:32:52.842752 [debug] [ThreadPool]: Using duckdb connection "create_my_duckdb_database_main"
[0m07:32:52.844812 [debug] [ThreadPool]: On create_my_duckdb_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "create_my_duckdb_database_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='my_duckdb_database'
        and type='sqlite'
    
  
[0m07:32:52.847081 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:32:52.962811 [debug] [ThreadPool]: SQL status: OK in 0.116 seconds
[0m07:32:52.967881 [debug] [ThreadPool]: Using duckdb connection "create_my_duckdb_database_main"
[0m07:32:52.981435 [debug] [ThreadPool]: On create_my_duckdb_database_main: BEGIN
[0m07:32:52.984137 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m07:32:52.987902 [debug] [ThreadPool]: Using duckdb connection "create_my_duckdb_database_main"
[0m07:32:52.989650 [debug] [ThreadPool]: On create_my_duckdb_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "create_my_duckdb_database_main"} */

    
    
        create schema if not exists "my_duckdb_database"."main"
    
[0m07:32:53.010080 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m07:32:53.014480 [debug] [ThreadPool]: On create_my_duckdb_database_main: COMMIT
[0m07:32:53.021354 [debug] [ThreadPool]: Using duckdb connection "create_my_duckdb_database_main"
[0m07:32:53.023047 [debug] [ThreadPool]: On create_my_duckdb_database_main: COMMIT
[0m07:32:53.029253 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m07:32:53.033203 [debug] [ThreadPool]: On create_my_duckdb_database_main: Close
[0m07:32:53.045173 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_my_duckdb_database_main, now list_my_duckdb_database_main)
[0m07:32:53.114764 [debug] [ThreadPool]: Using duckdb connection "list_my_duckdb_database_main"
[0m07:32:53.120185 [debug] [ThreadPool]: On list_my_duckdb_database_main: BEGIN
[0m07:32:53.122897 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:32:53.178365 [debug] [ThreadPool]: SQL status: OK in 0.055 seconds
[0m07:32:53.183153 [debug] [ThreadPool]: Using duckdb connection "list_my_duckdb_database_main"
[0m07:32:53.186070 [debug] [ThreadPool]: On list_my_duckdb_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "list_my_duckdb_database_main"} */
select
      'my_duckdb_database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'my_duckdb_database'
  
[0m07:32:53.375683 [debug] [ThreadPool]: SQL status: OK in 0.187 seconds
[0m07:32:53.380744 [debug] [ThreadPool]: On list_my_duckdb_database_main: ROLLBACK
[0m07:32:53.391740 [debug] [ThreadPool]: Failed to rollback 'list_my_duckdb_database_main'
[0m07:32:53.395482 [debug] [ThreadPool]: On list_my_duckdb_database_main: Close
[0m07:32:53.428504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9ba5899a-074f-44b7-a2d4-042ebc3ad61c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19f1fa5ee0>]}
[0m07:32:53.430776 [debug] [MainThread]: Using duckdb connection "master"
[0m07:32:53.432356 [debug] [MainThread]: On master: BEGIN
[0m07:32:53.435546 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:32:53.513089 [debug] [MainThread]: SQL status: OK in 0.078 seconds
[0m07:32:53.527891 [debug] [MainThread]: On master: COMMIT
[0m07:32:53.541618 [debug] [MainThread]: Using duckdb connection "master"
[0m07:32:53.544224 [debug] [MainThread]: On master: COMMIT
[0m07:32:53.558047 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m07:32:53.559976 [debug] [MainThread]: On master: Close
[0m07:32:53.619725 [debug] [Thread-1 (]: Began running node model.my_dbt_project.transform_users
[0m07:32:53.622219 [info ] [Thread-1 (]: 1 of 2 START sql table model main.transform_users .............................. [RUN]
[0m07:32:53.624977 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.my_dbt_project.transform_users'
[0m07:32:53.631730 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.transform_users
[0m07:32:53.662580 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.transform_users"
[0m07:32:53.686199 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.transform_users
[0m07:32:53.866885 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.transform_users"
[0m07:32:53.890043 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users"
[0m07:32:53.891942 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users: BEGIN
[0m07:32:53.893787 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m07:32:53.925613 [debug] [Thread-1 (]: SQL status: OK in 0.032 seconds
[0m07:32:53.927622 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users"
[0m07:32:53.929665 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_users"} */

  
    
    

    create  table
      "my_duckdb_database"."main"."transform_users__dbt_tmp"
  
    as (
      -- /opt/airflow/dags/dbt_models/transform_users.sql


WITH users AS (
    SELECT * FROM "my_duckdb_database"."main"."users"
)

SELECT
    id,
    name,
    username,
    email,
    address_street,
    address_suite,
    address_city,
    address_zipcode,
    phone,
    website,
    company_name
FROM users
WHERE address_city = 'Gwenborough'
    );
  
  
[0m07:32:53.969752 [debug] [Thread-1 (]: SQL status: OK in 0.038 seconds
[0m07:32:54.012703 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users"
[0m07:32:54.014555 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_users"} */
alter table "my_duckdb_database"."main"."transform_users" rename to "transform_users__dbt_backup"
[0m07:32:54.020134 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:32:54.038569 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users"
[0m07:32:54.040669 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_users"} */
alter table "my_duckdb_database"."main"."transform_users__dbt_tmp" rename to "transform_users"
[0m07:32:54.045036 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:32:54.116196 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users: COMMIT
[0m07:32:54.120216 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users"
[0m07:32:54.122597 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users: COMMIT
[0m07:32:54.155585 [debug] [Thread-1 (]: SQL status: OK in 0.031 seconds
[0m07:32:54.182031 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users"
[0m07:32:54.187109 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_users"} */
drop table if exists "my_duckdb_database"."main"."transform_users__dbt_backup" cascade
[0m07:32:54.213669 [debug] [Thread-1 (]: SQL status: OK in 0.022 seconds
[0m07:32:54.223813 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users: Close
[0m07:32:54.563700 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ba5899a-074f-44b7-a2d4-042ebc3ad61c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19f0c33740>]}
[0m07:32:54.567546 [info ] [Thread-1 (]: 1 of 2 OK created sql table model main.transform_users ......................... [[32mOK[0m in 0.93s]
[0m07:32:54.577530 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.transform_users
[0m07:32:54.582441 [debug] [Thread-1 (]: Began running node model.my_dbt_project.transform_users2
[0m07:32:54.587199 [info ] [Thread-1 (]: 2 of 2 START sql table model main.transform_users2 ............................. [RUN]
[0m07:32:54.590473 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.transform_users, now model.my_dbt_project.transform_users2)
[0m07:32:54.592764 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.transform_users2
[0m07:32:54.606388 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.transform_users2"
[0m07:32:54.627858 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.transform_users2
[0m07:32:54.639940 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.transform_users2"
[0m07:32:54.659797 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users2"
[0m07:32:54.661962 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users2: BEGIN
[0m07:32:54.663825 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:32:54.694928 [debug] [Thread-1 (]: SQL status: OK in 0.031 seconds
[0m07:32:54.697861 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users2"
[0m07:32:54.700319 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users2: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_users2"} */

  
    
    

    create  table
      "my_duckdb_database"."main"."transform_users2__dbt_tmp"
  
    as (
      -- /opt/airflow/dags/dbt_models/transform_users.sql


WITH users AS (
    SELECT * FROM "my_duckdb_database"."main"."users"
)

SELECT
    id,
    name,
    username,
    email,
    address_street,
    address_suite,
    address_city,
    address_zipcode,
    phone,
    website,
    company_name
FROM users
WHERE address_city = 'Wisokyburgh'
    );
  
  
[0m07:32:54.716048 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m07:32:54.728312 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users2"
[0m07:32:54.730264 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users2: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_users2"} */
alter table "my_duckdb_database"."main"."transform_users2" rename to "transform_users2__dbt_backup"
[0m07:32:54.733202 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:32:54.744707 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users2"
[0m07:32:54.746641 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users2: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_users2"} */
alter table "my_duckdb_database"."main"."transform_users2__dbt_tmp" rename to "transform_users2"
[0m07:32:54.749472 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:32:54.757152 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users2: COMMIT
[0m07:32:54.759123 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users2"
[0m07:32:54.760982 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users2: COMMIT
[0m07:32:54.780029 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m07:32:54.788989 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users2"
[0m07:32:54.791102 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users2: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_users2"} */
drop table if exists "my_duckdb_database"."main"."transform_users2__dbt_backup" cascade
[0m07:32:54.796546 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m07:32:54.801941 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users2: Close
[0m07:32:54.850131 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ba5899a-074f-44b7-a2d4-042ebc3ad61c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19f0c6c050>]}
[0m07:32:54.855530 [info ] [Thread-1 (]: 2 of 2 OK created sql table model main.transform_users2 ........................ [[32mOK[0m in 0.26s]
[0m07:32:54.865122 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.transform_users2
[0m07:32:54.873435 [debug] [MainThread]: Using duckdb connection "master"
[0m07:32:54.875521 [debug] [MainThread]: On master: BEGIN
[0m07:32:54.879731 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:32:54.946268 [debug] [MainThread]: SQL status: OK in 0.067 seconds
[0m07:32:54.948334 [debug] [MainThread]: On master: COMMIT
[0m07:32:54.950640 [debug] [MainThread]: Using duckdb connection "master"
[0m07:32:54.954613 [debug] [MainThread]: On master: COMMIT
[0m07:32:54.959085 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m07:32:54.960830 [debug] [MainThread]: On master: Close
[0m07:32:54.967092 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:32:54.971108 [debug] [MainThread]: Connection 'list_my_duckdb_database_main' was properly closed.
[0m07:32:54.974509 [debug] [MainThread]: Connection 'model.my_dbt_project.transform_users2' was properly closed.
[0m07:32:54.977029 [info ] [MainThread]: 
[0m07:32:54.979169 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 2.94 seconds (2.94s).
[0m07:32:54.983581 [debug] [MainThread]: Command end result
[0m07:32:55.182072 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m07:32:55.204073 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m07:32:55.264677 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dags/dbt_models/target/run_results.json
[0m07:32:55.266645 [info ] [MainThread]: 
[0m07:32:55.270520 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:32:55.274048 [info ] [MainThread]: 
[0m07:32:55.276640 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m07:32:55.291485 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 59.294807, "process_in_blocks": "1251904", "process_kernel_time": 6.320957, "process_mem_max_rss": "129760", "process_out_blocks": "0", "process_user_time": 11.523514}
[0m07:32:55.297877 [debug] [MainThread]: Command `dbt run` succeeded at 07:32:55.297539 after 59.30 seconds
[0m07:32:55.301951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19f7bd83e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19f19b45f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19f19b78f0>]}
[0m07:32:55.307923 [debug] [MainThread]: Flushing usage events
[0m07:32:57.296272 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:35:59.005626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe150ffff20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe150a9d730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe150ffe7b0>]}


============================== 07:35:59.026147 | d240178d-cf09-4534-83f3-511cfc289cb2 ==============================
[0m07:35:59.026147 [info ] [MainThread]: Running with dbt=1.9.1
[0m07:35:59.028450 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/profiles.yml', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dags/dbt_models/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt/profiles.yml --target dev', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m07:36:00.429342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd240178d-cf09-4534-83f3-511cfc289cb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe14ab69940>]}
[0m07:36:00.606310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd240178d-cf09-4534-83f3-511cfc289cb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1508ca150>]}
[0m07:36:00.619753 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m07:36:00.960221 [debug] [MainThread]: checksum: cac3b9519010e47bfbeb71ca6efb4867dae2858687671594dc23fefc94ecf25d, vars: {}, profile: , target: dev, version: 1.9.1
[0m07:36:01.416877 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:36:01.418093 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:36:01.536731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd240178d-cf09-4534-83f3-511cfc289cb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe14ab9a750>]}
[0m07:36:01.911409 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m07:36:01.927522 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m07:36:02.217600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd240178d-cf09-4534-83f3-511cfc289cb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe14a707f50>]}
[0m07:36:02.220452 [info ] [MainThread]: Found 2 models, 1 source, 424 macros
[0m07:36:02.230823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd240178d-cf09-4534-83f3-511cfc289cb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe14a5e1e80>]}
[0m07:36:02.241015 [info ] [MainThread]: 
[0m07:36:02.271166 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:36:02.281142 [info ] [MainThread]: 
[0m07:36:02.305072 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m07:36:02.344031 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_my_duckdb_database'
[0m07:36:02.644207 [debug] [ThreadPool]: Using duckdb connection "list_my_duckdb_database"
[0m07:36:02.646316 [debug] [ThreadPool]: On list_my_duckdb_database: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "list_my_duckdb_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"my_duckdb_database"'
    
  
  
[0m07:36:02.648241 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:36:02.785437 [debug] [ThreadPool]: SQL status: OK in 0.137 seconds
[0m07:36:02.789925 [debug] [ThreadPool]: On list_my_duckdb_database: Close
[0m07:36:02.797597 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_duckdb_database, now create_my_duckdb_database_main)
[0m07:36:02.800788 [debug] [ThreadPool]: Creating schema "database: "my_duckdb_database"
schema: "main"
"
[0m07:36:02.825222 [debug] [ThreadPool]: Using duckdb connection "create_my_duckdb_database_main"
[0m07:36:02.827097 [debug] [ThreadPool]: On create_my_duckdb_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "create_my_duckdb_database_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='my_duckdb_database'
        and type='sqlite'
    
  
[0m07:36:02.828484 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:36:02.863560 [debug] [ThreadPool]: SQL status: OK in 0.035 seconds
[0m07:36:02.869082 [debug] [ThreadPool]: Using duckdb connection "create_my_duckdb_database_main"
[0m07:36:02.870877 [debug] [ThreadPool]: On create_my_duckdb_database_main: BEGIN
[0m07:36:02.873514 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m07:36:02.877087 [debug] [ThreadPool]: Using duckdb connection "create_my_duckdb_database_main"
[0m07:36:02.879824 [debug] [ThreadPool]: On create_my_duckdb_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "create_my_duckdb_database_main"} */

    
    
        create schema if not exists "my_duckdb_database"."main"
    
[0m07:36:02.883649 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m07:36:02.886860 [debug] [ThreadPool]: On create_my_duckdb_database_main: COMMIT
[0m07:36:02.888609 [debug] [ThreadPool]: Using duckdb connection "create_my_duckdb_database_main"
[0m07:36:02.892517 [debug] [ThreadPool]: On create_my_duckdb_database_main: COMMIT
[0m07:36:02.894887 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m07:36:02.896771 [debug] [ThreadPool]: On create_my_duckdb_database_main: Close
[0m07:36:02.905884 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_my_duckdb_database_main, now list_my_duckdb_database_main)
[0m07:36:02.929051 [debug] [ThreadPool]: Using duckdb connection "list_my_duckdb_database_main"
[0m07:36:02.970987 [debug] [ThreadPool]: On list_my_duckdb_database_main: BEGIN
[0m07:36:03.004776 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:36:03.363491 [debug] [ThreadPool]: SQL status: OK in 0.358 seconds
[0m07:36:03.367249 [debug] [ThreadPool]: Using duckdb connection "list_my_duckdb_database_main"
[0m07:36:03.377568 [debug] [ThreadPool]: On list_my_duckdb_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "list_my_duckdb_database_main"} */
select
      'my_duckdb_database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'my_duckdb_database'
  
[0m07:36:03.492356 [debug] [ThreadPool]: SQL status: OK in 0.112 seconds
[0m07:36:03.496790 [debug] [ThreadPool]: On list_my_duckdb_database_main: ROLLBACK
[0m07:36:03.501817 [debug] [ThreadPool]: Failed to rollback 'list_my_duckdb_database_main'
[0m07:36:03.503334 [debug] [ThreadPool]: On list_my_duckdb_database_main: Close
[0m07:36:03.516553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd240178d-cf09-4534-83f3-511cfc289cb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1502840b0>]}
[0m07:36:03.518360 [debug] [MainThread]: Using duckdb connection "master"
[0m07:36:03.519760 [debug] [MainThread]: On master: BEGIN
[0m07:36:03.521189 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:36:03.552451 [debug] [MainThread]: SQL status: OK in 0.031 seconds
[0m07:36:03.554089 [debug] [MainThread]: On master: COMMIT
[0m07:36:03.557383 [debug] [MainThread]: Using duckdb connection "master"
[0m07:36:03.559524 [debug] [MainThread]: On master: COMMIT
[0m07:36:03.562371 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m07:36:03.564491 [debug] [MainThread]: On master: Close
[0m07:36:03.574271 [debug] [Thread-1 (]: Began running node model.my_dbt_project.transform_users
[0m07:36:03.576840 [info ] [Thread-1 (]: 1 of 2 START sql table model main.transform_users .............................. [RUN]
[0m07:36:03.584630 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.my_dbt_project.transform_users'
[0m07:36:03.585999 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.transform_users
[0m07:36:03.609697 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.transform_users"
[0m07:36:03.628605 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.transform_users
[0m07:36:03.732028 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.transform_users"
[0m07:36:03.751374 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users"
[0m07:36:03.753054 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users: BEGIN
[0m07:36:03.755126 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m07:36:03.784755 [debug] [Thread-1 (]: SQL status: OK in 0.030 seconds
[0m07:36:03.786316 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users"
[0m07:36:03.788169 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_users"} */

  
    
    

    create  table
      "my_duckdb_database"."main"."transform_users__dbt_tmp"
  
    as (
      -- /opt/airflow/dags/dbt_models/transform_users.sql


WITH users AS (
    SELECT * FROM "my_duckdb_database"."main"."users"
)

SELECT
    id,
    name,
    username,
    email,
    address_street,
    address_suite,
    address_city,
    address_zipcode,
    phone,
    website,
    company_name
FROM users
WHERE address_city = 'Gwenborough'
    );
  
  
[0m07:36:03.799913 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m07:36:03.813616 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users"
[0m07:36:03.814976 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_users"} */
alter table "my_duckdb_database"."main"."transform_users" rename to "transform_users__dbt_backup"
[0m07:36:03.817075 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:36:03.827881 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users"
[0m07:36:03.829723 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_users"} */
alter table "my_duckdb_database"."main"."transform_users__dbt_tmp" rename to "transform_users"
[0m07:36:03.832324 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:36:03.868580 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users: COMMIT
[0m07:36:03.870132 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users"
[0m07:36:03.871619 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users: COMMIT
[0m07:36:03.882296 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m07:36:03.897737 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users"
[0m07:36:03.901035 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_users"} */
drop table if exists "my_duckdb_database"."main"."transform_users__dbt_backup" cascade
[0m07:36:03.911839 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m07:36:03.929814 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users: Close
[0m07:36:03.987773 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd240178d-cf09-4534-83f3-511cfc289cb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe150fd01a0>]}
[0m07:36:03.990122 [info ] [Thread-1 (]: 1 of 2 OK created sql table model main.transform_users ......................... [[32mOK[0m in 0.40s]
[0m07:36:03.993001 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.transform_users
[0m07:36:03.994594 [debug] [Thread-1 (]: Began running node model.my_dbt_project.transform_users2
[0m07:36:03.996500 [info ] [Thread-1 (]: 2 of 2 START sql table model main.transform_users2 ............................. [RUN]
[0m07:36:03.998913 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.transform_users, now model.my_dbt_project.transform_users2)
[0m07:36:04.000780 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.transform_users2
[0m07:36:04.012991 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.transform_users2"
[0m07:36:04.029251 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.transform_users2
[0m07:36:04.039092 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.transform_users2"
[0m07:36:04.055566 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users2"
[0m07:36:04.057950 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users2: BEGIN
[0m07:36:04.059908 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:36:04.098170 [debug] [Thread-1 (]: SQL status: OK in 0.038 seconds
[0m07:36:04.101603 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users2"
[0m07:36:04.110458 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users2: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_users2"} */

  
    
    

    create  table
      "my_duckdb_database"."main"."transform_users2__dbt_tmp"
  
    as (
      -- /opt/airflow/dags/dbt_models/transform_users.sql


WITH users AS (
    SELECT * FROM "my_duckdb_database"."main"."users"
)

SELECT
    id,
    name,
    username,
    email,
    address_street,
    address_suite,
    address_city,
    address_zipcode,
    phone,
    website,
    company_name
FROM users
WHERE address_city = 'Wisokyburgh'
    );
  
  
[0m07:36:04.126633 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m07:36:04.142659 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users2"
[0m07:36:04.145969 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users2: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_users2"} */
alter table "my_duckdb_database"."main"."transform_users2" rename to "transform_users2__dbt_backup"
[0m07:36:04.148911 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:36:04.155725 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users2"
[0m07:36:04.158294 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users2: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_users2"} */
alter table "my_duckdb_database"."main"."transform_users2__dbt_tmp" rename to "transform_users2"
[0m07:36:04.161952 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:36:04.167672 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users2: COMMIT
[0m07:36:04.169375 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users2"
[0m07:36:04.171059 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users2: COMMIT
[0m07:36:04.181917 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m07:36:04.189033 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users2"
[0m07:36:04.191311 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users2: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_users2"} */
drop table if exists "my_duckdb_database"."main"."transform_users2__dbt_backup" cascade
[0m07:36:04.196771 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m07:36:04.201990 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users2: Close
[0m07:36:04.259181 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd240178d-cf09-4534-83f3-511cfc289cb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1499b6a50>]}
[0m07:36:04.261870 [info ] [Thread-1 (]: 2 of 2 OK created sql table model main.transform_users2 ........................ [[32mOK[0m in 0.26s]
[0m07:36:04.265115 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.transform_users2
[0m07:36:04.270681 [debug] [MainThread]: Using duckdb connection "master"
[0m07:36:04.272267 [debug] [MainThread]: On master: BEGIN
[0m07:36:04.274456 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:36:04.311772 [debug] [MainThread]: SQL status: OK in 0.037 seconds
[0m07:36:04.313597 [debug] [MainThread]: On master: COMMIT
[0m07:36:04.315519 [debug] [MainThread]: Using duckdb connection "master"
[0m07:36:04.318064 [debug] [MainThread]: On master: COMMIT
[0m07:36:04.320894 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m07:36:04.322859 [debug] [MainThread]: On master: Close
[0m07:36:04.329721 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:36:04.332929 [debug] [MainThread]: Connection 'list_my_duckdb_database_main' was properly closed.
[0m07:36:04.337275 [debug] [MainThread]: Connection 'model.my_dbt_project.transform_users2' was properly closed.
[0m07:36:04.342951 [info ] [MainThread]: 
[0m07:36:04.345248 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 2.04 seconds (2.04s).
[0m07:36:04.349786 [debug] [MainThread]: Command end result
[0m07:36:04.515514 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m07:36:04.527792 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m07:36:04.554825 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dags/dbt_models/target/run_results.json
[0m07:36:04.557704 [info ] [MainThread]: 
[0m07:36:04.559750 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:36:04.562038 [info ] [MainThread]: 
[0m07:36:04.563969 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m07:36:04.567024 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.905764, "process_in_blocks": "130496", "process_kernel_time": 2.788841, "process_mem_max_rss": "149032", "process_out_blocks": "0", "process_user_time": 13.031311}
[0m07:36:04.572371 [debug] [MainThread]: Command `dbt run` succeeded at 07:36:04.572018 after 5.91 seconds
[0m07:36:04.576300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1503a2f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe150fd2570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe150fd2f30>]}
[0m07:36:04.577631 [debug] [MainThread]: Flushing usage events
[0m07:36:05.892328 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:40:58.876611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f8286bdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f810b6600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f8197c560>]}


============================== 07:40:58.923611 | 66e422ea-8549-4862-8f2e-1b37e2258eaf ==============================
[0m07:40:58.923611 [info ] [MainThread]: Running with dbt=1.9.1
[0m07:40:58.929198 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/profiles.yml', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dags/dbt_models/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt/profiles.yml --target dev', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:41:00.420203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '66e422ea-8549-4862-8f2e-1b37e2258eaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f80933830>]}
[0m07:41:00.643611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '66e422ea-8549-4862-8f2e-1b37e2258eaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f8226ad20>]}
[0m07:41:00.680444 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m07:41:01.864916 [debug] [MainThread]: checksum: cac3b9519010e47bfbeb71ca6efb4867dae2858687671594dc23fefc94ecf25d, vars: {}, profile: , target: dev, version: 1.9.1
[0m07:41:03.333805 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:41:03.336689 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:41:03.539681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '66e422ea-8549-4862-8f2e-1b37e2258eaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f8048c1d0>]}
[0m07:41:03.955315 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m07:41:03.987087 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m07:41:04.353960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '66e422ea-8549-4862-8f2e-1b37e2258eaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f7a8b0b60>]}
[0m07:41:04.369772 [info ] [MainThread]: Found 2 models, 1 source, 424 macros
[0m07:41:04.373448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '66e422ea-8549-4862-8f2e-1b37e2258eaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f8043c5f0>]}
[0m07:41:04.392640 [info ] [MainThread]: 
[0m07:41:04.400231 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:41:04.411609 [info ] [MainThread]: 
[0m07:41:04.422868 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m07:41:04.472377 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_my_duckdb_database'
[0m07:41:04.809779 [debug] [ThreadPool]: Using duckdb connection "list_my_duckdb_database"
[0m07:41:04.821591 [debug] [ThreadPool]: On list_my_duckdb_database: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "list_my_duckdb_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"my_duckdb_database"'
    
  
  
[0m07:41:04.824424 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:41:06.972604 [debug] [ThreadPool]: SQL status: OK in 2.118 seconds
[0m07:41:07.099331 [debug] [ThreadPool]: On list_my_duckdb_database: Close
[0m07:41:07.322421 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_duckdb_database, now create_my_duckdb_database_main)
[0m07:41:07.361978 [debug] [ThreadPool]: Creating schema "database: "my_duckdb_database"
schema: "main"
"
[0m07:41:07.422808 [debug] [ThreadPool]: Using duckdb connection "create_my_duckdb_database_main"
[0m07:41:07.435431 [debug] [ThreadPool]: On create_my_duckdb_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "create_my_duckdb_database_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='my_duckdb_database'
        and type='sqlite'
    
  
[0m07:41:07.437223 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:41:08.874524 [debug] [ThreadPool]: SQL status: OK in 1.417 seconds
[0m07:41:09.047834 [debug] [ThreadPool]: Using duckdb connection "create_my_duckdb_database_main"
[0m07:41:09.064363 [debug] [ThreadPool]: On create_my_duckdb_database_main: BEGIN
[0m07:41:09.502438 [debug] [ThreadPool]: SQL status: OK in 0.198 seconds
[0m07:41:10.075064 [debug] [ThreadPool]: Using duckdb connection "create_my_duckdb_database_main"
[0m07:41:10.077593 [debug] [ThreadPool]: On create_my_duckdb_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "create_my_duckdb_database_main"} */

    
    
        create schema if not exists "my_duckdb_database"."main"
    
[0m07:41:10.407193 [debug] [ThreadPool]: SQL status: OK in 0.310 seconds
[0m07:41:10.425308 [debug] [ThreadPool]: On create_my_duckdb_database_main: COMMIT
[0m07:41:10.430147 [debug] [ThreadPool]: Using duckdb connection "create_my_duckdb_database_main"
[0m07:41:10.436345 [debug] [ThreadPool]: On create_my_duckdb_database_main: COMMIT
[0m07:41:10.658685 [debug] [ThreadPool]: SQL status: OK in 0.196 seconds
[0m07:41:10.698460 [debug] [ThreadPool]: On create_my_duckdb_database_main: Close
[0m07:41:10.885597 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_my_duckdb_database_main'
[0m07:41:11.049951 [debug] [ThreadPool]: Using duckdb connection "list_my_duckdb_database_main"
[0m07:41:11.065602 [debug] [ThreadPool]: On list_my_duckdb_database_main: BEGIN
[0m07:41:11.067679 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:41:13.244976 [debug] [ThreadPool]: SQL status: OK in 2.158 seconds
[0m07:41:13.253547 [debug] [ThreadPool]: Using duckdb connection "list_my_duckdb_database_main"
[0m07:41:13.255435 [debug] [ThreadPool]: On list_my_duckdb_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "list_my_duckdb_database_main"} */
select
      'my_duckdb_database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'my_duckdb_database'
  
[0m07:41:21.012525 [debug] [ThreadPool]: SQL status: OK in 7.801 seconds
[0m07:41:21.021147 [debug] [ThreadPool]: On list_my_duckdb_database_main: ROLLBACK
[0m07:41:21.031988 [debug] [ThreadPool]: Failed to rollback 'list_my_duckdb_database_main'
[0m07:41:21.033783 [debug] [ThreadPool]: On list_my_duckdb_database_main: Close
[0m07:41:21.049979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '66e422ea-8549-4862-8f2e-1b37e2258eaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f8226af60>]}
[0m07:41:21.052165 [debug] [MainThread]: Using duckdb connection "master"
[0m07:41:21.053739 [debug] [MainThread]: On master: BEGIN
[0m07:41:21.055401 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:41:21.148144 [debug] [MainThread]: SQL status: OK in 0.093 seconds
[0m07:41:21.149807 [debug] [MainThread]: On master: COMMIT
[0m07:41:21.151507 [debug] [MainThread]: Using duckdb connection "master"
[0m07:41:21.153322 [debug] [MainThread]: On master: COMMIT
[0m07:41:21.155619 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m07:41:21.157103 [debug] [MainThread]: On master: Close
[0m07:41:21.183754 [debug] [Thread-1 (]: Began running node model.my_dbt_project.transform_users
[0m07:41:21.186385 [info ] [Thread-1 (]: 1 of 2 START sql table model main.transform_users .............................. [RUN]
[0m07:41:21.189909 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.my_dbt_project.transform_users'
[0m07:41:21.197233 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.transform_users
[0m07:41:21.248391 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.transform_users"
[0m07:41:21.275591 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.transform_users
[0m07:41:21.586402 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.transform_users"
[0m07:41:21.643908 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users"
[0m07:41:21.646895 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users: BEGIN
[0m07:41:21.649109 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m07:41:21.762830 [debug] [Thread-1 (]: SQL status: OK in 0.114 seconds
[0m07:41:21.765288 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users"
[0m07:41:21.776530 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_users"} */

  
    
    

    create  table
      "my_duckdb_database"."main"."transform_users__dbt_tmp"
  
    as (
      -- /opt/airflow/dags/dbt_models/transform_users.sql


WITH users AS (
    SELECT * FROM "my_duckdb_database"."main"."users"
)

SELECT
    id,
    name,
    username,
    email,
    address_street,
    address_suite,
    address_city,
    address_zipcode,
    phone,
    website,
    company_name
FROM users
WHERE address_city = 'Gwenborough'
    );
  
  
[0m07:41:21.867878 [debug] [Thread-1 (]: SQL status: OK in 0.088 seconds
[0m07:41:21.926217 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users"
[0m07:41:21.928720 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_users"} */
alter table "my_duckdb_database"."main"."transform_users" rename to "transform_users__dbt_backup"
[0m07:41:21.945297 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m07:41:22.000382 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users"
[0m07:41:22.014584 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_users"} */
alter table "my_duckdb_database"."main"."transform_users__dbt_tmp" rename to "transform_users"
[0m07:41:22.018256 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:41:22.240770 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users: COMMIT
[0m07:41:22.252561 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users"
[0m07:41:22.254795 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users: COMMIT
[0m07:41:22.438657 [debug] [Thread-1 (]: SQL status: OK in 0.179 seconds
[0m07:41:22.536810 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users"
[0m07:41:22.568289 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_users"} */
drop table if exists "my_duckdb_database"."main"."transform_users__dbt_backup" cascade
[0m07:41:22.680825 [debug] [Thread-1 (]: SQL status: OK in 0.104 seconds
[0m07:41:22.717037 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users: Close
[0m07:41:23.142838 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '66e422ea-8549-4862-8f2e-1b37e2258eaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f8275f9b0>]}
[0m07:41:23.161514 [info ] [Thread-1 (]: 1 of 2 OK created sql table model main.transform_users ......................... [[32mOK[0m in 1.91s]
[0m07:41:23.177088 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.transform_users
[0m07:41:23.191330 [debug] [Thread-1 (]: Began running node model.my_dbt_project.transform_users2
[0m07:41:23.220919 [info ] [Thread-1 (]: 2 of 2 START sql table model main.transform_users2 ............................. [RUN]
[0m07:41:23.230168 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.transform_users, now model.my_dbt_project.transform_users2)
[0m07:41:23.244282 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.transform_users2
[0m07:41:23.284920 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.transform_users2"
[0m07:41:23.367017 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.transform_users2
[0m07:41:23.392300 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.transform_users2"
[0m07:41:23.461919 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users2"
[0m07:41:23.465027 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users2: BEGIN
[0m07:41:23.467140 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:41:23.615585 [debug] [Thread-1 (]: SQL status: OK in 0.148 seconds
[0m07:41:23.629605 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users2"
[0m07:41:23.631946 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users2: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_users2"} */

  
    
    

    create  table
      "my_duckdb_database"."main"."transform_users2__dbt_tmp"
  
    as (
      -- /opt/airflow/dags/dbt_models/transform_users.sql


WITH users AS (
    SELECT * FROM "my_duckdb_database"."main"."users"
)

SELECT
    id,
    name,
    username,
    email,
    address_street,
    address_suite,
    address_city,
    address_zipcode,
    phone,
    website,
    company_name
FROM users
WHERE address_city = 'Wisokyburgh'
    );
  
  
[0m07:41:23.668530 [debug] [Thread-1 (]: SQL status: OK in 0.034 seconds
[0m07:41:23.708117 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users2"
[0m07:41:23.736828 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users2: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_users2"} */
alter table "my_duckdb_database"."main"."transform_users2" rename to "transform_users2__dbt_backup"
[0m07:41:23.755472 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m07:41:23.795245 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users2"
[0m07:41:23.802998 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users2: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_users2"} */
alter table "my_duckdb_database"."main"."transform_users2__dbt_tmp" rename to "transform_users2"
[0m07:41:23.829601 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m07:41:23.878420 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users2: COMMIT
[0m07:41:23.893711 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users2"
[0m07:41:23.896545 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users2: COMMIT
[0m07:41:24.020006 [debug] [Thread-1 (]: SQL status: OK in 0.112 seconds
[0m07:41:24.043450 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users2"
[0m07:41:24.059931 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users2: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_users2"} */
drop table if exists "my_duckdb_database"."main"."transform_users2__dbt_backup" cascade
[0m07:41:24.126222 [debug] [Thread-1 (]: SQL status: OK in 0.063 seconds
[0m07:41:24.133515 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users2: Close
[0m07:41:24.521347 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '66e422ea-8549-4862-8f2e-1b37e2258eaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f79bc98e0>]}
[0m07:41:24.538884 [info ] [Thread-1 (]: 2 of 2 OK created sql table model main.transform_users2 ........................ [[32mOK[0m in 1.29s]
[0m07:41:24.544602 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.transform_users2
[0m07:41:24.558685 [debug] [MainThread]: Using duckdb connection "master"
[0m07:41:24.565245 [debug] [MainThread]: On master: BEGIN
[0m07:41:24.567310 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:41:24.633344 [debug] [MainThread]: SQL status: OK in 0.066 seconds
[0m07:41:24.636608 [debug] [MainThread]: On master: COMMIT
[0m07:41:24.640670 [debug] [MainThread]: Using duckdb connection "master"
[0m07:41:24.643668 [debug] [MainThread]: On master: COMMIT
[0m07:41:24.645931 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m07:41:24.647675 [debug] [MainThread]: On master: Close
[0m07:41:24.657879 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:41:24.662882 [debug] [MainThread]: Connection 'create_my_duckdb_database_main' was properly closed.
[0m07:41:24.666067 [debug] [MainThread]: Connection 'list_my_duckdb_database_main' was properly closed.
[0m07:41:24.668090 [debug] [MainThread]: Connection 'model.my_dbt_project.transform_users2' was properly closed.
[0m07:41:24.675981 [info ] [MainThread]: 
[0m07:41:24.680602 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 20.26 seconds (20.26s).
[0m07:41:24.685864 [debug] [MainThread]: Command end result
[0m07:41:24.901351 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m07:41:24.946182 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m07:41:24.996222 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dags/dbt_models/target/run_results.json
[0m07:41:24.998464 [info ] [MainThread]: 
[0m07:41:25.000388 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:41:25.013536 [info ] [MainThread]: 
[0m07:41:25.017758 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m07:41:25.042840 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 26.778421, "process_in_blocks": "2237648", "process_kernel_time": 4.055976, "process_mem_max_rss": "128092", "process_out_blocks": "0", "process_user_time": 18.603943}
[0m07:41:25.051280 [debug] [MainThread]: Command `dbt run` succeeded at 07:41:25.050544 after 26.79 seconds
[0m07:41:25.053874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f7ad08500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f81085d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f8052e630>]}
[0m07:41:25.056719 [debug] [MainThread]: Flushing usage events
[0m07:41:26.649942 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:47:34.618129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff39380ae70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff39354d400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff39380bfe0>]}


============================== 07:47:34.874836 | 7a39b13a-03ee-4958-8ebe-554ad6fccbf1 ==============================
[0m07:47:34.874836 [info ] [MainThread]: Running with dbt=1.9.1
[0m07:47:34.896144 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/profiles.yml', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dags/dbt_models/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt/profiles.yml --target dev', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m07:47:58.291482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7a39b13a-03ee-4958-8ebe-554ad6fccbf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff393351880>]}
[0m07:47:58.741058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7a39b13a-03ee-4958-8ebe-554ad6fccbf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff393de2d80>]}
[0m07:47:58.812794 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m07:47:59.728293 [debug] [MainThread]: checksum: cac3b9519010e47bfbeb71ca6efb4867dae2858687671594dc23fefc94ecf25d, vars: {}, profile: , target: dev, version: 1.9.1
[0m07:48:00.753399 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:48:00.759221 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:48:00.904884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7a39b13a-03ee-4958-8ebe-554ad6fccbf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff38f9cfb60>]}
[0m07:48:01.269684 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m07:48:01.289420 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m07:48:01.448662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7a39b13a-03ee-4958-8ebe-554ad6fccbf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff39302da60>]}
[0m07:48:01.450987 [info ] [MainThread]: Found 2 models, 1 source, 424 macros
[0m07:48:01.454006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7a39b13a-03ee-4958-8ebe-554ad6fccbf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3937d8ec0>]}
[0m07:48:01.467373 [info ] [MainThread]: 
[0m07:48:01.471133 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:48:01.473170 [info ] [MainThread]: 
[0m07:48:01.477375 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m07:48:01.503702 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_my_duckdb_database'
[0m07:48:01.732414 [debug] [ThreadPool]: Using duckdb connection "list_my_duckdb_database"
[0m07:48:01.734521 [debug] [ThreadPool]: On list_my_duckdb_database: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "list_my_duckdb_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"my_duckdb_database"'
    
  
  
[0m07:48:01.736644 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:48:01.943937 [debug] [ThreadPool]: SQL status: OK in 0.207 seconds
[0m07:48:01.955723 [debug] [ThreadPool]: On list_my_duckdb_database: Close
[0m07:48:02.009390 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_duckdb_database, now create_my_duckdb_database_main)
[0m07:48:02.011976 [debug] [ThreadPool]: Creating schema "database: "my_duckdb_database"
schema: "main"
"
[0m07:48:02.058785 [debug] [ThreadPool]: Using duckdb connection "create_my_duckdb_database_main"
[0m07:48:02.063951 [debug] [ThreadPool]: On create_my_duckdb_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "create_my_duckdb_database_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='my_duckdb_database'
        and type='sqlite'
    
  
[0m07:48:02.076817 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:48:02.172702 [debug] [ThreadPool]: SQL status: OK in 0.096 seconds
[0m07:48:02.182333 [debug] [ThreadPool]: Using duckdb connection "create_my_duckdb_database_main"
[0m07:48:02.185117 [debug] [ThreadPool]: On create_my_duckdb_database_main: BEGIN
[0m07:48:02.189092 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m07:48:02.191248 [debug] [ThreadPool]: Using duckdb connection "create_my_duckdb_database_main"
[0m07:48:02.194534 [debug] [ThreadPool]: On create_my_duckdb_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "create_my_duckdb_database_main"} */

    
    
        create schema if not exists "my_duckdb_database"."main"
    
[0m07:48:02.208863 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m07:48:02.222266 [debug] [ThreadPool]: On create_my_duckdb_database_main: COMMIT
[0m07:48:02.225689 [debug] [ThreadPool]: Using duckdb connection "create_my_duckdb_database_main"
[0m07:48:02.239038 [debug] [ThreadPool]: On create_my_duckdb_database_main: COMMIT
[0m07:48:02.242939 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m07:48:02.254406 [debug] [ThreadPool]: On create_my_duckdb_database_main: Close
[0m07:48:02.266342 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_my_duckdb_database_main'
[0m07:48:02.296503 [debug] [ThreadPool]: Using duckdb connection "list_my_duckdb_database_main"
[0m07:48:02.299209 [debug] [ThreadPool]: On list_my_duckdb_database_main: BEGIN
[0m07:48:02.303039 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:48:02.336520 [debug] [ThreadPool]: SQL status: OK in 0.033 seconds
[0m07:48:02.338184 [debug] [ThreadPool]: Using duckdb connection "list_my_duckdb_database_main"
[0m07:48:02.340068 [debug] [ThreadPool]: On list_my_duckdb_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "list_my_duckdb_database_main"} */
select
      'my_duckdb_database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'my_duckdb_database'
  
[0m07:48:02.540601 [debug] [ThreadPool]: SQL status: OK in 0.198 seconds
[0m07:48:02.545083 [debug] [ThreadPool]: On list_my_duckdb_database_main: ROLLBACK
[0m07:48:02.552751 [debug] [ThreadPool]: Failed to rollback 'list_my_duckdb_database_main'
[0m07:48:02.554626 [debug] [ThreadPool]: On list_my_duckdb_database_main: Close
[0m07:48:02.570163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7a39b13a-03ee-4958-8ebe-554ad6fccbf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff39302d8b0>]}
[0m07:48:02.572378 [debug] [MainThread]: Using duckdb connection "master"
[0m07:48:02.574632 [debug] [MainThread]: On master: BEGIN
[0m07:48:02.576499 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:48:02.612503 [debug] [MainThread]: SQL status: OK in 0.036 seconds
[0m07:48:02.616909 [debug] [MainThread]: On master: COMMIT
[0m07:48:02.619618 [debug] [MainThread]: Using duckdb connection "master"
[0m07:48:02.621562 [debug] [MainThread]: On master: COMMIT
[0m07:48:02.625634 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m07:48:02.627303 [debug] [MainThread]: On master: Close
[0m07:48:02.652657 [debug] [Thread-1 (]: Began running node model.my_dbt_project.transform_users
[0m07:48:02.655517 [info ] [Thread-1 (]: 1 of 2 START sql table model main.transform_users .............................. [RUN]
[0m07:48:02.666140 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.my_dbt_project.transform_users'
[0m07:48:02.670250 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.transform_users
[0m07:48:02.700720 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.transform_users"
[0m07:48:02.722139 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.transform_users
[0m07:48:02.858430 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.transform_users"
[0m07:48:02.897186 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users"
[0m07:48:02.902999 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users: BEGIN
[0m07:48:02.907986 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m07:48:03.069041 [debug] [Thread-1 (]: SQL status: OK in 0.161 seconds
[0m07:48:03.072142 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users"
[0m07:48:03.075885 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_users"} */

  
    
    

    create  table
      "my_duckdb_database"."main"."transform_users__dbt_tmp"
  
    as (
      -- /opt/airflow/dags/dbt_models/transform_users.sql


WITH users AS (
    SELECT * FROM "my_duckdb_database"."main"."users"
)

SELECT
    id,
    name,
    username,
    email,
    address_street,
    address_suite,
    address_city,
    address_zipcode,
    phone,
    website,
    company_name
FROM users
WHERE address_city = 'Gwenborough'
    );
  
  
[0m07:48:03.107661 [debug] [Thread-1 (]: SQL status: OK in 0.026 seconds
[0m07:48:03.129291 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users"
[0m07:48:03.132507 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_users"} */
alter table "my_duckdb_database"."main"."transform_users" rename to "transform_users__dbt_backup"
[0m07:48:03.136993 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m07:48:03.152619 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users"
[0m07:48:03.156418 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_users"} */
alter table "my_duckdb_database"."main"."transform_users__dbt_tmp" rename to "transform_users"
[0m07:48:03.160882 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:48:03.223130 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users: COMMIT
[0m07:48:03.226378 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users"
[0m07:48:03.228529 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users: COMMIT
[0m07:48:03.240847 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m07:48:03.261705 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users"
[0m07:48:03.267065 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_users"} */
drop table if exists "my_duckdb_database"."main"."transform_users__dbt_backup" cascade
[0m07:48:03.283912 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m07:48:03.292917 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users: Close
[0m07:48:03.405844 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a39b13a-03ee-4958-8ebe-554ad6fccbf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3952dbd40>]}
[0m07:48:03.410472 [info ] [Thread-1 (]: 1 of 2 OK created sql table model main.transform_users ......................... [[32mOK[0m in 0.74s]
[0m07:48:03.416930 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.transform_users
[0m07:48:03.422850 [debug] [Thread-1 (]: Began running node model.my_dbt_project.transform_users2
[0m07:48:03.430916 [info ] [Thread-1 (]: 2 of 2 START sql table model main.transform_users2 ............................. [RUN]
[0m07:48:03.435866 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.transform_users, now model.my_dbt_project.transform_users2)
[0m07:48:03.439053 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.transform_users2
[0m07:48:03.457701 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.transform_users2"
[0m07:48:03.493983 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.transform_users2
[0m07:48:03.509008 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.transform_users2"
[0m07:48:03.544226 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users2"
[0m07:48:03.546454 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users2: BEGIN
[0m07:48:03.548709 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:48:03.621184 [debug] [Thread-1 (]: SQL status: OK in 0.072 seconds
[0m07:48:03.623073 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users2"
[0m07:48:03.624974 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users2: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_users2"} */

  
    
    

    create  table
      "my_duckdb_database"."main"."transform_users2__dbt_tmp"
  
    as (
      -- /opt/airflow/dags/dbt_models/transform_users.sql


WITH users AS (
    SELECT * FROM "my_duckdb_database"."main"."users"
)

SELECT
    id,
    name,
    username,
    email,
    address_street,
    address_suite,
    address_city,
    address_zipcode,
    phone,
    website,
    company_name
FROM users
WHERE address_city = 'Wisokyburgh'
    );
  
  
[0m07:48:03.640466 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m07:48:03.655713 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users2"
[0m07:48:03.658583 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users2: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_users2"} */
alter table "my_duckdb_database"."main"."transform_users2" rename to "transform_users2__dbt_backup"
[0m07:48:03.661309 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:48:03.672735 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users2"
[0m07:48:03.674970 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users2: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_users2"} */
alter table "my_duckdb_database"."main"."transform_users2__dbt_tmp" rename to "transform_users2"
[0m07:48:03.679347 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:48:03.691076 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users2: COMMIT
[0m07:48:03.694131 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users2"
[0m07:48:03.701335 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users2: COMMIT
[0m07:48:03.720121 [debug] [Thread-1 (]: SQL status: OK in 0.015 seconds
[0m07:48:03.731720 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users2"
[0m07:48:03.736566 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users2: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_users2"} */
drop table if exists "my_duckdb_database"."main"."transform_users2__dbt_backup" cascade
[0m07:48:03.742487 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m07:48:03.749736 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users2: Close
[0m07:48:03.833668 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a39b13a-03ee-4958-8ebe-554ad6fccbf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff38c6aca10>]}
[0m07:48:03.837405 [info ] [Thread-1 (]: 2 of 2 OK created sql table model main.transform_users2 ........................ [[32mOK[0m in 0.40s]
[0m07:48:03.846273 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.transform_users2
[0m07:48:03.860107 [debug] [MainThread]: Using duckdb connection "master"
[0m07:48:03.862374 [debug] [MainThread]: On master: BEGIN
[0m07:48:03.866364 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:48:03.928738 [debug] [MainThread]: SQL status: OK in 0.062 seconds
[0m07:48:03.937022 [debug] [MainThread]: On master: COMMIT
[0m07:48:03.948441 [debug] [MainThread]: Using duckdb connection "master"
[0m07:48:03.950434 [debug] [MainThread]: On master: COMMIT
[0m07:48:03.955263 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m07:48:03.957914 [debug] [MainThread]: On master: Close
[0m07:48:03.971470 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:48:03.975290 [debug] [MainThread]: Connection 'create_my_duckdb_database_main' was properly closed.
[0m07:48:03.982576 [debug] [MainThread]: Connection 'list_my_duckdb_database_main' was properly closed.
[0m07:48:03.984226 [debug] [MainThread]: Connection 'model.my_dbt_project.transform_users2' was properly closed.
[0m07:48:03.986973 [info ] [MainThread]: 
[0m07:48:03.989601 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 2.51 seconds (2.51s).
[0m07:48:03.993005 [debug] [MainThread]: Command end result
[0m07:48:04.179334 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m07:48:04.199119 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m07:48:04.250233 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dags/dbt_models/target/run_results.json
[0m07:48:04.252124 [info ] [MainThread]: 
[0m07:48:04.255438 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:48:04.260991 [info ] [MainThread]: 
[0m07:48:04.266520 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m07:48:04.270532 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 31.494835, "process_in_blocks": "2255576", "process_kernel_time": 8.080228, "process_mem_max_rss": "131488", "process_out_blocks": "0", "process_user_time": 12.254846}
[0m07:48:04.272835 [debug] [MainThread]: Command `dbt run` succeeded at 07:48:04.272460 after 31.50 seconds
[0m07:48:04.274482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff393d84d40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff393e6be90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff38d2e78c0>]}
[0m07:48:04.283258 [debug] [MainThread]: Flushing usage events
[0m07:48:05.766679 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:53:05.272507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14238f8f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14218d6c30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f142199c770>]}


============================== 07:53:05.351552 | e7753ba9-211f-43b5-b0f6-ad0fd4a9ac5b ==============================
[0m07:53:05.351552 [info ] [MainThread]: Running with dbt=1.9.1
[0m07:53:05.371176 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/profiles.yml', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dags/dbt_models/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt/profiles.yml --target dev', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m07:53:07.825736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e7753ba9-211f-43b5-b0f6-ad0fd4a9ac5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1422167ef0>]}
[0m07:53:08.130051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e7753ba9-211f-43b5-b0f6-ad0fd4a9ac5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f142117dc40>]}
[0m07:53:08.239818 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m07:53:09.604368 [debug] [MainThread]: checksum: cac3b9519010e47bfbeb71ca6efb4867dae2858687671594dc23fefc94ecf25d, vars: {}, profile: , target: dev, version: 1.9.1
[0m07:53:10.547777 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:53:10.559743 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:53:10.739065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e7753ba9-211f-43b5-b0f6-ad0fd4a9ac5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f141b75d220>]}
[0m07:53:11.132494 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m07:53:11.162788 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m07:53:11.406112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e7753ba9-211f-43b5-b0f6-ad0fd4a9ac5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f141b5e4d10>]}
[0m07:53:11.430832 [info ] [MainThread]: Found 2 models, 1 source, 424 macros
[0m07:53:11.432969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e7753ba9-211f-43b5-b0f6-ad0fd4a9ac5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f141b7032f0>]}
[0m07:53:11.445213 [info ] [MainThread]: 
[0m07:53:11.448256 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:53:11.450630 [info ] [MainThread]: 
[0m07:53:11.457521 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m07:53:11.493652 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_my_duckdb_database'
[0m07:53:11.994025 [debug] [ThreadPool]: Using duckdb connection "list_my_duckdb_database"
[0m07:53:12.098671 [debug] [ThreadPool]: On list_my_duckdb_database: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "list_my_duckdb_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"my_duckdb_database"'
    
  
  
[0m07:53:12.122113 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:53:53.200958 [debug] [ThreadPool]: SQL status: OK in 41.051 seconds
[0m07:53:53.231457 [debug] [ThreadPool]: On list_my_duckdb_database: Close
[0m07:53:53.316340 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_duckdb_database, now create_my_duckdb_database_main)
[0m07:53:53.320542 [debug] [ThreadPool]: Creating schema "database: "my_duckdb_database"
schema: "main"
"
[0m07:53:53.392465 [debug] [ThreadPool]: Using duckdb connection "create_my_duckdb_database_main"
[0m07:53:53.400897 [debug] [ThreadPool]: On create_my_duckdb_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "create_my_duckdb_database_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='my_duckdb_database'
        and type='sqlite'
    
  
[0m07:53:53.409438 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:53:53.544144 [debug] [ThreadPool]: SQL status: OK in 0.135 seconds
[0m07:53:53.553003 [debug] [ThreadPool]: Using duckdb connection "create_my_duckdb_database_main"
[0m07:53:53.555630 [debug] [ThreadPool]: On create_my_duckdb_database_main: BEGIN
[0m07:53:53.562261 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m07:53:53.565148 [debug] [ThreadPool]: Using duckdb connection "create_my_duckdb_database_main"
[0m07:53:53.567437 [debug] [ThreadPool]: On create_my_duckdb_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "create_my_duckdb_database_main"} */

    
    
        create schema if not exists "my_duckdb_database"."main"
    
[0m07:53:53.571361 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m07:53:53.575276 [debug] [ThreadPool]: On create_my_duckdb_database_main: COMMIT
[0m07:53:53.577233 [debug] [ThreadPool]: Using duckdb connection "create_my_duckdb_database_main"
[0m07:53:53.579231 [debug] [ThreadPool]: On create_my_duckdb_database_main: COMMIT
[0m07:53:53.582415 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m07:53:53.584582 [debug] [ThreadPool]: On create_my_duckdb_database_main: Close
[0m07:53:53.599603 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_my_duckdb_database_main, now list_my_duckdb_database_main)
[0m07:53:53.621222 [debug] [ThreadPool]: Using duckdb connection "list_my_duckdb_database_main"
[0m07:53:53.622426 [debug] [ThreadPool]: On list_my_duckdb_database_main: BEGIN
[0m07:53:53.623648 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:53:53.644393 [debug] [ThreadPool]: SQL status: OK in 0.021 seconds
[0m07:53:53.647363 [debug] [ThreadPool]: Using duckdb connection "list_my_duckdb_database_main"
[0m07:53:53.648967 [debug] [ThreadPool]: On list_my_duckdb_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "list_my_duckdb_database_main"} */
select
      'my_duckdb_database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'my_duckdb_database'
  
[0m07:53:53.840726 [debug] [ThreadPool]: SQL status: OK in 0.191 seconds
[0m07:53:53.844774 [debug] [ThreadPool]: On list_my_duckdb_database_main: ROLLBACK
[0m07:53:53.906142 [debug] [ThreadPool]: Failed to rollback 'list_my_duckdb_database_main'
[0m07:53:53.907746 [debug] [ThreadPool]: On list_my_duckdb_database_main: Close
[0m07:53:53.917166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e7753ba9-211f-43b5-b0f6-ad0fd4a9ac5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f141bb51cd0>]}
[0m07:53:53.919349 [debug] [MainThread]: Using duckdb connection "master"
[0m07:53:53.921056 [debug] [MainThread]: On master: BEGIN
[0m07:53:53.922698 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:53:53.943934 [debug] [MainThread]: SQL status: OK in 0.021 seconds
[0m07:53:53.945305 [debug] [MainThread]: On master: COMMIT
[0m07:53:53.947246 [debug] [MainThread]: Using duckdb connection "master"
[0m07:53:53.948497 [debug] [MainThread]: On master: COMMIT
[0m07:53:53.950103 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m07:53:53.951225 [debug] [MainThread]: On master: Close
[0m07:53:53.968712 [debug] [Thread-1 (]: Began running node model.my_dbt_project.transform_users
[0m07:53:53.985811 [info ] [Thread-1 (]: 1 of 2 START sql table model main.transform_users .............................. [RUN]
[0m07:53:53.992616 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.my_dbt_project.transform_users'
[0m07:53:53.998944 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.transform_users
[0m07:53:54.030382 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.transform_users"
[0m07:53:54.045230 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.transform_users
[0m07:53:54.280649 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.transform_users"
[0m07:53:54.311269 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users"
[0m07:53:54.314926 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users: BEGIN
[0m07:53:54.317022 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m07:53:54.430660 [debug] [Thread-1 (]: SQL status: OK in 0.113 seconds
[0m07:53:54.433606 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users"
[0m07:53:54.435953 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_users"} */

  
    
    

    create  table
      "my_duckdb_database"."main"."transform_users__dbt_tmp"
  
    as (
      -- /opt/airflow/dags/dbt_models/transform_users.sql


WITH users AS (
    SELECT * FROM "my_duckdb_database"."main"."users"
)

SELECT
    id,
    name,
    username,
    email,
    address_street,
    address_suite,
    address_city,
    address_zipcode,
    phone,
    website,
    company_name
FROM users
WHERE address_city = 'Gwenborough'
    );
  
  
[0m07:53:54.544000 [debug] [Thread-1 (]: SQL status: OK in 0.105 seconds
[0m07:53:54.602821 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users"
[0m07:53:54.615737 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_users"} */
alter table "my_duckdb_database"."main"."transform_users" rename to "transform_users__dbt_backup"
[0m07:53:54.636804 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m07:53:54.674821 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users"
[0m07:53:54.678964 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_users"} */
alter table "my_duckdb_database"."main"."transform_users__dbt_tmp" rename to "transform_users"
[0m07:53:54.693690 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m07:53:54.911953 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users: COMMIT
[0m07:53:54.932492 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users"
[0m07:53:54.949245 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users: COMMIT
[0m07:53:55.094496 [debug] [Thread-1 (]: SQL status: OK in 0.117 seconds
[0m07:53:55.257976 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users"
[0m07:53:55.273702 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_users"} */
drop table if exists "my_duckdb_database"."main"."transform_users__dbt_backup" cascade
[0m07:53:55.388091 [debug] [Thread-1 (]: SQL status: OK in 0.107 seconds
[0m07:53:55.479247 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users: Close
[0m07:53:55.833568 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7753ba9-211f-43b5-b0f6-ad0fd4a9ac5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1421f906b0>]}
[0m07:53:55.847209 [info ] [Thread-1 (]: 1 of 2 OK created sql table model main.transform_users ......................... [[32mOK[0m in 1.81s]
[0m07:53:55.867565 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.transform_users
[0m07:53:55.872176 [debug] [Thread-1 (]: Began running node model.my_dbt_project.transform_users2
[0m07:53:55.875088 [info ] [Thread-1 (]: 2 of 2 START sql table model main.transform_users2 ............................. [RUN]
[0m07:53:55.889900 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.transform_users, now model.my_dbt_project.transform_users2)
[0m07:53:55.903160 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.transform_users2
[0m07:53:55.925433 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.transform_users2"
[0m07:53:56.183798 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.transform_users2
[0m07:53:56.213764 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.transform_users2"
[0m07:53:56.270053 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users2"
[0m07:53:56.283712 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users2: BEGIN
[0m07:53:56.306011 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:53:56.454739 [debug] [Thread-1 (]: SQL status: OK in 0.149 seconds
[0m07:53:56.472158 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users2"
[0m07:53:56.522518 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users2: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_users2"} */

  
    
    

    create  table
      "my_duckdb_database"."main"."transform_users2__dbt_tmp"
  
    as (
      -- /opt/airflow/dags/dbt_models/transform_users.sql


WITH users AS (
    SELECT * FROM "my_duckdb_database"."main"."users"
)

SELECT
    id,
    name,
    username,
    email,
    address_street,
    address_suite,
    address_city,
    address_zipcode,
    phone,
    website,
    company_name
FROM users
WHERE address_city = 'Wisokyburgh'
    );
  
  
[0m07:53:56.602473 [debug] [Thread-1 (]: SQL status: OK in 0.062 seconds
[0m07:53:56.734304 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users2"
[0m07:53:56.750435 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users2: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_users2"} */
alter table "my_duckdb_database"."main"."transform_users2" rename to "transform_users2__dbt_backup"
[0m07:53:56.782715 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m07:53:56.857264 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users2"
[0m07:53:56.876858 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users2: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_users2"} */
alter table "my_duckdb_database"."main"."transform_users2__dbt_tmp" rename to "transform_users2"
[0m07:53:56.907542 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m07:53:56.991526 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users2: COMMIT
[0m07:53:57.006865 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users2"
[0m07:53:57.010610 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users2: COMMIT
[0m07:53:57.111203 [debug] [Thread-1 (]: SQL status: OK in 0.086 seconds
[0m07:53:57.234359 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users2"
[0m07:53:57.237221 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users2: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_users2"} */
drop table if exists "my_duckdb_database"."main"."transform_users2__dbt_backup" cascade
[0m07:53:57.270685 [debug] [Thread-1 (]: SQL status: OK in 0.016 seconds
[0m07:53:57.310961 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users2: Close
[0m07:53:57.512196 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7753ba9-211f-43b5-b0f6-ad0fd4a9ac5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f141a9b0ef0>]}
[0m07:53:57.516626 [info ] [Thread-1 (]: 2 of 2 OK created sql table model main.transform_users2 ........................ [[32mOK[0m in 1.62s]
[0m07:53:57.523204 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.transform_users2
[0m07:53:57.554645 [debug] [MainThread]: Using duckdb connection "master"
[0m07:53:57.560843 [debug] [MainThread]: On master: BEGIN
[0m07:53:57.568591 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:53:57.893499 [debug] [MainThread]: SQL status: OK in 0.325 seconds
[0m07:53:57.896570 [debug] [MainThread]: On master: COMMIT
[0m07:53:57.909116 [debug] [MainThread]: Using duckdb connection "master"
[0m07:53:57.911215 [debug] [MainThread]: On master: COMMIT
[0m07:53:57.924877 [debug] [MainThread]: SQL status: OK in 0.006 seconds
[0m07:53:57.926945 [debug] [MainThread]: On master: Close
[0m07:53:57.954610 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:53:57.956793 [debug] [MainThread]: Connection 'list_my_duckdb_database_main' was properly closed.
[0m07:53:57.969318 [debug] [MainThread]: Connection 'model.my_dbt_project.transform_users2' was properly closed.
[0m07:53:57.972336 [info ] [MainThread]: 
[0m07:53:57.986540 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 46.52 seconds (46.52s).
[0m07:53:57.991810 [debug] [MainThread]: Command end result
[0m07:53:58.289833 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m07:53:58.328871 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m07:53:58.411038 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dags/dbt_models/target/run_results.json
[0m07:53:58.422379 [info ] [MainThread]: 
[0m07:53:58.424711 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:53:58.427138 [info ] [MainThread]: 
[0m07:53:58.431373 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m07:53:58.445111 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 54.11213, "process_in_blocks": "2699800", "process_kernel_time": 6.973001, "process_mem_max_rss": "129536", "process_out_blocks": "0", "process_user_time": 9.679237}
[0m07:53:58.460325 [debug] [MainThread]: Command `dbt run` succeeded at 07:53:58.457808 after 54.13 seconds
[0m07:53:58.475036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1422136c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14211ec350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1423226fc0>]}
[0m07:53:58.479684 [debug] [MainThread]: Flushing usage events
[0m07:54:00.176385 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:58:33.039204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f0a8d57c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f0a8d4620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f0a8d6720>]}


============================== 07:58:33.095979 | fa74cfe5-8eda-4de4-be4d-b7373a92f68f ==============================
[0m07:58:33.095979 [info ] [MainThread]: Running with dbt=1.9.1
[0m07:58:33.126433 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/profiles.yml', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dags/dbt_models/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt/profiles.yml --target dev', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:58:35.855961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fa74cfe5-8eda-4de4-be4d-b7373a92f68f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f0496baa0>]}
[0m07:58:36.106353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fa74cfe5-8eda-4de4-be4d-b7373a92f68f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f0a91cf80>]}
[0m07:58:36.194108 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m07:58:37.453382 [debug] [MainThread]: checksum: cac3b9519010e47bfbeb71ca6efb4867dae2858687671594dc23fefc94ecf25d, vars: {}, profile: , target: dev, version: 1.9.1
[0m07:58:39.136883 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:58:39.149067 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:58:39.343516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fa74cfe5-8eda-4de4-be4d-b7373a92f68f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f04559250>]}
[0m07:58:40.071335 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m07:58:40.217359 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m07:58:40.782046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fa74cfe5-8eda-4de4-be4d-b7373a92f68f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f0a0e0320>]}
[0m07:58:40.805340 [info ] [MainThread]: Found 2 models, 1 source, 424 macros
[0m07:58:40.817615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fa74cfe5-8eda-4de4-be4d-b7373a92f68f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f0a6e0620>]}
[0m07:58:40.903538 [info ] [MainThread]: 
[0m07:58:40.926066 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:58:40.935902 [info ] [MainThread]: 
[0m07:58:40.943744 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m07:58:41.234010 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_my_duckdb_database'
[0m07:58:42.706575 [debug] [ThreadPool]: Using duckdb connection "list_my_duckdb_database"
[0m07:58:42.770151 [debug] [ThreadPool]: On list_my_duckdb_database: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "list_my_duckdb_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"my_duckdb_database"'
    
  
  
[0m07:58:42.775208 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:59:50.365331 [debug] [ThreadPool]: SQL status: OK in 67.628 seconds
[0m07:59:50.381369 [debug] [ThreadPool]: On list_my_duckdb_database: Close
[0m07:59:50.411646 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_duckdb_database, now create_my_duckdb_database_main)
[0m07:59:50.425979 [debug] [ThreadPool]: Creating schema "database: "my_duckdb_database"
schema: "main"
"
[0m07:59:50.514746 [debug] [ThreadPool]: Using duckdb connection "create_my_duckdb_database_main"
[0m07:59:50.519818 [debug] [ThreadPool]: On create_my_duckdb_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "create_my_duckdb_database_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='my_duckdb_database'
        and type='sqlite'
    
  
[0m07:59:50.534528 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:59:50.622504 [debug] [ThreadPool]: SQL status: OK in 0.088 seconds
[0m07:59:50.628408 [debug] [ThreadPool]: Using duckdb connection "create_my_duckdb_database_main"
[0m07:59:50.630010 [debug] [ThreadPool]: On create_my_duckdb_database_main: BEGIN
[0m07:59:50.632598 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m07:59:50.634284 [debug] [ThreadPool]: Using duckdb connection "create_my_duckdb_database_main"
[0m07:59:50.639405 [debug] [ThreadPool]: On create_my_duckdb_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "create_my_duckdb_database_main"} */

    
    
        create schema if not exists "my_duckdb_database"."main"
    
[0m07:59:50.643950 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m07:59:50.647451 [debug] [ThreadPool]: On create_my_duckdb_database_main: COMMIT
[0m07:59:50.649185 [debug] [ThreadPool]: Using duckdb connection "create_my_duckdb_database_main"
[0m07:59:50.653212 [debug] [ThreadPool]: On create_my_duckdb_database_main: COMMIT
[0m07:59:50.656404 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m07:59:50.658453 [debug] [ThreadPool]: On create_my_duckdb_database_main: Close
[0m07:59:50.667045 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_my_duckdb_database_main, now list_my_duckdb_database_main)
[0m07:59:50.688486 [debug] [ThreadPool]: Using duckdb connection "list_my_duckdb_database_main"
[0m07:59:50.692595 [debug] [ThreadPool]: On list_my_duckdb_database_main: BEGIN
[0m07:59:50.698486 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:59:50.752254 [debug] [ThreadPool]: SQL status: OK in 0.054 seconds
[0m07:59:50.754235 [debug] [ThreadPool]: Using duckdb connection "list_my_duckdb_database_main"
[0m07:59:50.756482 [debug] [ThreadPool]: On list_my_duckdb_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "list_my_duckdb_database_main"} */
select
      'my_duckdb_database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'my_duckdb_database'
  
[0m07:59:50.968819 [debug] [ThreadPool]: SQL status: OK in 0.210 seconds
[0m07:59:50.979244 [debug] [ThreadPool]: On list_my_duckdb_database_main: ROLLBACK
[0m07:59:51.002750 [debug] [ThreadPool]: Failed to rollback 'list_my_duckdb_database_main'
[0m07:59:51.009865 [debug] [ThreadPool]: On list_my_duckdb_database_main: Close
[0m07:59:51.022876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fa74cfe5-8eda-4de4-be4d-b7373a92f68f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f0a0b5130>]}
[0m07:59:51.026163 [debug] [MainThread]: Using duckdb connection "master"
[0m07:59:51.027934 [debug] [MainThread]: On master: BEGIN
[0m07:59:51.029624 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:59:51.076299 [debug] [MainThread]: SQL status: OK in 0.046 seconds
[0m07:59:51.078530 [debug] [MainThread]: On master: COMMIT
[0m07:59:51.081050 [debug] [MainThread]: Using duckdb connection "master"
[0m07:59:51.085351 [debug] [MainThread]: On master: COMMIT
[0m07:59:51.097424 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m07:59:51.117867 [debug] [MainThread]: On master: Close
[0m07:59:51.136048 [debug] [Thread-1 (]: Began running node model.my_dbt_project.transform_users
[0m07:59:51.153474 [info ] [Thread-1 (]: 1 of 2 START sql table model main.transform_users .............................. [RUN]
[0m07:59:51.184912 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.my_dbt_project.transform_users'
[0m07:59:51.189123 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.transform_users
[0m07:59:51.260888 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.transform_users"
[0m07:59:51.354976 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.transform_users
[0m07:59:51.579254 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.transform_users"
[0m07:59:51.610706 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users"
[0m07:59:51.618287 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users: BEGIN
[0m07:59:51.625163 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m07:59:51.686961 [debug] [Thread-1 (]: SQL status: OK in 0.063 seconds
[0m07:59:51.693833 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users"
[0m07:59:51.698930 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_users"} */

  
    
    

    create  table
      "my_duckdb_database"."main"."transform_users__dbt_tmp"
  
    as (
      -- /opt/airflow/dags/dbt_models/transform_users.sql


WITH users AS (
    SELECT * FROM "my_duckdb_database"."main"."users"
)

SELECT
    id,
    name,
    username,
    email,
    address_street,
    address_suite,
    address_city,
    address_zipcode,
    phone,
    website,
    company_name
FROM users
WHERE address_city = 'Gwenborough'
    );
  
  
[0m07:59:51.719531 [debug] [Thread-1 (]: SQL status: OK in 0.018 seconds
[0m07:59:51.767641 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users"
[0m07:59:51.773554 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_users"} */
alter table "my_duckdb_database"."main"."transform_users" rename to "transform_users__dbt_backup"
[0m07:59:51.776851 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:59:51.812999 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users"
[0m07:59:51.827573 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_users"} */
alter table "my_duckdb_database"."main"."transform_users__dbt_tmp" rename to "transform_users"
[0m07:59:51.832609 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:59:51.963027 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users: COMMIT
[0m07:59:51.973146 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users"
[0m07:59:51.975249 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users: COMMIT
[0m07:59:52.007833 [debug] [Thread-1 (]: SQL status: OK in 0.031 seconds
[0m07:59:52.034205 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users"
[0m07:59:52.038464 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_users"} */
drop table if exists "my_duckdb_database"."main"."transform_users__dbt_backup" cascade
[0m07:59:52.051629 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m07:59:52.064511 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users: Close
[0m07:59:52.192355 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fa74cfe5-8eda-4de4-be4d-b7373a92f68f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f0ae50770>]}
[0m07:59:52.199417 [info ] [Thread-1 (]: 1 of 2 OK created sql table model main.transform_users ......................... [[32mOK[0m in 1.00s]
[0m07:59:52.216601 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.transform_users
[0m07:59:52.219351 [debug] [Thread-1 (]: Began running node model.my_dbt_project.transform_users2
[0m07:59:52.224282 [info ] [Thread-1 (]: 2 of 2 START sql table model main.transform_users2 ............................. [RUN]
[0m07:59:52.229256 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.transform_users, now model.my_dbt_project.transform_users2)
[0m07:59:52.231105 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.transform_users2
[0m07:59:52.241360 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.transform_users2"
[0m07:59:52.260047 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.transform_users2
[0m07:59:52.274022 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.transform_users2"
[0m07:59:52.301067 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users2"
[0m07:59:52.305345 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users2: BEGIN
[0m07:59:52.308033 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:59:52.370852 [debug] [Thread-1 (]: SQL status: OK in 0.063 seconds
[0m07:59:52.372935 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users2"
[0m07:59:52.374990 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users2: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_users2"} */

  
    
    

    create  table
      "my_duckdb_database"."main"."transform_users2__dbt_tmp"
  
    as (
      -- /opt/airflow/dags/dbt_models/transform_users.sql


WITH users AS (
    SELECT * FROM "my_duckdb_database"."main"."users"
)

SELECT
    id,
    name,
    username,
    email,
    address_street,
    address_suite,
    address_city,
    address_zipcode,
    phone,
    website,
    company_name
FROM users
WHERE address_city = 'Wisokyburgh'
    );
  
  
[0m07:59:52.397542 [debug] [Thread-1 (]: SQL status: OK in 0.020 seconds
[0m07:59:52.417127 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users2"
[0m07:59:52.422502 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users2: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_users2"} */
alter table "my_duckdb_database"."main"."transform_users2" rename to "transform_users2__dbt_backup"
[0m07:59:52.426944 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:59:52.445853 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users2"
[0m07:59:52.448097 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users2: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_users2"} */
alter table "my_duckdb_database"."main"."transform_users2__dbt_tmp" rename to "transform_users2"
[0m07:59:52.463142 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:59:52.471133 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users2: COMMIT
[0m07:59:52.476955 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users2"
[0m07:59:52.483910 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users2: COMMIT
[0m07:59:52.522776 [debug] [Thread-1 (]: SQL status: OK in 0.036 seconds
[0m07:59:52.550021 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users2"
[0m07:59:52.568843 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users2: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_users2"} */
drop table if exists "my_duckdb_database"."main"."transform_users2__dbt_backup" cascade
[0m07:59:52.648377 [debug] [Thread-1 (]: SQL status: OK in 0.048 seconds
[0m07:59:52.655047 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users2: Close
[0m07:59:52.762142 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fa74cfe5-8eda-4de4-be4d-b7373a92f68f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ef7765f10>]}
[0m07:59:52.765268 [info ] [Thread-1 (]: 2 of 2 OK created sql table model main.transform_users2 ........................ [[32mOK[0m in 0.53s]
[0m07:59:52.790564 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.transform_users2
[0m07:59:52.805455 [debug] [MainThread]: Using duckdb connection "master"
[0m07:59:52.807172 [debug] [MainThread]: On master: BEGIN
[0m07:59:52.808927 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:59:52.875156 [debug] [MainThread]: SQL status: OK in 0.066 seconds
[0m07:59:52.876916 [debug] [MainThread]: On master: COMMIT
[0m07:59:52.882367 [debug] [MainThread]: Using duckdb connection "master"
[0m07:59:52.884488 [debug] [MainThread]: On master: COMMIT
[0m07:59:52.888360 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m07:59:52.890160 [debug] [MainThread]: On master: Close
[0m07:59:52.902136 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:59:52.904508 [debug] [MainThread]: Connection 'list_my_duckdb_database_main' was properly closed.
[0m07:59:52.906318 [debug] [MainThread]: Connection 'model.my_dbt_project.transform_users2' was properly closed.
[0m07:59:52.908756 [info ] [MainThread]: 
[0m07:59:52.910827 [info ] [MainThread]: Finished running 2 table models in 0 hours 1 minutes and 11.97 seconds (71.97s).
[0m07:59:52.914975 [debug] [MainThread]: Command end result
[0m07:59:53.123254 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m07:59:53.150364 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m07:59:53.211667 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dags/dbt_models/target/run_results.json
[0m07:59:53.213133 [info ] [MainThread]: 
[0m07:59:53.224155 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:59:53.226898 [info ] [MainThread]: 
[0m07:59:53.228879 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m07:59:53.233219 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 80.78946, "process_in_blocks": "3809184", "process_kernel_time": 10.329841, "process_mem_max_rss": "131132", "process_out_blocks": "0", "process_user_time": 11.479786}
[0m07:59:53.240404 [debug] [MainThread]: Command `dbt run` succeeded at 07:59:53.240059 after 80.80 seconds
[0m07:59:53.242164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f0a7c18e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f0a5c8560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f0a6e0620>]}
[0m07:59:53.246177 [debug] [MainThread]: Flushing usage events
[0m07:59:54.547229 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:23:51.870169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40226e0260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4020badd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4020baed50>]}


============================== 08:23:51.896349 | 1af3704d-8033-42e7-af4e-efacc8a5cbc3 ==============================
[0m08:23:51.896349 [info ] [MainThread]: Running with dbt=1.9.1
[0m08:23:51.899814 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/profiles.yml', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dags/dbt_models/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt/profiles.yml --target dev', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:23:52.976591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1af3704d-8033-42e7-af4e-efacc8a5cbc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40203c5c70>]}
[0m08:23:53.321453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1af3704d-8033-42e7-af4e-efacc8a5cbc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f402310ae40>]}
[0m08:23:53.337974 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m08:23:53.612635 [debug] [MainThread]: checksum: cac3b9519010e47bfbeb71ca6efb4867dae2858687671594dc23fefc94ecf25d, vars: {}, profile: , target: dev, version: 1.9.1
[0m08:23:54.038052 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:23:54.039485 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:23:54.152668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1af3704d-8033-42e7-af4e-efacc8a5cbc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40203989b0>]}
[0m08:23:54.390757 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m08:23:54.403060 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m08:23:54.495605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1af3704d-8033-42e7-af4e-efacc8a5cbc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f401a79e330>]}
[0m08:23:54.496825 [info ] [MainThread]: Found 2 models, 1 source, 424 macros
[0m08:23:54.497960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1af3704d-8033-42e7-af4e-efacc8a5cbc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f401a6e76b0>]}
[0m08:23:54.502378 [info ] [MainThread]: 
[0m08:23:54.503658 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:23:54.505226 [info ] [MainThread]: 
[0m08:23:54.506887 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m08:23:54.515270 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_my_duckdb_database'
[0m08:23:54.641910 [debug] [ThreadPool]: Using duckdb connection "list_my_duckdb_database"
[0m08:23:54.643400 [debug] [ThreadPool]: On list_my_duckdb_database: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "list_my_duckdb_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"my_duckdb_database"'
    
  
  
[0m08:23:54.644627 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:23:54.718806 [debug] [ThreadPool]: SQL status: OK in 0.074 seconds
[0m08:23:54.722517 [debug] [ThreadPool]: On list_my_duckdb_database: Close
[0m08:23:54.727965 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_duckdb_database, now create_my_duckdb_database_main)
[0m08:23:54.729875 [debug] [ThreadPool]: Creating schema "database: "my_duckdb_database"
schema: "main"
"
[0m08:23:54.746436 [debug] [ThreadPool]: Using duckdb connection "create_my_duckdb_database_main"
[0m08:23:54.747751 [debug] [ThreadPool]: On create_my_duckdb_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "create_my_duckdb_database_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='my_duckdb_database'
        and type='sqlite'
    
  
[0m08:23:54.748900 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:23:54.771092 [debug] [ThreadPool]: SQL status: OK in 0.022 seconds
[0m08:23:54.774684 [debug] [ThreadPool]: Using duckdb connection "create_my_duckdb_database_main"
[0m08:23:54.776007 [debug] [ThreadPool]: On create_my_duckdb_database_main: BEGIN
[0m08:23:54.777962 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m08:23:54.779212 [debug] [ThreadPool]: Using duckdb connection "create_my_duckdb_database_main"
[0m08:23:54.780462 [debug] [ThreadPool]: On create_my_duckdb_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "create_my_duckdb_database_main"} */

    
    
        create schema if not exists "my_duckdb_database"."main"
    
[0m08:23:54.783131 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m08:23:54.785940 [debug] [ThreadPool]: On create_my_duckdb_database_main: COMMIT
[0m08:23:54.787118 [debug] [ThreadPool]: Using duckdb connection "create_my_duckdb_database_main"
[0m08:23:54.788458 [debug] [ThreadPool]: On create_my_duckdb_database_main: COMMIT
[0m08:23:54.790765 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m08:23:54.791963 [debug] [ThreadPool]: On create_my_duckdb_database_main: Close
[0m08:23:54.797908 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_my_duckdb_database_main, now list_my_duckdb_database_main)
[0m08:23:54.810053 [debug] [ThreadPool]: Using duckdb connection "list_my_duckdb_database_main"
[0m08:23:54.811277 [debug] [ThreadPool]: On list_my_duckdb_database_main: BEGIN
[0m08:23:54.812656 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:23:54.832494 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m08:23:54.835498 [debug] [ThreadPool]: Using duckdb connection "list_my_duckdb_database_main"
[0m08:23:54.836998 [debug] [ThreadPool]: On list_my_duckdb_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "list_my_duckdb_database_main"} */
select
      'my_duckdb_database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'my_duckdb_database'
  
[0m08:23:54.914810 [debug] [ThreadPool]: SQL status: OK in 0.077 seconds
[0m08:23:54.919217 [debug] [ThreadPool]: On list_my_duckdb_database_main: ROLLBACK
[0m08:23:54.924420 [debug] [ThreadPool]: Failed to rollback 'list_my_duckdb_database_main'
[0m08:23:54.925821 [debug] [ThreadPool]: On list_my_duckdb_database_main: Close
[0m08:23:54.932601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1af3704d-8033-42e7-af4e-efacc8a5cbc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f401a6e0650>]}
[0m08:23:54.934798 [debug] [MainThread]: Using duckdb connection "master"
[0m08:23:54.936435 [debug] [MainThread]: On master: BEGIN
[0m08:23:54.937683 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:23:54.957739 [debug] [MainThread]: SQL status: OK in 0.020 seconds
[0m08:23:54.958963 [debug] [MainThread]: On master: COMMIT
[0m08:23:54.960405 [debug] [MainThread]: Using duckdb connection "master"
[0m08:23:54.961595 [debug] [MainThread]: On master: COMMIT
[0m08:23:54.963606 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m08:23:54.964851 [debug] [MainThread]: On master: Close
[0m08:23:54.973708 [debug] [Thread-1 (]: Began running node model.my_dbt_project.transform_users
[0m08:23:54.975829 [info ] [Thread-1 (]: 1 of 2 START sql table model main.transform_users .............................. [RUN]
[0m08:23:54.978407 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.my_dbt_project.transform_users'
[0m08:23:54.979943 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.transform_users
[0m08:23:54.996049 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.transform_users"
[0m08:23:55.012275 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.transform_users
[0m08:23:55.107248 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.transform_users"
[0m08:23:55.123071 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users"
[0m08:23:55.124590 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users: BEGIN
[0m08:23:55.126004 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m08:23:55.149394 [debug] [Thread-1 (]: SQL status: OK in 0.023 seconds
[0m08:23:55.151323 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users"
[0m08:23:55.153168 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_users"} */

  
    
    

    create  table
      "my_duckdb_database"."main"."transform_users__dbt_tmp"
  
    as (
      -- /opt/airflow/dags/dbt_models/transform_users.sql


WITH users AS (
    SELECT * FROM "my_duckdb_database"."main"."users"
)

SELECT
    id,
    name,
    username,
    email,
    address_street,
    address_suite,
    address_city,
    address_zipcode,
    phone,
    website,
    company_name
FROM users
WHERE address_city = 'Gwenborough'
    );
  
  
[0m08:23:55.163926 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m08:23:55.179325 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users"
[0m08:23:55.180977 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_users"} */
alter table "my_duckdb_database"."main"."transform_users" rename to "transform_users__dbt_backup"
[0m08:23:55.183218 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:23:55.193079 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users"
[0m08:23:55.194369 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_users"} */
alter table "my_duckdb_database"."main"."transform_users__dbt_tmp" rename to "transform_users"
[0m08:23:55.196369 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:23:55.231830 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users: COMMIT
[0m08:23:55.233374 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users"
[0m08:23:55.235761 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users: COMMIT
[0m08:23:55.260649 [debug] [Thread-1 (]: SQL status: OK in 0.024 seconds
[0m08:23:55.272143 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users"
[0m08:23:55.273517 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_users"} */
drop table if exists "my_duckdb_database"."main"."transform_users__dbt_backup" cascade
[0m08:23:55.296287 [debug] [Thread-1 (]: SQL status: OK in 0.020 seconds
[0m08:23:55.313729 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users: Close
[0m08:23:55.422643 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1af3704d-8033-42e7-af4e-efacc8a5cbc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40210e8080>]}
[0m08:23:55.424835 [info ] [Thread-1 (]: 1 of 2 OK created sql table model main.transform_users ......................... [[32mOK[0m in 0.44s]
[0m08:23:55.426868 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.transform_users
[0m08:23:55.429077 [debug] [Thread-1 (]: Began running node model.my_dbt_project.transform_users2
[0m08:23:55.431550 [info ] [Thread-1 (]: 2 of 2 START sql table model main.transform_users2 ............................. [RUN]
[0m08:23:55.435806 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.transform_users, now model.my_dbt_project.transform_users2)
[0m08:23:55.437550 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.transform_users2
[0m08:23:55.446045 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.transform_users2"
[0m08:23:55.463064 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.transform_users2
[0m08:23:55.474623 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.transform_users2"
[0m08:23:55.490687 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users2"
[0m08:23:55.492407 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users2: BEGIN
[0m08:23:55.494051 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:23:55.521660 [debug] [Thread-1 (]: SQL status: OK in 0.028 seconds
[0m08:23:55.523394 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users2"
[0m08:23:55.524803 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users2: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_users2"} */

  
    
    

    create  table
      "my_duckdb_database"."main"."transform_users2__dbt_tmp"
  
    as (
      -- /opt/airflow/dags/dbt_models/transform_users.sql


WITH users AS (
    SELECT * FROM "my_duckdb_database"."main"."users"
)

SELECT
    id,
    name,
    username,
    email,
    address_street,
    address_suite,
    address_city,
    address_zipcode,
    phone,
    website,
    company_name
FROM users
WHERE address_city = 'Wisokyburgh'
    );
  
  
[0m08:23:55.532022 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m08:23:55.542886 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users2"
[0m08:23:55.544193 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users2: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_users2"} */
alter table "my_duckdb_database"."main"."transform_users2" rename to "transform_users2__dbt_backup"
[0m08:23:55.546397 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:23:55.556329 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users2"
[0m08:23:55.557914 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users2: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_users2"} */
alter table "my_duckdb_database"."main"."transform_users2__dbt_tmp" rename to "transform_users2"
[0m08:23:55.560880 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:23:55.571640 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users2: COMMIT
[0m08:23:55.573520 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users2"
[0m08:23:55.575542 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users2: COMMIT
[0m08:23:55.604883 [debug] [Thread-1 (]: SQL status: OK in 0.028 seconds
[0m08:23:55.615039 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users2"
[0m08:23:55.616505 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users2: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_users2"} */
drop table if exists "my_duckdb_database"."main"."transform_users2__dbt_backup" cascade
[0m08:23:55.640326 [debug] [Thread-1 (]: SQL status: OK in 0.021 seconds
[0m08:23:55.653831 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users2: Close
[0m08:23:55.927591 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1af3704d-8033-42e7-af4e-efacc8a5cbc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4019ab4ad0>]}
[0m08:23:55.929933 [info ] [Thread-1 (]: 2 of 2 OK created sql table model main.transform_users2 ........................ [[32mOK[0m in 0.49s]
[0m08:23:55.932740 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.transform_users2
[0m08:23:55.941036 [debug] [MainThread]: Using duckdb connection "master"
[0m08:23:55.942703 [debug] [MainThread]: On master: BEGIN
[0m08:23:55.944290 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:23:55.981266 [debug] [MainThread]: SQL status: OK in 0.037 seconds
[0m08:23:55.983398 [debug] [MainThread]: On master: COMMIT
[0m08:23:55.988012 [debug] [MainThread]: Using duckdb connection "master"
[0m08:23:55.989903 [debug] [MainThread]: On master: COMMIT
[0m08:23:55.992006 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m08:23:55.993263 [debug] [MainThread]: On master: Close
[0m08:23:55.997888 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:23:55.999722 [debug] [MainThread]: Connection 'list_my_duckdb_database_main' was properly closed.
[0m08:23:56.002839 [debug] [MainThread]: Connection 'model.my_dbt_project.transform_users2' was properly closed.
[0m08:23:56.004735 [info ] [MainThread]: 
[0m08:23:56.006620 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 1.50 seconds (1.50s).
[0m08:23:56.010003 [debug] [MainThread]: Command end result
[0m08:23:56.115808 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m08:23:56.126537 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m08:23:56.148342 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dags/dbt_models/target/run_results.json
[0m08:23:56.149796 [info ] [MainThread]: 
[0m08:23:56.152489 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:23:56.153878 [info ] [MainThread]: 
[0m08:23:56.155352 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m08:23:56.157966 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.6087246, "process_in_blocks": "126128", "process_kernel_time": 1.239461, "process_mem_max_rss": "151316", "process_out_blocks": "0", "process_user_time": 9.395919}
[0m08:23:56.159424 [debug] [MainThread]: Command `dbt run` succeeded at 08:23:56.159207 after 4.61 seconds
[0m08:23:56.160703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40226e0260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f401992bf80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f401cd462a0>]}
[0m08:23:56.161947 [debug] [MainThread]: Flushing usage events
[0m08:23:57.657919 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:32:58.662657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4179b1a330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4177abc110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41779bb230>]}


============================== 08:32:58.682546 | 436c1df2-4f28-4fb2-b99d-9ad9a22406ac ==============================
[0m08:32:58.682546 [info ] [MainThread]: Running with dbt=1.9.1
[0m08:32:58.684431 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/profiles.yml', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/dags/dbt_models/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt/profiles.yml --target dev', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m08:32:59.546480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '436c1df2-4f28-4fb2-b99d-9ad9a22406ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4177143e60>]}
[0m08:32:59.650585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '436c1df2-4f28-4fb2-b99d-9ad9a22406ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41771942c0>]}
[0m08:32:59.667037 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m08:32:59.971668 [debug] [MainThread]: checksum: cac3b9519010e47bfbeb71ca6efb4867dae2858687671594dc23fefc94ecf25d, vars: {}, profile: , target: dev, version: 1.9.1
[0m08:33:00.396487 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:33:00.397549 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:33:00.462769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '436c1df2-4f28-4fb2-b99d-9ad9a22406ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4173aefd40>]}
[0m08:33:00.635098 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m08:33:00.648699 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m08:33:00.746445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '436c1df2-4f28-4fb2-b99d-9ad9a22406ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4171558b60>]}
[0m08:33:00.747907 [info ] [MainThread]: Found 2 models, 1 source, 424 macros
[0m08:33:00.749149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '436c1df2-4f28-4fb2-b99d-9ad9a22406ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41714e4560>]}
[0m08:33:00.752621 [info ] [MainThread]: 
[0m08:33:00.755039 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:33:00.756303 [info ] [MainThread]: 
[0m08:33:00.757994 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m08:33:00.766050 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_my_duckdb_database'
[0m08:33:00.852281 [debug] [ThreadPool]: Using duckdb connection "list_my_duckdb_database"
[0m08:33:00.854336 [debug] [ThreadPool]: On list_my_duckdb_database: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "list_my_duckdb_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"my_duckdb_database"'
    
  
  
[0m08:33:00.855942 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:33:00.914777 [debug] [ThreadPool]: SQL status: OK in 0.059 seconds
[0m08:33:00.919224 [debug] [ThreadPool]: On list_my_duckdb_database: Close
[0m08:33:00.926279 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_duckdb_database, now create_my_duckdb_database_main)
[0m08:33:00.927935 [debug] [ThreadPool]: Creating schema "database: "my_duckdb_database"
schema: "main"
"
[0m08:33:00.942383 [debug] [ThreadPool]: Using duckdb connection "create_my_duckdb_database_main"
[0m08:33:00.943842 [debug] [ThreadPool]: On create_my_duckdb_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "create_my_duckdb_database_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='my_duckdb_database'
        and type='sqlite'
    
  
[0m08:33:00.945247 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:33:00.972197 [debug] [ThreadPool]: SQL status: OK in 0.027 seconds
[0m08:33:00.975040 [debug] [ThreadPool]: Using duckdb connection "create_my_duckdb_database_main"
[0m08:33:00.976333 [debug] [ThreadPool]: On create_my_duckdb_database_main: BEGIN
[0m08:33:00.978144 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m08:33:00.979434 [debug] [ThreadPool]: Using duckdb connection "create_my_duckdb_database_main"
[0m08:33:00.981005 [debug] [ThreadPool]: On create_my_duckdb_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "create_my_duckdb_database_main"} */

    
    
        create schema if not exists "my_duckdb_database"."main"
    
[0m08:33:00.984275 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m08:33:00.986892 [debug] [ThreadPool]: On create_my_duckdb_database_main: COMMIT
[0m08:33:00.988962 [debug] [ThreadPool]: Using duckdb connection "create_my_duckdb_database_main"
[0m08:33:00.990279 [debug] [ThreadPool]: On create_my_duckdb_database_main: COMMIT
[0m08:33:00.992260 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m08:33:00.993620 [debug] [ThreadPool]: On create_my_duckdb_database_main: Close
[0m08:33:00.999931 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_my_duckdb_database_main, now list_my_duckdb_database_main)
[0m08:33:01.011433 [debug] [ThreadPool]: Using duckdb connection "list_my_duckdb_database_main"
[0m08:33:01.012910 [debug] [ThreadPool]: On list_my_duckdb_database_main: BEGIN
[0m08:33:01.014236 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:33:01.038975 [debug] [ThreadPool]: SQL status: OK in 0.025 seconds
[0m08:33:01.040402 [debug] [ThreadPool]: Using duckdb connection "list_my_duckdb_database_main"
[0m08:33:01.041919 [debug] [ThreadPool]: On list_my_duckdb_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "list_my_duckdb_database_main"} */
select
      'my_duckdb_database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'my_duckdb_database'
  
[0m08:33:01.100969 [debug] [ThreadPool]: SQL status: OK in 0.058 seconds
[0m08:33:01.105399 [debug] [ThreadPool]: On list_my_duckdb_database_main: ROLLBACK
[0m08:33:01.110451 [debug] [ThreadPool]: Failed to rollback 'list_my_duckdb_database_main'
[0m08:33:01.111864 [debug] [ThreadPool]: On list_my_duckdb_database_main: Close
[0m08:33:01.118650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '436c1df2-4f28-4fb2-b99d-9ad9a22406ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41771421b0>]}
[0m08:33:01.120411 [debug] [MainThread]: Using duckdb connection "master"
[0m08:33:01.122419 [debug] [MainThread]: On master: BEGIN
[0m08:33:01.123700 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:33:01.149340 [debug] [MainThread]: SQL status: OK in 0.026 seconds
[0m08:33:01.150715 [debug] [MainThread]: On master: COMMIT
[0m08:33:01.152030 [debug] [MainThread]: Using duckdb connection "master"
[0m08:33:01.153300 [debug] [MainThread]: On master: COMMIT
[0m08:33:01.156152 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m08:33:01.157639 [debug] [MainThread]: On master: Close
[0m08:33:01.165205 [debug] [Thread-1 (]: Began running node model.my_dbt_project.transform_users
[0m08:33:01.166828 [info ] [Thread-1 (]: 1 of 2 START sql table model main.transform_users .............................. [RUN]
[0m08:33:01.168854 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.my_dbt_project.transform_users'
[0m08:33:01.171177 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.transform_users
[0m08:33:01.184689 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.transform_users"
[0m08:33:01.203211 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.transform_users
[0m08:33:01.268205 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.transform_users"
[0m08:33:01.286979 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users"
[0m08:33:01.288972 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users: BEGIN
[0m08:33:01.290420 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m08:33:01.321674 [debug] [Thread-1 (]: SQL status: OK in 0.030 seconds
[0m08:33:01.323731 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users"
[0m08:33:01.325356 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_users"} */

  
    
    

    create  table
      "my_duckdb_database"."main"."transform_users__dbt_tmp"
  
    as (
      -- /opt/airflow/dags/dbt_models/transform_users.sql


WITH users AS (
    SELECT * FROM "my_duckdb_database"."main"."users"
)

SELECT
    id,
    name,
    username,
    email,
    address_street,
    address_suite,
    address_city,
    address_zipcode,
    phone,
    website,
    company_name
FROM users
WHERE address_city = 'Gwenborough'
    );
  
  
[0m08:33:01.345831 [debug] [Thread-1 (]: SQL status: OK in 0.019 seconds
[0m08:33:01.390166 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users"
[0m08:33:01.392107 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_users"} */
alter table "my_duckdb_database"."main"."transform_users__dbt_tmp" rename to "transform_users"
[0m08:33:01.394275 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:33:01.447444 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users: COMMIT
[0m08:33:01.449039 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users"
[0m08:33:01.450376 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users: COMMIT
[0m08:33:01.460025 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m08:33:01.471183 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users"
[0m08:33:01.472979 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_users"} */
drop table if exists "my_duckdb_database"."main"."transform_users__dbt_backup" cascade
[0m08:33:01.474944 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:33:01.479274 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users: Close
[0m08:33:01.517705 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '436c1df2-4f28-4fb2-b99d-9ad9a22406ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f417072ccb0>]}
[0m08:33:01.519352 [info ] [Thread-1 (]: 1 of 2 OK created sql table model main.transform_users ......................... [[32mOK[0m in 0.35s]
[0m08:33:01.522336 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.transform_users
[0m08:33:01.523800 [debug] [Thread-1 (]: Began running node model.my_dbt_project.transform_users2
[0m08:33:01.525271 [info ] [Thread-1 (]: 2 of 2 START sql table model main.transform_users2 ............................. [RUN]
[0m08:33:01.526716 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.transform_users, now model.my_dbt_project.transform_users2)
[0m08:33:01.528143 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.transform_users2
[0m08:33:01.533614 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.transform_users2"
[0m08:33:01.547948 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.transform_users2
[0m08:33:01.557517 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.transform_users2"
[0m08:33:01.573803 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users2"
[0m08:33:01.575376 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users2: BEGIN
[0m08:33:01.576787 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:33:01.599588 [debug] [Thread-1 (]: SQL status: OK in 0.023 seconds
[0m08:33:01.601036 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users2"
[0m08:33:01.602767 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users2: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_users2"} */

  
    
    

    create  table
      "my_duckdb_database"."main"."transform_users2__dbt_tmp"
  
    as (
      -- /opt/airflow/dags/dbt_models/transform_users.sql


WITH users AS (
    SELECT * FROM "my_duckdb_database"."main"."users"
)

SELECT
    id,
    name,
    username,
    email,
    address_street,
    address_suite,
    address_city,
    address_zipcode,
    phone,
    website,
    company_name
FROM users
WHERE address_city = 'Wisokyburgh'
    );
  
  
[0m08:33:01.612134 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m08:33:01.618374 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users2"
[0m08:33:01.619936 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users2: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_users2"} */
alter table "my_duckdb_database"."main"."transform_users2__dbt_tmp" rename to "transform_users2"
[0m08:33:01.622974 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:33:01.626606 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users2: COMMIT
[0m08:33:01.628052 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users2"
[0m08:33:01.629348 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users2: COMMIT
[0m08:33:01.641418 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m08:33:01.649575 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_users2"
[0m08:33:01.651005 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users2: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_users2"} */
drop table if exists "my_duckdb_database"."main"."transform_users2__dbt_backup" cascade
[0m08:33:01.653221 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:33:01.657550 [debug] [Thread-1 (]: On model.my_dbt_project.transform_users2: Close
[0m08:33:01.692250 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '436c1df2-4f28-4fb2-b99d-9ad9a22406ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4170727c50>]}
[0m08:33:01.694182 [info ] [Thread-1 (]: 2 of 2 OK created sql table model main.transform_users2 ........................ [[32mOK[0m in 0.17s]
[0m08:33:01.696452 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.transform_users2
[0m08:33:01.700897 [debug] [MainThread]: Using duckdb connection "master"
[0m08:33:01.702321 [debug] [MainThread]: On master: BEGIN
[0m08:33:01.704634 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:33:01.726156 [debug] [MainThread]: SQL status: OK in 0.022 seconds
[0m08:33:01.727363 [debug] [MainThread]: On master: COMMIT
[0m08:33:01.728750 [debug] [MainThread]: Using duckdb connection "master"
[0m08:33:01.730498 [debug] [MainThread]: On master: COMMIT
[0m08:33:01.732820 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m08:33:01.734059 [debug] [MainThread]: On master: Close
[0m08:33:01.741377 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:33:01.743104 [debug] [MainThread]: Connection 'list_my_duckdb_database_main' was properly closed.
[0m08:33:01.744532 [debug] [MainThread]: Connection 'model.my_dbt_project.transform_users2' was properly closed.
[0m08:33:01.746309 [info ] [MainThread]: 
[0m08:33:01.748206 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.99 seconds (0.99s).
[0m08:33:01.751196 [debug] [MainThread]: Command end result
[0m08:33:01.843730 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m08:33:01.863470 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m08:33:01.896491 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dags/dbt_models/target/run_results.json
[0m08:33:01.897924 [info ] [MainThread]: 
[0m08:33:01.900715 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:33:01.902327 [info ] [MainThread]: 
[0m08:33:01.905455 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m08:33:01.912168 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.504072, "process_in_blocks": "140848", "process_kernel_time": 1.004217, "process_mem_max_rss": "148796", "process_out_blocks": "0", "process_user_time": 7.685745}
[0m08:33:01.915118 [debug] [MainThread]: Command `dbt run` succeeded at 08:33:01.914731 after 3.51 seconds
[0m08:33:01.917323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4177dd8680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4173ada900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4177f05df0>]}
[0m08:33:01.919583 [debug] [MainThread]: Flushing usage events
[0m08:33:03.227697 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:10:21.789631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd75d26c3e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd75b59a6f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd75bd852e0>]}


============================== 14:10:21.812657 | 845771ae-df96-4010-aa1f-fed10e673851 ==============================
[0m14:10:21.812657 [info ] [MainThread]: Running with dbt=1.9.1
[0m14:10:21.815052 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/profiles.yml', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dags/dbt_models/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt/profiles.yml --target dev', 'send_anonymous_usage_stats': 'True'}
[0m14:10:22.862483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '845771ae-df96-4010-aa1f-fed10e673851', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd75b25e3c0>]}
[0m14:10:23.153318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '845771ae-df96-4010-aa1f-fed10e673851', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd75c2aff50>]}
[0m14:10:23.174090 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m14:10:23.696535 [debug] [MainThread]: checksum: cac3b9519010e47bfbeb71ca6efb4867dae2858687671594dc23fefc94ecf25d, vars: {}, profile: , target: dev, version: 1.9.1
[0m14:10:24.051958 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m14:10:24.053805 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m14:10:24.055717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '845771ae-df96-4010-aa1f-fed10e673851', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd75b7e6c30>]}
[0m14:10:26.767297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '845771ae-df96-4010-aa1f-fed10e673851', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7551c6ba0>]}
[0m14:10:27.003311 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m14:10:27.015654 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m14:10:27.307579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '845771ae-df96-4010-aa1f-fed10e673851', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd754700410>]}
[0m14:10:27.310614 [info ] [MainThread]: Found 1 model, 1 source, 424 macros
[0m14:10:27.312287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '845771ae-df96-4010-aa1f-fed10e673851', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7548ec710>]}
[0m14:10:27.315877 [info ] [MainThread]: 
[0m14:10:27.317475 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:10:27.319127 [info ] [MainThread]: 
[0m14:10:27.321054 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:10:27.323862 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_sales_database'
[0m14:10:27.589337 [debug] [ThreadPool]: Using duckdb connection "list_sales_database"
[0m14:10:27.591521 [debug] [ThreadPool]: On list_sales_database: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "list_sales_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"sales_database"'
    
  
  
[0m14:10:27.594297 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:10:27.681308 [debug] [ThreadPool]: SQL status: OK in 0.087 seconds
[0m14:10:27.687693 [debug] [ThreadPool]: On list_sales_database: Close
[0m14:10:27.700821 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_database, now create_sales_database_main)
[0m14:10:27.703220 [debug] [ThreadPool]: Creating schema "database: "sales_database"
schema: "main"
"
[0m14:10:27.738927 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m14:10:27.741527 [debug] [ThreadPool]: On create_sales_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "create_sales_database_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='sales_database'
        and type='sqlite'
    
  
[0m14:10:27.744265 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:10:27.784814 [debug] [ThreadPool]: SQL status: OK in 0.041 seconds
[0m14:10:27.788831 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m14:10:27.790881 [debug] [ThreadPool]: On create_sales_database_main: BEGIN
[0m14:10:27.795071 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:10:27.796562 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m14:10:27.798112 [debug] [ThreadPool]: On create_sales_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "create_sales_database_main"} */

    
    
        create schema if not exists "sales_database"."main"
    
[0m14:10:27.801768 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m14:10:27.804570 [debug] [ThreadPool]: On create_sales_database_main: COMMIT
[0m14:10:27.806075 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m14:10:27.807642 [debug] [ThreadPool]: On create_sales_database_main: COMMIT
[0m14:10:27.812674 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:10:27.814431 [debug] [ThreadPool]: On create_sales_database_main: Close
[0m14:10:27.820711 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_sales_database_main, now list_sales_database_main)
[0m14:10:27.839329 [debug] [ThreadPool]: Using duckdb connection "list_sales_database_main"
[0m14:10:27.841162 [debug] [ThreadPool]: On list_sales_database_main: BEGIN
[0m14:10:27.845006 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:10:27.877930 [debug] [ThreadPool]: SQL status: OK in 0.033 seconds
[0m14:10:27.879285 [debug] [ThreadPool]: Using duckdb connection "list_sales_database_main"
[0m14:10:27.881434 [debug] [ThreadPool]: On list_sales_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "list_sales_database_main"} */
select
      'sales_database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'sales_database'
  
[0m14:10:27.999784 [debug] [ThreadPool]: SQL status: OK in 0.116 seconds
[0m14:10:28.002847 [debug] [ThreadPool]: On list_sales_database_main: ROLLBACK
[0m14:10:28.006327 [debug] [ThreadPool]: Failed to rollback 'list_sales_database_main'
[0m14:10:28.007392 [debug] [ThreadPool]: On list_sales_database_main: Close
[0m14:10:28.013776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '845771ae-df96-4010-aa1f-fed10e673851', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd754703020>]}
[0m14:10:28.015036 [debug] [MainThread]: Using duckdb connection "master"
[0m14:10:28.016031 [debug] [MainThread]: On master: BEGIN
[0m14:10:28.017268 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:10:28.037188 [debug] [MainThread]: SQL status: OK in 0.020 seconds
[0m14:10:28.038280 [debug] [MainThread]: On master: COMMIT
[0m14:10:28.039187 [debug] [MainThread]: Using duckdb connection "master"
[0m14:10:28.040050 [debug] [MainThread]: On master: COMMIT
[0m14:10:28.041410 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:10:28.043248 [debug] [MainThread]: On master: Close
[0m14:10:28.049869 [debug] [Thread-1 (]: Began running node model.my_dbt_project.transform_sales
[0m14:10:28.051246 [info ] [Thread-1 (]: 1 of 1 START sql table model main.transform_sales .............................. [RUN]
[0m14:10:28.052812 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.my_dbt_project.transform_sales'
[0m14:10:28.053836 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.transform_sales
[0m14:10:28.069721 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.transform_sales"
[0m14:10:28.088762 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.transform_sales
[0m14:10:28.220110 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.transform_sales"
[0m14:10:28.247032 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m14:10:28.254382 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: BEGIN
[0m14:10:28.258088 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:10:28.297643 [debug] [Thread-1 (]: SQL status: OK in 0.040 seconds
[0m14:10:28.299119 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m14:10:28.300382 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */

  
    
    

    create  table
      "sales_database"."main"."transform_sales__dbt_tmp"
  
    as (
      -- /opt/airflow/dags/dbt_models/transform_users.sql


WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
   *
FROM users
WHERE name = 'ABC private LTD-0002'
    );
  
  
[0m14:10:28.355261 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */

  
    
    

    create  table
      "sales_database"."main"."transform_sales__dbt_tmp"
  
    as (
      -- /opt/airflow/dags/dbt_models/transform_users.sql


WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
   *
FROM users
WHERE name = 'ABC private LTD-0002'
    );
  
  
[0m14:10:28.356630 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m14:10:28.358065 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: ROLLBACK
[0m14:10:28.374383 [debug] [Thread-1 (]: Failed to rollback 'model.my_dbt_project.transform_sales'
[0m14:10:28.376281 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: Close
[0m14:10:28.388473 [debug] [Thread-1 (]: Runtime Error in model transform_sales (models/transform_sales.sql)
  Catalog Error: Table with name users does not exist!
  Did you mean "sales"?
  LINE 20: FROM users
                ^
[0m14:10:28.393545 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '845771ae-df96-4010-aa1f-fed10e673851', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7553ec170>]}
[0m14:10:28.395373 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model main.transform_sales ..................... [[31mERROR[0m in 0.34s]
[0m14:10:28.397919 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.transform_sales
[0m14:10:28.399653 [debug] [Thread-4 (]: Marking all children of 'model.my_dbt_project.transform_sales' to be skipped because of status 'error'.  Reason: Runtime Error in model transform_sales (models/transform_sales.sql)
  Catalog Error: Table with name users does not exist!
  Did you mean "sales"?
  LINE 20: FROM users
                ^.
[0m14:10:28.404241 [debug] [MainThread]: Using duckdb connection "master"
[0m14:10:28.405503 [debug] [MainThread]: On master: BEGIN
[0m14:10:28.406888 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:10:28.432194 [debug] [MainThread]: SQL status: OK in 0.025 seconds
[0m14:10:28.433459 [debug] [MainThread]: On master: COMMIT
[0m14:10:28.434589 [debug] [MainThread]: Using duckdb connection "master"
[0m14:10:28.435900 [debug] [MainThread]: On master: COMMIT
[0m14:10:28.437755 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m14:10:28.438957 [debug] [MainThread]: On master: Close
[0m14:10:28.445413 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:10:28.447031 [debug] [MainThread]: Connection 'list_sales_database_main' was properly closed.
[0m14:10:28.448093 [debug] [MainThread]: Connection 'model.my_dbt_project.transform_sales' was properly closed.
[0m14:10:28.449256 [info ] [MainThread]: 
[0m14:10:28.450922 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.13 seconds (1.13s).
[0m14:10:28.453459 [debug] [MainThread]: Command end result
[0m14:10:28.553856 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m14:10:28.564235 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m14:10:28.583930 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dags/dbt_models/target/run_results.json
[0m14:10:28.585049 [info ] [MainThread]: 
[0m14:10:28.586772 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:10:28.588553 [info ] [MainThread]: 
[0m14:10:28.590291 [error] [MainThread]:   Runtime Error in model transform_sales (models/transform_sales.sql)
  Catalog Error: Table with name users does not exist!
  Did you mean "sales"?
  LINE 20: FROM users
                ^
[0m14:10:28.594333 [info ] [MainThread]: 
[0m14:10:28.596306 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:10:28.599702 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 7.116448, "process_in_blocks": "137880", "process_kernel_time": 1.058563, "process_mem_max_rss": "149052", "process_out_blocks": "1968", "process_user_time": 11.214785}
[0m14:10:28.601803 [debug] [MainThread]: Command `dbt run` failed at 14:10:28.601475 after 7.12 seconds
[0m14:10:28.603354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7553bfe30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7552f7e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7552f6ab0>]}
[0m14:10:28.604713 [debug] [MainThread]: Flushing usage events
[0m14:10:30.440009 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:13:59.465633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81c5f06d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81c5f07ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81c7cf8740>]}


============================== 14:13:59.525237 | b2e22a5d-cf4d-4c0d-a3d4-21f6122fb374 ==============================
[0m14:13:59.525237 [info ] [MainThread]: Running with dbt=1.9.1
[0m14:13:59.528410 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt/profiles.yml', 'log_path': '/opt/airflow/dags/dbt_models/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt/profiles.yml --target dev', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:14:00.493723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b2e22a5d-cf4d-4c0d-a3d4-21f6122fb374', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81c568e7e0>]}
[0m14:14:00.656879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b2e22a5d-cf4d-4c0d-a3d4-21f6122fb374', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81c64826f0>]}
[0m14:14:00.670381 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m14:14:00.989940 [debug] [MainThread]: checksum: cac3b9519010e47bfbeb71ca6efb4867dae2858687671594dc23fefc94ecf25d, vars: {}, profile: , target: dev, version: 1.9.1
[0m14:14:01.601833 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:14:01.604658 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/transform_sales.sql
[0m14:14:02.553938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b2e22a5d-cf4d-4c0d-a3d4-21f6122fb374', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81bef51d90>]}
[0m14:14:03.271762 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m14:14:03.319733 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m14:14:03.553541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b2e22a5d-cf4d-4c0d-a3d4-21f6122fb374', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81bfa62150>]}
[0m14:14:03.555028 [info ] [MainThread]: Found 1 model, 1 source, 424 macros
[0m14:14:03.556751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b2e22a5d-cf4d-4c0d-a3d4-21f6122fb374', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81c568ed20>]}
[0m14:14:03.560104 [info ] [MainThread]: 
[0m14:14:03.561662 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:14:03.563174 [info ] [MainThread]: 
[0m14:14:03.565453 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:14:03.568445 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_sales_database'
[0m14:14:03.722365 [debug] [ThreadPool]: Using duckdb connection "list_sales_database"
[0m14:14:03.724422 [debug] [ThreadPool]: On list_sales_database: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "list_sales_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"sales_database"'
    
  
  
[0m14:14:03.726334 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:14:03.809498 [debug] [ThreadPool]: SQL status: OK in 0.083 seconds
[0m14:14:03.814566 [debug] [ThreadPool]: On list_sales_database: Close
[0m14:14:03.823271 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_database, now create_sales_database_main)
[0m14:14:03.825888 [debug] [ThreadPool]: Creating schema "database: "sales_database"
schema: "main"
"
[0m14:14:03.860315 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m14:14:03.862597 [debug] [ThreadPool]: On create_sales_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "create_sales_database_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='sales_database'
        and type='sqlite'
    
  
[0m14:14:03.865627 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:14:03.912274 [debug] [ThreadPool]: SQL status: OK in 0.048 seconds
[0m14:14:03.917823 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m14:14:03.919238 [debug] [ThreadPool]: On create_sales_database_main: BEGIN
[0m14:14:03.921015 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:14:03.922261 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m14:14:03.923570 [debug] [ThreadPool]: On create_sales_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "create_sales_database_main"} */

    
    
        create schema if not exists "sales_database"."main"
    
[0m14:14:03.925543 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:14:03.927812 [debug] [ThreadPool]: On create_sales_database_main: COMMIT
[0m14:14:03.929163 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m14:14:03.930573 [debug] [ThreadPool]: On create_sales_database_main: COMMIT
[0m14:14:03.933200 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:14:03.934701 [debug] [ThreadPool]: On create_sales_database_main: Close
[0m14:14:03.940978 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_sales_database_main'
[0m14:14:03.959347 [debug] [ThreadPool]: Using duckdb connection "list_sales_database_main"
[0m14:14:03.960962 [debug] [ThreadPool]: On list_sales_database_main: BEGIN
[0m14:14:03.962352 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:14:03.996421 [debug] [ThreadPool]: SQL status: OK in 0.034 seconds
[0m14:14:03.997784 [debug] [ThreadPool]: Using duckdb connection "list_sales_database_main"
[0m14:14:03.999770 [debug] [ThreadPool]: On list_sales_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "list_sales_database_main"} */
select
      'sales_database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'sales_database'
  
[0m14:14:04.091175 [debug] [ThreadPool]: SQL status: OK in 0.090 seconds
[0m14:14:04.096579 [debug] [ThreadPool]: On list_sales_database_main: ROLLBACK
[0m14:14:04.104070 [debug] [ThreadPool]: Failed to rollback 'list_sales_database_main'
[0m14:14:04.105849 [debug] [ThreadPool]: On list_sales_database_main: Close
[0m14:14:04.127474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b2e22a5d-cf4d-4c0d-a3d4-21f6122fb374', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81be4ed6a0>]}
[0m14:14:04.129682 [debug] [MainThread]: Using duckdb connection "master"
[0m14:14:04.131947 [debug] [MainThread]: On master: BEGIN
[0m14:14:04.133004 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:14:04.154607 [debug] [MainThread]: SQL status: OK in 0.022 seconds
[0m14:14:04.155862 [debug] [MainThread]: On master: COMMIT
[0m14:14:04.157134 [debug] [MainThread]: Using duckdb connection "master"
[0m14:14:04.158203 [debug] [MainThread]: On master: COMMIT
[0m14:14:04.159786 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m14:14:04.160870 [debug] [MainThread]: On master: Close
[0m14:14:04.166795 [debug] [Thread-1 (]: Began running node model.my_dbt_project.transform_sales
[0m14:14:04.168322 [info ] [Thread-1 (]: 1 of 1 START sql table model main.transform_sales .............................. [RUN]
[0m14:14:04.169917 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.my_dbt_project.transform_sales'
[0m14:14:04.171552 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.transform_sales
[0m14:14:04.185892 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.transform_sales"
[0m14:14:04.198610 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.transform_sales
[0m14:14:04.271607 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.transform_sales"
[0m14:14:04.286764 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m14:14:04.288122 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: BEGIN
[0m14:14:04.289611 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:14:04.319040 [debug] [Thread-1 (]: SQL status: OK in 0.029 seconds
[0m14:14:04.320791 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m14:14:04.322596 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */

  
    
    

    create  table
      "sales_database"."main"."transform_sales__dbt_tmp"
  
    as (
      -- /opt/airflow/dags/dbt_models/transform_users.sql


WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
   *
FROM sales
WHERE name = 'ABC private LTD-0002'
    );
  
  
[0m14:14:04.344495 [debug] [Thread-1 (]: SQL status: OK in 0.020 seconds
[0m14:14:04.363509 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m14:14:04.365419 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */
alter table "sales_database"."main"."transform_sales__dbt_tmp" rename to "transform_sales"
[0m14:14:04.369201 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:14:04.396066 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: COMMIT
[0m14:14:04.397529 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m14:14:04.398810 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: COMMIT
[0m14:14:04.426100 [debug] [Thread-1 (]: SQL status: OK in 0.026 seconds
[0m14:14:04.437556 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m14:14:04.439219 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */
drop table if exists "sales_database"."main"."transform_sales__dbt_backup" cascade
[0m14:14:04.441342 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:14:04.448992 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: Close
[0m14:14:04.597715 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2e22a5d-cf4d-4c0d-a3d4-21f6122fb374', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81be451070>]}
[0m14:14:04.599775 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main.transform_sales ......................... [[32mOK[0m in 0.43s]
[0m14:14:04.601549 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.transform_sales
[0m14:14:04.605464 [debug] [MainThread]: Using duckdb connection "master"
[0m14:14:04.606860 [debug] [MainThread]: On master: BEGIN
[0m14:14:04.608165 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:14:04.639395 [debug] [MainThread]: SQL status: OK in 0.031 seconds
[0m14:14:04.640866 [debug] [MainThread]: On master: COMMIT
[0m14:14:04.642227 [debug] [MainThread]: Using duckdb connection "master"
[0m14:14:04.643602 [debug] [MainThread]: On master: COMMIT
[0m14:14:04.645490 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m14:14:04.646898 [debug] [MainThread]: On master: Close
[0m14:14:04.652284 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:14:04.653793 [debug] [MainThread]: Connection 'create_sales_database_main' was properly closed.
[0m14:14:04.655081 [debug] [MainThread]: Connection 'list_sales_database_main' was properly closed.
[0m14:14:04.656363 [debug] [MainThread]: Connection 'model.my_dbt_project.transform_sales' was properly closed.
[0m14:14:04.657764 [info ] [MainThread]: 
[0m14:14:04.658981 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.09 seconds (1.09s).
[0m14:14:04.661076 [debug] [MainThread]: Command end result
[0m14:14:04.760198 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m14:14:04.773752 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m14:14:04.813807 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dags/dbt_models/target/run_results.json
[0m14:14:04.815146 [info ] [MainThread]: 
[0m14:14:04.816485 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:14:04.818108 [info ] [MainThread]: 
[0m14:14:04.820387 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:14:04.826835 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.717981, "process_in_blocks": "81552", "process_kernel_time": 1.001619, "process_mem_max_rss": "156596", "process_out_blocks": "0", "process_user_time": 8.974909}
[0m14:14:04.847205 [debug] [MainThread]: Command `dbt run` succeeded at 14:14:04.845502 after 5.74 seconds
[0m14:14:04.853137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81c94c35c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81c56636b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81c79e22a0>]}
[0m14:14:04.855381 [debug] [MainThread]: Flushing usage events
[0m14:14:06.333530 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:06:22.913481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c17523fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c177287a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c15618f20>]}


============================== 07:06:23.030985 | b316b182-b723-4cae-9cba-86eae7d76a01 ==============================
[0m07:06:23.030985 [info ] [MainThread]: Running with dbt=1.9.1
[0m07:06:23.070712 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/profiles.yml', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dags/dbt_models/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt/profiles.yml --target dev', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m07:06:28.418869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b316b182-b723-4cae-9cba-86eae7d76a01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c153cbaa0>]}
[0m07:06:28.564122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b316b182-b723-4cae-9cba-86eae7d76a01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c1558bb30>]}
[0m07:06:28.741368 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m07:06:31.903451 [debug] [MainThread]: checksum: cac3b9519010e47bfbeb71ca6efb4867dae2858687671594dc23fefc94ecf25d, vars: {}, profile: , target: dev, version: 1.9.1
[0m07:06:34.389021 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m07:06:34.401336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b316b182-b723-4cae-9cba-86eae7d76a01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c1594ecf0>]}
[0m07:06:41.738291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b316b182-b723-4cae-9cba-86eae7d76a01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c0ea168d0>]}
[0m07:06:42.468054 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m07:06:42.509870 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m07:06:42.846508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b316b182-b723-4cae-9cba-86eae7d76a01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c0ea04e90>]}
[0m07:06:42.848661 [info ] [MainThread]: Found 6 models, 1 source, 424 macros
[0m07:06:42.853106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b316b182-b723-4cae-9cba-86eae7d76a01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c11b09400>]}
[0m07:06:42.859479 [info ] [MainThread]: 
[0m07:06:42.862759 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:06:42.866072 [info ] [MainThread]: 
[0m07:06:42.870696 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m07:06:42.891309 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_sales_database'
[0m07:06:43.250508 [debug] [ThreadPool]: Using duckdb connection "list_sales_database"
[0m07:06:43.253057 [debug] [ThreadPool]: On list_sales_database: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "list_sales_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"sales_database"'
    
  
  
[0m07:06:43.256973 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:06:43.582986 [debug] [ThreadPool]: SQL status: OK in 0.326 seconds
[0m07:06:43.597157 [debug] [ThreadPool]: On list_sales_database: Close
[0m07:06:43.609440 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_database, now create_sales_database_main)
[0m07:06:43.612221 [debug] [ThreadPool]: Creating schema "database: "sales_database"
schema: "main"
"
[0m07:06:43.636225 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m07:06:43.639014 [debug] [ThreadPool]: On create_sales_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "create_sales_database_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='sales_database'
        and type='sqlite'
    
  
[0m07:06:43.641278 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:06:43.687663 [debug] [ThreadPool]: SQL status: OK in 0.046 seconds
[0m07:06:43.692619 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m07:06:43.694337 [debug] [ThreadPool]: On create_sales_database_main: BEGIN
[0m07:06:43.696897 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m07:06:43.698800 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m07:06:43.701023 [debug] [ThreadPool]: On create_sales_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "create_sales_database_main"} */

    
    
        create schema if not exists "sales_database"."main"
    
[0m07:06:43.705288 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m07:06:43.708736 [debug] [ThreadPool]: On create_sales_database_main: COMMIT
[0m07:06:43.710521 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m07:06:43.712551 [debug] [ThreadPool]: On create_sales_database_main: COMMIT
[0m07:06:43.714947 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m07:06:43.716769 [debug] [ThreadPool]: On create_sales_database_main: Close
[0m07:06:43.729381 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_sales_database_main'
[0m07:06:43.773239 [debug] [ThreadPool]: Using duckdb connection "list_sales_database_main"
[0m07:06:43.775550 [debug] [ThreadPool]: On list_sales_database_main: BEGIN
[0m07:06:43.777380 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:06:43.841362 [debug] [ThreadPool]: SQL status: OK in 0.064 seconds
[0m07:06:43.843432 [debug] [ThreadPool]: Using duckdb connection "list_sales_database_main"
[0m07:06:43.846584 [debug] [ThreadPool]: On list_sales_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "list_sales_database_main"} */
select
      'sales_database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'sales_database'
  
[0m07:06:43.980519 [debug] [ThreadPool]: SQL status: OK in 0.128 seconds
[0m07:06:43.985422 [debug] [ThreadPool]: On list_sales_database_main: ROLLBACK
[0m07:06:43.993120 [debug] [ThreadPool]: Failed to rollback 'list_sales_database_main'
[0m07:06:43.994897 [debug] [ThreadPool]: On list_sales_database_main: Close
[0m07:06:44.007023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b316b182-b723-4cae-9cba-86eae7d76a01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c0ea20200>]}
[0m07:06:44.009523 [debug] [MainThread]: Using duckdb connection "master"
[0m07:06:44.011208 [debug] [MainThread]: On master: BEGIN
[0m07:06:44.012838 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:06:44.061073 [debug] [MainThread]: SQL status: OK in 0.048 seconds
[0m07:06:44.062942 [debug] [MainThread]: On master: COMMIT
[0m07:06:44.064859 [debug] [MainThread]: Using duckdb connection "master"
[0m07:06:44.066533 [debug] [MainThread]: On master: COMMIT
[0m07:06:44.069300 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m07:06:44.071737 [debug] [MainThread]: On master: Close
[0m07:06:44.081187 [debug] [Thread-1 (]: Began running node model.my_dbt_project.customer_dimension
[0m07:06:44.083965 [info ] [Thread-1 (]: 1 of 6 START sql view model main.customer_dimension ............................ [RUN]
[0m07:06:44.088614 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.my_dbt_project.customer_dimension'
[0m07:06:44.091410 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.customer_dimension
[0m07:06:44.120449 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.customer_dimension"
[0m07:06:44.155843 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.customer_dimension
[0m07:06:44.330050 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.customer_dimension"
[0m07:06:44.370052 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m07:06:44.373437 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: BEGIN
[0m07:06:44.377116 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m07:06:44.447309 [debug] [Thread-1 (]: SQL status: OK in 0.070 seconds
[0m07:06:44.451601 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m07:06:44.455473 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */

  
  create view "sales_database"."main"."customer_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
    DISTINCT
    customer AS customer_id,
    customer_name,
    customer_address,
    customer_group,
    territory,
    language AS customer_language
FROM sales
WHERE customer IS NOT NULL
  );

[0m07:06:44.460906 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m07:06:44.496572 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m07:06:44.499200 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */
alter view "sales_database"."main"."customer_dimension__dbt_tmp" rename to "customer_dimension"
[0m07:06:44.503255 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:06:44.550808 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: COMMIT
[0m07:06:44.555768 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m07:06:44.563758 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: COMMIT
[0m07:06:44.575212 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m07:06:44.593841 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m07:06:44.595789 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */
drop view if exists "sales_database"."main"."customer_dimension__dbt_backup" cascade
[0m07:06:44.599225 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:06:44.609584 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: Close
[0m07:06:44.737934 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b316b182-b723-4cae-9cba-86eae7d76a01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c0f325e80>]}
[0m07:06:44.741884 [info ] [Thread-1 (]: 1 of 6 OK created sql view model main.customer_dimension ....................... [[32mOK[0m in 0.64s]
[0m07:06:44.752513 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.customer_dimension
[0m07:06:44.760629 [debug] [Thread-1 (]: Began running node model.my_dbt_project.date_dimension
[0m07:06:44.763836 [info ] [Thread-1 (]: 2 of 6 START sql view model main.date_dimension ................................ [RUN]
[0m07:06:44.769465 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customer_dimension, now model.my_dbt_project.date_dimension)
[0m07:06:44.772744 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.date_dimension
[0m07:06:44.782823 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.date_dimension"
[0m07:06:44.824301 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.date_dimension
[0m07:06:44.841684 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.date_dimension"
[0m07:06:44.862873 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m07:06:44.865161 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: BEGIN
[0m07:06:44.867404 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:06:44.911400 [debug] [Thread-1 (]: SQL status: OK in 0.044 seconds
[0m07:06:44.914136 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m07:06:44.916255 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.date_dimension"} */

  
  create view "sales_database"."main"."date_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
    DISTINCT
    transaction_date AS date_id,
    EXTRACT(YEAR FROM transaction_date) AS year,
    EXTRACT(MONTH FROM transaction_date) AS month,
    EXTRACT(DAY FROM transaction_date) AS day,
    TO_CHAR(transaction_date, 'Day') AS weekday_name,
    EXTRACT(QUARTER FROM transaction_date) AS quarter
FROM sales
WHERE transaction_date IS NOT NULL
  );

[0m07:06:44.965559 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.date_dimension"} */

  
  create view "sales_database"."main"."date_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
    DISTINCT
    transaction_date AS date_id,
    EXTRACT(YEAR FROM transaction_date) AS year,
    EXTRACT(MONTH FROM transaction_date) AS month,
    EXTRACT(DAY FROM transaction_date) AS day,
    TO_CHAR(transaction_date, 'Day') AS weekday_name,
    EXTRACT(QUARTER FROM transaction_date) AS quarter
FROM sales
WHERE transaction_date IS NOT NULL
  );

[0m07:06:44.967869 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m07:06:44.971886 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: ROLLBACK
[0m07:06:44.994709 [debug] [Thread-1 (]: Failed to rollback 'model.my_dbt_project.date_dimension'
[0m07:06:44.997047 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: Close
[0m07:06:45.017011 [debug] [Thread-1 (]: Runtime Error in model date_dimension (models/dimensions/date_dimension.sql)
  Catalog Error: Scalar Function with name to_char does not exist!
  Did you mean "to_hours"?
  LINE 15:     TO_CHAR(transaction_date, 'Day') AS weekday_name,
      EXTRACT(QUARTER FROM transaction_date) AS quarter
  FROM sales
  WHERE transaction_date IS NOT NULL
    );
  ...
               ^
[0m07:06:45.019920 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b316b182-b723-4cae-9cba-86eae7d76a01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c0df09c10>]}
[0m07:06:45.023968 [error] [Thread-1 (]: 2 of 6 ERROR creating sql view model main.date_dimension ....................... [[31mERROR[0m in 0.25s]
[0m07:06:45.026981 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.date_dimension
[0m07:06:45.029272 [debug] [Thread-1 (]: Began running node model.my_dbt_project.product_dimension
[0m07:06:45.031226 [debug] [Thread-4 (]: Marking all children of 'model.my_dbt_project.date_dimension' to be skipped because of status 'error'.  Reason: Runtime Error in model date_dimension (models/dimensions/date_dimension.sql)
  Catalog Error: Scalar Function with name to_char does not exist!
  Did you mean "to_hours"?
  LINE 15:     TO_CHAR(transaction_date, 'Day') AS weekday_name,
      EXTRACT(QUARTER FROM transaction_date) AS quarter
  FROM sales
  WHERE transaction_date IS NOT NULL
    );
  ...
               ^.
[0m07:06:45.033172 [info ] [Thread-1 (]: 3 of 6 START sql view model main.product_dimension ............................. [RUN]
[0m07:06:45.037098 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.date_dimension, now model.my_dbt_project.product_dimension)
[0m07:06:45.039441 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.product_dimension
[0m07:06:45.050717 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.product_dimension"
[0m07:06:45.090328 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.product_dimension
[0m07:06:45.108854 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.product_dimension"
[0m07:06:45.155544 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m07:06:45.158053 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: BEGIN
[0m07:06:45.165169 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:06:45.380058 [debug] [Thread-1 (]: SQL status: OK in 0.217 seconds
[0m07:06:45.384844 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m07:06:45.390403 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.product_dimension"} */

  
  create view "sales_database"."main"."product_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
    DISTINCT
    unnest(items) AS product_id,   -- Assuming 'items' is a JSON array, we extract each product in the order
    product->>'name' AS product_name, -- Get product name from the JSON object
    product->>'category' AS product_category, -- Get product category
    product->>'price' AS price
FROM sales,
LATERAL FLATTEN(input => sales.items) AS product
WHERE product->>'name' IS NOT NULL
  );

[0m07:06:45.398857 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.product_dimension"} */

  
  create view "sales_database"."main"."product_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
    DISTINCT
    unnest(items) AS product_id,   -- Assuming 'items' is a JSON array, we extract each product in the order
    product->>'name' AS product_name, -- Get product name from the JSON object
    product->>'category' AS product_category, -- Get product category
    product->>'price' AS price
FROM sales,
LATERAL FLATTEN(input => sales.items) AS product
WHERE product->>'name' IS NOT NULL
  );

[0m07:06:45.401959 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m07:06:45.408916 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: ROLLBACK
[0m07:06:45.428727 [debug] [Thread-1 (]: Failed to rollback 'model.my_dbt_project.product_dimension'
[0m07:06:45.431783 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: Close
[0m07:06:45.463226 [debug] [Thread-1 (]: Runtime Error in model product_dimension (models/dimensions/product_dimension.sql)
  Catalog Error: Table Function with name flatten does not exist!
  Did you mean "read_text"?
  LINE 16: LATERAL FLATTEN(input => sales.items) AS product
  WHERE product->>'name' IS NOT NULL
    );
  ...
                   ^
[0m07:06:45.465556 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b316b182-b723-4cae-9cba-86eae7d76a01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c0dea70e0>]}
[0m07:06:45.469714 [error] [Thread-1 (]: 3 of 6 ERROR creating sql view model main.product_dimension .................... [[31mERROR[0m in 0.43s]
[0m07:06:45.495263 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.product_dimension
[0m07:06:45.498509 [debug] [Thread-1 (]: Began running node model.my_dbt_project.sales_team_dimension
[0m07:06:45.506412 [info ] [Thread-1 (]: 4 of 6 START sql view model main.sales_team_dimension .......................... [RUN]
[0m07:06:45.512448 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.product_dimension, now model.my_dbt_project.sales_team_dimension)
[0m07:06:45.515531 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.sales_team_dimension
[0m07:06:45.501200 [debug] [Thread-4 (]: Marking all children of 'model.my_dbt_project.product_dimension' to be skipped because of status 'error'.  Reason: Runtime Error in model product_dimension (models/dimensions/product_dimension.sql)
  Catalog Error: Table Function with name flatten does not exist!
  Did you mean "read_text"?
  LINE 16: LATERAL FLATTEN(input => sales.items) AS product
  WHERE product->>'name' IS NOT NULL
    );
  ...
                   ^.
[0m07:06:45.575151 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.sales_team_dimension"
[0m07:06:45.652137 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.sales_team_dimension
[0m07:06:45.696352 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.sales_team_dimension"
[0m07:06:45.814717 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m07:06:45.818815 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: BEGIN
[0m07:06:45.821075 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:06:45.945108 [debug] [Thread-1 (]: SQL status: OK in 0.124 seconds
[0m07:06:45.948757 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m07:06:45.961539 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */

  
  create view "sales_database"."main"."sales_team_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
    DISTINCT
    sales_team->>'name' AS sales_team_id,
    sales_team->>'region' AS sales_team_region
FROM sales
WHERE sales_team IS NOT NULL
  );

[0m07:06:45.985598 [debug] [Thread-1 (]: SQL status: OK in 0.020 seconds
[0m07:06:46.032528 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m07:06:46.035243 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */
alter view "sales_database"."main"."sales_team_dimension__dbt_tmp" rename to "sales_team_dimension"
[0m07:06:46.053743 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m07:06:46.065563 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: COMMIT
[0m07:06:46.067776 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m07:06:46.069936 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: COMMIT
[0m07:06:46.124674 [debug] [Thread-1 (]: SQL status: OK in 0.041 seconds
[0m07:06:46.164519 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m07:06:46.192763 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */
drop view if exists "sales_database"."main"."sales_team_dimension__dbt_backup" cascade
[0m07:06:46.287311 [debug] [Thread-1 (]: SQL status: OK in 0.072 seconds
[0m07:06:46.305469 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: Close
[0m07:06:53.381574 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b316b182-b723-4cae-9cba-86eae7d76a01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c0dea1460>]}
[0m07:06:53.385919 [info ] [Thread-1 (]: 4 of 6 OK created sql view model main.sales_team_dimension ..................... [[32mOK[0m in 7.86s]
[0m07:06:53.391290 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.sales_team_dimension
[0m07:06:53.394406 [debug] [Thread-1 (]: Began running node model.my_dbt_project.transform_sales
[0m07:06:53.402197 [info ] [Thread-1 (]: 5 of 6 START sql table model main.transform_sales .............................. [RUN]
[0m07:06:53.406837 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.sales_team_dimension, now model.my_dbt_project.transform_sales)
[0m07:06:53.409721 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.transform_sales
[0m07:06:53.444686 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.transform_sales"
[0m07:06:53.481690 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.transform_sales
[0m07:06:53.576087 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.transform_sales"
[0m07:06:53.596773 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m07:06:53.599106 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: BEGIN
[0m07:06:53.608103 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:06:53.856906 [debug] [Thread-1 (]: SQL status: OK in 0.252 seconds
[0m07:06:53.859173 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m07:06:53.861655 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */

  
    
    

    create  table
      "sales_database"."main"."transform_sales__dbt_tmp"
  
    as (
      -- /opt/airflow/dags/dbt_models/transform_users.sql


WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
   *
FROM sales
WHERE name = 'ABC private LTD-0002'
    );
  
  
[0m07:06:53.975620 [debug] [Thread-1 (]: SQL status: OK in 0.111 seconds
[0m07:06:53.982372 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m07:06:53.983917 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */
alter table "sales_database"."main"."transform_sales" rename to "transform_sales__dbt_backup"
[0m07:06:53.999355 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m07:06:54.006435 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m07:06:54.007920 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */
alter table "sales_database"."main"."transform_sales__dbt_tmp" rename to "transform_sales"
[0m07:06:54.010231 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:06:54.025450 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: COMMIT
[0m07:06:54.027353 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m07:06:54.028557 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: COMMIT
[0m07:06:54.052719 [debug] [Thread-1 (]: SQL status: OK in 0.023 seconds
[0m07:06:54.058012 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m07:06:54.059207 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */
drop table if exists "sales_database"."main"."transform_sales__dbt_backup" cascade
[0m07:06:54.075326 [debug] [Thread-1 (]: SQL status: OK in 0.015 seconds
[0m07:06:54.078168 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: Close
[0m07:06:54.508899 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b316b182-b723-4cae-9cba-86eae7d76a01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c0dec2480>]}
[0m07:06:54.510930 [info ] [Thread-1 (]: 5 of 6 OK created sql table model main.transform_sales ......................... [[32mOK[0m in 1.10s]
[0m07:06:54.513165 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.transform_sales
[0m07:06:54.514527 [debug] [Thread-1 (]: Began running node model.my_dbt_project.sales_fact
[0m07:06:54.515972 [info ] [Thread-1 (]: 6 of 6 SKIP relation main.sales_fact ........................................... [[33mSKIP[0m]
[0m07:06:54.517826 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.sales_fact
[0m07:06:54.522184 [debug] [MainThread]: Using duckdb connection "master"
[0m07:06:54.523607 [debug] [MainThread]: On master: BEGIN
[0m07:06:54.524878 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:06:54.621531 [debug] [MainThread]: SQL status: OK in 0.097 seconds
[0m07:06:54.623292 [debug] [MainThread]: On master: COMMIT
[0m07:06:54.624741 [debug] [MainThread]: Using duckdb connection "master"
[0m07:06:54.626171 [debug] [MainThread]: On master: COMMIT
[0m07:06:54.628222 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m07:06:54.629571 [debug] [MainThread]: On master: Close
[0m07:06:54.638179 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:06:54.640743 [debug] [MainThread]: Connection 'create_sales_database_main' was properly closed.
[0m07:06:54.642702 [debug] [MainThread]: Connection 'list_sales_database_main' was properly closed.
[0m07:06:54.644185 [debug] [MainThread]: Connection 'model.my_dbt_project.transform_sales' was properly closed.
[0m07:06:54.646948 [info ] [MainThread]: 
[0m07:06:54.657350 [info ] [MainThread]: Finished running 2 table models, 4 view models in 0 hours 0 minutes and 11.78 seconds (11.78s).
[0m07:06:54.675397 [debug] [MainThread]: Command end result
[0m07:06:54.993436 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m07:06:55.041812 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m07:06:55.164771 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dags/dbt_models/target/run_results.json
[0m07:06:55.166731 [info ] [MainThread]: 
[0m07:06:55.172714 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m07:06:55.184908 [info ] [MainThread]: 
[0m07:06:55.189573 [error] [MainThread]:   Runtime Error in model date_dimension (models/dimensions/date_dimension.sql)
  Catalog Error: Scalar Function with name to_char does not exist!
  Did you mean "to_hours"?
  LINE 15:     TO_CHAR(transaction_date, 'Day') AS weekday_name,
      EXTRACT(QUARTER FROM transaction_date) AS quarter
  FROM sales
  WHERE transaction_date IS NOT NULL
    );
  ...
               ^
[0m07:06:55.204831 [info ] [MainThread]: 
[0m07:06:55.214441 [error] [MainThread]:   Runtime Error in model product_dimension (models/dimensions/product_dimension.sql)
  Catalog Error: Table Function with name flatten does not exist!
  Did you mean "read_text"?
  LINE 16: LATERAL FLATTEN(input => sales.items) AS product
  WHERE product->>'name' IS NOT NULL
    );
  ...
                   ^
[0m07:06:55.217408 [info ] [MainThread]: 
[0m07:06:55.221242 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=2 SKIP=1 TOTAL=6
[0m07:06:55.227334 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 32.74733, "process_in_blocks": "1311424", "process_kernel_time": 6.051976, "process_mem_max_rss": "138084", "process_out_blocks": "1968", "process_user_time": 16.258604}
[0m07:06:55.266920 [debug] [MainThread]: Command `dbt run` failed at 07:06:55.257939 after 32.78 seconds
[0m07:06:55.269053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c15edf6b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c0f4a12b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c0f5d6f30>]}
[0m07:06:55.271163 [debug] [MainThread]: Flushing usage events
[0m07:06:57.744557 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:12:41.212207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9548abc890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9548ceedb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f954ae29010>]}


============================== 07:12:41.337194 | a431b1a4-2b51-4e6f-b4cd-b48cda66c345 ==============================
[0m07:12:41.337194 [info ] [MainThread]: Running with dbt=1.9.1
[0m07:12:41.342670 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/profiles.yml', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dags/dbt_models/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt/profiles.yml --target dev', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m07:12:43.944643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a431b1a4-2b51-4e6f-b4cd-b48cda66c345', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95486ca3c0>]}
[0m07:12:44.256729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a431b1a4-2b51-4e6f-b4cd-b48cda66c345', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f954a756ba0>]}
[0m07:12:44.444003 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m07:12:46.069469 [debug] [MainThread]: checksum: cac3b9519010e47bfbeb71ca6efb4867dae2858687671594dc23fefc94ecf25d, vars: {}, profile: , target: dev, version: 1.9.1
[0m07:12:48.335434 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m07:12:48.374711 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/dimensions/product_dimension.sql
[0m07:12:51.268044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a431b1a4-2b51-4e6f-b4cd-b48cda66c345', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f954205f980>]}
[0m07:12:52.022723 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m07:12:52.278043 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m07:12:52.869949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a431b1a4-2b51-4e6f-b4cd-b48cda66c345', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9549dccfb0>]}
[0m07:12:52.881436 [info ] [MainThread]: Found 6 models, 1 source, 424 macros
[0m07:12:52.883453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a431b1a4-2b51-4e6f-b4cd-b48cda66c345', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9542b9fb60>]}
[0m07:12:52.895024 [info ] [MainThread]: 
[0m07:12:52.897735 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:12:52.901915 [info ] [MainThread]: 
[0m07:12:52.907097 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m07:12:52.938596 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_sales_database'
[0m07:12:53.402552 [debug] [ThreadPool]: Using duckdb connection "list_sales_database"
[0m07:12:53.426303 [debug] [ThreadPool]: On list_sales_database: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "list_sales_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"sales_database"'
    
  
  
[0m07:12:53.430157 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:12:57.772451 [debug] [ThreadPool]: SQL status: OK in 4.337 seconds
[0m07:12:57.860634 [debug] [ThreadPool]: On list_sales_database: Close
[0m07:12:58.113243 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_database, now create_sales_database_main)
[0m07:12:58.122267 [debug] [ThreadPool]: Creating schema "database: "sales_database"
schema: "main"
"
[0m07:12:58.192740 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m07:12:58.232414 [debug] [ThreadPool]: On create_sales_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "create_sales_database_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='sales_database'
        and type='sqlite'
    
  
[0m07:12:58.234227 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:13:02.136691 [debug] [ThreadPool]: SQL status: OK in 3.816 seconds
[0m07:13:02.237418 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m07:13:02.245938 [debug] [ThreadPool]: On create_sales_database_main: BEGIN
[0m07:13:02.872989 [debug] [ThreadPool]: SQL status: OK in 0.236 seconds
[0m07:13:02.900079 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m07:13:02.902989 [debug] [ThreadPool]: On create_sales_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "create_sales_database_main"} */

    
    
        create schema if not exists "sales_database"."main"
    
[0m07:13:03.356792 [debug] [ThreadPool]: SQL status: OK in 0.447 seconds
[0m07:13:03.366991 [debug] [ThreadPool]: On create_sales_database_main: COMMIT
[0m07:13:03.368587 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m07:13:03.370666 [debug] [ThreadPool]: On create_sales_database_main: COMMIT
[0m07:13:03.491858 [debug] [ThreadPool]: SQL status: OK in 0.105 seconds
[0m07:13:03.999292 [debug] [ThreadPool]: On create_sales_database_main: Close
[0m07:13:04.310785 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_sales_database_main, now list_sales_database_main)
[0m07:13:04.364179 [debug] [ThreadPool]: Using duckdb connection "list_sales_database_main"
[0m07:13:04.368002 [debug] [ThreadPool]: On list_sales_database_main: BEGIN
[0m07:13:04.370712 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:13:07.693573 [debug] [ThreadPool]: SQL status: OK in 3.291 seconds
[0m07:13:07.771225 [debug] [ThreadPool]: Using duckdb connection "list_sales_database_main"
[0m07:13:07.833463 [debug] [ThreadPool]: On list_sales_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "list_sales_database_main"} */
select
      'sales_database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'sales_database'
  
[0m07:13:13.693936 [debug] [ThreadPool]: SQL status: OK in 5.773 seconds
[0m07:13:13.722307 [debug] [ThreadPool]: On list_sales_database_main: ROLLBACK
[0m07:13:13.736913 [debug] [ThreadPool]: Failed to rollback 'list_sales_database_main'
[0m07:13:13.738930 [debug] [ThreadPool]: On list_sales_database_main: Close
[0m07:13:13.799744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a431b1a4-2b51-4e6f-b4cd-b48cda66c345', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9542038470>]}
[0m07:13:13.808134 [debug] [MainThread]: Using duckdb connection "master"
[0m07:13:13.810498 [debug] [MainThread]: On master: BEGIN
[0m07:13:13.814122 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:13:15.226733 [debug] [MainThread]: SQL status: OK in 1.406 seconds
[0m07:13:15.232632 [debug] [MainThread]: On master: COMMIT
[0m07:13:15.237178 [debug] [MainThread]: Using duckdb connection "master"
[0m07:13:15.239233 [debug] [MainThread]: On master: COMMIT
[0m07:13:15.746413 [debug] [MainThread]: SQL status: OK in 0.481 seconds
[0m07:13:15.756359 [debug] [MainThread]: On master: Close
[0m07:13:15.919454 [debug] [Thread-1 (]: Began running node model.my_dbt_project.customer_dimension
[0m07:13:15.934155 [info ] [Thread-1 (]: 1 of 6 START sql view model main.customer_dimension ............................ [RUN]
[0m07:13:15.945150 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.my_dbt_project.customer_dimension'
[0m07:13:15.948162 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.customer_dimension
[0m07:13:16.017120 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.customer_dimension"
[0m07:13:16.082511 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.customer_dimension
[0m07:13:16.315518 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.customer_dimension"
[0m07:13:16.348005 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m07:13:16.350552 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: BEGIN
[0m07:13:16.353820 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m07:13:19.695562 [debug] [Thread-1 (]: SQL status: OK in 3.313 seconds
[0m07:13:19.741556 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m07:13:19.744753 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */

  
  create view "sales_database"."main"."customer_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
    DISTINCT
    customer AS customer_id,
    customer_name,
    customer_address,
    customer_group,
    territory,
    language AS customer_language
FROM sales
WHERE customer IS NOT NULL
  );

[0m07:13:20.949364 [debug] [Thread-1 (]: SQL status: OK in 1.181 seconds
[0m07:13:21.008419 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m07:13:21.022732 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */
alter view "sales_database"."main"."customer_dimension" rename to "customer_dimension__dbt_backup"
[0m07:13:21.835317 [debug] [Thread-1 (]: SQL status: OK in 0.784 seconds
[0m07:13:21.893264 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m07:13:21.907709 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */
alter view "sales_database"."main"."customer_dimension__dbt_tmp" rename to "customer_dimension"
[0m07:13:23.982302 [debug] [Thread-1 (]: SQL status: OK in 1.847 seconds
[0m07:13:24.897857 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: COMMIT
[0m07:13:24.911293 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m07:13:24.912379 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: COMMIT
[0m07:13:27.757866 [debug] [Thread-1 (]: SQL status: OK in 2.796 seconds
[0m07:13:27.882946 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m07:13:27.891147 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */
drop view if exists "sales_database"."main"."customer_dimension__dbt_backup" cascade
[0m07:13:29.574537 [debug] [Thread-1 (]: SQL status: OK in 1.647 seconds
[0m07:13:29.604241 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: Close
[0m07:13:31.024668 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a431b1a4-2b51-4e6f-b4cd-b48cda66c345', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9542b9c6e0>]}
[0m07:13:31.080362 [info ] [Thread-1 (]: 1 of 6 OK created sql view model main.customer_dimension ....................... [[32mOK[0m in 14.94s]
[0m07:13:31.092273 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.customer_dimension
[0m07:13:31.111844 [debug] [Thread-1 (]: Began running node model.my_dbt_project.date_dimension
[0m07:13:31.115907 [info ] [Thread-1 (]: 2 of 6 START sql view model main.date_dimension ................................ [RUN]
[0m07:13:31.131524 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customer_dimension, now model.my_dbt_project.date_dimension)
[0m07:13:31.134807 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.date_dimension
[0m07:13:31.190363 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.date_dimension"
[0m07:13:31.233070 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.date_dimension
[0m07:13:31.285747 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.date_dimension"
[0m07:13:31.352907 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m07:13:31.371594 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: BEGIN
[0m07:13:31.376930 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:13:38.319810 [debug] [Thread-1 (]: SQL status: OK in 6.927 seconds
[0m07:13:38.337363 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m07:13:38.340094 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.date_dimension"} */

  
  create view "sales_database"."main"."date_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
    DISTINCT
    transaction_date AS date_id,
    EXTRACT(YEAR FROM transaction_date) AS year,
    EXTRACT(MONTH FROM transaction_date) AS month,
    EXTRACT(DAY FROM transaction_date) AS day,
    TO_CHAR(transaction_date, 'Day') AS weekday_name,
    EXTRACT(QUARTER FROM transaction_date) AS quarter
FROM sales
WHERE transaction_date IS NOT NULL
  );

[0m07:13:44.543497 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.date_dimension"} */

  
  create view "sales_database"."main"."date_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
    DISTINCT
    transaction_date AS date_id,
    EXTRACT(YEAR FROM transaction_date) AS year,
    EXTRACT(MONTH FROM transaction_date) AS month,
    EXTRACT(DAY FROM transaction_date) AS day,
    TO_CHAR(transaction_date, 'Day') AS weekday_name,
    EXTRACT(QUARTER FROM transaction_date) AS quarter
FROM sales
WHERE transaction_date IS NOT NULL
  );

[0m07:13:44.584063 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m07:13:44.589793 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: ROLLBACK
[0m07:13:44.726698 [debug] [Thread-1 (]: Failed to rollback 'model.my_dbt_project.date_dimension'
[0m07:13:44.788609 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: Close
[0m07:13:46.249140 [debug] [Thread-1 (]: Runtime Error in model date_dimension (models/dimensions/date_dimension.sql)
  Catalog Error: Scalar Function with name to_char does not exist!
  Did you mean "to_hours"?
  LINE 15:     TO_CHAR(transaction_date, 'Day') AS weekday_name,
      EXTRACT(QUARTER FROM transaction_date) AS quarter
  FROM sales
  WHERE transaction_date IS NOT NULL
    );
  ...
               ^
[0m07:13:46.270193 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a431b1a4-2b51-4e6f-b4cd-b48cda66c345', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9540105d60>]}
[0m07:13:46.280379 [error] [Thread-1 (]: 2 of 6 ERROR creating sql view model main.date_dimension ....................... [[31mERROR[0m in 15.13s]
[0m07:13:46.288936 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.date_dimension
[0m07:13:46.302838 [debug] [Thread-1 (]: Began running node model.my_dbt_project.product_dimension
[0m07:13:46.305344 [debug] [Thread-4 (]: Marking all children of 'model.my_dbt_project.date_dimension' to be skipped because of status 'error'.  Reason: Runtime Error in model date_dimension (models/dimensions/date_dimension.sql)
  Catalog Error: Scalar Function with name to_char does not exist!
  Did you mean "to_hours"?
  LINE 15:     TO_CHAR(transaction_date, 'Day') AS weekday_name,
      EXTRACT(QUARTER FROM transaction_date) AS quarter
  FROM sales
  WHERE transaction_date IS NOT NULL
    );
  ...
               ^.
[0m07:13:46.316403 [info ] [Thread-1 (]: 3 of 6 START sql view model main.product_dimension ............................. [RUN]
[0m07:13:46.326834 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.date_dimension, now model.my_dbt_project.product_dimension)
[0m07:13:46.331639 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.product_dimension
[0m07:13:46.372246 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.product_dimension"
[0m07:13:46.415152 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.product_dimension
[0m07:13:46.455432 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.product_dimension"
[0m07:13:46.486117 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m07:13:46.487871 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: BEGIN
[0m07:13:46.489331 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:13:48.585736 [debug] [Thread-1 (]: SQL status: OK in 2.090 seconds
[0m07:13:48.597655 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m07:13:48.602441 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.product_dimension"} */

  
  create view "sales_database"."main"."product_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
),

-- Flattening the `items` JSON array using `json_each()`
product AS (
    SELECT 
        sales.name,
        product.value->>'name' AS product_name,
        product.value->>'item_code' AS product_item_code
    FROM sales,
    LATERAL json_each(sales.items) AS product
)

SELECT *
FROM product
WHERE product_name IS NOT NULL;
  );

[0m07:13:48.954412 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.product_dimension"} */

  
  create view "sales_database"."main"."product_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
),

-- Flattening the `items` JSON array using `json_each()`
product AS (
    SELECT 
        sales.name,
        product.value->>'name' AS product_name,
        product.value->>'item_code' AS product_item_code
    FROM sales,
    LATERAL json_each(sales.items) AS product
)

SELECT *
FROM product
WHERE product_name IS NOT NULL;
  );

[0m07:13:48.971597 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m07:13:48.976539 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: ROLLBACK
[0m07:13:49.021678 [debug] [Thread-1 (]: Failed to rollback 'model.my_dbt_project.product_dimension'
[0m07:13:49.029870 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: Close
[0m07:13:49.172189 [debug] [Thread-1 (]: Runtime Error in model product_dimension (models/dimensions/product_dimension.sql)
  Parser Error: syntax error at or near ";"
[0m07:13:49.200436 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a431b1a4-2b51-4e6f-b4cd-b48cda66c345', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95414c95e0>]}
[0m07:13:49.207758 [error] [Thread-1 (]: 3 of 6 ERROR creating sql view model main.product_dimension .................... [[31mERROR[0m in 2.86s]
[0m07:13:49.212473 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.product_dimension
[0m07:13:49.218661 [debug] [Thread-1 (]: Began running node model.my_dbt_project.sales_team_dimension
[0m07:13:49.223722 [debug] [Thread-4 (]: Marking all children of 'model.my_dbt_project.product_dimension' to be skipped because of status 'error'.  Reason: Runtime Error in model product_dimension (models/dimensions/product_dimension.sql)
  Parser Error: syntax error at or near ";".
[0m07:13:49.233423 [info ] [Thread-1 (]: 4 of 6 START sql view model main.sales_team_dimension .......................... [RUN]
[0m07:13:49.238976 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.product_dimension, now model.my_dbt_project.sales_team_dimension)
[0m07:13:49.246792 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.sales_team_dimension
[0m07:13:49.296282 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.sales_team_dimension"
[0m07:13:49.341332 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.sales_team_dimension
[0m07:13:49.389039 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.sales_team_dimension"
[0m07:13:49.473643 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m07:13:49.504674 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: BEGIN
[0m07:13:49.507861 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:13:51.125153 [debug] [Thread-1 (]: SQL status: OK in 1.602 seconds
[0m07:13:51.137079 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m07:13:51.141552 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */

  
  create view "sales_database"."main"."sales_team_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
    DISTINCT
    sales_team->>'name' AS sales_team_id,
    sales_team->>'region' AS sales_team_region
FROM sales
WHERE sales_team IS NOT NULL
  );

[0m07:13:51.720089 [debug] [Thread-1 (]: SQL status: OK in 0.551 seconds
[0m07:13:51.745284 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m07:13:51.748836 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */
alter view "sales_database"."main"."sales_team_dimension" rename to "sales_team_dimension__dbt_backup"
[0m07:13:51.990219 [debug] [Thread-1 (]: SQL status: OK in 0.223 seconds
[0m07:13:52.049102 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m07:13:52.052076 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */
alter view "sales_database"."main"."sales_team_dimension__dbt_tmp" rename to "sales_team_dimension"
[0m07:13:54.492778 [debug] [Thread-1 (]: SQL status: OK in 2.429 seconds
[0m07:13:54.513400 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: COMMIT
[0m07:13:54.517008 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m07:13:54.521066 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: COMMIT
[0m07:13:55.562643 [debug] [Thread-1 (]: SQL status: OK in 1.008 seconds
[0m07:13:55.590333 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m07:13:55.600597 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */
drop view if exists "sales_database"."main"."sales_team_dimension__dbt_backup" cascade
[0m07:13:56.111535 [debug] [Thread-1 (]: SQL status: OK in 0.459 seconds
[0m07:13:56.140293 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: Close
[0m07:13:57.468846 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a431b1a4-2b51-4e6f-b4cd-b48cda66c345', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9541418ce0>]}
[0m07:13:57.490017 [info ] [Thread-1 (]: 4 of 6 OK created sql view model main.sales_team_dimension ..................... [[32mOK[0m in 8.21s]
[0m07:13:57.496905 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.sales_team_dimension
[0m07:13:57.501600 [debug] [Thread-1 (]: Began running node model.my_dbt_project.transform_sales
[0m07:13:57.505867 [info ] [Thread-1 (]: 5 of 6 START sql table model main.transform_sales .............................. [RUN]
[0m07:13:57.522627 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.sales_team_dimension, now model.my_dbt_project.transform_sales)
[0m07:13:57.525067 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.transform_sales
[0m07:13:57.547130 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.transform_sales"
[0m07:13:57.582693 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.transform_sales
[0m07:13:57.839110 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.transform_sales"
[0m07:13:57.885454 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m07:13:57.890493 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: BEGIN
[0m07:13:57.892796 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:14:02.333697 [debug] [Thread-1 (]: SQL status: OK in 4.425 seconds
[0m07:14:02.349581 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m07:14:02.351887 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */

  
    
    

    create  table
      "sales_database"."main"."transform_sales__dbt_tmp"
  
    as (
      -- /opt/airflow/dags/dbt_models/transform_users.sql


WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
   *
FROM sales
WHERE name = 'ABC private LTD-0002'
    );
  
  
[0m07:14:05.670252 [debug] [Thread-1 (]: SQL status: OK in 3.282 seconds
[0m07:14:05.703005 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m07:14:05.706923 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */
alter table "sales_database"."main"."transform_sales" rename to "transform_sales__dbt_backup"
[0m07:14:05.923387 [debug] [Thread-1 (]: SQL status: OK in 0.191 seconds
[0m07:14:05.956427 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m07:14:05.961797 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */
alter table "sales_database"."main"."transform_sales__dbt_tmp" rename to "transform_sales"
[0m07:14:07.002040 [debug] [Thread-1 (]: SQL status: OK in 1.021 seconds
[0m07:14:07.089393 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: COMMIT
[0m07:14:07.129214 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m07:14:07.132893 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: COMMIT
[0m07:14:12.040356 [debug] [Thread-1 (]: SQL status: OK in 4.902 seconds
[0m07:14:12.058422 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m07:14:12.061670 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */
drop table if exists "sales_database"."main"."transform_sales__dbt_backup" cascade
[0m07:14:12.529032 [debug] [Thread-1 (]: SQL status: OK in 0.515 seconds
[0m07:14:12.532747 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: Close
[0m07:14:12.883390 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a431b1a4-2b51-4e6f-b4cd-b48cda66c345', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95401634d0>]}
[0m07:14:12.887376 [info ] [Thread-1 (]: 5 of 6 OK created sql table model main.transform_sales ......................... [[32mOK[0m in 15.37s]
[0m07:14:12.893136 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.transform_sales
[0m07:14:12.895162 [debug] [Thread-1 (]: Began running node model.my_dbt_project.sales_fact
[0m07:14:12.897539 [info ] [Thread-1 (]: 6 of 6 SKIP relation main.sales_fact ........................................... [[33mSKIP[0m]
[0m07:14:12.900275 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.sales_fact
[0m07:14:12.906025 [debug] [MainThread]: Using duckdb connection "master"
[0m07:14:12.908304 [debug] [MainThread]: On master: BEGIN
[0m07:14:12.910441 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:14:13.043794 [debug] [MainThread]: SQL status: OK in 0.133 seconds
[0m07:14:13.046860 [debug] [MainThread]: On master: COMMIT
[0m07:14:13.049480 [debug] [MainThread]: Using duckdb connection "master"
[0m07:14:13.063601 [debug] [MainThread]: On master: COMMIT
[0m07:14:13.085036 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m07:14:13.092245 [debug] [MainThread]: On master: Close
[0m07:14:13.119785 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:14:13.122906 [debug] [MainThread]: Connection 'list_sales_database_main' was properly closed.
[0m07:14:13.134705 [debug] [MainThread]: Connection 'model.my_dbt_project.transform_sales' was properly closed.
[0m07:14:13.151844 [info ] [MainThread]: 
[0m07:14:13.165250 [info ] [MainThread]: Finished running 2 table models, 4 view models in 0 hours 1 minutes and 20.24 seconds (80.24s).
[0m07:14:13.194799 [debug] [MainThread]: Command end result
[0m07:14:13.800235 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m07:14:13.910222 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m07:14:14.068807 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dags/dbt_models/target/run_results.json
[0m07:14:14.070957 [info ] [MainThread]: 
[0m07:14:14.086325 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m07:14:14.089304 [info ] [MainThread]: 
[0m07:14:14.116846 [error] [MainThread]:   Runtime Error in model date_dimension (models/dimensions/date_dimension.sql)
  Catalog Error: Scalar Function with name to_char does not exist!
  Did you mean "to_hours"?
  LINE 15:     TO_CHAR(transaction_date, 'Day') AS weekday_name,
      EXTRACT(QUARTER FROM transaction_date) AS quarter
  FROM sales
  WHERE transaction_date IS NOT NULL
    );
  ...
               ^
[0m07:14:14.129674 [info ] [MainThread]: 
[0m07:14:14.155144 [error] [MainThread]:   Runtime Error in model product_dimension (models/dimensions/product_dimension.sql)
  Parser Error: syntax error at or near ";"
[0m07:14:14.170910 [info ] [MainThread]: 
[0m07:14:14.189312 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=2 SKIP=1 TOTAL=6
[0m07:14:14.226849 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 93.58312, "process_in_blocks": "9469328", "process_kernel_time": 10.584377, "process_mem_max_rss": "133308", "process_out_blocks": "0", "process_user_time": 23.2455}
[0m07:14:14.246543 [debug] [MainThread]: Command `dbt run` failed at 07:14:14.246128 after 93.60 seconds
[0m07:14:14.256358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f954c5275f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95494ecc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95486cb110>]}
[0m07:14:14.260066 [debug] [MainThread]: Flushing usage events
[0m07:14:16.350174 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:16:51.668974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46d9547aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46d96ed9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46d9545460>]}


============================== 07:16:51.697522 | 6b8feea8-2bb9-4974-8a58-b83326d2d12c ==============================
[0m07:16:51.697522 [info ] [MainThread]: Running with dbt=1.9.1
[0m07:16:51.701473 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/profiles.yml', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dags/dbt_models/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt/profiles.yml --target dev', 'send_anonymous_usage_stats': 'True'}
[0m07:16:53.717284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6b8feea8-2bb9-4974-8a58-b83326d2d12c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46d8827fb0>]}
[0m07:16:54.046368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6b8feea8-2bb9-4974-8a58-b83326d2d12c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46d9545490>]}
[0m07:16:54.115687 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m07:16:58.482803 [debug] [MainThread]: checksum: cac3b9519010e47bfbeb71ca6efb4867dae2858687671594dc23fefc94ecf25d, vars: {}, profile: , target: dev, version: 1.9.1
[0m07:17:22.555188 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:17:22.557701 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:17:23.068730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6b8feea8-2bb9-4974-8a58-b83326d2d12c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46d8944530>]}
[0m07:17:24.867144 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m07:17:25.040377 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m07:17:25.681916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6b8feea8-2bb9-4974-8a58-b83326d2d12c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46d9e8bad0>]}
[0m07:17:25.686927 [info ] [MainThread]: Found 6 models, 1 source, 424 macros
[0m07:17:25.701455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6b8feea8-2bb9-4974-8a58-b83326d2d12c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46d2f54b30>]}
[0m07:17:25.764843 [info ] [MainThread]: 
[0m07:17:25.773648 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:17:25.777637 [info ] [MainThread]: 
[0m07:17:25.800635 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m07:17:25.941387 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_sales_database'
[0m07:17:26.795225 [debug] [ThreadPool]: Using duckdb connection "list_sales_database"
[0m07:17:26.797091 [debug] [ThreadPool]: On list_sales_database: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "list_sales_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"sales_database"'
    
  
  
[0m07:17:26.800309 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:17:27.798151 [debug] [ThreadPool]: SQL status: OK in 0.993 seconds
[0m07:17:27.807450 [debug] [ThreadPool]: On list_sales_database: Close
[0m07:17:27.860558 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_database, now create_sales_database_main)
[0m07:17:27.864475 [debug] [ThreadPool]: Creating schema "database: "sales_database"
schema: "main"
"
[0m07:17:27.918693 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m07:17:27.924202 [debug] [ThreadPool]: On create_sales_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "create_sales_database_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='sales_database'
        and type='sqlite'
    
  
[0m07:17:27.936692 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:17:28.114302 [debug] [ThreadPool]: SQL status: OK in 0.177 seconds
[0m07:17:28.123071 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m07:17:28.136132 [debug] [ThreadPool]: On create_sales_database_main: BEGIN
[0m07:17:28.146164 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m07:17:28.148363 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m07:17:28.151437 [debug] [ThreadPool]: On create_sales_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "create_sales_database_main"} */

    
    
        create schema if not exists "sales_database"."main"
    
[0m07:17:28.162318 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m07:17:28.166553 [debug] [ThreadPool]: On create_sales_database_main: COMMIT
[0m07:17:28.173377 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m07:17:28.175480 [debug] [ThreadPool]: On create_sales_database_main: COMMIT
[0m07:17:28.181721 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m07:17:28.197330 [debug] [ThreadPool]: On create_sales_database_main: Close
[0m07:17:28.216208 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_sales_database_main'
[0m07:17:28.245908 [debug] [ThreadPool]: Using duckdb connection "list_sales_database_main"
[0m07:17:28.249153 [debug] [ThreadPool]: On list_sales_database_main: BEGIN
[0m07:17:28.254235 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:17:28.342641 [debug] [ThreadPool]: SQL status: OK in 0.088 seconds
[0m07:17:28.350360 [debug] [ThreadPool]: Using duckdb connection "list_sales_database_main"
[0m07:17:28.363706 [debug] [ThreadPool]: On list_sales_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "list_sales_database_main"} */
select
      'sales_database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'sales_database'
  
[0m07:17:28.851202 [debug] [ThreadPool]: SQL status: OK in 0.482 seconds
[0m07:17:28.879669 [debug] [ThreadPool]: On list_sales_database_main: ROLLBACK
[0m07:17:28.973576 [debug] [ThreadPool]: Failed to rollback 'list_sales_database_main'
[0m07:17:28.974975 [debug] [ThreadPool]: On list_sales_database_main: Close
[0m07:17:28.988350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6b8feea8-2bb9-4974-8a58-b83326d2d12c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46d8827fe0>]}
[0m07:17:29.001530 [debug] [MainThread]: Using duckdb connection "master"
[0m07:17:29.003675 [debug] [MainThread]: On master: BEGIN
[0m07:17:29.006374 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:17:29.127205 [debug] [MainThread]: SQL status: OK in 0.121 seconds
[0m07:17:29.129391 [debug] [MainThread]: On master: COMMIT
[0m07:17:29.131082 [debug] [MainThread]: Using duckdb connection "master"
[0m07:17:29.132328 [debug] [MainThread]: On master: COMMIT
[0m07:17:29.134504 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m07:17:29.135794 [debug] [MainThread]: On master: Close
[0m07:17:29.177307 [debug] [Thread-1 (]: Began running node model.my_dbt_project.customer_dimension
[0m07:17:29.180380 [info ] [Thread-1 (]: 1 of 6 START sql view model main.customer_dimension ............................ [RUN]
[0m07:17:29.184368 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.my_dbt_project.customer_dimension'
[0m07:17:29.187679 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.customer_dimension
[0m07:17:29.273449 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.customer_dimension"
[0m07:17:29.289322 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.customer_dimension
[0m07:17:29.417212 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.customer_dimension"
[0m07:17:29.433632 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m07:17:29.436180 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: BEGIN
[0m07:17:29.437760 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m07:17:32.154171 [debug] [Thread-1 (]: SQL status: OK in 2.691 seconds
[0m07:17:32.181915 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m07:17:32.206602 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */

  
  create view "sales_database"."main"."customer_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
    DISTINCT
    customer AS customer_id,
    customer_name,
    customer_address,
    customer_group,
    territory,
    language AS customer_language
FROM sales
WHERE customer IS NOT NULL
  );

[0m07:17:34.222466 [debug] [Thread-1 (]: SQL status: OK in 1.972 seconds
[0m07:17:41.878188 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m07:17:41.882931 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */
alter view "sales_database"."main"."customer_dimension" rename to "customer_dimension__dbt_backup"
[0m07:17:42.158277 [debug] [Thread-1 (]: SQL status: OK in 0.273 seconds
[0m07:17:42.244883 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m07:17:42.277554 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */
alter view "sales_database"."main"."customer_dimension__dbt_tmp" rename to "customer_dimension"
[0m07:17:42.298817 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m07:17:42.367677 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: COMMIT
[0m07:17:42.375724 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m07:17:42.378598 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: COMMIT
[0m07:17:42.419916 [debug] [Thread-1 (]: SQL status: OK in 0.037 seconds
[0m07:17:42.483117 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m07:17:42.489936 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */
drop view if exists "sales_database"."main"."customer_dimension__dbt_backup" cascade
[0m07:17:42.521545 [debug] [Thread-1 (]: SQL status: OK in 0.029 seconds
[0m07:17:42.533812 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: Close
[0m07:17:42.702890 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b8feea8-2bb9-4974-8a58-b83326d2d12c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46d1d2b500>]}
[0m07:17:42.707003 [info ] [Thread-1 (]: 1 of 6 OK created sql view model main.customer_dimension ....................... [[32mOK[0m in 13.49s]
[0m07:17:42.709690 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.customer_dimension
[0m07:17:42.721446 [debug] [Thread-1 (]: Began running node model.my_dbt_project.date_dimension
[0m07:17:42.726166 [info ] [Thread-1 (]: 2 of 6 START sql view model main.date_dimension ................................ [RUN]
[0m07:17:42.742607 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customer_dimension, now model.my_dbt_project.date_dimension)
[0m07:17:42.754466 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.date_dimension
[0m07:17:42.775500 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.date_dimension"
[0m07:17:42.826825 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.date_dimension
[0m07:17:42.866166 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.date_dimension"
[0m07:17:42.895550 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m07:17:42.899677 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: BEGIN
[0m07:17:42.902382 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:17:43.326158 [debug] [Thread-1 (]: SQL status: OK in 0.423 seconds
[0m07:17:43.331199 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m07:17:43.339671 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.date_dimension"} */

  
  create view "sales_database"."main"."date_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
    DISTINCT
    transaction_date AS date_id,
    EXTRACT(YEAR FROM transaction_date) AS year,
    EXTRACT(MONTH FROM transaction_date) AS month,
    EXTRACT(DAY FROM transaction_date) AS day,
    TO_CHAR(transaction_date, 'Day') AS weekday_name,
    EXTRACT(QUARTER FROM transaction_date) AS quarter
FROM sales
WHERE transaction_date IS NOT NULL
  );

[0m07:17:43.546975 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.date_dimension"} */

  
  create view "sales_database"."main"."date_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
    DISTINCT
    transaction_date AS date_id,
    EXTRACT(YEAR FROM transaction_date) AS year,
    EXTRACT(MONTH FROM transaction_date) AS month,
    EXTRACT(DAY FROM transaction_date) AS day,
    TO_CHAR(transaction_date, 'Day') AS weekday_name,
    EXTRACT(QUARTER FROM transaction_date) AS quarter
FROM sales
WHERE transaction_date IS NOT NULL
  );

[0m07:17:43.584851 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m07:17:43.588594 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: ROLLBACK
[0m07:17:43.764098 [debug] [Thread-1 (]: Failed to rollback 'model.my_dbt_project.date_dimension'
[0m07:17:43.766710 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: Close
[0m07:17:43.842709 [debug] [Thread-1 (]: Runtime Error in model date_dimension (models/dimensions/date_dimension.sql)
  Catalog Error: Scalar Function with name to_char does not exist!
  Did you mean "to_hours"?
  LINE 15:     TO_CHAR(transaction_date, 'Day') AS weekday_name,
      EXTRACT(QUARTER FROM transaction_date) AS quarter
  FROM sales
  WHERE transaction_date IS NOT NULL
    );
  ...
               ^
[0m07:17:43.886050 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b8feea8-2bb9-4974-8a58-b83326d2d12c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46d1d856d0>]}
[0m07:17:43.893496 [error] [Thread-1 (]: 2 of 6 ERROR creating sql view model main.date_dimension ....................... [[31mERROR[0m in 1.12s]
[0m07:17:43.909277 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.date_dimension
[0m07:17:43.920727 [debug] [Thread-4 (]: Marking all children of 'model.my_dbt_project.date_dimension' to be skipped because of status 'error'.  Reason: Runtime Error in model date_dimension (models/dimensions/date_dimension.sql)
  Catalog Error: Scalar Function with name to_char does not exist!
  Did you mean "to_hours"?
  LINE 15:     TO_CHAR(transaction_date, 'Day') AS weekday_name,
      EXTRACT(QUARTER FROM transaction_date) AS quarter
  FROM sales
  WHERE transaction_date IS NOT NULL
    );
  ...
               ^.
[0m07:17:43.928455 [debug] [Thread-1 (]: Began running node model.my_dbt_project.product_dimension
[0m07:17:43.966409 [info ] [Thread-1 (]: 3 of 6 START sql view model main.product_dimension ............................. [RUN]
[0m07:17:43.985478 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.date_dimension, now model.my_dbt_project.product_dimension)
[0m07:17:43.998992 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.product_dimension
[0m07:17:44.115017 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.product_dimension"
[0m07:17:44.142921 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.product_dimension
[0m07:17:44.180184 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.product_dimension"
[0m07:17:44.218554 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m07:17:44.220446 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: BEGIN
[0m07:17:44.222461 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:17:45.231481 [debug] [Thread-1 (]: SQL status: OK in 0.996 seconds
[0m07:17:45.240499 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m07:17:45.250322 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.product_dimension"} */

  
  create view "sales_database"."main"."product_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
),

-- Flattening the `items` JSON array using `json_each()`
product AS (
    SELECT 
        sales.name,
        product.value->>'name' AS product_name,
        product.value->>'item_code' AS product_item_code
    FROM sales,
    LATERAL json_each(sales.items) AS product
)

SELECT *
FROM product
WHERE product_name IS NOT NULL;
  );

[0m07:17:45.289288 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.product_dimension"} */

  
  create view "sales_database"."main"."product_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
),

-- Flattening the `items` JSON array using `json_each()`
product AS (
    SELECT 
        sales.name,
        product.value->>'name' AS product_name,
        product.value->>'item_code' AS product_item_code
    FROM sales,
    LATERAL json_each(sales.items) AS product
)

SELECT *
FROM product
WHERE product_name IS NOT NULL;
  );

[0m07:17:45.297877 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m07:17:45.308722 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: ROLLBACK
[0m07:17:45.354727 [debug] [Thread-1 (]: Failed to rollback 'model.my_dbt_project.product_dimension'
[0m07:17:45.356882 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: Close
[0m07:17:45.373281 [debug] [Thread-1 (]: Runtime Error in model product_dimension (models/dimensions/product_dimension.sql)
  Parser Error: syntax error at or near ";"
[0m07:17:45.375440 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b8feea8-2bb9-4974-8a58-b83326d2d12c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46d1defb00>]}
[0m07:17:45.392258 [error] [Thread-1 (]: 3 of 6 ERROR creating sql view model main.product_dimension .................... [[31mERROR[0m in 1.40s]
[0m07:17:45.405144 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.product_dimension
[0m07:17:45.412362 [debug] [Thread-1 (]: Began running node model.my_dbt_project.sales_team_dimension
[0m07:17:45.415201 [debug] [Thread-4 (]: Marking all children of 'model.my_dbt_project.product_dimension' to be skipped because of status 'error'.  Reason: Runtime Error in model product_dimension (models/dimensions/product_dimension.sql)
  Parser Error: syntax error at or near ";".
[0m07:17:45.417430 [info ] [Thread-1 (]: 4 of 6 START sql view model main.sales_team_dimension .......................... [RUN]
[0m07:17:45.422888 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.product_dimension, now model.my_dbt_project.sales_team_dimension)
[0m07:17:45.425118 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.sales_team_dimension
[0m07:17:45.436939 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.sales_team_dimension"
[0m07:17:45.463160 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.sales_team_dimension
[0m07:17:45.485319 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.sales_team_dimension"
[0m07:17:45.523728 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m07:17:45.528233 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: BEGIN
[0m07:17:45.530404 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:17:45.652790 [debug] [Thread-1 (]: SQL status: OK in 0.122 seconds
[0m07:17:45.657305 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m07:17:45.659846 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */

  
  create view "sales_database"."main"."sales_team_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
    DISTINCT
    sales_team->>'name' AS sales_team_id,
    sales_team->>'region' AS sales_team_region
FROM sales
WHERE sales_team IS NOT NULL
  );

[0m07:17:45.721284 [debug] [Thread-1 (]: SQL status: OK in 0.052 seconds
[0m07:17:45.785807 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m07:17:45.788855 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */
alter view "sales_database"."main"."sales_team_dimension" rename to "sales_team_dimension__dbt_backup"
[0m07:17:45.797895 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m07:17:45.822758 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m07:17:45.842158 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */
alter view "sales_database"."main"."sales_team_dimension__dbt_tmp" rename to "sales_team_dimension"
[0m07:17:45.847076 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m07:17:45.977675 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: COMMIT
[0m07:17:46.021830 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m07:17:46.034514 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: COMMIT
[0m07:17:46.089054 [debug] [Thread-1 (]: SQL status: OK in 0.050 seconds
[0m07:17:46.105688 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m07:17:46.115673 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */
drop view if exists "sales_database"."main"."sales_team_dimension__dbt_backup" cascade
[0m07:17:46.132391 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m07:17:46.148153 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: Close
[0m07:17:46.286855 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b8feea8-2bb9-4974-8a58-b83326d2d12c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46b270b140>]}
[0m07:17:46.300380 [info ] [Thread-1 (]: 4 of 6 OK created sql view model main.sales_team_dimension ..................... [[32mOK[0m in 0.86s]
[0m07:17:46.304463 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.sales_team_dimension
[0m07:17:46.316910 [debug] [Thread-1 (]: Began running node model.my_dbt_project.transform_sales
[0m07:17:46.324275 [info ] [Thread-1 (]: 5 of 6 START sql table model main.transform_sales .............................. [RUN]
[0m07:17:46.344025 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.sales_team_dimension, now model.my_dbt_project.transform_sales)
[0m07:17:46.346685 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.transform_sales
[0m07:17:46.409563 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.transform_sales"
[0m07:17:46.449987 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.transform_sales
[0m07:17:46.678659 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.transform_sales"
[0m07:17:46.791051 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m07:17:46.803432 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: BEGIN
[0m07:17:46.810301 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:17:46.944258 [debug] [Thread-1 (]: SQL status: OK in 0.134 seconds
[0m07:17:46.949475 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m07:17:46.953547 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */

  
    
    

    create  table
      "sales_database"."main"."transform_sales__dbt_tmp"
  
    as (
      -- /opt/airflow/dags/dbt_models/transform_users.sql


WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
   *
FROM sales
WHERE name = 'ABC private LTD-0002'
    );
  
  
[0m07:17:47.146842 [debug] [Thread-1 (]: SQL status: OK in 0.188 seconds
[0m07:17:47.230167 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m07:17:47.234414 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */
alter table "sales_database"."main"."transform_sales" rename to "transform_sales__dbt_backup"
[0m07:17:47.242793 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m07:17:47.300721 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m07:17:47.308465 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */
alter table "sales_database"."main"."transform_sales__dbt_tmp" rename to "transform_sales"
[0m07:17:47.312877 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:17:47.335559 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: COMMIT
[0m07:17:47.338164 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m07:17:47.340828 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: COMMIT
[0m07:17:47.378150 [debug] [Thread-1 (]: SQL status: OK in 0.035 seconds
[0m07:17:47.391776 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m07:17:47.393964 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */
drop table if exists "sales_database"."main"."transform_sales__dbt_backup" cascade
[0m07:17:47.402620 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m07:17:47.407591 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: Close
[0m07:17:47.867968 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b8feea8-2bb9-4974-8a58-b83326d2d12c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46b270aa80>]}
[0m07:17:47.883892 [info ] [Thread-1 (]: 5 of 6 OK created sql table model main.transform_sales ......................... [[32mOK[0m in 1.52s]
[0m07:17:47.896218 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.transform_sales
[0m07:17:47.901993 [debug] [Thread-1 (]: Began running node model.my_dbt_project.sales_fact
[0m07:17:47.904775 [info ] [Thread-1 (]: 6 of 6 SKIP relation main.sales_fact ........................................... [[33mSKIP[0m]
[0m07:17:47.912345 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.sales_fact
[0m07:17:47.922226 [debug] [MainThread]: Using duckdb connection "master"
[0m07:17:47.928054 [debug] [MainThread]: On master: BEGIN
[0m07:17:47.931947 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:17:48.043167 [debug] [MainThread]: SQL status: OK in 0.111 seconds
[0m07:17:48.072648 [debug] [MainThread]: On master: COMMIT
[0m07:17:48.076880 [debug] [MainThread]: Using duckdb connection "master"
[0m07:17:48.088060 [debug] [MainThread]: On master: COMMIT
[0m07:17:48.101716 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m07:17:48.118148 [debug] [MainThread]: On master: Close
[0m07:17:48.155784 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:17:48.169753 [debug] [MainThread]: Connection 'create_sales_database_main' was properly closed.
[0m07:17:48.171414 [debug] [MainThread]: Connection 'list_sales_database_main' was properly closed.
[0m07:17:48.174223 [debug] [MainThread]: Connection 'model.my_dbt_project.transform_sales' was properly closed.
[0m07:17:48.178577 [info ] [MainThread]: 
[0m07:17:48.188375 [info ] [MainThread]: Finished running 2 table models, 4 view models in 0 hours 0 minutes and 22.38 seconds (22.38s).
[0m07:17:48.227619 [debug] [MainThread]: Command end result
[0m07:17:48.643786 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m07:17:48.694854 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m07:17:48.758912 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dags/dbt_models/target/run_results.json
[0m07:17:48.760626 [info ] [MainThread]: 
[0m07:17:48.770588 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m07:17:48.785318 [info ] [MainThread]: 
[0m07:17:48.787280 [error] [MainThread]:   Runtime Error in model date_dimension (models/dimensions/date_dimension.sql)
  Catalog Error: Scalar Function with name to_char does not exist!
  Did you mean "to_hours"?
  LINE 15:     TO_CHAR(transaction_date, 'Day') AS weekday_name,
      EXTRACT(QUARTER FROM transaction_date) AS quarter
  FROM sales
  WHERE transaction_date IS NOT NULL
    );
  ...
               ^
[0m07:17:48.789018 [info ] [MainThread]: 
[0m07:17:48.798184 [error] [MainThread]:   Runtime Error in model product_dimension (models/dimensions/product_dimension.sql)
  Parser Error: syntax error at or near ";"
[0m07:17:48.807417 [info ] [MainThread]: 
[0m07:17:48.814065 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=2 SKIP=1 TOTAL=6
[0m07:17:48.824776 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 57.695713, "process_in_blocks": "2391480", "process_kernel_time": 7.745832, "process_mem_max_rss": "133208", "process_out_blocks": "0", "process_user_time": 11.731077}
[0m07:17:48.830277 [debug] [MainThread]: Command `dbt run` failed at 07:17:48.829942 after 57.70 seconds
[0m07:17:48.832928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46d96ed9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46d2a0c200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46d2af88f0>]}
[0m07:17:48.837561 [debug] [MainThread]: Flushing usage events
[0m07:17:50.827922 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:20:47.358707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb27776600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb27e84530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb26edd5b0>]}


============================== 07:20:47.381880 | 578ae1c8-2c00-4288-8807-ebbbd1ff89e5 ==============================
[0m07:20:47.381880 [info ] [MainThread]: Running with dbt=1.9.1
[0m07:20:47.384707 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/profiles.yml', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dags/dbt_models/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt/profiles.yml --target dev', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:20:49.584986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '578ae1c8-2c00-4288-8807-ebbbd1ff89e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb27038980>]}
[0m07:20:49.884127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '578ae1c8-2c00-4288-8807-ebbbd1ff89e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb27168770>]}
[0m07:20:49.926879 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m07:20:50.763022 [debug] [MainThread]: checksum: cac3b9519010e47bfbeb71ca6efb4867dae2858687671594dc23fefc94ecf25d, vars: {}, profile: , target: dev, version: 1.9.1
[0m07:20:51.714887 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:20:51.725521 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:20:51.899640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '578ae1c8-2c00-4288-8807-ebbbd1ff89e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb276e78c0>]}
[0m07:20:52.277347 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m07:20:52.305597 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m07:20:52.471546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '578ae1c8-2c00-4288-8807-ebbbd1ff89e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb268d4c20>]}
[0m07:20:52.473899 [info ] [MainThread]: Found 6 models, 1 source, 424 macros
[0m07:20:52.476338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '578ae1c8-2c00-4288-8807-ebbbd1ff89e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb20cde2d0>]}
[0m07:20:52.486296 [info ] [MainThread]: 
[0m07:20:52.492117 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:20:52.493874 [info ] [MainThread]: 
[0m07:20:52.499486 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m07:20:52.554591 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_sales_database'
[0m07:20:52.975752 [debug] [ThreadPool]: Using duckdb connection "list_sales_database"
[0m07:20:52.988563 [debug] [ThreadPool]: On list_sales_database: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "list_sales_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"sales_database"'
    
  
  
[0m07:20:52.990876 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:21:27.090867 [debug] [ThreadPool]: SQL status: OK in 34.096 seconds
[0m07:21:27.092214 [debug] [ThreadPool]: On list_sales_database: Close
[0m07:21:27.115565 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_database, now create_sales_database_main)
[0m07:21:27.118068 [debug] [ThreadPool]: Creating schema "database: "sales_database"
schema: "main"
"
[0m07:21:27.154193 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m07:21:27.156147 [debug] [ThreadPool]: On create_sales_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "create_sales_database_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='sales_database'
        and type='sqlite'
    
  
[0m07:21:27.158038 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:21:27.314840 [debug] [ThreadPool]: SQL status: OK in 0.156 seconds
[0m07:21:27.323843 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m07:21:27.326093 [debug] [ThreadPool]: On create_sales_database_main: BEGIN
[0m07:21:27.330850 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m07:21:27.333366 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m07:21:27.335812 [debug] [ThreadPool]: On create_sales_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "create_sales_database_main"} */

    
    
        create schema if not exists "sales_database"."main"
    
[0m07:21:27.341124 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m07:21:27.345519 [debug] [ThreadPool]: On create_sales_database_main: COMMIT
[0m07:21:27.347656 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m07:21:27.350067 [debug] [ThreadPool]: On create_sales_database_main: COMMIT
[0m07:21:27.352963 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m07:21:27.357333 [debug] [ThreadPool]: On create_sales_database_main: Close
[0m07:21:27.369490 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_sales_database_main, now list_sales_database_main)
[0m07:21:27.393796 [debug] [ThreadPool]: Using duckdb connection "list_sales_database_main"
[0m07:21:27.396517 [debug] [ThreadPool]: On list_sales_database_main: BEGIN
[0m07:21:27.407364 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:21:27.489927 [debug] [ThreadPool]: SQL status: OK in 0.082 seconds
[0m07:21:27.491951 [debug] [ThreadPool]: Using duckdb connection "list_sales_database_main"
[0m07:21:27.493687 [debug] [ThreadPool]: On list_sales_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "list_sales_database_main"} */
select
      'sales_database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'sales_database'
  
[0m07:21:27.713096 [debug] [ThreadPool]: SQL status: OK in 0.218 seconds
[0m07:21:27.717850 [debug] [ThreadPool]: On list_sales_database_main: ROLLBACK
[0m07:21:27.776916 [debug] [ThreadPool]: Failed to rollback 'list_sales_database_main'
[0m07:21:27.778727 [debug] [ThreadPool]: On list_sales_database_main: Close
[0m07:21:27.794656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '578ae1c8-2c00-4288-8807-ebbbd1ff89e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb26994080>]}
[0m07:21:27.796633 [debug] [MainThread]: Using duckdb connection "master"
[0m07:21:27.798168 [debug] [MainThread]: On master: BEGIN
[0m07:21:27.799637 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:21:27.850915 [debug] [MainThread]: SQL status: OK in 0.051 seconds
[0m07:21:27.852800 [debug] [MainThread]: On master: COMMIT
[0m07:21:27.856701 [debug] [MainThread]: Using duckdb connection "master"
[0m07:21:27.858754 [debug] [MainThread]: On master: COMMIT
[0m07:21:27.861333 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m07:21:27.864170 [debug] [MainThread]: On master: Close
[0m07:21:27.875245 [debug] [Thread-1 (]: Began running node model.my_dbt_project.customer_dimension
[0m07:21:27.877532 [info ] [Thread-1 (]: 1 of 6 START sql view model main.customer_dimension ............................ [RUN]
[0m07:21:27.880356 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.my_dbt_project.customer_dimension'
[0m07:21:27.882482 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.customer_dimension
[0m07:21:27.915204 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.customer_dimension"
[0m07:21:27.934987 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.customer_dimension
[0m07:21:28.120183 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.customer_dimension"
[0m07:21:28.143608 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m07:21:28.145855 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: BEGIN
[0m07:21:28.148454 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m07:21:28.295230 [debug] [Thread-1 (]: SQL status: OK in 0.147 seconds
[0m07:21:28.307570 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m07:21:28.310162 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */

  
  create view "sales_database"."main"."customer_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
    DISTINCT
    customer AS customer_id,
    customer_name,
    customer_address,
    customer_group,
    territory,
    language AS customer_language
FROM sales
WHERE customer IS NOT NULL
  );

[0m07:21:28.318865 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m07:21:28.386470 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m07:21:28.390183 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */
alter view "sales_database"."main"."customer_dimension" rename to "customer_dimension__dbt_backup"
[0m07:21:28.394182 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:21:28.422392 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m07:21:28.427183 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */
alter view "sales_database"."main"."customer_dimension__dbt_tmp" rename to "customer_dimension"
[0m07:21:28.431662 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:21:28.554331 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: COMMIT
[0m07:21:28.557020 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m07:21:28.559265 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: COMMIT
[0m07:21:28.616898 [debug] [Thread-1 (]: SQL status: OK in 0.054 seconds
[0m07:21:28.666093 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m07:21:28.669818 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */
drop view if exists "sales_database"."main"."customer_dimension__dbt_backup" cascade
[0m07:21:28.693670 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m07:21:28.746326 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: Close
[0m07:21:29.180918 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '578ae1c8-2c00-4288-8807-ebbbd1ff89e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb28c57bf0>]}
[0m07:21:29.221261 [info ] [Thread-1 (]: 1 of 6 OK created sql view model main.customer_dimension ....................... [[32mOK[0m in 1.28s]
[0m07:21:29.235692 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.customer_dimension
[0m07:21:29.243316 [debug] [Thread-1 (]: Began running node model.my_dbt_project.date_dimension
[0m07:21:29.253761 [info ] [Thread-1 (]: 2 of 6 START sql view model main.date_dimension ................................ [RUN]
[0m07:21:29.271049 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customer_dimension, now model.my_dbt_project.date_dimension)
[0m07:21:29.286853 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.date_dimension
[0m07:21:29.355334 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.date_dimension"
[0m07:21:29.469790 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.date_dimension
[0m07:21:29.549934 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.date_dimension"
[0m07:21:29.642214 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m07:21:29.650221 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: BEGIN
[0m07:21:29.661720 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:21:29.828365 [debug] [Thread-1 (]: SQL status: OK in 0.167 seconds
[0m07:21:29.832024 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m07:21:29.842208 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.date_dimension"} */

  
  create view "sales_database"."main"."date_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
    DISTINCT
    transaction_date AS date_id,
    EXTRACT(YEAR FROM transaction_date) AS year,
    EXTRACT(MONTH FROM transaction_date) AS month,
    EXTRACT(DAY FROM transaction_date) AS day,
    TO_CHAR(transaction_date, 'Day') AS weekday_name,
    EXTRACT(QUARTER FROM transaction_date) AS quarter
FROM sales
WHERE transaction_date IS NOT NULL
  );

[0m07:21:29.973159 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.date_dimension"} */

  
  create view "sales_database"."main"."date_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
    DISTINCT
    transaction_date AS date_id,
    EXTRACT(YEAR FROM transaction_date) AS year,
    EXTRACT(MONTH FROM transaction_date) AS month,
    EXTRACT(DAY FROM transaction_date) AS day,
    TO_CHAR(transaction_date, 'Day') AS weekday_name,
    EXTRACT(QUARTER FROM transaction_date) AS quarter
FROM sales
WHERE transaction_date IS NOT NULL
  );

[0m07:21:29.976778 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m07:21:29.979399 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: ROLLBACK
[0m07:21:30.066506 [debug] [Thread-1 (]: Failed to rollback 'model.my_dbt_project.date_dimension'
[0m07:21:30.076718 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: Close
[0m07:21:30.132809 [debug] [Thread-1 (]: Runtime Error in model date_dimension (models/dimensions/date_dimension.sql)
  Catalog Error: Scalar Function with name to_char does not exist!
  Did you mean "to_hours"?
  LINE 15:     TO_CHAR(transaction_date, 'Day') AS weekday_name,
      EXTRACT(QUARTER FROM transaction_date) AS quarter
  FROM sales
  WHERE transaction_date IS NOT NULL
    );
  ...
               ^
[0m07:21:30.140603 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '578ae1c8-2c00-4288-8807-ebbbd1ff89e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb13e9a150>]}
[0m07:21:30.150346 [error] [Thread-1 (]: 2 of 6 ERROR creating sql view model main.date_dimension ....................... [[31mERROR[0m in 0.87s]
[0m07:21:30.157433 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.date_dimension
[0m07:21:30.160495 [debug] [Thread-1 (]: Began running node model.my_dbt_project.product_dimension
[0m07:21:30.162848 [debug] [Thread-4 (]: Marking all children of 'model.my_dbt_project.date_dimension' to be skipped because of status 'error'.  Reason: Runtime Error in model date_dimension (models/dimensions/date_dimension.sql)
  Catalog Error: Scalar Function with name to_char does not exist!
  Did you mean "to_hours"?
  LINE 15:     TO_CHAR(transaction_date, 'Day') AS weekday_name,
      EXTRACT(QUARTER FROM transaction_date) AS quarter
  FROM sales
  WHERE transaction_date IS NOT NULL
    );
  ...
               ^.
[0m07:21:30.165138 [info ] [Thread-1 (]: 3 of 6 START sql view model main.product_dimension ............................. [RUN]
[0m07:21:30.172245 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.date_dimension, now model.my_dbt_project.product_dimension)
[0m07:21:30.174239 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.product_dimension
[0m07:21:30.188344 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.product_dimension"
[0m07:21:30.324611 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.product_dimension
[0m07:21:30.391448 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.product_dimension"
[0m07:21:30.444933 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m07:21:30.447051 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: BEGIN
[0m07:21:30.450441 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:21:30.524079 [debug] [Thread-1 (]: SQL status: OK in 0.074 seconds
[0m07:21:30.525796 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m07:21:30.527634 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.product_dimension"} */

  
  create view "sales_database"."main"."product_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
),

-- Flattening the `items` JSON array using `json_each()`
product AS (
    SELECT 
        sales.name,
        product.value->>'name' AS product_name,
        product.value->>'item_code' AS product_item_code
    FROM sales,
    LATERAL json_each(sales.items) AS product
)

SELECT *
FROM product
WHERE product_name IS NOT NULL;
  );

[0m07:21:30.729625 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.product_dimension"} */

  
  create view "sales_database"."main"."product_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
),

-- Flattening the `items` JSON array using `json_each()`
product AS (
    SELECT 
        sales.name,
        product.value->>'name' AS product_name,
        product.value->>'item_code' AS product_item_code
    FROM sales,
    LATERAL json_each(sales.items) AS product
)

SELECT *
FROM product
WHERE product_name IS NOT NULL;
  );

[0m07:21:30.733098 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m07:21:30.734678 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: ROLLBACK
[0m07:21:30.757124 [debug] [Thread-1 (]: Failed to rollback 'model.my_dbt_project.product_dimension'
[0m07:21:30.758403 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: Close
[0m07:21:30.766869 [debug] [Thread-1 (]: Runtime Error in model product_dimension (models/dimensions/product_dimension.sql)
  Parser Error: syntax error at or near ";"
[0m07:21:30.768295 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '578ae1c8-2c00-4288-8807-ebbbd1ff89e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb13ef48f0>]}
[0m07:21:30.770174 [error] [Thread-1 (]: 3 of 6 ERROR creating sql view model main.product_dimension .................... [[31mERROR[0m in 0.60s]
[0m07:21:30.773421 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.product_dimension
[0m07:21:30.775778 [debug] [Thread-1 (]: Began running node model.my_dbt_project.sales_team_dimension
[0m07:21:30.777075 [debug] [Thread-4 (]: Marking all children of 'model.my_dbt_project.product_dimension' to be skipped because of status 'error'.  Reason: Runtime Error in model product_dimension (models/dimensions/product_dimension.sql)
  Parser Error: syntax error at or near ";".
[0m07:21:30.778233 [info ] [Thread-1 (]: 4 of 6 START sql view model main.sales_team_dimension .......................... [RUN]
[0m07:21:30.780367 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.product_dimension, now model.my_dbt_project.sales_team_dimension)
[0m07:21:30.781440 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.sales_team_dimension
[0m07:21:30.787999 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.sales_team_dimension"
[0m07:21:30.800282 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.sales_team_dimension
[0m07:21:30.808767 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.sales_team_dimension"
[0m07:21:30.824939 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m07:21:30.826716 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: BEGIN
[0m07:21:30.828154 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:21:30.899694 [debug] [Thread-1 (]: SQL status: OK in 0.071 seconds
[0m07:21:30.902821 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m07:21:30.909089 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */

  
  create view "sales_database"."main"."sales_team_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
    DISTINCT
    sales_team->>'name' AS sales_team_id,
    sales_team->>'region' AS sales_team_region
FROM sales
WHERE sales_team IS NOT NULL
  );

[0m07:21:31.129317 [debug] [Thread-1 (]: SQL status: OK in 0.218 seconds
[0m07:21:31.135622 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m07:21:31.136998 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */
alter view "sales_database"."main"."sales_team_dimension" rename to "sales_team_dimension__dbt_backup"
[0m07:21:31.220003 [debug] [Thread-1 (]: SQL status: OK in 0.080 seconds
[0m07:21:31.229800 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m07:21:31.231397 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */
alter view "sales_database"."main"."sales_team_dimension__dbt_tmp" rename to "sales_team_dimension"
[0m07:21:31.233847 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:21:31.241541 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: COMMIT
[0m07:21:31.242973 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m07:21:31.244527 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: COMMIT
[0m07:21:31.266317 [debug] [Thread-1 (]: SQL status: OK in 0.020 seconds
[0m07:21:31.281002 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m07:21:31.283468 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */
drop view if exists "sales_database"."main"."sales_team_dimension__dbt_backup" cascade
[0m07:21:31.302507 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m07:21:31.316797 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: Close
[0m07:21:31.548594 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '578ae1c8-2c00-4288-8807-ebbbd1ff89e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb108971d0>]}
[0m07:21:31.659911 [info ] [Thread-1 (]: 4 of 6 OK created sql view model main.sales_team_dimension ..................... [[32mOK[0m in 0.76s]
[0m07:21:31.685312 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.sales_team_dimension
[0m07:21:31.715707 [debug] [Thread-1 (]: Began running node model.my_dbt_project.transform_sales
[0m07:21:31.727511 [info ] [Thread-1 (]: 5 of 6 START sql table model main.transform_sales .............................. [RUN]
[0m07:21:31.799036 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.sales_team_dimension, now model.my_dbt_project.transform_sales)
[0m07:21:32.127664 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.transform_sales
[0m07:21:33.035923 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.transform_sales"
[0m07:21:33.087748 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.transform_sales
[0m07:21:33.271181 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.transform_sales"
[0m07:21:33.302276 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m07:21:33.310321 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: BEGIN
[0m07:21:33.313162 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:21:33.585136 [debug] [Thread-1 (]: SQL status: OK in 0.267 seconds
[0m07:21:33.589990 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m07:21:33.591947 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */

  
    
    

    create  table
      "sales_database"."main"."transform_sales__dbt_tmp"
  
    as (
      -- /opt/airflow/dags/dbt_models/transform_users.sql


WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
   *
FROM sales
WHERE name = 'ABC private LTD-0002'
    );
  
  
[0m07:21:33.668404 [debug] [Thread-1 (]: SQL status: OK in 0.074 seconds
[0m07:21:33.682620 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m07:21:33.684884 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */
alter table "sales_database"."main"."transform_sales" rename to "transform_sales__dbt_backup"
[0m07:21:33.690538 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m07:21:33.702148 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m07:21:33.704052 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */
alter table "sales_database"."main"."transform_sales__dbt_tmp" rename to "transform_sales"
[0m07:21:33.708829 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:21:33.730621 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: COMMIT
[0m07:21:33.732816 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m07:21:33.735018 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: COMMIT
[0m07:21:33.756632 [debug] [Thread-1 (]: SQL status: OK in 0.019 seconds
[0m07:21:33.767317 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m07:21:33.770015 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */
drop table if exists "sales_database"."main"."transform_sales__dbt_backup" cascade
[0m07:21:33.780515 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m07:21:33.785998 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: Close
[0m07:21:33.948110 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '578ae1c8-2c00-4288-8807-ebbbd1ff89e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb1087f470>]}
[0m07:21:33.959695 [info ] [Thread-1 (]: 5 of 6 OK created sql table model main.transform_sales ......................... [[32mOK[0m in 2.20s]
[0m07:21:33.963990 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.transform_sales
[0m07:21:33.969913 [debug] [Thread-1 (]: Began running node model.my_dbt_project.sales_fact
[0m07:21:33.976912 [info ] [Thread-1 (]: 6 of 6 SKIP relation main.sales_fact ........................................... [[33mSKIP[0m]
[0m07:21:33.987047 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.sales_fact
[0m07:21:33.998151 [debug] [MainThread]: Using duckdb connection "master"
[0m07:21:34.007990 [debug] [MainThread]: On master: BEGIN
[0m07:21:34.010360 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:21:34.248468 [debug] [MainThread]: SQL status: OK in 0.238 seconds
[0m07:21:34.250675 [debug] [MainThread]: On master: COMMIT
[0m07:21:34.252767 [debug] [MainThread]: Using duckdb connection "master"
[0m07:21:34.254530 [debug] [MainThread]: On master: COMMIT
[0m07:21:34.259381 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m07:21:34.261763 [debug] [MainThread]: On master: Close
[0m07:21:34.269946 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:21:34.271920 [debug] [MainThread]: Connection 'list_sales_database_main' was properly closed.
[0m07:21:34.273948 [debug] [MainThread]: Connection 'model.my_dbt_project.transform_sales' was properly closed.
[0m07:21:34.277365 [info ] [MainThread]: 
[0m07:21:34.279564 [info ] [MainThread]: Finished running 2 table models, 4 view models in 0 hours 0 minutes and 41.78 seconds (41.78s).
[0m07:21:34.287754 [debug] [MainThread]: Command end result
[0m07:21:34.481695 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m07:21:34.535052 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m07:21:34.587246 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dags/dbt_models/target/run_results.json
[0m07:21:34.592204 [info ] [MainThread]: 
[0m07:21:34.595644 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m07:21:34.603471 [info ] [MainThread]: 
[0m07:21:34.620379 [error] [MainThread]:   Runtime Error in model date_dimension (models/dimensions/date_dimension.sql)
  Catalog Error: Scalar Function with name to_char does not exist!
  Did you mean "to_hours"?
  LINE 15:     TO_CHAR(transaction_date, 'Day') AS weekday_name,
      EXTRACT(QUARTER FROM transaction_date) AS quarter
  FROM sales
  WHERE transaction_date IS NOT NULL
    );
  ...
               ^
[0m07:21:34.641065 [info ] [MainThread]: 
[0m07:21:34.644592 [error] [MainThread]:   Runtime Error in model product_dimension (models/dimensions/product_dimension.sql)
  Parser Error: syntax error at or near ";"
[0m07:21:34.647058 [info ] [MainThread]: 
[0m07:21:34.653562 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=2 SKIP=1 TOTAL=6
[0m07:21:34.676136 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 47.72588, "process_in_blocks": "1817712", "process_kernel_time": 5.137763, "process_mem_max_rss": "129688", "process_out_blocks": "0", "process_user_time": 9.314074}
[0m07:21:34.680978 [debug] [MainThread]: Command `dbt run` failed at 07:21:34.680270 after 47.73 seconds
[0m07:21:34.683426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb273df6b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb2724ee70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb28772ea0>]}
[0m07:21:34.685172 [debug] [MainThread]: Flushing usage events
[0m07:21:37.972406 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:27:50.395102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9223f427e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9225da14f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92244ecda0>]}


============================== 07:27:50.431099 | a05f499d-7cca-41a2-b740-d255a40ebc44 ==============================
[0m07:27:50.431099 [info ] [MainThread]: Running with dbt=1.9.1
[0m07:27:50.434277 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dags/dbt_models/logs', 'profiles_dir': '/opt/airflow/dbt/profiles.yml', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt/profiles.yml --target dev', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m07:27:51.745483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a05f499d-7cca-41a2-b740-d255a40ebc44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92236fad50>]}
[0m07:27:52.067208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a05f499d-7cca-41a2-b740-d255a40ebc44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9223ce8e30>]}
[0m07:27:52.233562 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m07:27:53.142809 [debug] [MainThread]: checksum: cac3b9519010e47bfbeb71ca6efb4867dae2858687671594dc23fefc94ecf25d, vars: {}, profile: , target: dev, version: 1.9.1
[0m07:27:54.274916 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m07:27:54.278061 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/dimensions/date_dimension.sql
[0m07:27:56.076113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a05f499d-7cca-41a2-b740-d255a40ebc44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f921d06ba10>]}
[0m07:27:56.474220 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m07:27:56.532202 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m07:27:56.970795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a05f499d-7cca-41a2-b740-d255a40ebc44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f921d02ce90>]}
[0m07:27:56.973357 [info ] [MainThread]: Found 6 models, 1 source, 424 macros
[0m07:27:56.977357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a05f499d-7cca-41a2-b740-d255a40ebc44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f921d03ab40>]}
[0m07:27:56.984250 [info ] [MainThread]: 
[0m07:27:56.995739 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:27:57.002681 [info ] [MainThread]: 
[0m07:27:57.012647 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m07:27:57.077298 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_sales_database'
[0m07:27:57.554251 [debug] [ThreadPool]: Using duckdb connection "list_sales_database"
[0m07:27:57.565880 [debug] [ThreadPool]: On list_sales_database: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "list_sales_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"sales_database"'
    
  
  
[0m07:27:57.569776 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:27:58.116199 [debug] [ThreadPool]: SQL status: OK in 0.541 seconds
[0m07:27:58.128626 [debug] [ThreadPool]: On list_sales_database: Close
[0m07:27:58.149181 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_database, now create_sales_database_main)
[0m07:27:58.151819 [debug] [ThreadPool]: Creating schema "database: "sales_database"
schema: "main"
"
[0m07:27:58.178772 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m07:27:58.180512 [debug] [ThreadPool]: On create_sales_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "create_sales_database_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='sales_database'
        and type='sqlite'
    
  
[0m07:27:58.182683 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:27:58.287588 [debug] [ThreadPool]: SQL status: OK in 0.105 seconds
[0m07:27:58.295645 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m07:27:58.297760 [debug] [ThreadPool]: On create_sales_database_main: BEGIN
[0m07:27:58.301640 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m07:27:58.305387 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m07:27:58.312406 [debug] [ThreadPool]: On create_sales_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "create_sales_database_main"} */

    
    
        create schema if not exists "sales_database"."main"
    
[0m07:27:58.318872 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m07:27:58.322452 [debug] [ThreadPool]: On create_sales_database_main: COMMIT
[0m07:27:58.332195 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m07:27:58.334910 [debug] [ThreadPool]: On create_sales_database_main: COMMIT
[0m07:27:58.337773 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m07:27:58.339600 [debug] [ThreadPool]: On create_sales_database_main: Close
[0m07:27:58.355885 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_sales_database_main, now list_sales_database_main)
[0m07:27:58.396674 [debug] [ThreadPool]: Using duckdb connection "list_sales_database_main"
[0m07:27:58.400792 [debug] [ThreadPool]: On list_sales_database_main: BEGIN
[0m07:27:58.403847 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:27:58.465684 [debug] [ThreadPool]: SQL status: OK in 0.062 seconds
[0m07:27:58.469716 [debug] [ThreadPool]: Using duckdb connection "list_sales_database_main"
[0m07:27:58.476902 [debug] [ThreadPool]: On list_sales_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "list_sales_database_main"} */
select
      'sales_database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'sales_database'
  
[0m07:27:58.779284 [debug] [ThreadPool]: SQL status: OK in 0.298 seconds
[0m07:27:58.803759 [debug] [ThreadPool]: On list_sales_database_main: ROLLBACK
[0m07:27:58.828279 [debug] [ThreadPool]: Failed to rollback 'list_sales_database_main'
[0m07:27:58.830775 [debug] [ThreadPool]: On list_sales_database_main: Close
[0m07:27:58.891007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a05f499d-7cca-41a2-b740-d255a40ebc44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f922374fe30>]}
[0m07:27:58.894883 [debug] [MainThread]: Using duckdb connection "master"
[0m07:27:58.897085 [debug] [MainThread]: On master: BEGIN
[0m07:27:58.899774 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:27:59.606018 [debug] [MainThread]: SQL status: OK in 0.699 seconds
[0m07:27:59.617925 [debug] [MainThread]: On master: COMMIT
[0m07:27:59.628223 [debug] [MainThread]: Using duckdb connection "master"
[0m07:27:59.641630 [debug] [MainThread]: On master: COMMIT
[0m07:27:59.658044 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m07:27:59.670741 [debug] [MainThread]: On master: Close
[0m07:27:59.821645 [debug] [Thread-1 (]: Began running node model.my_dbt_project.customer_dimension
[0m07:27:59.828258 [info ] [Thread-1 (]: 1 of 6 START sql view model main.customer_dimension ............................ [RUN]
[0m07:27:59.832432 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.my_dbt_project.customer_dimension'
[0m07:27:59.842038 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.customer_dimension
[0m07:27:59.874637 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.customer_dimension"
[0m07:27:59.918542 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.customer_dimension
[0m07:28:00.116207 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.customer_dimension"
[0m07:28:00.144247 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m07:28:00.147028 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: BEGIN
[0m07:28:00.149929 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m07:28:00.816110 [debug] [Thread-1 (]: SQL status: OK in 0.653 seconds
[0m07:28:00.836308 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m07:28:00.845856 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */

  
  create view "sales_database"."main"."customer_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
    DISTINCT
    customer AS customer_id,
    customer_name,
    customer_address,
    customer_group,
    territory,
    language AS customer_language
FROM sales
WHERE customer IS NOT NULL
  );

[0m07:28:01.186662 [debug] [Thread-1 (]: SQL status: OK in 0.317 seconds
[0m07:28:01.229331 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m07:28:01.233309 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */
alter view "sales_database"."main"."customer_dimension" rename to "customer_dimension__dbt_backup"
[0m07:28:01.433682 [debug] [Thread-1 (]: SQL status: OK in 0.191 seconds
[0m07:28:01.455208 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m07:28:01.457918 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */
alter view "sales_database"."main"."customer_dimension__dbt_tmp" rename to "customer_dimension"
[0m07:28:02.449564 [debug] [Thread-1 (]: SQL status: OK in 0.968 seconds
[0m07:28:02.573757 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: COMMIT
[0m07:28:02.596223 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m07:28:02.599354 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: COMMIT
[0m07:28:02.972148 [debug] [Thread-1 (]: SQL status: OK in 0.359 seconds
[0m07:28:03.009068 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m07:28:03.011300 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */
drop view if exists "sales_database"."main"."customer_dimension__dbt_backup" cascade
[0m07:28:03.343255 [debug] [Thread-1 (]: SQL status: OK in 0.309 seconds
[0m07:28:03.391015 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: Close
[0m07:28:04.034446 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a05f499d-7cca-41a2-b740-d255a40ebc44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f921c4cb890>]}
[0m07:28:04.055044 [info ] [Thread-1 (]: 1 of 6 OK created sql view model main.customer_dimension ....................... [[32mOK[0m in 4.16s]
[0m07:28:04.061028 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.customer_dimension
[0m07:28:04.069206 [debug] [Thread-1 (]: Began running node model.my_dbt_project.date_dimension
[0m07:28:04.071986 [info ] [Thread-1 (]: 2 of 6 START sql view model main.date_dimension ................................ [RUN]
[0m07:28:04.089129 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customer_dimension, now model.my_dbt_project.date_dimension)
[0m07:28:04.095308 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.date_dimension
[0m07:28:04.122632 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.date_dimension"
[0m07:28:04.160342 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.date_dimension
[0m07:28:04.229727 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.date_dimension"
[0m07:28:04.325083 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m07:28:04.363781 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: BEGIN
[0m07:28:04.395230 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:28:37.997967 [debug] [Thread-1 (]: SQL status: OK in 33.599 seconds
[0m07:28:38.007219 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m07:28:38.016151 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.date_dimension"} */

  
  create view "sales_database"."main"."date_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
    transaction_date,
    strftime(transaction_date, '%A') AS weekday_name,  -- Extract weekday name
    strftime(transaction_date, '%m') AS month,          -- Extract month (numeric)
    strftime(transaction_date, '%Y') AS year,           -- Extract year
    strftime(transaction_date, '%d') AS day,            -- Extract day
    EXTRACT(QUARTER FROM transaction_date) AS quarter   -- Extract quarter (DuckDB supports EXTRACT for quarters)
FROM sales
WHERE transaction_date IS NOT NULL;
  );

[0m07:28:38.059117 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.date_dimension"} */

  
  create view "sales_database"."main"."date_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
    transaction_date,
    strftime(transaction_date, '%A') AS weekday_name,  -- Extract weekday name
    strftime(transaction_date, '%m') AS month,          -- Extract month (numeric)
    strftime(transaction_date, '%Y') AS year,           -- Extract year
    strftime(transaction_date, '%d') AS day,            -- Extract day
    EXTRACT(QUARTER FROM transaction_date) AS quarter   -- Extract quarter (DuckDB supports EXTRACT for quarters)
FROM sales
WHERE transaction_date IS NOT NULL;
  );

[0m07:28:38.065300 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m07:28:38.084583 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: ROLLBACK
[0m07:28:38.121288 [debug] [Thread-1 (]: Failed to rollback 'model.my_dbt_project.date_dimension'
[0m07:28:38.123449 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: Close
[0m07:28:38.138663 [debug] [Thread-1 (]: Runtime Error in model date_dimension (models/dimensions/date_dimension.sql)
  Parser Error: syntax error at or near ";"
[0m07:28:38.141419 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a05f499d-7cca-41a2-b740-d255a40ebc44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f921c105c10>]}
[0m07:28:38.146309 [error] [Thread-1 (]: 2 of 6 ERROR creating sql view model main.date_dimension ....................... [[31mERROR[0m in 34.06s]
[0m07:28:38.149607 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.date_dimension
[0m07:28:38.151947 [debug] [Thread-1 (]: Began running node model.my_dbt_project.product_dimension
[0m07:28:38.155028 [debug] [Thread-4 (]: Marking all children of 'model.my_dbt_project.date_dimension' to be skipped because of status 'error'.  Reason: Runtime Error in model date_dimension (models/dimensions/date_dimension.sql)
  Parser Error: syntax error at or near ";".
[0m07:28:38.157928 [info ] [Thread-1 (]: 3 of 6 START sql view model main.product_dimension ............................. [RUN]
[0m07:28:38.164619 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.date_dimension, now model.my_dbt_project.product_dimension)
[0m07:28:38.166669 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.product_dimension
[0m07:28:38.177583 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.product_dimension"
[0m07:28:38.208717 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.product_dimension
[0m07:28:38.247292 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.product_dimension"
[0m07:28:38.289078 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m07:28:38.294345 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: BEGIN
[0m07:28:38.297927 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:28:38.523912 [debug] [Thread-1 (]: SQL status: OK in 0.226 seconds
[0m07:28:38.526615 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m07:28:38.544271 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.product_dimension"} */

  
  create view "sales_database"."main"."product_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
),

-- Flattening the `items` JSON array using `json_each()`
product AS (
    SELECT 
        sales.name,
        product.value->>'name' AS product_name,
        product.value->>'item_code' AS product_item_code
    FROM sales,
    LATERAL json_each(sales.items) AS product
)

SELECT *
FROM product
WHERE product_name IS NOT NULL;
  );

[0m07:28:38.563268 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.product_dimension"} */

  
  create view "sales_database"."main"."product_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
),

-- Flattening the `items` JSON array using `json_each()`
product AS (
    SELECT 
        sales.name,
        product.value->>'name' AS product_name,
        product.value->>'item_code' AS product_item_code
    FROM sales,
    LATERAL json_each(sales.items) AS product
)

SELECT *
FROM product
WHERE product_name IS NOT NULL;
  );

[0m07:28:38.569103 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m07:28:38.585288 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: ROLLBACK
[0m07:28:38.614546 [debug] [Thread-1 (]: Failed to rollback 'model.my_dbt_project.product_dimension'
[0m07:28:38.621593 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: Close
[0m07:28:38.767181 [debug] [Thread-1 (]: Runtime Error in model product_dimension (models/dimensions/product_dimension.sql)
  Parser Error: syntax error at or near ";"
[0m07:28:38.804880 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a05f499d-7cca-41a2-b740-d255a40ebc44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f921c4be240>]}
[0m07:28:38.818274 [error] [Thread-1 (]: 3 of 6 ERROR creating sql view model main.product_dimension .................... [[31mERROR[0m in 0.64s]
[0m07:28:38.840115 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.product_dimension
[0m07:28:38.875960 [debug] [Thread-1 (]: Began running node model.my_dbt_project.sales_team_dimension
[0m07:28:38.877708 [debug] [Thread-4 (]: Marking all children of 'model.my_dbt_project.product_dimension' to be skipped because of status 'error'.  Reason: Runtime Error in model product_dimension (models/dimensions/product_dimension.sql)
  Parser Error: syntax error at or near ";".
[0m07:28:38.895578 [info ] [Thread-1 (]: 4 of 6 START sql view model main.sales_team_dimension .......................... [RUN]
[0m07:28:38.929283 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.product_dimension, now model.my_dbt_project.sales_team_dimension)
[0m07:28:38.961089 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.sales_team_dimension
[0m07:28:38.994414 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.sales_team_dimension"
[0m07:28:39.126033 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.sales_team_dimension
[0m07:28:39.217196 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.sales_team_dimension"
[0m07:28:39.326628 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m07:28:39.336443 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: BEGIN
[0m07:28:39.361729 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:28:39.877491 [debug] [Thread-1 (]: SQL status: OK in 0.521 seconds
[0m07:28:39.888668 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m07:28:39.927344 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */

  
  create view "sales_database"."main"."sales_team_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
    DISTINCT
    sales_team->>'name' AS sales_team_id,
    sales_team->>'region' AS sales_team_region
FROM sales
WHERE sales_team IS NOT NULL
  );

[0m07:28:40.022926 [debug] [Thread-1 (]: SQL status: OK in 0.078 seconds
[0m07:28:40.062850 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m07:28:40.065799 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */
alter view "sales_database"."main"."sales_team_dimension" rename to "sales_team_dimension__dbt_backup"
[0m07:28:40.083615 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m07:28:40.121689 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m07:28:40.131618 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */
alter view "sales_database"."main"."sales_team_dimension__dbt_tmp" rename to "sales_team_dimension"
[0m07:28:40.145839 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m07:28:40.185176 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: COMMIT
[0m07:28:40.214847 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m07:28:40.218083 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: COMMIT
[0m07:28:40.267441 [debug] [Thread-1 (]: SQL status: OK in 0.032 seconds
[0m07:28:40.309990 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m07:28:40.314115 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */
drop view if exists "sales_database"."main"."sales_team_dimension__dbt_backup" cascade
[0m07:28:40.374316 [debug] [Thread-1 (]: SQL status: OK in 0.056 seconds
[0m07:28:40.387186 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: Close
[0m07:28:40.611497 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a05f499d-7cca-41a2-b740-d255a40ebc44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f921c4a42f0>]}
[0m07:28:40.625360 [info ] [Thread-1 (]: 4 of 6 OK created sql view model main.sales_team_dimension ..................... [[32mOK[0m in 1.68s]
[0m07:28:40.643374 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.sales_team_dimension
[0m07:28:40.660547 [debug] [Thread-1 (]: Began running node model.my_dbt_project.transform_sales
[0m07:28:40.681666 [info ] [Thread-1 (]: 5 of 6 START sql table model main.transform_sales .............................. [RUN]
[0m07:28:40.696850 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.sales_team_dimension, now model.my_dbt_project.transform_sales)
[0m07:28:40.717225 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.transform_sales
[0m07:28:40.749050 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.transform_sales"
[0m07:28:40.831975 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.transform_sales
[0m07:28:41.157339 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.transform_sales"
[0m07:28:41.214891 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m07:28:41.233251 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: BEGIN
[0m07:28:41.249503 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:28:41.348397 [debug] [Thread-1 (]: SQL status: OK in 0.104 seconds
[0m07:28:41.364267 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m07:28:41.367538 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */

  
    
    

    create  table
      "sales_database"."main"."transform_sales__dbt_tmp"
  
    as (
      -- /opt/airflow/dags/dbt_models/transform_users.sql


WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
   *
FROM sales
WHERE name = 'ABC private LTD-0002'
    );
  
  
[0m07:28:41.526480 [debug] [Thread-1 (]: SQL status: OK in 0.152 seconds
[0m07:28:41.566891 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m07:28:41.582747 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */
alter table "sales_database"."main"."transform_sales" rename to "transform_sales__dbt_backup"
[0m07:28:41.634835 [debug] [Thread-1 (]: SQL status: OK in 0.048 seconds
[0m07:28:41.659862 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m07:28:41.671657 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */
alter table "sales_database"."main"."transform_sales__dbt_tmp" rename to "transform_sales"
[0m07:28:41.688552 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m07:28:41.733424 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: COMMIT
[0m07:28:41.759267 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m07:28:41.764723 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: COMMIT
[0m07:28:41.887902 [debug] [Thread-1 (]: SQL status: OK in 0.108 seconds
[0m07:28:41.971676 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m07:28:41.982277 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */
drop table if exists "sales_database"."main"."transform_sales__dbt_backup" cascade
[0m07:28:42.009290 [debug] [Thread-1 (]: SQL status: OK in 0.018 seconds
[0m07:28:42.031011 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: Close
[0m07:28:42.381906 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a05f499d-7cca-41a2-b740-d255a40ebc44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f921c162d20>]}
[0m07:28:42.389010 [info ] [Thread-1 (]: 5 of 6 OK created sql table model main.transform_sales ......................... [[32mOK[0m in 1.68s]
[0m07:28:42.406826 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.transform_sales
[0m07:28:42.421768 [debug] [Thread-1 (]: Began running node model.my_dbt_project.sales_fact
[0m07:28:42.435731 [info ] [Thread-1 (]: 6 of 6 SKIP relation main.sales_fact ........................................... [[33mSKIP[0m]
[0m07:28:42.450653 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.sales_fact
[0m07:28:42.481988 [debug] [MainThread]: Using duckdb connection "master"
[0m07:28:42.487906 [debug] [MainThread]: On master: BEGIN
[0m07:28:42.500999 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:28:42.720262 [debug] [MainThread]: SQL status: OK in 0.219 seconds
[0m07:28:42.723692 [debug] [MainThread]: On master: COMMIT
[0m07:28:42.725610 [debug] [MainThread]: Using duckdb connection "master"
[0m07:28:42.731174 [debug] [MainThread]: On master: COMMIT
[0m07:28:42.750113 [debug] [MainThread]: SQL status: OK in 0.007 seconds
[0m07:28:42.753338 [debug] [MainThread]: On master: Close
[0m07:28:42.787777 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:28:42.789951 [debug] [MainThread]: Connection 'list_sales_database_main' was properly closed.
[0m07:28:42.803379 [debug] [MainThread]: Connection 'model.my_dbt_project.transform_sales' was properly closed.
[0m07:28:42.806796 [info ] [MainThread]: 
[0m07:28:42.808769 [info ] [MainThread]: Finished running 2 table models, 4 view models in 0 hours 0 minutes and 45.80 seconds (45.80s).
[0m07:28:42.844959 [debug] [MainThread]: Command end result
[0m07:28:43.469516 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m07:28:43.519058 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m07:28:43.647525 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dags/dbt_models/target/run_results.json
[0m07:28:43.650538 [info ] [MainThread]: 
[0m07:28:43.652728 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m07:28:43.673517 [info ] [MainThread]: 
[0m07:28:43.688749 [error] [MainThread]:   Runtime Error in model date_dimension (models/dimensions/date_dimension.sql)
  Parser Error: syntax error at or near ";"
[0m07:28:43.702674 [info ] [MainThread]: 
[0m07:28:43.704922 [error] [MainThread]:   Runtime Error in model product_dimension (models/dimensions/product_dimension.sql)
  Parser Error: syntax error at or near ";"
[0m07:28:43.706593 [info ] [MainThread]: 
[0m07:28:43.723429 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=2 SKIP=1 TOTAL=6
[0m07:28:43.735463 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 54.634052, "process_in_blocks": "2758744", "process_kernel_time": 5.846982, "process_mem_max_rss": "134596", "process_out_blocks": "0", "process_user_time": 11.62364}
[0m07:28:43.762308 [debug] [MainThread]: Command `dbt run` failed at 07:28:43.759782 after 54.66 seconds
[0m07:28:43.765663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f922381fdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f921c5bf3e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f921c5bf1d0>]}
[0m07:28:43.768047 [debug] [MainThread]: Flushing usage events
[0m07:28:46.062731 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:50:40.881492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f895813c230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89597549e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8957ef0ec0>]}


============================== 07:50:40.905971 | 19def0dd-24fc-46a4-b24e-432f1007f93e ==============================
[0m07:50:40.905971 [info ] [MainThread]: Running with dbt=1.9.1
[0m07:50:40.911201 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/profiles.yml', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dags/dbt_models/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt/profiles.yml --target dev', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:50:41.820967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '19def0dd-24fc-46a4-b24e-432f1007f93e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89570fc4a0>]}
[0m07:50:41.924594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '19def0dd-24fc-46a4-b24e-432f1007f93e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89576f2f30>]}
[0m07:50:41.935872 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m07:50:42.131965 [debug] [MainThread]: checksum: cac3b9519010e47bfbeb71ca6efb4867dae2858687671594dc23fefc94ecf25d, vars: {}, profile: , target: dev, version: 1.9.1
[0m07:50:42.570156 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:50:42.573926 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:50:42.749735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '19def0dd-24fc-46a4-b24e-432f1007f93e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8957174200>]}
[0m07:50:42.976534 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m07:50:42.985332 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m07:50:43.059386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '19def0dd-24fc-46a4-b24e-432f1007f93e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89514d2990>]}
[0m07:50:43.060778 [info ] [MainThread]: Found 6 models, 1 source, 424 macros
[0m07:50:43.061959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '19def0dd-24fc-46a4-b24e-432f1007f93e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89515b4530>]}
[0m07:50:43.065452 [info ] [MainThread]: 
[0m07:50:43.066675 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:50:43.067820 [info ] [MainThread]: 
[0m07:50:43.069370 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m07:50:43.077864 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_sales_database'
[0m07:50:43.170931 [debug] [ThreadPool]: Using duckdb connection "list_sales_database"
[0m07:50:43.172205 [debug] [ThreadPool]: On list_sales_database: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "list_sales_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"sales_database"'
    
  
  
[0m07:50:43.173410 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:50:43.213610 [debug] [ThreadPool]: SQL status: OK in 0.040 seconds
[0m07:50:43.216451 [debug] [ThreadPool]: On list_sales_database: Close
[0m07:50:43.222471 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_database, now create_sales_database_main)
[0m07:50:43.223845 [debug] [ThreadPool]: Creating schema "database: "sales_database"
schema: "main"
"
[0m07:50:43.237164 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m07:50:43.238463 [debug] [ThreadPool]: On create_sales_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "create_sales_database_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='sales_database'
        and type='sqlite'
    
  
[0m07:50:43.239524 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:50:43.265555 [debug] [ThreadPool]: SQL status: OK in 0.026 seconds
[0m07:50:43.271551 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m07:50:43.275602 [debug] [ThreadPool]: On create_sales_database_main: BEGIN
[0m07:50:43.278562 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m07:50:43.280326 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m07:50:43.281476 [debug] [ThreadPool]: On create_sales_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "create_sales_database_main"} */

    
    
        create schema if not exists "sales_database"."main"
    
[0m07:50:43.284061 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m07:50:43.286343 [debug] [ThreadPool]: On create_sales_database_main: COMMIT
[0m07:50:43.288173 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m07:50:43.290262 [debug] [ThreadPool]: On create_sales_database_main: COMMIT
[0m07:50:43.293620 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m07:50:43.295083 [debug] [ThreadPool]: On create_sales_database_main: Close
[0m07:50:43.303157 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_sales_database_main, now list_sales_database_main)
[0m07:50:43.315514 [debug] [ThreadPool]: Using duckdb connection "list_sales_database_main"
[0m07:50:43.317200 [debug] [ThreadPool]: On list_sales_database_main: BEGIN
[0m07:50:43.318280 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:50:43.342672 [debug] [ThreadPool]: SQL status: OK in 0.024 seconds
[0m07:50:43.343942 [debug] [ThreadPool]: Using duckdb connection "list_sales_database_main"
[0m07:50:43.345619 [debug] [ThreadPool]: On list_sales_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "list_sales_database_main"} */
select
      'sales_database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'sales_database'
  
[0m07:50:43.413014 [debug] [ThreadPool]: SQL status: OK in 0.066 seconds
[0m07:50:43.417149 [debug] [ThreadPool]: On list_sales_database_main: ROLLBACK
[0m07:50:43.422473 [debug] [ThreadPool]: Failed to rollback 'list_sales_database_main'
[0m07:50:43.424224 [debug] [ThreadPool]: On list_sales_database_main: Close
[0m07:50:43.431320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '19def0dd-24fc-46a4-b24e-432f1007f93e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8953a3e120>]}
[0m07:50:43.432849 [debug] [MainThread]: Using duckdb connection "master"
[0m07:50:43.434100 [debug] [MainThread]: On master: BEGIN
[0m07:50:43.435284 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:50:43.464200 [debug] [MainThread]: SQL status: OK in 0.029 seconds
[0m07:50:43.465347 [debug] [MainThread]: On master: COMMIT
[0m07:50:43.466485 [debug] [MainThread]: Using duckdb connection "master"
[0m07:50:43.467552 [debug] [MainThread]: On master: COMMIT
[0m07:50:43.469216 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m07:50:43.470361 [debug] [MainThread]: On master: Close
[0m07:50:43.476627 [debug] [Thread-1 (]: Began running node model.my_dbt_project.customer_dimension
[0m07:50:43.478384 [info ] [Thread-1 (]: 1 of 6 START sql view model main.customer_dimension ............................ [RUN]
[0m07:50:43.480033 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.my_dbt_project.customer_dimension'
[0m07:50:43.481201 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.customer_dimension
[0m07:50:43.496425 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.customer_dimension"
[0m07:50:43.511872 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.customer_dimension
[0m07:50:43.584156 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.customer_dimension"
[0m07:50:43.598661 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m07:50:43.600188 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: BEGIN
[0m07:50:43.601792 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m07:50:43.628595 [debug] [Thread-1 (]: SQL status: OK in 0.027 seconds
[0m07:50:43.629920 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m07:50:43.631233 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */

  
  create view "sales_database"."main"."customer_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
    DISTINCT
    customer AS customer_id,
    customer_name,
    customer_address,
    customer_group,
    territory,
    language AS customer_language
FROM sales
WHERE customer IS NOT NULL
  );

[0m07:50:43.633941 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:50:43.650364 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m07:50:43.652012 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */
alter view "sales_database"."main"."customer_dimension__dbt_tmp" rename to "customer_dimension"
[0m07:50:43.656591 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m07:50:43.690618 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: COMMIT
[0m07:50:43.694629 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m07:50:43.696412 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: COMMIT
[0m07:50:43.712992 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m07:50:43.733145 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m07:50:43.735260 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */
drop view if exists "sales_database"."main"."customer_dimension__dbt_backup" cascade
[0m07:50:43.739393 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m07:50:43.749400 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: Close
[0m07:50:43.890977 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '19def0dd-24fc-46a4-b24e-432f1007f93e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f895721bd70>]}
[0m07:50:43.895165 [info ] [Thread-1 (]: 1 of 6 OK created sql view model main.customer_dimension ....................... [[32mOK[0m in 0.40s]
[0m07:50:43.899601 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.customer_dimension
[0m07:50:43.902443 [debug] [Thread-1 (]: Began running node model.my_dbt_project.date_dimension
[0m07:50:43.911690 [info ] [Thread-1 (]: 2 of 6 START sql view model main.date_dimension ................................ [RUN]
[0m07:50:43.928265 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customer_dimension, now model.my_dbt_project.date_dimension)
[0m07:50:43.941459 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.date_dimension
[0m07:50:43.953082 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.date_dimension"
[0m07:50:43.984653 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.date_dimension
[0m07:50:44.008870 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.date_dimension"
[0m07:50:44.037346 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m07:50:44.040126 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: BEGIN
[0m07:50:44.042029 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:50:44.094793 [debug] [Thread-1 (]: SQL status: OK in 0.053 seconds
[0m07:50:44.096772 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m07:50:44.099269 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.date_dimension"} */

  
  create view "sales_database"."main"."date_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
    transaction_date,
    strftime(transaction_date, '%A') AS weekday_name,  -- Extract weekday name
    strftime(transaction_date, '%m') AS month,          -- Extract month (numeric)
    strftime(transaction_date, '%Y') AS year,           -- Extract year
    strftime(transaction_date, '%d') AS day,            -- Extract day
    EXTRACT(QUARTER FROM transaction_date) AS quarter   -- Extract quarter (DuckDB supports EXTRACT for quarters)
FROM sales
WHERE transaction_date IS NOT NULL;
  );

[0m07:50:44.130859 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.date_dimension"} */

  
  create view "sales_database"."main"."date_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
    transaction_date,
    strftime(transaction_date, '%A') AS weekday_name,  -- Extract weekday name
    strftime(transaction_date, '%m') AS month,          -- Extract month (numeric)
    strftime(transaction_date, '%Y') AS year,           -- Extract year
    strftime(transaction_date, '%d') AS day,            -- Extract day
    EXTRACT(QUARTER FROM transaction_date) AS quarter   -- Extract quarter (DuckDB supports EXTRACT for quarters)
FROM sales
WHERE transaction_date IS NOT NULL;
  );

[0m07:50:44.135826 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m07:50:44.142219 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: ROLLBACK
[0m07:50:44.178484 [debug] [Thread-1 (]: Failed to rollback 'model.my_dbt_project.date_dimension'
[0m07:50:44.180938 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: Close
[0m07:50:44.204491 [debug] [Thread-1 (]: Runtime Error in model date_dimension (models/dimensions/date_dimension.sql)
  Parser Error: syntax error at or near ";"
[0m07:50:44.207150 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '19def0dd-24fc-46a4-b24e-432f1007f93e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f895074e150>]}
[0m07:50:44.211483 [error] [Thread-1 (]: 2 of 6 ERROR creating sql view model main.date_dimension ....................... [[31mERROR[0m in 0.28s]
[0m07:50:44.217566 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.date_dimension
[0m07:50:44.219959 [debug] [Thread-1 (]: Began running node model.my_dbt_project.product_dimension
[0m07:50:44.230682 [debug] [Thread-4 (]: Marking all children of 'model.my_dbt_project.date_dimension' to be skipped because of status 'error'.  Reason: Runtime Error in model date_dimension (models/dimensions/date_dimension.sql)
  Parser Error: syntax error at or near ";".
[0m07:50:44.228244 [info ] [Thread-1 (]: 3 of 6 START sql view model main.product_dimension ............................. [RUN]
[0m07:50:44.314735 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.date_dimension, now model.my_dbt_project.product_dimension)
[0m07:50:44.318985 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.product_dimension
[0m07:50:44.356603 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.product_dimension"
[0m07:50:44.554141 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.product_dimension
[0m07:50:44.575204 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.product_dimension"
[0m07:50:44.648536 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m07:50:44.650825 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: BEGIN
[0m07:50:44.653168 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:50:44.715011 [debug] [Thread-1 (]: SQL status: OK in 0.062 seconds
[0m07:50:44.719748 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m07:50:44.729514 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.product_dimension"} */

  
  create view "sales_database"."main"."product_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
),

-- Flattening the `items` JSON array using `json_each()`
product AS (
    SELECT 
        sales.name,
        product.value->>'name' AS product_name,
        product.value->>'item_code' AS product_item_code
    FROM sales,
    LATERAL json_each(sales.items) AS product
)

SELECT *
FROM product
WHERE product_name IS NOT NULL;
  );

[0m07:50:44.740126 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.product_dimension"} */

  
  create view "sales_database"."main"."product_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
),

-- Flattening the `items` JSON array using `json_each()`
product AS (
    SELECT 
        sales.name,
        product.value->>'name' AS product_name,
        product.value->>'item_code' AS product_item_code
    FROM sales,
    LATERAL json_each(sales.items) AS product
)

SELECT *
FROM product
WHERE product_name IS NOT NULL;
  );

[0m07:50:44.744078 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m07:50:44.753709 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: ROLLBACK
[0m07:50:44.777891 [debug] [Thread-1 (]: Failed to rollback 'model.my_dbt_project.product_dimension'
[0m07:50:44.802641 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: Close
[0m07:50:44.831326 [debug] [Thread-1 (]: Runtime Error in model product_dimension (models/dimensions/product_dimension.sql)
  Parser Error: syntax error at or near ";"
[0m07:50:44.835780 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '19def0dd-24fc-46a4-b24e-432f1007f93e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89507f8350>]}
[0m07:50:44.851253 [error] [Thread-1 (]: 3 of 6 ERROR creating sql view model main.product_dimension .................... [[31mERROR[0m in 0.52s]
[0m07:50:44.855958 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.product_dimension
[0m07:50:44.859234 [debug] [Thread-1 (]: Began running node model.my_dbt_project.sales_team_dimension
[0m07:50:44.863101 [debug] [Thread-4 (]: Marking all children of 'model.my_dbt_project.product_dimension' to be skipped because of status 'error'.  Reason: Runtime Error in model product_dimension (models/dimensions/product_dimension.sql)
  Parser Error: syntax error at or near ";".
[0m07:50:44.867795 [info ] [Thread-1 (]: 4 of 6 START sql view model main.sales_team_dimension .......................... [RUN]
[0m07:50:44.877736 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.product_dimension, now model.my_dbt_project.sales_team_dimension)
[0m07:50:44.884641 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.sales_team_dimension
[0m07:50:44.897394 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.sales_team_dimension"
[0m07:50:44.928426 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.sales_team_dimension
[0m07:50:44.950352 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.sales_team_dimension"
[0m07:50:45.059535 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m07:50:45.062052 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: BEGIN
[0m07:50:45.065592 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:50:45.130896 [debug] [Thread-1 (]: SQL status: OK in 0.065 seconds
[0m07:50:45.132882 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m07:50:45.134785 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */

  
  create view "sales_database"."main"."sales_team_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
    DISTINCT
    sales_team->>'name' AS sales_team_id,
    sales_team->>'region' AS sales_team_region
FROM sales
WHERE sales_team IS NOT NULL
  );

[0m07:50:45.142477 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m07:50:45.158019 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m07:50:45.160515 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */
alter view "sales_database"."main"."sales_team_dimension__dbt_tmp" rename to "sales_team_dimension"
[0m07:50:45.164062 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:50:45.172338 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: COMMIT
[0m07:50:45.174397 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m07:50:45.176699 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: COMMIT
[0m07:50:45.195052 [debug] [Thread-1 (]: SQL status: OK in 0.015 seconds
[0m07:50:45.207973 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m07:50:45.209895 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */
drop view if exists "sales_database"."main"."sales_team_dimension__dbt_backup" cascade
[0m07:50:45.212852 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:50:45.217557 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: Close
[0m07:50:45.266912 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '19def0dd-24fc-46a4-b24e-432f1007f93e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89508b0c80>]}
[0m07:50:45.269015 [info ] [Thread-1 (]: 4 of 6 OK created sql view model main.sales_team_dimension ..................... [[32mOK[0m in 0.39s]
[0m07:50:45.271573 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.sales_team_dimension
[0m07:50:45.273535 [debug] [Thread-1 (]: Began running node model.my_dbt_project.transform_sales
[0m07:50:45.276065 [info ] [Thread-1 (]: 5 of 6 START sql table model main.transform_sales .............................. [RUN]
[0m07:50:45.285810 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.sales_team_dimension, now model.my_dbt_project.transform_sales)
[0m07:50:45.295031 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.transform_sales
[0m07:50:45.306126 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.transform_sales"
[0m07:50:45.324775 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.transform_sales
[0m07:50:45.394535 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.transform_sales"
[0m07:50:45.410058 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m07:50:45.411766 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: BEGIN
[0m07:50:45.413569 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:50:45.468099 [debug] [Thread-1 (]: SQL status: OK in 0.054 seconds
[0m07:50:45.470990 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m07:50:45.473563 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */

  
    
    

    create  table
      "sales_database"."main"."transform_sales__dbt_tmp"
  
    as (
      -- /opt/airflow/dags/dbt_models/transform_users.sql


WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
   *
FROM sales
WHERE name = 'ABC private LTD-0002'
    );
  
  
[0m07:50:45.544399 [debug] [Thread-1 (]: SQL status: OK in 0.069 seconds
[0m07:50:45.585978 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m07:50:45.595413 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */
alter table "sales_database"."main"."transform_sales__dbt_tmp" rename to "transform_sales"
[0m07:50:45.604201 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m07:50:45.653448 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: COMMIT
[0m07:50:45.655874 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m07:50:45.659496 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: COMMIT
[0m07:50:45.678317 [debug] [Thread-1 (]: SQL status: OK in 0.016 seconds
[0m07:50:45.691440 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m07:50:45.694233 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */
drop table if exists "sales_database"."main"."transform_sales__dbt_backup" cascade
[0m07:50:45.701166 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m07:50:45.708048 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: Close
[0m07:50:45.874451 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '19def0dd-24fc-46a4-b24e-432f1007f93e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8950434d10>]}
[0m07:50:45.878520 [info ] [Thread-1 (]: 5 of 6 OK created sql table model main.transform_sales ......................... [[32mOK[0m in 0.59s]
[0m07:50:45.883943 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.transform_sales
[0m07:50:45.887355 [debug] [Thread-1 (]: Began running node model.my_dbt_project.sales_fact
[0m07:50:45.891983 [info ] [Thread-1 (]: 6 of 6 SKIP relation main.sales_fact ........................................... [[33mSKIP[0m]
[0m07:50:45.895308 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.sales_fact
[0m07:50:45.901794 [debug] [MainThread]: Using duckdb connection "master"
[0m07:50:45.903520 [debug] [MainThread]: On master: BEGIN
[0m07:50:45.905281 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:50:46.059603 [debug] [MainThread]: SQL status: OK in 0.154 seconds
[0m07:50:46.083758 [debug] [MainThread]: On master: COMMIT
[0m07:50:46.087949 [debug] [MainThread]: Using duckdb connection "master"
[0m07:50:46.089958 [debug] [MainThread]: On master: COMMIT
[0m07:50:46.092199 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m07:50:46.102195 [debug] [MainThread]: On master: Close
[0m07:50:46.137418 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:50:46.142985 [debug] [MainThread]: Connection 'list_sales_database_main' was properly closed.
[0m07:50:46.151421 [debug] [MainThread]: Connection 'model.my_dbt_project.transform_sales' was properly closed.
[0m07:50:46.166448 [info ] [MainThread]: 
[0m07:50:46.170857 [info ] [MainThread]: Finished running 2 table models, 4 view models in 0 hours 0 minutes and 3.10 seconds (3.10s).
[0m07:50:46.180190 [debug] [MainThread]: Command end result
[0m07:50:46.375776 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m07:50:46.392702 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m07:50:46.423288 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dags/dbt_models/target/run_results.json
[0m07:50:46.424517 [info ] [MainThread]: 
[0m07:50:46.426956 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m07:50:46.428482 [info ] [MainThread]: 
[0m07:50:46.430353 [error] [MainThread]:   Runtime Error in model date_dimension (models/dimensions/date_dimension.sql)
  Parser Error: syntax error at or near ";"
[0m07:50:46.432917 [info ] [MainThread]: 
[0m07:50:46.435003 [error] [MainThread]:   Runtime Error in model product_dimension (models/dimensions/product_dimension.sql)
  Parser Error: syntax error at or near ";"
[0m07:50:46.436628 [info ] [MainThread]: 
[0m07:50:46.439401 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=2 SKIP=1 TOTAL=6
[0m07:50:46.443947 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 5.8668733, "process_in_blocks": "139392", "process_kernel_time": 1.087532, "process_mem_max_rss": "141860", "process_out_blocks": "0", "process_user_time": 8.972145}
[0m07:50:46.450908 [debug] [MainThread]: Command `dbt run` failed at 07:50:46.450564 after 5.87 seconds
[0m07:50:46.452452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f895af1b5c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f895777ede0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f895777e0f0>]}
[0m07:50:46.454158 [debug] [MainThread]: Flushing usage events
[0m07:50:48.280016 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:52:08.724820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f738dd7e9f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f738fab1670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f738dd7e810>]}


============================== 07:52:08.738329 | c732e2d7-3124-4d0e-afc5-1ece518b442f ==============================
[0m07:52:08.738329 [info ] [MainThread]: Running with dbt=1.9.1
[0m07:52:08.740505 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/profiles.yml', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dags/dbt_models/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt/profiles.yml --target dev', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m07:52:09.350883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c732e2d7-3124-4d0e-afc5-1ece518b442f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f738dd2c110>]}
[0m07:52:09.463032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c732e2d7-3124-4d0e-afc5-1ece518b442f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f738de36c30>]}
[0m07:52:09.474259 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m07:52:09.668523 [debug] [MainThread]: checksum: cac3b9519010e47bfbeb71ca6efb4867dae2858687671594dc23fefc94ecf25d, vars: {}, profile: , target: dev, version: 1.9.1
[0m07:52:10.065256 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:52:10.066633 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:52:10.143254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c732e2d7-3124-4d0e-afc5-1ece518b442f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7388566bd0>]}
[0m07:52:10.319928 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m07:52:10.332448 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m07:52:10.419542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c732e2d7-3124-4d0e-afc5-1ece518b442f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f738dc65040>]}
[0m07:52:10.421129 [info ] [MainThread]: Found 6 models, 1 source, 424 macros
[0m07:52:10.422634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c732e2d7-3124-4d0e-afc5-1ece518b442f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f738851d6d0>]}
[0m07:52:10.426076 [info ] [MainThread]: 
[0m07:52:10.428831 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:52:10.430251 [info ] [MainThread]: 
[0m07:52:10.431929 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m07:52:10.440913 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_sales_database'
[0m07:52:10.585269 [debug] [ThreadPool]: Using duckdb connection "list_sales_database"
[0m07:52:10.586928 [debug] [ThreadPool]: On list_sales_database: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "list_sales_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"sales_database"'
    
  
  
[0m07:52:10.588310 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:52:10.680046 [debug] [ThreadPool]: SQL status: OK in 0.092 seconds
[0m07:52:10.688128 [debug] [ThreadPool]: On list_sales_database: Close
[0m07:52:10.698767 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_database, now create_sales_database_main)
[0m07:52:10.706095 [debug] [ThreadPool]: Creating schema "database: "sales_database"
schema: "main"
"
[0m07:52:10.733635 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m07:52:10.738350 [debug] [ThreadPool]: On create_sales_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "create_sales_database_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='sales_database'
        and type='sqlite'
    
  
[0m07:52:10.740292 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:52:10.774425 [debug] [ThreadPool]: SQL status: OK in 0.034 seconds
[0m07:52:10.777168 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m07:52:10.778598 [debug] [ThreadPool]: On create_sales_database_main: BEGIN
[0m07:52:10.780545 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m07:52:10.782589 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m07:52:10.784117 [debug] [ThreadPool]: On create_sales_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "create_sales_database_main"} */

    
    
        create schema if not exists "sales_database"."main"
    
[0m07:52:10.786518 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m07:52:10.788405 [debug] [ThreadPool]: On create_sales_database_main: COMMIT
[0m07:52:10.789413 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m07:52:10.790285 [debug] [ThreadPool]: On create_sales_database_main: COMMIT
[0m07:52:10.791819 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m07:52:10.792787 [debug] [ThreadPool]: On create_sales_database_main: Close
[0m07:52:10.799839 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_sales_database_main, now list_sales_database_main)
[0m07:52:10.809889 [debug] [ThreadPool]: Using duckdb connection "list_sales_database_main"
[0m07:52:10.812356 [debug] [ThreadPool]: On list_sales_database_main: BEGIN
[0m07:52:10.813693 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:52:10.852834 [debug] [ThreadPool]: SQL status: OK in 0.039 seconds
[0m07:52:10.853932 [debug] [ThreadPool]: Using duckdb connection "list_sales_database_main"
[0m07:52:10.854947 [debug] [ThreadPool]: On list_sales_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "list_sales_database_main"} */
select
      'sales_database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'sales_database'
  
[0m07:52:10.912324 [debug] [ThreadPool]: SQL status: OK in 0.056 seconds
[0m07:52:10.916001 [debug] [ThreadPool]: On list_sales_database_main: ROLLBACK
[0m07:52:10.919250 [debug] [ThreadPool]: Failed to rollback 'list_sales_database_main'
[0m07:52:10.920329 [debug] [ThreadPool]: On list_sales_database_main: Close
[0m07:52:10.927023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c732e2d7-3124-4d0e-afc5-1ece518b442f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f738dcbbef0>]}
[0m07:52:10.928813 [debug] [MainThread]: Using duckdb connection "master"
[0m07:52:10.930344 [debug] [MainThread]: On master: BEGIN
[0m07:52:10.932001 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:52:10.960949 [debug] [MainThread]: SQL status: OK in 0.029 seconds
[0m07:52:10.963922 [debug] [MainThread]: On master: COMMIT
[0m07:52:10.964998 [debug] [MainThread]: Using duckdb connection "master"
[0m07:52:10.965996 [debug] [MainThread]: On master: COMMIT
[0m07:52:10.967599 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m07:52:10.968642 [debug] [MainThread]: On master: Close
[0m07:52:10.975046 [debug] [Thread-1 (]: Began running node model.my_dbt_project.customer_dimension
[0m07:52:10.976441 [info ] [Thread-1 (]: 1 of 6 START sql view model main.customer_dimension ............................ [RUN]
[0m07:52:10.979396 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.my_dbt_project.customer_dimension'
[0m07:52:10.980929 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.customer_dimension
[0m07:52:10.993763 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.customer_dimension"
[0m07:52:11.009436 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.customer_dimension
[0m07:52:11.072074 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.customer_dimension"
[0m07:52:11.092804 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m07:52:11.094435 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: BEGIN
[0m07:52:11.097223 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m07:52:11.144287 [debug] [Thread-1 (]: SQL status: OK in 0.047 seconds
[0m07:52:11.147619 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m07:52:11.150137 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */

  
  create view "sales_database"."main"."customer_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
    DISTINCT
    customer AS customer_id,
    customer_name,
    customer_address,
    customer_group,
    territory,
    language AS customer_language
FROM sales
WHERE customer IS NOT NULL
  );

[0m07:52:11.154638 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m07:52:11.176799 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m07:52:11.180070 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */
alter view "sales_database"."main"."customer_dimension" rename to "customer_dimension__dbt_backup"
[0m07:52:11.183396 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:52:11.192832 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m07:52:11.196256 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */
alter view "sales_database"."main"."customer_dimension__dbt_tmp" rename to "customer_dimension"
[0m07:52:11.199231 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:52:11.256509 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: COMMIT
[0m07:52:11.260240 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m07:52:11.272745 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: COMMIT
[0m07:52:11.326138 [debug] [Thread-1 (]: SQL status: OK in 0.051 seconds
[0m07:52:11.376399 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m07:52:11.382522 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */
drop view if exists "sales_database"."main"."customer_dimension__dbt_backup" cascade
[0m07:52:11.391161 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m07:52:11.406198 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: Close
[0m07:52:11.529954 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c732e2d7-3124-4d0e-afc5-1ece518b442f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7383321970>]}
[0m07:52:11.536041 [info ] [Thread-1 (]: 1 of 6 OK created sql view model main.customer_dimension ....................... [[32mOK[0m in 0.54s]
[0m07:52:11.539775 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.customer_dimension
[0m07:52:11.542399 [debug] [Thread-1 (]: Began running node model.my_dbt_project.date_dimension
[0m07:52:11.545092 [info ] [Thread-1 (]: 2 of 6 START sql view model main.date_dimension ................................ [RUN]
[0m07:52:11.548760 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customer_dimension, now model.my_dbt_project.date_dimension)
[0m07:52:11.550138 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.date_dimension
[0m07:52:11.556875 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.date_dimension"
[0m07:52:11.571576 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.date_dimension
[0m07:52:11.583276 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.date_dimension"
[0m07:52:11.598019 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m07:52:11.599261 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: BEGIN
[0m07:52:11.600383 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:52:11.632895 [debug] [Thread-1 (]: SQL status: OK in 0.032 seconds
[0m07:52:11.635258 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m07:52:11.637393 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.date_dimension"} */

  
  create view "sales_database"."main"."date_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
    transaction_date,
    strftime(transaction_date, '%A') AS weekday_name,  -- Extract weekday name
    strftime(transaction_date, '%m') AS month,          -- Extract month (numeric)
    strftime(transaction_date, '%Y') AS year,           -- Extract year
    strftime(transaction_date, '%d') AS day,            -- Extract day
    EXTRACT(QUARTER FROM transaction_date) AS quarter   -- Extract quarter (DuckDB supports EXTRACT for quarters)
FROM sales
WHERE transaction_date IS NOT NULL;
  );

[0m07:52:11.655285 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.date_dimension"} */

  
  create view "sales_database"."main"."date_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
    transaction_date,
    strftime(transaction_date, '%A') AS weekday_name,  -- Extract weekday name
    strftime(transaction_date, '%m') AS month,          -- Extract month (numeric)
    strftime(transaction_date, '%Y') AS year,           -- Extract year
    strftime(transaction_date, '%d') AS day,            -- Extract day
    EXTRACT(QUARTER FROM transaction_date) AS quarter   -- Extract quarter (DuckDB supports EXTRACT for quarters)
FROM sales
WHERE transaction_date IS NOT NULL;
  );

[0m07:52:11.657176 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m07:52:11.659121 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: ROLLBACK
[0m07:52:11.678895 [debug] [Thread-1 (]: Failed to rollback 'model.my_dbt_project.date_dimension'
[0m07:52:11.680827 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: Close
[0m07:52:11.689844 [debug] [Thread-1 (]: Runtime Error in model date_dimension (models/dimensions/date_dimension.sql)
  Parser Error: syntax error at or near ";"
[0m07:52:11.691290 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c732e2d7-3124-4d0e-afc5-1ece518b442f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73815ce060>]}
[0m07:52:11.692894 [error] [Thread-1 (]: 2 of 6 ERROR creating sql view model main.date_dimension ....................... [[31mERROR[0m in 0.14s]
[0m07:52:11.694767 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.date_dimension
[0m07:52:11.696871 [debug] [Thread-1 (]: Began running node model.my_dbt_project.product_dimension
[0m07:52:11.698455 [debug] [Thread-4 (]: Marking all children of 'model.my_dbt_project.date_dimension' to be skipped because of status 'error'.  Reason: Runtime Error in model date_dimension (models/dimensions/date_dimension.sql)
  Parser Error: syntax error at or near ";".
[0m07:52:11.700153 [info ] [Thread-1 (]: 3 of 6 START sql view model main.product_dimension ............................. [RUN]
[0m07:52:11.703173 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.date_dimension, now model.my_dbt_project.product_dimension)
[0m07:52:11.704323 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.product_dimension
[0m07:52:11.709594 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.product_dimension"
[0m07:52:11.723599 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.product_dimension
[0m07:52:11.734993 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.product_dimension"
[0m07:52:11.750082 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m07:52:11.751293 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: BEGIN
[0m07:52:11.752532 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:52:11.781162 [debug] [Thread-1 (]: SQL status: OK in 0.029 seconds
[0m07:52:11.782426 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m07:52:11.783630 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.product_dimension"} */

  
  create view "sales_database"."main"."product_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
),

-- Flattening the `items` JSON array using `json_each()`
product AS (
    SELECT 
        sales.name,
        product.value->>'name' AS product_name,
        product.value->>'item_code' AS product_item_code
    FROM sales,
    LATERAL json_each(sales.items) AS product
)

SELECT *
FROM product
WHERE product_name IS NOT NULL;
  );

[0m07:52:11.785277 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.product_dimension"} */

  
  create view "sales_database"."main"."product_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
),

-- Flattening the `items` JSON array using `json_each()`
product AS (
    SELECT 
        sales.name,
        product.value->>'name' AS product_name,
        product.value->>'item_code' AS product_item_code
    FROM sales,
    LATERAL json_each(sales.items) AS product
)

SELECT *
FROM product
WHERE product_name IS NOT NULL;
  );

[0m07:52:11.786492 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m07:52:11.787787 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: ROLLBACK
[0m07:52:11.793301 [debug] [Thread-1 (]: Failed to rollback 'model.my_dbt_project.product_dimension'
[0m07:52:11.794456 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: Close
[0m07:52:11.802172 [debug] [Thread-1 (]: Runtime Error in model product_dimension (models/dimensions/product_dimension.sql)
  Parser Error: syntax error at or near ";"
[0m07:52:11.803429 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c732e2d7-3124-4d0e-afc5-1ece518b442f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7381637bc0>]}
[0m07:52:11.804929 [error] [Thread-1 (]: 3 of 6 ERROR creating sql view model main.product_dimension .................... [[31mERROR[0m in 0.10s]
[0m07:52:11.806887 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.product_dimension
[0m07:52:11.808041 [debug] [Thread-1 (]: Began running node model.my_dbt_project.sales_team_dimension
[0m07:52:11.809198 [debug] [Thread-4 (]: Marking all children of 'model.my_dbt_project.product_dimension' to be skipped because of status 'error'.  Reason: Runtime Error in model product_dimension (models/dimensions/product_dimension.sql)
  Parser Error: syntax error at or near ";".
[0m07:52:11.810240 [info ] [Thread-1 (]: 4 of 6 START sql view model main.sales_team_dimension .......................... [RUN]
[0m07:52:11.813103 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.product_dimension, now model.my_dbt_project.sales_team_dimension)
[0m07:52:11.814293 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.sales_team_dimension
[0m07:52:11.819418 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.sales_team_dimension"
[0m07:52:11.831036 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.sales_team_dimension
[0m07:52:11.838175 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.sales_team_dimension"
[0m07:52:11.853020 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m07:52:11.854909 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: BEGIN
[0m07:52:11.856268 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:52:11.883800 [debug] [Thread-1 (]: SQL status: OK in 0.028 seconds
[0m07:52:11.885259 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m07:52:11.886881 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */

  
  create view "sales_database"."main"."sales_team_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
    DISTINCT
    sales_team->>'name' AS sales_team_id,
    sales_team->>'region' AS sales_team_region
FROM sales
WHERE sales_team IS NOT NULL
  );

[0m07:52:11.889738 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:52:11.896569 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m07:52:11.897951 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */
alter view "sales_database"."main"."sales_team_dimension" rename to "sales_team_dimension__dbt_backup"
[0m07:52:11.900279 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:52:11.906165 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m07:52:11.907370 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */
alter view "sales_database"."main"."sales_team_dimension__dbt_tmp" rename to "sales_team_dimension"
[0m07:52:11.909258 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:52:11.917183 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: COMMIT
[0m07:52:11.918517 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m07:52:11.919726 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: COMMIT
[0m07:52:11.930293 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m07:52:11.938143 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m07:52:11.939751 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */
drop view if exists "sales_database"."main"."sales_team_dimension__dbt_backup" cascade
[0m07:52:11.944962 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m07:52:11.951108 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: Close
[0m07:52:12.004252 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c732e2d7-3124-4d0e-afc5-1ece518b442f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f738164ef30>]}
[0m07:52:12.006977 [info ] [Thread-1 (]: 4 of 6 OK created sql view model main.sales_team_dimension ..................... [[32mOK[0m in 0.19s]
[0m07:52:12.010795 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.sales_team_dimension
[0m07:52:12.014767 [debug] [Thread-1 (]: Began running node model.my_dbt_project.transform_sales
[0m07:52:12.017850 [info ] [Thread-1 (]: 5 of 6 START sql table model main.transform_sales .............................. [RUN]
[0m07:52:12.026391 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.sales_team_dimension, now model.my_dbt_project.transform_sales)
[0m07:52:12.029211 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.transform_sales
[0m07:52:12.039286 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.transform_sales"
[0m07:52:12.056179 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.transform_sales
[0m07:52:12.110707 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.transform_sales"
[0m07:52:12.125769 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m07:52:12.127742 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: BEGIN
[0m07:52:12.130103 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:52:12.159123 [debug] [Thread-1 (]: SQL status: OK in 0.029 seconds
[0m07:52:12.160860 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m07:52:12.163427 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */

  
    
    

    create  table
      "sales_database"."main"."transform_sales__dbt_tmp"
  
    as (
      -- /opt/airflow/dags/dbt_models/transform_users.sql


WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
   *
FROM sales
WHERE name = 'ABC private LTD-0002'
    );
  
  
[0m07:52:12.272145 [debug] [Thread-1 (]: SQL status: OK in 0.107 seconds
[0m07:52:12.281229 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m07:52:12.282959 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */
alter table "sales_database"."main"."transform_sales" rename to "transform_sales__dbt_backup"
[0m07:52:12.285706 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:52:12.294663 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m07:52:12.297752 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */
alter table "sales_database"."main"."transform_sales__dbt_tmp" rename to "transform_sales"
[0m07:52:12.300925 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:52:12.318447 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: COMMIT
[0m07:52:12.320255 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m07:52:12.321966 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: COMMIT
[0m07:52:12.365362 [debug] [Thread-1 (]: SQL status: OK in 0.042 seconds
[0m07:52:12.370410 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m07:52:12.371717 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */
drop table if exists "sales_database"."main"."transform_sales__dbt_backup" cascade
[0m07:52:12.391104 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m07:52:12.410706 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: Close
[0m07:52:12.601337 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c732e2d7-3124-4d0e-afc5-1ece518b442f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f738166f110>]}
[0m07:52:12.604034 [info ] [Thread-1 (]: 5 of 6 OK created sql table model main.transform_sales ......................... [[32mOK[0m in 0.58s]
[0m07:52:12.607402 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.transform_sales
[0m07:52:12.609666 [debug] [Thread-1 (]: Began running node model.my_dbt_project.sales_fact
[0m07:52:12.612063 [info ] [Thread-1 (]: 6 of 6 SKIP relation main.sales_fact ........................................... [[33mSKIP[0m]
[0m07:52:12.614996 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.sales_fact
[0m07:52:12.619577 [debug] [MainThread]: Using duckdb connection "master"
[0m07:52:12.621226 [debug] [MainThread]: On master: BEGIN
[0m07:52:12.623171 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:52:12.685960 [debug] [MainThread]: SQL status: OK in 0.063 seconds
[0m07:52:12.690067 [debug] [MainThread]: On master: COMMIT
[0m07:52:12.694191 [debug] [MainThread]: Using duckdb connection "master"
[0m07:52:12.698210 [debug] [MainThread]: On master: COMMIT
[0m07:52:12.700806 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m07:52:12.702528 [debug] [MainThread]: On master: Close
[0m07:52:12.707919 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:52:12.709677 [debug] [MainThread]: Connection 'list_sales_database_main' was properly closed.
[0m07:52:12.711619 [debug] [MainThread]: Connection 'model.my_dbt_project.transform_sales' was properly closed.
[0m07:52:12.714225 [info ] [MainThread]: 
[0m07:52:12.716303 [info ] [MainThread]: Finished running 2 table models, 4 view models in 0 hours 0 minutes and 2.28 seconds (2.28s).
[0m07:52:12.722655 [debug] [MainThread]: Command end result
[0m07:52:12.837488 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m07:52:12.937541 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m07:52:12.984440 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dags/dbt_models/target/run_results.json
[0m07:52:12.985921 [info ] [MainThread]: 
[0m07:52:12.987829 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m07:52:12.989824 [info ] [MainThread]: 
[0m07:52:12.991332 [error] [MainThread]:   Runtime Error in model date_dimension (models/dimensions/date_dimension.sql)
  Parser Error: syntax error at or near ";"
[0m07:52:12.992843 [info ] [MainThread]: 
[0m07:52:12.994573 [error] [MainThread]:   Runtime Error in model product_dimension (models/dimensions/product_dimension.sql)
  Parser Error: syntax error at or near ";"
[0m07:52:12.996240 [info ] [MainThread]: 
[0m07:52:12.999165 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=2 SKIP=1 TOTAL=6
[0m07:52:13.004340 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 4.4560466, "process_in_blocks": "96848", "process_kernel_time": 0.807858, "process_mem_max_rss": "159824", "process_out_blocks": "0", "process_user_time": 6.620498}
[0m07:52:13.006120 [debug] [MainThread]: Command `dbt run` failed at 07:52:13.005866 after 4.46 seconds
[0m07:52:13.007512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f738dd7ec00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f738dd0b6e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f738dd0b650>]}
[0m07:52:13.009069 [debug] [MainThread]: Flushing usage events
[0m07:52:15.861441 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:55:18.981869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ef7592630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ef798fa10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ef7924cb0>]}


============================== 07:55:19.101882 | 2e2ce247-dcb3-4db3-ac23-1b47b569ee48 ==============================
[0m07:55:19.101882 [info ] [MainThread]: Running with dbt=1.9.1
[0m07:55:19.122668 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt/profiles.yml', 'log_path': '/opt/airflow/dags/dbt_models/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt/profiles.yml --target dev', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:55:23.210914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2e2ce247-dcb3-4db3-ac23-1b47b569ee48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ef7592a80>]}
[0m07:55:23.606347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2e2ce247-dcb3-4db3-ac23-1b47b569ee48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ef1d17110>]}
[0m07:55:23.837796 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m07:55:27.306923 [debug] [MainThread]: checksum: cac3b9519010e47bfbeb71ca6efb4867dae2858687671594dc23fefc94ecf25d, vars: {}, profile: , target: dev, version: 1.9.1
[0m07:55:30.539604 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m07:55:30.542790 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/dimensions/date_dimension.sql
[0m07:55:30.547598 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/dimensions/product_dimension.sql
[0m07:55:33.129514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2e2ce247-dcb3-4db3-ac23-1b47b569ee48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ef172f050>]}
[0m07:55:34.064946 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m07:55:34.268794 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m07:55:34.635373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2e2ce247-dcb3-4db3-ac23-1b47b569ee48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ef1ddbd70>]}
[0m07:55:34.641628 [info ] [MainThread]: Found 6 models, 1 source, 424 macros
[0m07:55:34.644979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2e2ce247-dcb3-4db3-ac23-1b47b569ee48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ef747af60>]}
[0m07:55:34.652558 [info ] [MainThread]: 
[0m07:55:34.665667 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:55:34.667894 [info ] [MainThread]: 
[0m07:55:34.674886 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m07:55:34.724879 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_sales_database'
[0m07:55:35.014269 [debug] [ThreadPool]: Using duckdb connection "list_sales_database"
[0m07:55:35.016725 [debug] [ThreadPool]: On list_sales_database: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "list_sales_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"sales_database"'
    
  
  
[0m07:55:35.018966 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:55:35.329749 [debug] [ThreadPool]: SQL status: OK in 0.307 seconds
[0m07:55:35.337947 [debug] [ThreadPool]: On list_sales_database: Close
[0m07:55:35.349123 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_database, now create_sales_database_main)
[0m07:55:35.352774 [debug] [ThreadPool]: Creating schema "database: "sales_database"
schema: "main"
"
[0m07:55:35.407397 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m07:55:35.409422 [debug] [ThreadPool]: On create_sales_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "create_sales_database_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='sales_database'
        and type='sqlite'
    
  
[0m07:55:35.411460 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:55:35.515714 [debug] [ThreadPool]: SQL status: OK in 0.102 seconds
[0m07:55:35.539511 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m07:55:35.551156 [debug] [ThreadPool]: On create_sales_database_main: BEGIN
[0m07:55:35.556966 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m07:55:35.559873 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m07:55:35.575525 [debug] [ThreadPool]: On create_sales_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "create_sales_database_main"} */

    
    
        create schema if not exists "sales_database"."main"
    
[0m07:55:35.581153 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m07:55:35.594476 [debug] [ThreadPool]: On create_sales_database_main: COMMIT
[0m07:55:35.597635 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m07:55:35.599879 [debug] [ThreadPool]: On create_sales_database_main: COMMIT
[0m07:55:35.606973 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m07:55:35.611911 [debug] [ThreadPool]: On create_sales_database_main: Close
[0m07:55:35.636434 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_sales_database_main, now list_sales_database_main)
[0m07:55:35.677972 [debug] [ThreadPool]: Using duckdb connection "list_sales_database_main"
[0m07:55:35.679930 [debug] [ThreadPool]: On list_sales_database_main: BEGIN
[0m07:55:35.691665 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:55:35.771912 [debug] [ThreadPool]: SQL status: OK in 0.080 seconds
[0m07:55:35.775031 [debug] [ThreadPool]: Using duckdb connection "list_sales_database_main"
[0m07:55:35.779354 [debug] [ThreadPool]: On list_sales_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "list_sales_database_main"} */
select
      'sales_database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'sales_database'
  
[0m07:55:36.259179 [debug] [ThreadPool]: SQL status: OK in 0.473 seconds
[0m07:55:36.304931 [debug] [ThreadPool]: On list_sales_database_main: ROLLBACK
[0m07:55:36.347254 [debug] [ThreadPool]: Failed to rollback 'list_sales_database_main'
[0m07:55:36.349905 [debug] [ThreadPool]: On list_sales_database_main: Close
[0m07:55:36.421903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2e2ce247-dcb3-4db3-ac23-1b47b569ee48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ef185ec30>]}
[0m07:55:36.441127 [debug] [MainThread]: Using duckdb connection "master"
[0m07:55:36.458549 [debug] [MainThread]: On master: BEGIN
[0m07:55:36.462712 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:55:39.724452 [debug] [MainThread]: SQL status: OK in 3.251 seconds
[0m07:55:39.736909 [debug] [MainThread]: On master: COMMIT
[0m07:55:39.751567 [debug] [MainThread]: Using duckdb connection "master"
[0m07:55:39.769914 [debug] [MainThread]: On master: COMMIT
[0m07:55:39.797406 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m07:55:39.802791 [debug] [MainThread]: On master: Close
[0m07:55:39.850164 [debug] [Thread-1 (]: Began running node model.my_dbt_project.customer_dimension
[0m07:55:39.867516 [info ] [Thread-1 (]: 1 of 6 START sql view model main.customer_dimension ............................ [RUN]
[0m07:55:39.880221 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.my_dbt_project.customer_dimension'
[0m07:55:39.883683 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.customer_dimension
[0m07:55:39.932331 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.customer_dimension"
[0m07:55:39.979134 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.customer_dimension
[0m07:55:40.162121 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.customer_dimension"
[0m07:55:40.192701 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m07:55:40.194641 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: BEGIN
[0m07:55:40.196435 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m07:55:40.276436 [debug] [Thread-1 (]: SQL status: OK in 0.080 seconds
[0m07:55:40.278693 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m07:55:40.281479 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */

  
  create view "sales_database"."main"."customer_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
    DISTINCT
    customer AS customer_id,
    customer_name,
    customer_address,
    customer_group,
    territory,
    language AS customer_language
FROM sales
WHERE customer IS NOT NULL
  );

[0m07:55:40.308372 [debug] [Thread-1 (]: SQL status: OK in 0.024 seconds
[0m07:55:40.389684 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m07:55:40.392865 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */
alter view "sales_database"."main"."customer_dimension" rename to "customer_dimension__dbt_backup"
[0m07:55:40.397616 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:55:40.447048 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m07:55:40.454465 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */
alter view "sales_database"."main"."customer_dimension__dbt_tmp" rename to "customer_dimension"
[0m07:55:40.462855 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m07:55:40.649105 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: COMMIT
[0m07:55:40.668009 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m07:55:40.683687 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: COMMIT
[0m07:55:40.811144 [debug] [Thread-1 (]: SQL status: OK in 0.107 seconds
[0m07:55:40.879890 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m07:55:40.890012 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */
drop view if exists "sales_database"."main"."customer_dimension__dbt_backup" cascade
[0m07:55:40.930041 [debug] [Thread-1 (]: SQL status: OK in 0.031 seconds
[0m07:55:40.952414 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: Close
[0m07:55:41.133513 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e2ce247-dcb3-4db3-ac23-1b47b569ee48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ef167d070>]}
[0m07:55:41.137234 [info ] [Thread-1 (]: 1 of 6 OK created sql view model main.customer_dimension ....................... [[32mOK[0m in 1.24s]
[0m07:55:41.143062 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.customer_dimension
[0m07:55:41.146406 [debug] [Thread-1 (]: Began running node model.my_dbt_project.date_dimension
[0m07:55:41.149469 [info ] [Thread-1 (]: 2 of 6 START sql view model main.date_dimension ................................ [RUN]
[0m07:55:41.153982 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customer_dimension, now model.my_dbt_project.date_dimension)
[0m07:55:41.157858 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.date_dimension
[0m07:55:41.181524 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.date_dimension"
[0m07:55:41.219569 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.date_dimension
[0m07:55:41.241844 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.date_dimension"
[0m07:55:41.308564 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m07:55:41.311629 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: BEGIN
[0m07:55:41.313883 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:55:41.387308 [debug] [Thread-1 (]: SQL status: OK in 0.073 seconds
[0m07:55:41.405719 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m07:55:41.416359 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.date_dimension"} */

  
  create view "sales_database"."main"."date_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
    transaction_date,
    strftime(transaction_date, '%A') AS weekday_name,  -- Extract weekday name
    strftime(transaction_date, '%m') AS month,          -- Extract month (numeric)
    strftime(transaction_date, '%Y') AS year,           -- Extract year
    strftime(transaction_date, '%d') AS day,            -- Extract day
    EXTRACT(QUARTER FROM transaction_date) AS quarter   -- Extract quarter
FROM sales
WHERE transaction_date IS NOT NULL
  );

[0m07:55:41.440432 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m07:55:41.471434 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m07:55:41.484665 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.date_dimension"} */
alter view "sales_database"."main"."date_dimension__dbt_tmp" rename to "date_dimension"
[0m07:55:41.503128 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:55:41.541701 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: COMMIT
[0m07:55:41.562523 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m07:55:41.581790 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: COMMIT
[0m07:55:41.646448 [debug] [Thread-1 (]: SQL status: OK in 0.053 seconds
[0m07:55:41.680159 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m07:55:41.693622 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.date_dimension"} */
drop view if exists "sales_database"."main"."date_dimension__dbt_backup" cascade
[0m07:55:41.705980 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:55:41.731680 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: Close
[0m07:55:41.922201 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e2ce247-dcb3-4db3-ac23-1b47b569ee48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ef01ab950>]}
[0m07:55:41.938566 [info ] [Thread-1 (]: 2 of 6 OK created sql view model main.date_dimension ........................... [[32mOK[0m in 0.77s]
[0m07:55:41.944420 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.date_dimension
[0m07:55:41.948216 [debug] [Thread-1 (]: Began running node model.my_dbt_project.product_dimension
[0m07:55:41.954424 [info ] [Thread-1 (]: 3 of 6 START sql view model main.product_dimension ............................. [RUN]
[0m07:55:41.974586 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.date_dimension, now model.my_dbt_project.product_dimension)
[0m07:55:41.984037 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.product_dimension
[0m07:55:42.002840 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.product_dimension"
[0m07:55:42.059655 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.product_dimension
[0m07:55:42.079820 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.product_dimension"
[0m07:55:42.113009 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m07:55:42.115062 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: BEGIN
[0m07:55:42.117823 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:55:42.202574 [debug] [Thread-1 (]: SQL status: OK in 0.085 seconds
[0m07:55:42.206951 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m07:55:42.215688 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.product_dimension"} */

  
  create view "sales_database"."main"."product_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
),

product AS (
    SELECT 
        sales.name,
        product.value->>'name' AS product_name,
        product.value->>'item_code' AS product_item_code
    FROM sales,
    LATERAL json_each(sales.items) AS product
)

SELECT *
FROM product
WHERE product_name IS NOT NULL
  );

[0m07:55:42.255124 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.product_dimension"} */

  
  create view "sales_database"."main"."product_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
),

product AS (
    SELECT 
        sales.name,
        product.value->>'name' AS product_name,
        product.value->>'item_code' AS product_item_code
    FROM sales,
    LATERAL json_each(sales.items) AS product
)

SELECT *
FROM product
WHERE product_name IS NOT NULL
  );

[0m07:55:42.257077 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m07:55:42.259503 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: ROLLBACK
[0m07:55:42.289703 [debug] [Thread-1 (]: Failed to rollback 'model.my_dbt_project.product_dimension'
[0m07:55:42.291937 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: Close
[0m07:55:42.307951 [debug] [Thread-1 (]: Runtime Error in model product_dimension (models/dimensions/product_dimension.sql)
  Catalog Error: Table Function with name json_each does not exist!
  Did you mean "json_execute_serialized_sql"?
  LINE 15:     LATERAL json_each(sales.items) AS product
                       ^
[0m07:55:42.310645 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e2ce247-dcb3-4db3-ac23-1b47b569ee48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ef01db710>]}
[0m07:55:42.317004 [error] [Thread-1 (]: 3 of 6 ERROR creating sql view model main.product_dimension .................... [[31mERROR[0m in 0.34s]
[0m07:55:42.321858 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.product_dimension
[0m07:55:42.323786 [debug] [Thread-1 (]: Began running node model.my_dbt_project.sales_team_dimension
[0m07:55:42.327968 [info ] [Thread-1 (]: 4 of 6 START sql view model main.sales_team_dimension .......................... [RUN]
[0m07:55:42.325672 [debug] [Thread-4 (]: Marking all children of 'model.my_dbt_project.product_dimension' to be skipped because of status 'error'.  Reason: Runtime Error in model product_dimension (models/dimensions/product_dimension.sql)
  Catalog Error: Table Function with name json_each does not exist!
  Did you mean "json_execute_serialized_sql"?
  LINE 15:     LATERAL json_each(sales.items) AS product
                       ^.
[0m07:55:42.331096 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.product_dimension, now model.my_dbt_project.sales_team_dimension)
[0m07:55:42.336962 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.sales_team_dimension
[0m07:55:42.347153 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.sales_team_dimension"
[0m07:55:42.375918 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.sales_team_dimension
[0m07:55:42.392654 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.sales_team_dimension"
[0m07:55:42.412758 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m07:55:42.414212 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: BEGIN
[0m07:55:42.415595 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:55:42.474617 [debug] [Thread-1 (]: SQL status: OK in 0.059 seconds
[0m07:55:42.477145 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m07:55:42.479185 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */

  
  create view "sales_database"."main"."sales_team_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
    DISTINCT
    sales_team->>'name' AS sales_team_id,
    sales_team->>'region' AS sales_team_region
FROM sales
WHERE sales_team IS NOT NULL
  );

[0m07:55:42.483674 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m07:55:42.502323 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m07:55:42.506473 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */
alter view "sales_database"."main"."sales_team_dimension" rename to "sales_team_dimension__dbt_backup"
[0m07:55:42.511081 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m07:55:42.522423 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m07:55:42.524497 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */
alter view "sales_database"."main"."sales_team_dimension__dbt_tmp" rename to "sales_team_dimension"
[0m07:55:42.527359 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:55:42.533862 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: COMMIT
[0m07:55:42.537149 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m07:55:42.539250 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: COMMIT
[0m07:55:42.556349 [debug] [Thread-1 (]: SQL status: OK in 0.015 seconds
[0m07:55:42.566354 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m07:55:42.568641 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */
drop view if exists "sales_database"."main"."sales_team_dimension__dbt_backup" cascade
[0m07:55:42.573698 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m07:55:42.577370 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: Close
[0m07:55:42.638099 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e2ce247-dcb3-4db3-ac23-1b47b569ee48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ef01012b0>]}
[0m07:55:42.640753 [info ] [Thread-1 (]: 4 of 6 OK created sql view model main.sales_team_dimension ..................... [[32mOK[0m in 0.31s]
[0m07:55:42.643941 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.sales_team_dimension
[0m07:55:42.645366 [debug] [Thread-1 (]: Began running node model.my_dbt_project.transform_sales
[0m07:55:42.647413 [info ] [Thread-1 (]: 5 of 6 START sql table model main.transform_sales .............................. [RUN]
[0m07:55:42.652711 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.sales_team_dimension, now model.my_dbt_project.transform_sales)
[0m07:55:42.654799 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.transform_sales
[0m07:55:42.665824 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.transform_sales"
[0m07:55:42.683850 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.transform_sales
[0m07:55:42.772347 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.transform_sales"
[0m07:55:42.794350 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m07:55:42.795668 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: BEGIN
[0m07:55:42.797151 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:55:42.832041 [debug] [Thread-1 (]: SQL status: OK in 0.035 seconds
[0m07:55:42.833969 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m07:55:42.835313 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */

  
    
    

    create  table
      "sales_database"."main"."transform_sales__dbt_tmp"
  
    as (
      -- /opt/airflow/dags/dbt_models/transform_users.sql


WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
   *
FROM sales
WHERE name = 'ABC private LTD-0002'
    );
  
  
[0m07:55:42.855672 [debug] [Thread-1 (]: SQL status: OK in 0.019 seconds
[0m07:55:42.866054 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m07:55:42.867905 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */
alter table "sales_database"."main"."transform_sales" rename to "transform_sales__dbt_backup"
[0m07:55:42.870381 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:55:42.877651 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m07:55:42.879183 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */
alter table "sales_database"."main"."transform_sales__dbt_tmp" rename to "transform_sales"
[0m07:55:42.882685 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m07:55:42.899505 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: COMMIT
[0m07:55:42.901462 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m07:55:42.903344 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: COMMIT
[0m07:55:42.914307 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m07:55:42.922262 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m07:55:42.923796 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */
drop table if exists "sales_database"."main"."transform_sales__dbt_backup" cascade
[0m07:55:42.928457 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m07:55:42.932273 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: Close
[0m07:55:43.076033 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e2ce247-dcb3-4db3-ac23-1b47b569ee48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ed0adb020>]}
[0m07:55:43.077866 [info ] [Thread-1 (]: 5 of 6 OK created sql table model main.transform_sales ......................... [[32mOK[0m in 0.42s]
[0m07:55:43.080207 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.transform_sales
[0m07:55:43.082982 [debug] [Thread-1 (]: Began running node model.my_dbt_project.sales_fact
[0m07:55:43.085053 [info ] [Thread-1 (]: 6 of 6 SKIP relation main.sales_fact ........................................... [[33mSKIP[0m]
[0m07:55:43.086605 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.sales_fact
[0m07:55:43.090597 [debug] [MainThread]: Using duckdb connection "master"
[0m07:55:43.092143 [debug] [MainThread]: On master: BEGIN
[0m07:55:43.093607 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:55:43.150667 [debug] [MainThread]: SQL status: OK in 0.057 seconds
[0m07:55:43.153458 [debug] [MainThread]: On master: COMMIT
[0m07:55:43.155938 [debug] [MainThread]: Using duckdb connection "master"
[0m07:55:43.167874 [debug] [MainThread]: On master: COMMIT
[0m07:55:43.171451 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m07:55:43.179123 [debug] [MainThread]: On master: Close
[0m07:55:43.190491 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:55:43.192411 [debug] [MainThread]: Connection 'list_sales_database_main' was properly closed.
[0m07:55:43.194152 [debug] [MainThread]: Connection 'model.my_dbt_project.transform_sales' was properly closed.
[0m07:55:43.196247 [info ] [MainThread]: 
[0m07:55:43.199901 [info ] [MainThread]: Finished running 2 table models, 4 view models in 0 hours 0 minutes and 8.52 seconds (8.52s).
[0m07:55:43.205812 [debug] [MainThread]: Command end result
[0m07:55:43.829422 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m07:55:43.991886 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m07:55:44.153188 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dags/dbt_models/target/run_results.json
[0m07:55:44.164733 [info ] [MainThread]: 
[0m07:55:44.185289 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m07:55:44.202130 [info ] [MainThread]: 
[0m07:55:44.204907 [error] [MainThread]:   Runtime Error in model product_dimension (models/dimensions/product_dimension.sql)
  Catalog Error: Table Function with name json_each does not exist!
  Did you mean "json_execute_serialized_sql"?
  LINE 15:     LATERAL json_each(sales.items) AS product
                       ^
[0m07:55:44.222880 [info ] [MainThread]: 
[0m07:55:44.229013 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=1 TOTAL=6
[0m07:55:44.258967 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 26.42342, "process_in_blocks": "1648736", "process_kernel_time": 7.430834, "process_mem_max_rss": "142832", "process_out_blocks": "0", "process_user_time": 14.566066}
[0m07:55:44.269883 [debug] [MainThread]: Command `dbt run` failed at 07:55:44.269513 after 26.43 seconds
[0m07:55:44.277508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ef9b1c830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ef7cc2030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ef7cc1eb0>]}
[0m07:55:44.279576 [debug] [MainThread]: Flushing usage events
[0m07:55:46.100380 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:21:56.037011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe40665a000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4063cd8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe406218560>]}


============================== 08:21:56.089762 | 36f3a2ba-ff13-4c3f-b946-775d2825a523 ==============================
[0m08:21:56.089762 [info ] [MainThread]: Running with dbt=1.9.1
[0m08:21:56.094727 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dags/dbt_models/logs', 'profiles_dir': '/opt/airflow/dbt/profiles.yml', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt/profiles.yml --target dev', 'send_anonymous_usage_stats': 'True'}
[0m08:21:57.775673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '36f3a2ba-ff13-4c3f-b946-775d2825a523', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe405d6e930>]}
[0m08:21:58.071370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '36f3a2ba-ff13-4c3f-b946-775d2825a523', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe406705fa0>]}
[0m08:21:58.175980 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m08:21:59.654922 [debug] [MainThread]: checksum: cac3b9519010e47bfbeb71ca6efb4867dae2858687671594dc23fefc94ecf25d, vars: {}, profile: , target: dev, version: 1.9.1
[0m08:22:00.769239 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:22:00.783517 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:22:01.136226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '36f3a2ba-ff13-4c3f-b946-775d2825a523', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe400269df0>]}
[0m08:22:02.034411 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m08:22:02.116024 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m08:22:03.367251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '36f3a2ba-ff13-4c3f-b946-775d2825a523', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4001ae6c0>]}
[0m08:22:04.223393 [info ] [MainThread]: Found 6 models, 1 source, 424 macros
[0m08:22:08.347216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '36f3a2ba-ff13-4c3f-b946-775d2825a523', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3f3c28830>]}
[0m08:22:14.922845 [info ] [MainThread]: 
[0m08:22:14.936153 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:22:14.954808 [info ] [MainThread]: 
[0m08:22:14.976169 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m08:22:15.031867 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_sales_database'
[0m08:22:15.374907 [debug] [ThreadPool]: Using duckdb connection "list_sales_database"
[0m08:22:15.376690 [debug] [ThreadPool]: On list_sales_database: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "list_sales_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"sales_database"'
    
  
  
[0m08:22:15.379154 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:22:16.290655 [debug] [ThreadPool]: SQL status: OK in 0.907 seconds
[0m08:22:16.298711 [debug] [ThreadPool]: On list_sales_database: Close
[0m08:22:16.322570 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_database, now create_sales_database_main)
[0m08:22:16.326166 [debug] [ThreadPool]: Creating schema "database: "sales_database"
schema: "main"
"
[0m08:22:16.395302 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m08:22:16.397416 [debug] [ThreadPool]: On create_sales_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "create_sales_database_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='sales_database'
        and type='sqlite'
    
  
[0m08:22:16.399641 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:22:16.512248 [debug] [ThreadPool]: SQL status: OK in 0.113 seconds
[0m08:22:16.529802 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m08:22:16.532502 [debug] [ThreadPool]: On create_sales_database_main: BEGIN
[0m08:22:16.542274 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m08:22:16.547719 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m08:22:16.550091 [debug] [ThreadPool]: On create_sales_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "create_sales_database_main"} */

    
    
        create schema if not exists "sales_database"."main"
    
[0m08:22:16.563924 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m08:22:16.569696 [debug] [ThreadPool]: On create_sales_database_main: COMMIT
[0m08:22:16.571671 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m08:22:16.576826 [debug] [ThreadPool]: On create_sales_database_main: COMMIT
[0m08:22:16.585230 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m08:22:16.587592 [debug] [ThreadPool]: On create_sales_database_main: Close
[0m08:22:16.605687 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_sales_database_main, now list_sales_database_main)
[0m08:22:16.646762 [debug] [ThreadPool]: Using duckdb connection "list_sales_database_main"
[0m08:22:16.649078 [debug] [ThreadPool]: On list_sales_database_main: BEGIN
[0m08:22:16.660573 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:22:16.729953 [debug] [ThreadPool]: SQL status: OK in 0.077 seconds
[0m08:22:16.732090 [debug] [ThreadPool]: Using duckdb connection "list_sales_database_main"
[0m08:22:16.741316 [debug] [ThreadPool]: On list_sales_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "list_sales_database_main"} */
select
      'sales_database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'sales_database'
  
[0m08:22:17.266028 [debug] [ThreadPool]: SQL status: OK in 0.512 seconds
[0m08:22:17.287997 [debug] [ThreadPool]: On list_sales_database_main: ROLLBACK
[0m08:22:17.343827 [debug] [ThreadPool]: Failed to rollback 'list_sales_database_main'
[0m08:22:17.345680 [debug] [ThreadPool]: On list_sales_database_main: Close
[0m08:22:17.357669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '36f3a2ba-ff13-4c3f-b946-775d2825a523', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe407ae7260>]}
[0m08:22:17.368226 [debug] [MainThread]: Using duckdb connection "master"
[0m08:22:17.370606 [debug] [MainThread]: On master: BEGIN
[0m08:22:17.372951 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:22:17.423121 [debug] [MainThread]: SQL status: OK in 0.049 seconds
[0m08:22:17.425160 [debug] [MainThread]: On master: COMMIT
[0m08:22:17.427087 [debug] [MainThread]: Using duckdb connection "master"
[0m08:22:17.429256 [debug] [MainThread]: On master: COMMIT
[0m08:22:17.431951 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m08:22:17.435559 [debug] [MainThread]: On master: Close
[0m08:22:17.473160 [debug] [Thread-1 (]: Began running node model.my_dbt_project.customer_dimension
[0m08:22:17.475807 [info ] [Thread-1 (]: 1 of 6 START sql view model main.customer_dimension ............................ [RUN]
[0m08:22:17.478352 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.my_dbt_project.customer_dimension'
[0m08:22:17.481500 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.customer_dimension
[0m08:22:17.522962 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.customer_dimension"
[0m08:22:17.544507 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.customer_dimension
[0m08:22:17.726472 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.customer_dimension"
[0m08:22:17.789658 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m08:22:17.799892 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: BEGIN
[0m08:22:17.803533 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m08:22:17.912514 [debug] [Thread-1 (]: SQL status: OK in 0.109 seconds
[0m08:22:17.940342 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m08:22:17.943222 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */

  
  create view "sales_database"."main"."customer_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
    DISTINCT
    customer AS customer_id,
    customer_name,
    customer_address,
    customer_group,
    territory,
    language AS customer_language
FROM sales
WHERE customer IS NOT NULL
  );

[0m08:22:17.961591 [debug] [Thread-1 (]: SQL status: OK in 0.015 seconds
[0m08:22:18.040602 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m08:22:18.043967 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */
alter view "sales_database"."main"."customer_dimension__dbt_tmp" rename to "customer_dimension"
[0m08:22:18.061452 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m08:22:18.204363 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: COMMIT
[0m08:22:18.219955 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m08:22:18.223149 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: COMMIT
[0m08:22:18.273052 [debug] [Thread-1 (]: SQL status: OK in 0.037 seconds
[0m08:22:18.318746 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m08:22:18.331653 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */
drop view if exists "sales_database"."main"."customer_dimension__dbt_backup" cascade
[0m08:22:18.341391 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m08:22:18.387271 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: Close
[0m08:22:18.580280 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36f3a2ba-ff13-4c3f-b946-775d2825a523', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe407dda360>]}
[0m08:22:18.583749 [info ] [Thread-1 (]: 1 of 6 OK created sql view model main.customer_dimension ....................... [[32mOK[0m in 1.06s]
[0m08:22:18.592273 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.customer_dimension
[0m08:22:18.596845 [debug] [Thread-1 (]: Began running node model.my_dbt_project.date_dimension
[0m08:22:18.612885 [info ] [Thread-1 (]: 2 of 6 START sql view model main.date_dimension ................................ [RUN]
[0m08:22:18.630903 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customer_dimension, now model.my_dbt_project.date_dimension)
[0m08:22:18.634542 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.date_dimension
[0m08:22:18.689902 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.date_dimension"
[0m08:22:18.732453 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.date_dimension
[0m08:22:18.781246 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.date_dimension"
[0m08:22:18.815715 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m08:22:18.822799 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: BEGIN
[0m08:22:18.826451 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:22:18.997073 [debug] [Thread-1 (]: SQL status: OK in 0.166 seconds
[0m08:22:18.999699 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m08:22:19.013597 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.date_dimension"} */

  
  create view "sales_database"."main"."date_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
    transaction_date,
    strftime(transaction_date, '%A') AS weekday_name,  -- Extract weekday name
    strftime(transaction_date, '%m') AS month,          -- Extract month (numeric)
    strftime(transaction_date, '%Y') AS year,           -- Extract year
    strftime(transaction_date, '%d') AS day,            -- Extract day
    EXTRACT(QUARTER FROM transaction_date) AS quarter   -- Extract quarter
FROM sales
WHERE transaction_date IS NOT NULL
  );

[0m08:22:19.045500 [debug] [Thread-1 (]: SQL status: OK in 0.029 seconds
[0m08:22:19.081433 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m08:22:19.095292 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.date_dimension"} */
alter view "sales_database"."main"."date_dimension__dbt_tmp" rename to "date_dimension"
[0m08:22:19.109164 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m08:22:19.122093 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: COMMIT
[0m08:22:19.137750 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m08:22:19.156868 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: COMMIT
[0m08:22:19.176530 [debug] [Thread-1 (]: SQL status: OK in 0.018 seconds
[0m08:22:19.197313 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m08:22:19.199675 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.date_dimension"} */
drop view if exists "sales_database"."main"."date_dimension__dbt_backup" cascade
[0m08:22:19.207022 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m08:22:19.223350 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: Close
[0m08:22:19.342212 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36f3a2ba-ff13-4c3f-b946-775d2825a523', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3f3283c20>]}
[0m08:22:19.345205 [info ] [Thread-1 (]: 2 of 6 OK created sql view model main.date_dimension ........................... [[32mOK[0m in 0.71s]
[0m08:22:19.348171 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.date_dimension
[0m08:22:19.350585 [debug] [Thread-1 (]: Began running node model.my_dbt_project.product_dimension
[0m08:22:19.354664 [info ] [Thread-1 (]: 3 of 6 START sql view model main.product_dimension ............................. [RUN]
[0m08:22:19.356903 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.date_dimension, now model.my_dbt_project.product_dimension)
[0m08:22:19.358908 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.product_dimension
[0m08:22:19.388527 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.product_dimension"
[0m08:22:19.408435 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.product_dimension
[0m08:22:19.424582 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.product_dimension"
[0m08:22:19.440067 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m08:22:19.441273 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: BEGIN
[0m08:22:19.442383 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:22:19.476031 [debug] [Thread-1 (]: SQL status: OK in 0.034 seconds
[0m08:22:19.477308 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m08:22:19.478592 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.product_dimension"} */

  
  create view "sales_database"."main"."product_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
),

product AS (
    SELECT 
        sales.name,
        product.value->>'name' AS product_name,
        product.value->>'item_code' AS product_item_code
    FROM sales,
    LATERAL json_each(sales.items) AS product
)

SELECT *
FROM product
WHERE product_name IS NOT NULL
  );

[0m08:22:20.080159 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.product_dimension"} */

  
  create view "sales_database"."main"."product_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
),

product AS (
    SELECT 
        sales.name,
        product.value->>'name' AS product_name,
        product.value->>'item_code' AS product_item_code
    FROM sales,
    LATERAL json_each(sales.items) AS product
)

SELECT *
FROM product
WHERE product_name IS NOT NULL
  );

[0m08:22:20.094307 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m08:22:20.111609 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: ROLLBACK
[0m08:22:20.156613 [debug] [Thread-1 (]: Failed to rollback 'model.my_dbt_project.product_dimension'
[0m08:22:20.159450 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: Close
[0m08:22:20.179658 [debug] [Thread-1 (]: Runtime Error in model product_dimension (models/dimensions/product_dimension.sql)
  Catalog Error: Table Function with name json_each does not exist!
  Did you mean "json_execute_serialized_sql"?
  LINE 15:     LATERAL json_each(sales.items) AS product
                       ^
[0m08:22:20.181741 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36f3a2ba-ff13-4c3f-b946-775d2825a523', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3f30630b0>]}
[0m08:22:20.188695 [error] [Thread-1 (]: 3 of 6 ERROR creating sql view model main.product_dimension .................... [[31mERROR[0m in 0.82s]
[0m08:22:20.191737 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.product_dimension
[0m08:22:20.195205 [debug] [Thread-1 (]: Began running node model.my_dbt_project.sales_team_dimension
[0m08:22:20.197252 [debug] [Thread-4 (]: Marking all children of 'model.my_dbt_project.product_dimension' to be skipped because of status 'error'.  Reason: Runtime Error in model product_dimension (models/dimensions/product_dimension.sql)
  Catalog Error: Table Function with name json_each does not exist!
  Did you mean "json_execute_serialized_sql"?
  LINE 15:     LATERAL json_each(sales.items) AS product
                       ^.
[0m08:22:20.199557 [info ] [Thread-1 (]: 4 of 6 START sql view model main.sales_team_dimension .......................... [RUN]
[0m08:22:20.207566 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.product_dimension, now model.my_dbt_project.sales_team_dimension)
[0m08:22:20.209536 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.sales_team_dimension
[0m08:22:20.221831 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.sales_team_dimension"
[0m08:22:20.249501 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.sales_team_dimension
[0m08:22:20.265252 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.sales_team_dimension"
[0m08:22:20.297435 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m08:22:20.299624 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: BEGIN
[0m08:22:20.302984 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:22:20.364737 [debug] [Thread-1 (]: SQL status: OK in 0.062 seconds
[0m08:22:20.366546 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m08:22:20.370860 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */

  
  create view "sales_database"."main"."sales_team_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
    DISTINCT
    sales_team->>'name' AS sales_team_id,
    sales_team->>'region' AS sales_team_region
FROM sales
WHERE sales_team IS NOT NULL
  );

[0m08:22:20.386709 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m08:22:20.396774 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m08:22:20.398790 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */
alter view "sales_database"."main"."sales_team_dimension__dbt_tmp" rename to "sales_team_dimension"
[0m08:22:20.405151 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m08:22:20.409933 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: COMMIT
[0m08:22:20.411768 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m08:22:20.413591 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: COMMIT
[0m08:22:20.424862 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m08:22:20.437657 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m08:22:20.440004 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */
drop view if exists "sales_database"."main"."sales_team_dimension__dbt_backup" cascade
[0m08:22:20.443471 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:22:20.448635 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: Close
[0m08:22:20.528700 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36f3a2ba-ff13-4c3f-b946-775d2825a523', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3f308af90>]}
[0m08:22:20.531822 [info ] [Thread-1 (]: 4 of 6 OK created sql view model main.sales_team_dimension ..................... [[32mOK[0m in 0.32s]
[0m08:22:20.534969 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.sales_team_dimension
[0m08:22:20.539584 [debug] [Thread-1 (]: Began running node model.my_dbt_project.transform_sales
[0m08:22:20.542278 [info ] [Thread-1 (]: 5 of 6 START sql table model main.transform_sales .............................. [RUN]
[0m08:22:20.545131 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.sales_team_dimension, now model.my_dbt_project.transform_sales)
[0m08:22:20.561703 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.transform_sales
[0m08:22:20.576292 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.transform_sales"
[0m08:22:20.603719 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.transform_sales
[0m08:22:20.711363 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.transform_sales"
[0m08:22:20.730529 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m08:22:20.732266 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: BEGIN
[0m08:22:20.734110 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:22:20.792982 [debug] [Thread-1 (]: SQL status: OK in 0.059 seconds
[0m08:22:20.807096 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m08:22:20.811719 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */

  
    
    

    create  table
      "sales_database"."main"."transform_sales__dbt_tmp"
  
    as (
      -- /opt/airflow/dags/dbt_models/transform_users.sql


WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
   *
FROM sales
WHERE name = 'ABC private LTD-0002'
    );
  
  
[0m08:22:20.872051 [debug] [Thread-1 (]: SQL status: OK in 0.058 seconds
[0m08:22:20.881035 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m08:22:20.885776 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */
alter table "sales_database"."main"."transform_sales__dbt_tmp" rename to "transform_sales"
[0m08:22:20.891552 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m08:22:20.911331 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: COMMIT
[0m08:22:20.912785 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m08:22:20.914252 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: COMMIT
[0m08:22:20.930480 [debug] [Thread-1 (]: SQL status: OK in 0.015 seconds
[0m08:22:20.941821 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m08:22:20.946192 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */
drop table if exists "sales_database"."main"."transform_sales__dbt_backup" cascade
[0m08:22:20.950352 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:22:20.955838 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: Close
[0m08:22:21.164451 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36f3a2ba-ff13-4c3f-b946-775d2825a523', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3f151a990>]}
[0m08:22:21.171756 [info ] [Thread-1 (]: 5 of 6 OK created sql table model main.transform_sales ......................... [[32mOK[0m in 0.60s]
[0m08:22:21.175780 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.transform_sales
[0m08:22:21.184526 [debug] [Thread-1 (]: Began running node model.my_dbt_project.sales_fact
[0m08:22:21.187264 [info ] [Thread-1 (]: 6 of 6 SKIP relation main.sales_fact ........................................... [[33mSKIP[0m]
[0m08:22:21.190759 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.sales_fact
[0m08:22:21.196156 [debug] [MainThread]: Using duckdb connection "master"
[0m08:22:21.197993 [debug] [MainThread]: On master: BEGIN
[0m08:22:21.200034 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:22:21.324520 [debug] [MainThread]: SQL status: OK in 0.124 seconds
[0m08:22:21.326705 [debug] [MainThread]: On master: COMMIT
[0m08:22:21.328369 [debug] [MainThread]: Using duckdb connection "master"
[0m08:22:21.329984 [debug] [MainThread]: On master: COMMIT
[0m08:22:21.332341 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m08:22:21.335343 [debug] [MainThread]: On master: Close
[0m08:22:21.341283 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:22:21.342904 [debug] [MainThread]: Connection 'list_sales_database_main' was properly closed.
[0m08:22:21.344385 [debug] [MainThread]: Connection 'model.my_dbt_project.transform_sales' was properly closed.
[0m08:22:21.348411 [info ] [MainThread]: 
[0m08:22:21.351316 [info ] [MainThread]: Finished running 2 table models, 4 view models in 0 hours 0 minutes and 6.37 seconds (6.37s).
[0m08:22:21.355898 [debug] [MainThread]: Command end result
[0m08:22:21.492338 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m08:22:21.567069 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m08:22:21.654636 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dags/dbt_models/target/run_results.json
[0m08:22:21.656465 [info ] [MainThread]: 
[0m08:22:21.659196 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m08:22:21.672289 [info ] [MainThread]: 
[0m08:22:21.676359 [error] [MainThread]:   Runtime Error in model product_dimension (models/dimensions/product_dimension.sql)
  Catalog Error: Table Function with name json_each does not exist!
  Did you mean "json_execute_serialized_sql"?
  LINE 15:     LATERAL json_each(sales.items) AS product
                       ^
[0m08:22:21.681205 [info ] [MainThread]: 
[0m08:22:21.685937 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=1 TOTAL=6
[0m08:22:21.715532 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 25.885386, "process_in_blocks": "980696", "process_kernel_time": 3.258145, "process_mem_max_rss": "127392", "process_out_blocks": "1968", "process_user_time": 9.535306}
[0m08:22:21.731689 [debug] [MainThread]: Command `dbt run` failed at 08:22:21.731053 after 25.91 seconds
[0m08:22:21.734031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe40639f680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe405e1c5c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3f3c29940>]}
[0m08:22:21.736793 [debug] [MainThread]: Flushing usage events
[0m08:22:24.259270 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:27:06.062866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a32e97fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a31496ff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a30fadc40>]}


============================== 08:27:06.156995 | 6e8a210f-3c53-43c2-9ed4-9560739f0ce4 ==============================
[0m08:27:06.156995 [info ] [MainThread]: Running with dbt=1.9.1
[0m08:27:06.170343 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt/profiles.yml', 'log_path': '/opt/airflow/dags/dbt_models/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt/profiles.yml --target dev', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m08:27:09.595709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6e8a210f-3c53-43c2-9ed4-9560739f0ce4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a31887290>]}
[0m08:27:09.972713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6e8a210f-3c53-43c2-9ed4-9560739f0ce4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a31887350>]}
[0m08:27:10.146493 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m08:27:12.469600 [debug] [MainThread]: checksum: cac3b9519010e47bfbeb71ca6efb4867dae2858687671594dc23fefc94ecf25d, vars: {}, profile: , target: dev, version: 1.9.1
[0m08:27:14.845168 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:27:15.673249 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/dimensions/product_dimension.sql
[0m08:27:25.757218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6e8a210f-3c53-43c2-9ed4-9560739f0ce4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a2b366f00>]}
[0m08:27:26.094212 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m08:27:26.130849 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m08:27:26.380412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6e8a210f-3c53-43c2-9ed4-9560739f0ce4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a2ae99460>]}
[0m08:27:26.384462 [info ] [MainThread]: Found 6 models, 1 source, 424 macros
[0m08:27:26.392760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6e8a210f-3c53-43c2-9ed4-9560739f0ce4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a2a35fa70>]}
[0m08:27:26.403291 [info ] [MainThread]: 
[0m08:27:26.406090 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:27:26.411120 [info ] [MainThread]: 
[0m08:27:26.414531 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m08:27:26.446918 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_sales_database'
[0m08:27:26.693473 [debug] [ThreadPool]: Using duckdb connection "list_sales_database"
[0m08:27:26.695618 [debug] [ThreadPool]: On list_sales_database: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "list_sales_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"sales_database"'
    
  
  
[0m08:27:26.697615 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:27:26.987499 [debug] [ThreadPool]: SQL status: OK in 0.290 seconds
[0m08:27:26.992078 [debug] [ThreadPool]: On list_sales_database: Close
[0m08:27:27.019529 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_database, now create_sales_database_main)
[0m08:27:27.021758 [debug] [ThreadPool]: Creating schema "database: "sales_database"
schema: "main"
"
[0m08:27:27.045971 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m08:27:27.047842 [debug] [ThreadPool]: On create_sales_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "create_sales_database_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='sales_database'
        and type='sqlite'
    
  
[0m08:27:27.049808 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:27:27.113150 [debug] [ThreadPool]: SQL status: OK in 0.063 seconds
[0m08:27:27.120795 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m08:27:27.124275 [debug] [ThreadPool]: On create_sales_database_main: BEGIN
[0m08:27:27.129675 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m08:27:27.131980 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m08:27:27.134086 [debug] [ThreadPool]: On create_sales_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "create_sales_database_main"} */

    
    
        create schema if not exists "sales_database"."main"
    
[0m08:27:27.138689 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m08:27:27.147212 [debug] [ThreadPool]: On create_sales_database_main: COMMIT
[0m08:27:27.149819 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m08:27:27.155475 [debug] [ThreadPool]: On create_sales_database_main: COMMIT
[0m08:27:27.159715 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m08:27:27.162669 [debug] [ThreadPool]: On create_sales_database_main: Close
[0m08:27:27.180076 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_sales_database_main'
[0m08:27:27.254392 [debug] [ThreadPool]: Using duckdb connection "list_sales_database_main"
[0m08:27:27.258843 [debug] [ThreadPool]: On list_sales_database_main: BEGIN
[0m08:27:27.260416 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:27:27.422781 [debug] [ThreadPool]: SQL status: OK in 0.162 seconds
[0m08:27:27.428867 [debug] [ThreadPool]: Using duckdb connection "list_sales_database_main"
[0m08:27:27.431965 [debug] [ThreadPool]: On list_sales_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "list_sales_database_main"} */
select
      'sales_database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'sales_database'
  
[0m08:27:27.581638 [debug] [ThreadPool]: SQL status: OK in 0.147 seconds
[0m08:27:27.587594 [debug] [ThreadPool]: On list_sales_database_main: ROLLBACK
[0m08:27:27.594121 [debug] [ThreadPool]: Failed to rollback 'list_sales_database_main'
[0m08:27:27.595879 [debug] [ThreadPool]: On list_sales_database_main: Close
[0m08:27:27.610521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6e8a210f-3c53-43c2-9ed4-9560739f0ce4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a30ada5d0>]}
[0m08:27:27.613077 [debug] [MainThread]: Using duckdb connection "master"
[0m08:27:27.614956 [debug] [MainThread]: On master: BEGIN
[0m08:27:27.616861 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:27:27.662247 [debug] [MainThread]: SQL status: OK in 0.045 seconds
[0m08:27:27.664163 [debug] [MainThread]: On master: COMMIT
[0m08:27:27.666023 [debug] [MainThread]: Using duckdb connection "master"
[0m08:27:27.667971 [debug] [MainThread]: On master: COMMIT
[0m08:27:27.670648 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m08:27:27.673134 [debug] [MainThread]: On master: Close
[0m08:27:27.695650 [debug] [Thread-1 (]: Began running node model.my_dbt_project.customer_dimension
[0m08:27:27.698893 [info ] [Thread-1 (]: 1 of 6 START sql view model main.customer_dimension ............................ [RUN]
[0m08:27:27.702101 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.my_dbt_project.customer_dimension'
[0m08:27:27.704500 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.customer_dimension
[0m08:27:27.746440 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.customer_dimension"
[0m08:27:27.778243 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.customer_dimension
[0m08:27:27.935231 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.customer_dimension"
[0m08:27:27.967316 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m08:27:27.969197 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: BEGIN
[0m08:27:27.971258 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m08:27:28.053766 [debug] [Thread-1 (]: SQL status: OK in 0.082 seconds
[0m08:27:28.055888 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m08:27:28.058369 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */

  
  create view "sales_database"."main"."customer_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
    DISTINCT
    customer AS customer_id,
    customer_name,
    customer_address,
    customer_group,
    territory,
    language AS customer_language
FROM sales
WHERE customer IS NOT NULL
  );

[0m08:27:28.061781 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:27:28.088563 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m08:27:28.090620 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */
alter view "sales_database"."main"."customer_dimension" rename to "customer_dimension__dbt_backup"
[0m08:27:28.094125 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:27:28.103571 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m08:27:28.105632 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */
alter view "sales_database"."main"."customer_dimension__dbt_tmp" rename to "customer_dimension"
[0m08:27:28.108854 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:27:28.159612 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: COMMIT
[0m08:27:28.162514 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m08:27:28.166225 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: COMMIT
[0m08:27:28.176738 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m08:27:28.197473 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m08:27:28.199614 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */
drop view if exists "sales_database"."main"."customer_dimension__dbt_backup" cascade
[0m08:27:28.205136 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m08:27:28.214509 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: Close
[0m08:27:28.320818 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e8a210f-3c53-43c2-9ed4-9560739f0ce4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a2a31dbe0>]}
[0m08:27:28.324702 [info ] [Thread-1 (]: 1 of 6 OK created sql view model main.customer_dimension ....................... [[32mOK[0m in 0.62s]
[0m08:27:28.328316 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.customer_dimension
[0m08:27:28.334689 [debug] [Thread-1 (]: Began running node model.my_dbt_project.date_dimension
[0m08:27:28.337731 [info ] [Thread-1 (]: 2 of 6 START sql view model main.date_dimension ................................ [RUN]
[0m08:27:28.340237 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customer_dimension, now model.my_dbt_project.date_dimension)
[0m08:27:28.343061 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.date_dimension
[0m08:27:28.357161 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.date_dimension"
[0m08:27:28.386996 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.date_dimension
[0m08:27:28.407569 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.date_dimension"
[0m08:27:28.431807 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m08:27:28.434097 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: BEGIN
[0m08:27:28.436603 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:27:28.478953 [debug] [Thread-1 (]: SQL status: OK in 0.042 seconds
[0m08:27:28.480765 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m08:27:28.483300 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.date_dimension"} */

  
  create view "sales_database"."main"."date_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
    transaction_date,
    strftime(transaction_date, '%A') AS weekday_name,  -- Extract weekday name
    strftime(transaction_date, '%m') AS month,          -- Extract month (numeric)
    strftime(transaction_date, '%Y') AS year,           -- Extract year
    strftime(transaction_date, '%d') AS day,            -- Extract day
    EXTRACT(QUARTER FROM transaction_date) AS quarter   -- Extract quarter
FROM sales
WHERE transaction_date IS NOT NULL
  );

[0m08:27:28.491370 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m08:27:28.501661 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m08:27:28.503621 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.date_dimension"} */
alter view "sales_database"."main"."date_dimension" rename to "date_dimension__dbt_backup"
[0m08:27:28.508560 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:27:28.519955 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m08:27:28.524370 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.date_dimension"} */
alter view "sales_database"."main"."date_dimension__dbt_tmp" rename to "date_dimension"
[0m08:27:28.527618 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:27:28.535708 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: COMMIT
[0m08:27:28.538191 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m08:27:28.540753 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: COMMIT
[0m08:27:28.552312 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m08:27:28.562850 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m08:27:28.567364 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.date_dimension"} */
drop view if exists "sales_database"."main"."date_dimension__dbt_backup" cascade
[0m08:27:28.576386 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m08:27:28.582842 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: Close
[0m08:27:28.663347 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e8a210f-3c53-43c2-9ed4-9560739f0ce4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a28193380>]}
[0m08:27:28.666134 [info ] [Thread-1 (]: 2 of 6 OK created sql view model main.date_dimension ........................... [[32mOK[0m in 0.32s]
[0m08:27:28.669517 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.date_dimension
[0m08:27:28.671971 [debug] [Thread-1 (]: Began running node model.my_dbt_project.product_dimension
[0m08:27:28.675177 [info ] [Thread-1 (]: 3 of 6 START sql view model main.product_dimension ............................. [RUN]
[0m08:27:28.677242 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.date_dimension, now model.my_dbt_project.product_dimension)
[0m08:27:28.679595 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.product_dimension
[0m08:27:28.691710 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.product_dimension"
[0m08:27:28.723292 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.product_dimension
[0m08:27:28.749758 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.product_dimension"
[0m08:27:28.790530 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m08:27:28.792215 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: BEGIN
[0m08:27:28.796404 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:27:28.854228 [debug] [Thread-1 (]: SQL status: OK in 0.056 seconds
[0m08:27:28.857189 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m08:27:28.860349 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.product_dimension"} */

  
  create view "sales_database"."main"."product_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * 
    FROM "sales_database"."main"."sales"
)

SELECT 
    sales.name,
    json_extract(items, '$[0].name') AS product_name,  -- Example to extract the first element's "name" field from JSON array
    json_extract(items, '$[0].item_code') AS product_item_code
FROM sales
WHERE json_extract(items, '$[0].name') IS NOT NULL  -- Filter to only keep rows with a non-null product name
  );

[0m08:27:28.866823 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m08:27:28.879477 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m08:27:28.883730 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.product_dimension"} */
alter view "sales_database"."main"."product_dimension__dbt_tmp" rename to "product_dimension"
[0m08:27:28.886591 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:27:28.893230 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: COMMIT
[0m08:27:28.898657 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m08:27:28.901160 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: COMMIT
[0m08:27:28.922224 [debug] [Thread-1 (]: SQL status: OK in 0.018 seconds
[0m08:27:28.933684 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m08:27:28.936367 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.product_dimension"} */
drop view if exists "sales_database"."main"."product_dimension__dbt_backup" cascade
[0m08:27:28.946131 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:27:28.951328 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: Close
[0m08:27:29.042669 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e8a210f-3c53-43c2-9ed4-9560739f0ce4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a297cb8f0>]}
[0m08:27:29.045997 [info ] [Thread-1 (]: 3 of 6 OK created sql view model main.product_dimension ........................ [[32mOK[0m in 0.37s]
[0m08:27:29.051064 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.product_dimension
[0m08:27:29.054085 [debug] [Thread-1 (]: Began running node model.my_dbt_project.sales_team_dimension
[0m08:27:29.058459 [info ] [Thread-1 (]: 4 of 6 START sql view model main.sales_team_dimension .......................... [RUN]
[0m08:27:29.062229 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.product_dimension, now model.my_dbt_project.sales_team_dimension)
[0m08:27:29.073372 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.sales_team_dimension
[0m08:27:29.085373 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.sales_team_dimension"
[0m08:27:29.166913 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.sales_team_dimension
[0m08:27:29.181665 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.sales_team_dimension"
[0m08:27:29.456211 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m08:27:29.469698 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: BEGIN
[0m08:27:29.477236 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:27:29.639729 [debug] [Thread-1 (]: SQL status: OK in 0.166 seconds
[0m08:27:29.659339 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m08:27:29.689584 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */

  
  create view "sales_database"."main"."sales_team_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
    DISTINCT
    sales_team->>'name' AS sales_team_id,
    sales_team->>'region' AS sales_team_region
FROM sales
WHERE sales_team IS NOT NULL
  );

[0m08:27:29.734414 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m08:27:29.769887 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m08:27:29.786717 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */
alter view "sales_database"."main"."sales_team_dimension" rename to "sales_team_dimension__dbt_backup"
[0m08:27:29.790601 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:27:29.826043 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m08:27:29.829366 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */
alter view "sales_database"."main"."sales_team_dimension__dbt_tmp" rename to "sales_team_dimension"
[0m08:27:29.842972 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m08:27:29.885014 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: COMMIT
[0m08:27:29.891499 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m08:27:29.898077 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: COMMIT
[0m08:27:29.951596 [debug] [Thread-1 (]: SQL status: OK in 0.049 seconds
[0m08:27:29.977249 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m08:27:29.989383 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */
drop view if exists "sales_database"."main"."sales_team_dimension__dbt_backup" cascade
[0m08:27:30.006908 [debug] [Thread-1 (]: SQL status: OK in 0.015 seconds
[0m08:27:30.021793 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: Close
[0m08:27:30.121791 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e8a210f-3c53-43c2-9ed4-9560739f0ce4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a281b5b20>]}
[0m08:27:30.124364 [info ] [Thread-1 (]: 4 of 6 OK created sql view model main.sales_team_dimension ..................... [[32mOK[0m in 1.06s]
[0m08:27:30.132255 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.sales_team_dimension
[0m08:27:30.141459 [debug] [Thread-1 (]: Began running node model.my_dbt_project.transform_sales
[0m08:27:30.144790 [info ] [Thread-1 (]: 5 of 6 START sql table model main.transform_sales .............................. [RUN]
[0m08:27:30.152648 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.sales_team_dimension, now model.my_dbt_project.transform_sales)
[0m08:27:30.156726 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.transform_sales
[0m08:27:30.169277 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.transform_sales"
[0m08:27:30.216237 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.transform_sales
[0m08:27:30.301376 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.transform_sales"
[0m08:27:30.322620 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m08:27:30.324534 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: BEGIN
[0m08:27:30.326488 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:27:30.633820 [debug] [Thread-1 (]: SQL status: OK in 0.307 seconds
[0m08:27:30.637806 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m08:27:30.647062 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */

  
    
    

    create  table
      "sales_database"."main"."transform_sales__dbt_tmp"
  
    as (
      -- /opt/airflow/dags/dbt_models/transform_users.sql


WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
   *
FROM sales
WHERE name = 'ABC private LTD-0002'
    );
  
  
[0m08:27:30.749635 [debug] [Thread-1 (]: SQL status: OK in 0.097 seconds
[0m08:27:30.763940 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m08:27:30.766373 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */
alter table "sales_database"."main"."transform_sales" rename to "transform_sales__dbt_backup"
[0m08:27:30.778198 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m08:27:30.798720 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m08:27:30.800918 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */
alter table "sales_database"."main"."transform_sales__dbt_tmp" rename to "transform_sales"
[0m08:27:30.805669 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:27:30.829234 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: COMMIT
[0m08:27:30.832449 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m08:27:30.836265 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: COMMIT
[0m08:27:30.891849 [debug] [Thread-1 (]: SQL status: OK in 0.051 seconds
[0m08:27:30.918402 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m08:27:30.921626 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */
drop table if exists "sales_database"."main"."transform_sales__dbt_backup" cascade
[0m08:27:30.937844 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m08:27:30.945321 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: Close
[0m08:27:31.202200 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e8a210f-3c53-43c2-9ed4-9560739f0ce4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a29872720>]}
[0m08:27:31.214269 [info ] [Thread-1 (]: 5 of 6 OK created sql table model main.transform_sales ......................... [[32mOK[0m in 1.05s]
[0m08:27:31.224283 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.transform_sales
[0m08:27:31.227035 [debug] [Thread-1 (]: Began running node model.my_dbt_project.sales_fact
[0m08:27:31.229484 [info ] [Thread-1 (]: 6 of 6 START sql table model main.sales_fact ................................... [RUN]
[0m08:27:31.231919 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.transform_sales, now model.my_dbt_project.sales_fact)
[0m08:27:31.233887 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.sales_fact
[0m08:27:31.249231 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.sales_fact"
[0m08:27:31.294303 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.sales_fact
[0m08:27:31.314222 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.sales_fact"
[0m08:27:31.414415 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_fact"
[0m08:27:31.416681 [debug] [Thread-1 (]: On model.my_dbt_project.sales_fact: BEGIN
[0m08:27:31.420035 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:27:31.551468 [debug] [Thread-1 (]: SQL status: OK in 0.132 seconds
[0m08:27:31.553910 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_fact"
[0m08:27:31.561280 [debug] [Thread-1 (]: On model.my_dbt_project.sales_fact: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_fact"} */

  
    
    

    create  table
      "sales_database"."main"."sales_fact__dbt_tmp"
  
    as (
      WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
),
customer AS (
    SELECT * FROM "sales_database"."main"."customer_dimension"
),
product AS (
    SELECT * FROM "sales_database"."main"."product_dimension"
),
sales_team AS (
    SELECT * FROM "sales_database"."main"."sales_team_dimension"
),
date AS (
    SELECT * FROM "sales_database"."main"."date_dimension"
)

SELECT
    sales.name AS sales_id,
    customer.customer_id,
    product.product_id,
    sales_team.sales_team_id,
    date.date_id,
    sales.total_qty,
    sales.total_net_weight,
    sales.total,
    sales.net_total,
    sales.grand_total,
    sales.tax_category
FROM sales
JOIN customer ON sales.customer = customer.customer_id
JOIN product ON sales.items @> ARRAY[product.product_id] -- Assuming `items` stores products as an array
JOIN sales_team ON sales.sales_team @> ARRAY[sales_team.sales_team_id] -- Assuming `sales_team` stores sales team info
JOIN date ON sales.transaction_date = date.date_id
    );
  
  
[0m08:27:31.742397 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_fact"} */

  
    
    

    create  table
      "sales_database"."main"."sales_fact__dbt_tmp"
  
    as (
      WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
),
customer AS (
    SELECT * FROM "sales_database"."main"."customer_dimension"
),
product AS (
    SELECT * FROM "sales_database"."main"."product_dimension"
),
sales_team AS (
    SELECT * FROM "sales_database"."main"."sales_team_dimension"
),
date AS (
    SELECT * FROM "sales_database"."main"."date_dimension"
)

SELECT
    sales.name AS sales_id,
    customer.customer_id,
    product.product_id,
    sales_team.sales_team_id,
    date.date_id,
    sales.total_qty,
    sales.total_net_weight,
    sales.total,
    sales.net_total,
    sales.grand_total,
    sales.tax_category
FROM sales
JOIN customer ON sales.customer = customer.customer_id
JOIN product ON sales.items @> ARRAY[product.product_id] -- Assuming `items` stores products as an array
JOIN sales_team ON sales.sales_team @> ARRAY[sales_team.sales_team_id] -- Assuming `sales_team` stores sales team info
JOIN date ON sales.transaction_date = date.date_id
    );
  
  
[0m08:27:31.744732 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m08:27:31.747626 [debug] [Thread-1 (]: On model.my_dbt_project.sales_fact: ROLLBACK
[0m08:27:31.812323 [debug] [Thread-1 (]: Failed to rollback 'model.my_dbt_project.sales_fact'
[0m08:27:31.817080 [debug] [Thread-1 (]: On model.my_dbt_project.sales_fact: Close
[0m08:27:31.880335 [debug] [Thread-1 (]: Runtime Error in model sales_fact (models/facts/sales_fact.sql)
  Binder Error: Values list "product" does not have a column named "product_id"
  LINE 41: JOIN product ON sales.items @> ARRAY[product.product_id] -- Assuming `items` stores products as an array
  JOIN sales_team ON sales.sales_team @> ARRAY[sales_team.sales_team_id] -- Assuming `sales_team` stores sales team info
  JOIN date ON sales.transaction_date = date.date_id
      );
    
    ...
                                                ^
[0m08:27:31.896155 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e8a210f-3c53-43c2-9ed4-9560739f0ce4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a297c4890>]}
[0m08:27:31.898756 [error] [Thread-1 (]: 6 of 6 ERROR creating sql table model main.sales_fact .......................... [[31mERROR[0m in 0.66s]
[0m08:27:31.902671 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.sales_fact
[0m08:27:31.921286 [debug] [Thread-4 (]: Marking all children of 'model.my_dbt_project.sales_fact' to be skipped because of status 'error'.  Reason: Runtime Error in model sales_fact (models/facts/sales_fact.sql)
  Binder Error: Values list "product" does not have a column named "product_id"
  LINE 41: JOIN product ON sales.items @> ARRAY[product.product_id] -- Assuming `items` stores products as an array
  JOIN sales_team ON sales.sales_team @> ARRAY[sales_team.sales_team_id] -- Assuming `sales_team` stores sales team info
  JOIN date ON sales.transaction_date = date.date_id
      );
    
    ...
                                                ^.
[0m08:27:31.940819 [debug] [MainThread]: Using duckdb connection "master"
[0m08:27:31.947740 [debug] [MainThread]: On master: BEGIN
[0m08:27:31.953609 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:27:32.100853 [debug] [MainThread]: SQL status: OK in 0.147 seconds
[0m08:27:32.113680 [debug] [MainThread]: On master: COMMIT
[0m08:27:32.129516 [debug] [MainThread]: Using duckdb connection "master"
[0m08:27:32.152164 [debug] [MainThread]: On master: COMMIT
[0m08:27:32.157901 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m08:27:32.160399 [debug] [MainThread]: On master: Close
[0m08:27:32.174557 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:27:32.176481 [debug] [MainThread]: Connection 'create_sales_database_main' was properly closed.
[0m08:27:32.178283 [debug] [MainThread]: Connection 'list_sales_database_main' was properly closed.
[0m08:27:32.180065 [debug] [MainThread]: Connection 'model.my_dbt_project.sales_fact' was properly closed.
[0m08:27:32.182814 [info ] [MainThread]: 
[0m08:27:32.188237 [info ] [MainThread]: Finished running 2 table models, 4 view models in 0 hours 0 minutes and 5.77 seconds (5.77s).
[0m08:27:32.195832 [debug] [MainThread]: Command end result
[0m08:27:32.637941 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m08:27:32.702528 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m08:27:32.829126 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dags/dbt_models/target/run_results.json
[0m08:27:32.838166 [info ] [MainThread]: 
[0m08:27:32.856996 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m08:27:32.869020 [info ] [MainThread]: 
[0m08:27:32.875434 [error] [MainThread]:   Runtime Error in model sales_fact (models/facts/sales_fact.sql)
  Binder Error: Values list "product" does not have a column named "product_id"
  LINE 41: JOIN product ON sales.items @> ARRAY[product.product_id] -- Assuming `items` stores products as an array
  JOIN sales_team ON sales.sales_team @> ARRAY[sales_team.sales_team_id] -- Assuming `sales_team` stores sales team info
  JOIN date ON sales.transaction_date = date.date_id
      );
    
    ...
                                                ^
[0m08:27:32.887691 [info ] [MainThread]: 
[0m08:27:32.908175 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m08:27:32.957983 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 28.236713, "process_in_blocks": "1852640", "process_kernel_time": 8.768709, "process_mem_max_rss": "139816", "process_out_blocks": "0", "process_user_time": 14.689798}
[0m08:27:32.971123 [debug] [MainThread]: Command `dbt run` failed at 08:27:32.970658 after 28.25 seconds
[0m08:27:32.974110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a30b4af30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a2a33f8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a317f65a0>]}
[0m08:27:32.981093 [debug] [MainThread]: Flushing usage events
[0m08:27:35.526131 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:29:55.418605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68e43a79e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68e40308c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68e3cc8290>]}


============================== 08:30:03.568792 | 2c726b11-063f-42bd-8680-096c7cabf90c ==============================
[0m08:30:03.568792 [info ] [MainThread]: Running with dbt=1.9.1
[0m08:30:03.572535 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/profiles.yml', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dags/dbt_models/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt/profiles.yml --target dev', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:30:31.571363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2c726b11-063f-42bd-8680-096c7cabf90c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68e19e17f0>]}
[0m08:30:32.071469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2c726b11-063f-42bd-8680-096c7cabf90c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68e19e17f0>]}
[0m08:30:32.163061 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m08:30:34.282761 [debug] [MainThread]: checksum: cac3b9519010e47bfbeb71ca6efb4867dae2858687671594dc23fefc94ecf25d, vars: {}, profile: , target: dev, version: 1.9.1
[0m08:30:35.773841 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:30:35.807497 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:30:36.302987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2c726b11-063f-42bd-8680-096c7cabf90c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68e1938110>]}
[0m08:30:37.380018 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m08:30:37.451393 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m08:30:38.623252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2c726b11-063f-42bd-8680-096c7cabf90c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68d7b034a0>]}
[0m08:30:38.679735 [info ] [MainThread]: Found 6 models, 1 source, 424 macros
[0m08:30:38.681997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2c726b11-063f-42bd-8680-096c7cabf90c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68d7b0fd40>]}
[0m08:30:38.702193 [info ] [MainThread]: 
[0m08:30:38.704072 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:30:38.708314 [info ] [MainThread]: 
[0m08:30:39.003407 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m08:30:39.049302 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_sales_database'
[0m08:30:41.843426 [debug] [ThreadPool]: Using duckdb connection "list_sales_database"
[0m08:30:43.282441 [debug] [ThreadPool]: On list_sales_database: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "list_sales_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"sales_database"'
    
  
  
[0m08:30:59.816162 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:31:35.908878 [debug] [ThreadPool]: SQL status: OK in 38.399 seconds
[0m08:31:35.915586 [debug] [ThreadPool]: On list_sales_database: Close
[0m08:31:35.930007 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_database, now create_sales_database_main)
[0m08:31:35.932650 [debug] [ThreadPool]: Creating schema "database: "sales_database"
schema: "main"
"
[0m08:31:35.960725 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m08:31:35.968563 [debug] [ThreadPool]: On create_sales_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "create_sales_database_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='sales_database'
        and type='sqlite'
    
  
[0m08:31:35.970766 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:31:36.040001 [debug] [ThreadPool]: SQL status: OK in 0.069 seconds
[0m08:31:36.053554 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m08:31:36.055957 [debug] [ThreadPool]: On create_sales_database_main: BEGIN
[0m08:31:36.059333 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m08:31:36.061445 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m08:31:36.074183 [debug] [ThreadPool]: On create_sales_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "create_sales_database_main"} */

    
    
        create schema if not exists "sales_database"."main"
    
[0m08:31:36.090235 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m08:31:36.094438 [debug] [ThreadPool]: On create_sales_database_main: COMMIT
[0m08:31:36.104357 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m08:31:36.108122 [debug] [ThreadPool]: On create_sales_database_main: COMMIT
[0m08:31:36.111173 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m08:31:36.115555 [debug] [ThreadPool]: On create_sales_database_main: Close
[0m08:31:36.135489 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_sales_database_main, now list_sales_database_main)
[0m08:31:36.200607 [debug] [ThreadPool]: Using duckdb connection "list_sales_database_main"
[0m08:31:36.202834 [debug] [ThreadPool]: On list_sales_database_main: BEGIN
[0m08:31:36.205755 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:31:36.313175 [debug] [ThreadPool]: SQL status: OK in 0.107 seconds
[0m08:31:36.316026 [debug] [ThreadPool]: Using duckdb connection "list_sales_database_main"
[0m08:31:36.318420 [debug] [ThreadPool]: On list_sales_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "list_sales_database_main"} */
select
      'sales_database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'sales_database'
  
[0m08:31:36.764152 [debug] [ThreadPool]: SQL status: OK in 0.444 seconds
[0m08:31:36.774495 [debug] [ThreadPool]: On list_sales_database_main: ROLLBACK
[0m08:31:36.872152 [debug] [ThreadPool]: Failed to rollback 'list_sales_database_main'
[0m08:31:36.874086 [debug] [ThreadPool]: On list_sales_database_main: Close
[0m08:31:36.886232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2c726b11-063f-42bd-8680-096c7cabf90c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68e3a270e0>]}
[0m08:31:36.889021 [debug] [MainThread]: Using duckdb connection "master"
[0m08:31:36.890769 [debug] [MainThread]: On master: BEGIN
[0m08:31:36.892427 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:31:37.076596 [debug] [MainThread]: SQL status: OK in 0.184 seconds
[0m08:31:37.093194 [debug] [MainThread]: On master: COMMIT
[0m08:31:37.101478 [debug] [MainThread]: Using duckdb connection "master"
[0m08:31:37.107619 [debug] [MainThread]: On master: COMMIT
[0m08:31:37.110876 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m08:31:37.124352 [debug] [MainThread]: On master: Close
[0m08:31:37.178947 [debug] [Thread-1 (]: Began running node model.my_dbt_project.customer_dimension
[0m08:31:37.197210 [info ] [Thread-1 (]: 1 of 6 START sql view model main.customer_dimension ............................ [RUN]
[0m08:31:37.226665 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.my_dbt_project.customer_dimension'
[0m08:31:37.242027 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.customer_dimension
[0m08:31:37.436418 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.customer_dimension"
[0m08:31:37.589727 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.customer_dimension
[0m08:31:38.713872 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.customer_dimension"
[0m08:31:38.815394 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m08:31:38.830475 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: BEGIN
[0m08:31:38.835920 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m08:31:40.182356 [debug] [Thread-1 (]: SQL status: OK in 1.342 seconds
[0m08:31:40.197067 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m08:31:40.200905 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */

  
  create view "sales_database"."main"."customer_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
    DISTINCT
    customer AS customer_id,
    customer_name,
    customer_address,
    customer_group,
    territory,
    language AS customer_language
FROM sales
WHERE customer IS NOT NULL
  );

[0m08:31:40.510496 [debug] [Thread-1 (]: SQL status: OK in 0.289 seconds
[0m08:31:40.581656 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m08:31:40.583744 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */
alter view "sales_database"."main"."customer_dimension" rename to "customer_dimension__dbt_backup"
[0m08:31:41.081100 [debug] [Thread-1 (]: SQL status: OK in 0.485 seconds
[0m08:31:41.170976 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m08:31:41.204815 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */
alter view "sales_database"."main"."customer_dimension__dbt_tmp" rename to "customer_dimension"
[0m08:31:42.385848 [debug] [Thread-1 (]: SQL status: OK in 0.958 seconds
[0m08:31:42.772222 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: COMMIT
[0m08:31:42.776084 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m08:31:42.781097 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: COMMIT
[0m08:31:45.099319 [debug] [Thread-1 (]: SQL status: OK in 2.300 seconds
[0m08:31:45.272336 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m08:31:45.303045 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */
drop view if exists "sales_database"."main"."customer_dimension__dbt_backup" cascade
[0m08:31:52.313450 [debug] [Thread-1 (]: SQL status: OK in 6.981 seconds
[0m08:31:52.339797 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: Close
[0m08:31:52.801574 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c726b11-063f-42bd-8680-096c7cabf90c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68e3d1a360>]}
[0m08:31:52.806124 [info ] [Thread-1 (]: 1 of 6 OK created sql view model main.customer_dimension ....................... [[32mOK[0m in 15.55s]
[0m08:31:52.808893 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.customer_dimension
[0m08:31:52.820489 [debug] [Thread-1 (]: Began running node model.my_dbt_project.date_dimension
[0m08:31:52.823565 [info ] [Thread-1 (]: 2 of 6 START sql view model main.date_dimension ................................ [RUN]
[0m08:31:52.825286 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customer_dimension, now model.my_dbt_project.date_dimension)
[0m08:31:52.853991 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.date_dimension
[0m08:31:52.864239 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.date_dimension"
[0m08:31:52.889670 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.date_dimension
[0m08:31:52.930944 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.date_dimension"
[0m08:31:52.972345 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m08:31:52.975891 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: BEGIN
[0m08:31:52.990469 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:31:53.376787 [debug] [Thread-1 (]: SQL status: OK in 0.376 seconds
[0m08:31:53.395617 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m08:31:53.414489 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.date_dimension"} */

  
  create view "sales_database"."main"."date_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
    transaction_date,
    strftime(transaction_date, '%A') AS weekday_name,  -- Extract weekday name
    strftime(transaction_date, '%m') AS month,          -- Extract month (numeric)
    strftime(transaction_date, '%Y') AS year,           -- Extract year
    strftime(transaction_date, '%d') AS day,            -- Extract day
    EXTRACT(QUARTER FROM transaction_date) AS quarter   -- Extract quarter
FROM sales
WHERE transaction_date IS NOT NULL
  );

[0m08:31:53.465224 [debug] [Thread-1 (]: SQL status: OK in 0.043 seconds
[0m08:31:53.525687 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m08:31:53.535676 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.date_dimension"} */
alter view "sales_database"."main"."date_dimension" rename to "date_dimension__dbt_backup"
[0m08:31:53.546579 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m08:31:53.585839 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m08:31:53.590203 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.date_dimension"} */
alter view "sales_database"."main"."date_dimension__dbt_tmp" rename to "date_dimension"
[0m08:31:53.594199 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:31:53.613295 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: COMMIT
[0m08:31:53.616871 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m08:31:53.628594 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: COMMIT
[0m08:31:53.653642 [debug] [Thread-1 (]: SQL status: OK in 0.023 seconds
[0m08:31:53.695668 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m08:31:53.716602 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.date_dimension"} */
drop view if exists "sales_database"."main"."date_dimension__dbt_backup" cascade
[0m08:31:53.757543 [debug] [Thread-1 (]: SQL status: OK in 0.036 seconds
[0m08:31:53.764136 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: Close
[0m08:31:54.255825 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c726b11-063f-42bd-8680-096c7cabf90c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68d6f7b080>]}
[0m08:31:54.321214 [info ] [Thread-1 (]: 2 of 6 OK created sql view model main.date_dimension ........................... [[32mOK[0m in 1.42s]
[0m08:31:54.337367 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.date_dimension
[0m08:31:54.353254 [debug] [Thread-1 (]: Began running node model.my_dbt_project.product_dimension
[0m08:31:54.401939 [info ] [Thread-1 (]: 3 of 6 START sql view model main.product_dimension ............................. [RUN]
[0m08:31:54.419904 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.date_dimension, now model.my_dbt_project.product_dimension)
[0m08:31:54.435430 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.product_dimension
[0m08:31:54.510922 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.product_dimension"
[0m08:31:54.844960 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.product_dimension
[0m08:31:54.947591 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.product_dimension"
[0m08:31:55.102667 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m08:31:55.120330 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: BEGIN
[0m08:31:55.148733 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:31:57.910995 [debug] [Thread-1 (]: SQL status: OK in 2.724 seconds
[0m08:31:57.950997 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m08:31:58.034649 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.product_dimension"} */

  
  create view "sales_database"."main"."product_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * 
    FROM "sales_database"."main"."sales"
)

SELECT 
    sales.name,
    json_extract(items, '$[0].name') AS product_name,  -- Example to extract the first element's "name" field from JSON array
    json_extract(items, '$[0].item_code') AS product_item_code
FROM sales
WHERE json_extract(items, '$[0].name') IS NOT NULL  -- Filter to only keep rows with a non-null product name
  );

[0m08:32:19.456680 [debug] [Thread-1 (]: SQL status: OK in 21.397 seconds
[0m08:32:19.999610 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m08:32:20.039242 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.product_dimension"} */
alter view "sales_database"."main"."product_dimension" rename to "product_dimension__dbt_backup"
[0m08:32:22.963844 [debug] [Thread-1 (]: SQL status: OK in 2.907 seconds
[0m08:32:23.123701 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m08:32:23.140780 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.product_dimension"} */
alter view "sales_database"."main"."product_dimension__dbt_tmp" rename to "product_dimension"
[0m08:32:29.874416 [debug] [Thread-1 (]: SQL status: OK in 6.711 seconds
[0m08:32:29.937419 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: COMMIT
[0m08:32:29.961418 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m08:32:29.969826 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: COMMIT
[0m08:32:30.164709 [debug] [Thread-1 (]: SQL status: OK in 0.170 seconds
[0m08:32:30.203159 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m08:32:30.233220 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.product_dimension"} */
drop view if exists "sales_database"."main"."product_dimension__dbt_backup" cascade
[0m08:32:30.286797 [debug] [Thread-1 (]: SQL status: OK in 0.050 seconds
[0m08:32:30.322006 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: Close
[0m08:32:30.626171 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c726b11-063f-42bd-8680-096c7cabf90c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68d6fd2de0>]}
[0m08:32:30.631260 [info ] [Thread-1 (]: 3 of 6 OK created sql view model main.product_dimension ........................ [[32mOK[0m in 36.19s]
[0m08:32:30.644511 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.product_dimension
[0m08:32:30.659509 [debug] [Thread-1 (]: Began running node model.my_dbt_project.sales_team_dimension
[0m08:32:30.663638 [info ] [Thread-1 (]: 4 of 6 START sql view model main.sales_team_dimension .......................... [RUN]
[0m08:32:30.678208 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.product_dimension, now model.my_dbt_project.sales_team_dimension)
[0m08:32:30.697144 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.sales_team_dimension
[0m08:32:30.761144 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.sales_team_dimension"
[0m08:32:30.843861 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.sales_team_dimension
[0m08:32:30.900295 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.sales_team_dimension"
[0m08:32:30.981751 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m08:32:30.992936 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: BEGIN
[0m08:32:31.018468 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:32:31.918030 [debug] [Thread-1 (]: SQL status: OK in 0.891 seconds
[0m08:32:31.923982 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m08:32:31.956626 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */

  
  create view "sales_database"."main"."sales_team_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
    DISTINCT
    sales_team->>'name' AS sales_team_id,
    sales_team->>'region' AS sales_team_region
FROM sales
WHERE sales_team IS NOT NULL
  );

[0m08:32:32.269913 [debug] [Thread-1 (]: SQL status: OK in 0.284 seconds
[0m08:32:32.409491 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m08:32:32.463136 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */
alter view "sales_database"."main"."sales_team_dimension" rename to "sales_team_dimension__dbt_backup"
[0m08:32:33.954610 [debug] [Thread-1 (]: SQL status: OK in 1.458 seconds
[0m08:32:34.056136 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m08:32:34.093896 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */
alter view "sales_database"."main"."sales_team_dimension__dbt_tmp" rename to "sales_team_dimension"
[0m08:32:34.216094 [debug] [Thread-1 (]: SQL status: OK in 0.120 seconds
[0m08:32:34.270604 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: COMMIT
[0m08:32:34.289502 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m08:32:34.296023 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: COMMIT
[0m08:32:34.396105 [debug] [Thread-1 (]: SQL status: OK in 0.077 seconds
[0m08:32:34.450076 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m08:32:34.456561 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */
drop view if exists "sales_database"."main"."sales_team_dimension__dbt_backup" cascade
[0m08:32:34.506191 [debug] [Thread-1 (]: SQL status: OK in 0.046 seconds
[0m08:32:34.521628 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: Close
[0m08:32:34.751567 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c726b11-063f-42bd-8680-096c7cabf90c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68d6f34fb0>]}
[0m08:32:34.753587 [info ] [Thread-1 (]: 4 of 6 OK created sql view model main.sales_team_dimension ..................... [[32mOK[0m in 4.08s]
[0m08:32:34.759434 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.sales_team_dimension
[0m08:32:34.777098 [debug] [Thread-1 (]: Began running node model.my_dbt_project.transform_sales
[0m08:32:34.794203 [info ] [Thread-1 (]: 5 of 6 START sql table model main.transform_sales .............................. [RUN]
[0m08:32:34.801710 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.sales_team_dimension, now model.my_dbt_project.transform_sales)
[0m08:32:34.812740 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.transform_sales
[0m08:32:34.829363 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.transform_sales"
[0m08:32:34.856665 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.transform_sales
[0m08:32:34.972716 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.transform_sales"
[0m08:32:35.005800 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m08:32:35.007732 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: BEGIN
[0m08:32:35.010297 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:32:35.366340 [debug] [Thread-1 (]: SQL status: OK in 0.355 seconds
[0m08:32:35.401928 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m08:32:35.443901 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */

  
    
    

    create  table
      "sales_database"."main"."transform_sales__dbt_tmp"
  
    as (
      -- /opt/airflow/dags/dbt_models/transform_users.sql


WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
   *
FROM sales
WHERE name = 'ABC private LTD-0002'
    );
  
  
[0m08:32:35.732437 [debug] [Thread-1 (]: SQL status: OK in 0.251 seconds
[0m08:32:35.759602 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m08:32:35.761647 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */
alter table "sales_database"."main"."transform_sales" rename to "transform_sales__dbt_backup"
[0m08:32:35.783788 [debug] [Thread-1 (]: SQL status: OK in 0.020 seconds
[0m08:32:35.927655 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m08:32:35.946124 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */
alter table "sales_database"."main"."transform_sales__dbt_tmp" rename to "transform_sales"
[0m08:32:35.950467 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m08:32:35.990344 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: COMMIT
[0m08:32:35.997236 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m08:32:36.012442 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: COMMIT
[0m08:32:36.075255 [debug] [Thread-1 (]: SQL status: OK in 0.061 seconds
[0m08:32:36.089190 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m08:32:36.118552 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */
drop table if exists "sales_database"."main"."transform_sales__dbt_backup" cascade
[0m08:32:36.153339 [debug] [Thread-1 (]: SQL status: OK in 0.028 seconds
[0m08:32:36.159765 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: Close
[0m08:32:36.617905 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c726b11-063f-42bd-8680-096c7cabf90c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68d6ff8230>]}
[0m08:32:36.620369 [info ] [Thread-1 (]: 5 of 6 OK created sql table model main.transform_sales ......................... [[32mOK[0m in 1.82s]
[0m08:32:36.622796 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.transform_sales
[0m08:32:36.625992 [debug] [Thread-1 (]: Began running node model.my_dbt_project.sales_fact
[0m08:32:36.629124 [info ] [Thread-1 (]: 6 of 6 START sql table model main.sales_fact ................................... [RUN]
[0m08:32:36.631901 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.transform_sales, now model.my_dbt_project.sales_fact)
[0m08:32:36.641479 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.sales_fact
[0m08:32:36.672059 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.sales_fact"
[0m08:32:36.726105 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.sales_fact
[0m08:32:36.797871 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.sales_fact"
[0m08:32:36.856978 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_fact"
[0m08:32:36.865890 [debug] [Thread-1 (]: On model.my_dbt_project.sales_fact: BEGIN
[0m08:32:36.868048 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:32:37.164305 [debug] [Thread-1 (]: SQL status: OK in 0.289 seconds
[0m08:32:37.191542 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_fact"
[0m08:32:37.198369 [debug] [Thread-1 (]: On model.my_dbt_project.sales_fact: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_fact"} */

  
    
    

    create  table
      "sales_database"."main"."sales_fact__dbt_tmp"
  
    as (
      WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
),
customer AS (
    SELECT * FROM "sales_database"."main"."customer_dimension"
),
product AS (
    SELECT * FROM "sales_database"."main"."product_dimension"
),
sales_team AS (
    SELECT * FROM "sales_database"."main"."sales_team_dimension"
),
date AS (
    SELECT * FROM "sales_database"."main"."date_dimension"
)

SELECT
    sales.name AS sales_id,
    customer.customer_id,
    product.product_id,
    sales_team.sales_team_id,
    date.date_id,
    sales.total_qty,
    sales.total_net_weight,
    sales.total,
    sales.net_total,
    sales.grand_total,
    sales.tax_category
FROM sales
JOIN customer ON sales.customer = customer.customer_id
JOIN product ON sales.items @> ARRAY[product.product_id] -- Assuming `items` stores products as an array
JOIN sales_team ON sales.sales_team @> ARRAY[sales_team.sales_team_id] -- Assuming `sales_team` stores sales team info
JOIN date ON sales.transaction_date = date.date_id
    );
  
  
[0m08:38:27.764903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc69064a3f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc692474680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc69064a360>]}


============================== 08:38:27.790506 | 845d3056-c8dd-4f49-9bfa-7d99e81f2dc8 ==============================
[0m08:38:27.790506 [info ] [MainThread]: Running with dbt=1.9.1
[0m08:38:27.792897 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dags/dbt_models/logs', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt/profiles.yml', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt/profiles.yml --target dev', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:38:30.282596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '845d3056-c8dd-4f49-9bfa-7d99e81f2dc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc68a769490>]}
[0m08:38:30.662192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '845d3056-c8dd-4f49-9bfa-7d99e81f2dc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc690b610a0>]}
[0m08:38:30.713315 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m08:38:31.621253 [debug] [MainThread]: checksum: cac3b9519010e47bfbeb71ca6efb4867dae2858687671594dc23fefc94ecf25d, vars: {}, profile: , target: dev, version: 1.9.1
[0m08:38:33.470358 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:38:33.483560 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:38:33.909340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '845d3056-c8dd-4f49-9bfa-7d99e81f2dc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc68a798710>]}
[0m08:38:34.666101 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m08:38:34.688108 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m08:38:35.012432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '845d3056-c8dd-4f49-9bfa-7d99e81f2dc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6913fbaa0>]}
[0m08:38:35.014859 [info ] [MainThread]: Found 6 models, 1 source, 424 macros
[0m08:38:35.024283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '845d3056-c8dd-4f49-9bfa-7d99e81f2dc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc68a751a60>]}
[0m08:38:35.030559 [info ] [MainThread]: 
[0m08:38:35.038935 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:38:35.045144 [info ] [MainThread]: 
[0m08:38:35.048948 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m08:38:35.074308 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_sales_database'
[0m08:38:35.515328 [debug] [ThreadPool]: Using duckdb connection "list_sales_database"
[0m08:38:35.519444 [debug] [ThreadPool]: On list_sales_database: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "list_sales_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"sales_database"'
    
  
  
[0m08:38:35.521258 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:38:35.664822 [debug] [ThreadPool]: SQL status: OK in 0.143 seconds
[0m08:38:35.672747 [debug] [ThreadPool]: On list_sales_database: Close
[0m08:38:35.687799 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_database, now create_sales_database_main)
[0m08:38:35.721128 [debug] [ThreadPool]: Creating schema "database: "sales_database"
schema: "main"
"
[0m08:38:35.743450 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m08:38:35.744995 [debug] [ThreadPool]: On create_sales_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "create_sales_database_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='sales_database'
        and type='sqlite'
    
  
[0m08:38:35.746629 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:38:35.791943 [debug] [ThreadPool]: SQL status: OK in 0.045 seconds
[0m08:38:35.796467 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m08:38:35.798172 [debug] [ThreadPool]: On create_sales_database_main: BEGIN
[0m08:38:35.800603 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m08:38:35.803024 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m08:38:35.804923 [debug] [ThreadPool]: On create_sales_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "create_sales_database_main"} */

    
    
        create schema if not exists "sales_database"."main"
    
[0m08:38:35.808478 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m08:38:35.811711 [debug] [ThreadPool]: On create_sales_database_main: COMMIT
[0m08:38:35.814777 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m08:38:35.816761 [debug] [ThreadPool]: On create_sales_database_main: COMMIT
[0m08:38:35.821160 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m08:38:35.822700 [debug] [ThreadPool]: On create_sales_database_main: Close
[0m08:38:35.830438 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_sales_database_main'
[0m08:38:35.858953 [debug] [ThreadPool]: Using duckdb connection "list_sales_database_main"
[0m08:38:35.869110 [debug] [ThreadPool]: On list_sales_database_main: BEGIN
[0m08:38:35.873572 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:38:35.956659 [debug] [ThreadPool]: SQL status: OK in 0.083 seconds
[0m08:38:35.976874 [debug] [ThreadPool]: Using duckdb connection "list_sales_database_main"
[0m08:38:35.983586 [debug] [ThreadPool]: On list_sales_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "list_sales_database_main"} */
select
      'sales_database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'sales_database'
  
[0m08:38:36.189420 [debug] [ThreadPool]: SQL status: OK in 0.194 seconds
[0m08:38:36.198765 [debug] [ThreadPool]: On list_sales_database_main: ROLLBACK
[0m08:38:36.217334 [debug] [ThreadPool]: Failed to rollback 'list_sales_database_main'
[0m08:38:36.222371 [debug] [ThreadPool]: On list_sales_database_main: Close
[0m08:38:36.257224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '845d3056-c8dd-4f49-9bfa-7d99e81f2dc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc68fe481d0>]}
[0m08:38:36.259479 [debug] [MainThread]: Using duckdb connection "master"
[0m08:38:36.261313 [debug] [MainThread]: On master: BEGIN
[0m08:38:36.264885 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:38:36.335795 [debug] [MainThread]: SQL status: OK in 0.071 seconds
[0m08:38:36.339783 [debug] [MainThread]: On master: COMMIT
[0m08:38:36.344303 [debug] [MainThread]: Using duckdb connection "master"
[0m08:38:36.346281 [debug] [MainThread]: On master: COMMIT
[0m08:38:36.349048 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m08:38:36.352039 [debug] [MainThread]: On master: Close
[0m08:38:36.387854 [debug] [Thread-1 (]: Began running node model.my_dbt_project.customer_dimension
[0m08:38:36.390441 [info ] [Thread-1 (]: 1 of 6 START sql view model main.customer_dimension ............................ [RUN]
[0m08:38:36.393221 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.my_dbt_project.customer_dimension'
[0m08:38:36.395281 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.customer_dimension
[0m08:38:36.429159 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.customer_dimension"
[0m08:38:36.466379 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.customer_dimension
[0m08:38:36.618195 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.customer_dimension"
[0m08:38:36.660617 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m08:38:36.668643 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: BEGIN
[0m08:38:36.671217 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m08:38:36.714002 [debug] [Thread-1 (]: SQL status: OK in 0.043 seconds
[0m08:38:36.715231 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m08:38:36.716364 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */

  
  create view "sales_database"."main"."customer_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
    DISTINCT
    customer AS customer_id,
    customer_name,
    customer_address,
    customer_group,
    territory,
    language AS customer_language
FROM sales
WHERE customer IS NOT NULL
  );

[0m08:38:36.725564 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m08:38:36.783536 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m08:38:36.805109 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */
alter view "sales_database"."main"."customer_dimension" rename to "customer_dimension__dbt_backup"
[0m08:38:36.828976 [debug] [Thread-1 (]: SQL status: OK in 0.016 seconds
[0m08:38:36.864861 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m08:38:36.879717 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */
alter view "sales_database"."main"."customer_dimension__dbt_tmp" rename to "customer_dimension"
[0m08:38:36.897282 [debug] [Thread-1 (]: SQL status: OK in 0.015 seconds
[0m08:38:36.985488 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: COMMIT
[0m08:38:36.988082 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m08:38:36.990217 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: COMMIT
[0m08:38:37.020226 [debug] [Thread-1 (]: SQL status: OK in 0.028 seconds
[0m08:38:37.038589 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m08:38:37.041123 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */
drop view if exists "sales_database"."main"."customer_dimension__dbt_backup" cascade
[0m08:38:37.061432 [debug] [Thread-1 (]: SQL status: OK in 0.018 seconds
[0m08:38:37.072961 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: Close
[0m08:38:37.232767 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '845d3056-c8dd-4f49-9bfa-7d99e81f2dc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc689426a80>]}
[0m08:38:37.237258 [info ] [Thread-1 (]: 1 of 6 OK created sql view model main.customer_dimension ....................... [[32mOK[0m in 0.83s]
[0m08:38:37.240128 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.customer_dimension
[0m08:38:37.241888 [debug] [Thread-1 (]: Began running node model.my_dbt_project.date_dimension
[0m08:38:37.244074 [info ] [Thread-1 (]: 2 of 6 START sql view model main.date_dimension ................................ [RUN]
[0m08:38:37.246378 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customer_dimension, now model.my_dbt_project.date_dimension)
[0m08:38:37.248502 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.date_dimension
[0m08:38:37.262089 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.date_dimension"
[0m08:38:37.281179 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.date_dimension
[0m08:38:37.295606 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.date_dimension"
[0m08:38:37.310205 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m08:38:37.311609 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: BEGIN
[0m08:38:37.313367 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:38:37.366314 [debug] [Thread-1 (]: SQL status: OK in 0.053 seconds
[0m08:38:37.370138 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m08:38:37.372299 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.date_dimension"} */

  
  create view "sales_database"."main"."date_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
    transaction_date,
    strftime(transaction_date, '%A') AS weekday_name,  -- Extract weekday name
    strftime(transaction_date, '%m') AS month,          -- Extract month (numeric)
    strftime(transaction_date, '%Y') AS year,           -- Extract year
    strftime(transaction_date, '%d') AS day,            -- Extract day
    EXTRACT(QUARTER FROM transaction_date) AS quarter   -- Extract quarter
FROM sales
WHERE transaction_date IS NOT NULL
  );

[0m08:38:37.380525 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m08:38:37.409551 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m08:38:37.411818 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.date_dimension"} */
alter view "sales_database"."main"."date_dimension" rename to "date_dimension__dbt_backup"
[0m08:38:37.414747 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:38:37.431203 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m08:38:37.433571 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.date_dimension"} */
alter view "sales_database"."main"."date_dimension__dbt_tmp" rename to "date_dimension"
[0m08:38:37.438487 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m08:38:37.448050 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: COMMIT
[0m08:38:37.450098 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m08:38:37.452415 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: COMMIT
[0m08:38:37.507798 [debug] [Thread-1 (]: SQL status: OK in 0.038 seconds
[0m08:38:37.530380 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m08:38:37.535372 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.date_dimension"} */
drop view if exists "sales_database"."main"."date_dimension__dbt_backup" cascade
[0m08:38:37.571116 [debug] [Thread-1 (]: SQL status: OK in 0.033 seconds
[0m08:38:37.580057 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: Close
[0m08:38:37.817655 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '845d3056-c8dd-4f49-9bfa-7d99e81f2dc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc690b94500>]}
[0m08:38:37.822258 [info ] [Thread-1 (]: 2 of 6 OK created sql view model main.date_dimension ........................... [[32mOK[0m in 0.57s]
[0m08:38:37.851317 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.date_dimension
[0m08:38:37.867237 [debug] [Thread-1 (]: Began running node model.my_dbt_project.product_dimension
[0m08:38:37.873109 [info ] [Thread-1 (]: 3 of 6 START sql view model main.product_dimension ............................. [RUN]
[0m08:38:37.876426 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.date_dimension, now model.my_dbt_project.product_dimension)
[0m08:38:37.884845 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.product_dimension
[0m08:38:37.943710 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.product_dimension"
[0m08:38:37.964648 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.product_dimension
[0m08:38:37.976882 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.product_dimension"
[0m08:38:38.032996 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m08:38:38.035655 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: BEGIN
[0m08:38:38.037971 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:38:38.593631 [debug] [Thread-1 (]: SQL status: OK in 0.556 seconds
[0m08:38:38.602212 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m08:38:38.623031 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.product_dimension"} */

  
  create view "sales_database"."main"."product_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * 
    FROM "sales_database"."main"."sales"
)

SELECT 
    sales.name,
    json_extract(items, '$[0].name') AS product_name,  -- Example to extract the first element's "name" field from JSON array
    json_extract(items, '$[0].item_code') AS product_item_code
FROM sales
WHERE json_extract(items, '$[0].name') IS NOT NULL  -- Filter to only keep rows with a non-null product name
  );

[0m08:38:38.758955 [debug] [Thread-1 (]: SQL status: OK in 0.132 seconds
[0m08:38:38.780749 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m08:38:38.787560 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.product_dimension"} */
alter view "sales_database"."main"."product_dimension" rename to "product_dimension__dbt_backup"
[0m08:38:38.832650 [debug] [Thread-1 (]: SQL status: OK in 0.031 seconds
[0m08:38:38.880390 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m08:38:38.882869 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.product_dimension"} */
alter view "sales_database"."main"."product_dimension__dbt_tmp" rename to "product_dimension"
[0m08:38:38.896817 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m08:38:38.918360 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: COMMIT
[0m08:38:38.939567 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m08:38:38.963246 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: COMMIT
[0m08:38:39.133174 [debug] [Thread-1 (]: SQL status: OK in 0.154 seconds
[0m08:38:39.160059 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m08:38:39.161518 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.product_dimension"} */
drop view if exists "sales_database"."main"."product_dimension__dbt_backup" cascade
[0m08:38:39.283058 [debug] [Thread-1 (]: SQL status: OK in 0.120 seconds
[0m08:38:39.289306 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: Close
[0m08:38:39.893783 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '845d3056-c8dd-4f49-9bfa-7d99e81f2dc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6894c1b80>]}
[0m08:38:39.909580 [info ] [Thread-1 (]: 3 of 6 OK created sql view model main.product_dimension ........................ [[32mOK[0m in 2.01s]
[0m08:38:39.913653 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.product_dimension
[0m08:38:39.919936 [debug] [Thread-1 (]: Began running node model.my_dbt_project.sales_team_dimension
[0m08:38:39.926088 [info ] [Thread-1 (]: 4 of 6 START sql view model main.sales_team_dimension .......................... [RUN]
[0m08:38:39.927781 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.product_dimension, now model.my_dbt_project.sales_team_dimension)
[0m08:38:39.929049 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.sales_team_dimension
[0m08:38:39.940043 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.sales_team_dimension"
[0m08:38:39.957554 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.sales_team_dimension
[0m08:38:40.025163 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.sales_team_dimension"
[0m08:38:40.109453 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m08:38:40.113501 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: BEGIN
[0m08:38:40.116669 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:38:41.122805 [debug] [Thread-1 (]: SQL status: OK in 0.981 seconds
[0m08:38:41.234324 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m08:38:41.252160 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */

  
  create view "sales_database"."main"."sales_team_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
    DISTINCT
    sales_team->>'name' AS sales_team_id,
    sales_team->>'region' AS sales_team_region
FROM sales
WHERE sales_team IS NOT NULL
  );

[0m08:38:41.645406 [debug] [Thread-1 (]: SQL status: OK in 0.380 seconds
[0m08:38:41.838648 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m08:38:42.089494 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */
alter view "sales_database"."main"."sales_team_dimension" rename to "sales_team_dimension__dbt_backup"
[0m08:38:42.661139 [debug] [Thread-1 (]: SQL status: OK in 0.399 seconds
[0m08:38:42.719135 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m08:38:42.722445 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */
alter view "sales_database"."main"."sales_team_dimension__dbt_tmp" rename to "sales_team_dimension"
[0m08:38:42.974923 [debug] [Thread-1 (]: SQL status: OK in 0.231 seconds
[0m08:38:42.996313 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: COMMIT
[0m08:38:43.001998 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m08:38:43.006875 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: COMMIT
[0m08:38:44.782370 [debug] [Thread-1 (]: SQL status: OK in 1.706 seconds
[0m08:38:44.828185 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m08:38:44.844545 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */
drop view if exists "sales_database"."main"."sales_team_dimension__dbt_backup" cascade
[0m08:38:45.284402 [debug] [Thread-1 (]: SQL status: OK in 0.411 seconds
[0m08:38:45.327676 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: Close
[0m08:38:46.074144 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '845d3056-c8dd-4f49-9bfa-7d99e81f2dc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc68945be00>]}
[0m08:38:46.092535 [info ] [Thread-1 (]: 4 of 6 OK created sql view model main.sales_team_dimension ..................... [[32mOK[0m in 6.07s]
[0m08:38:46.095950 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.sales_team_dimension
[0m08:38:46.102498 [debug] [Thread-1 (]: Began running node model.my_dbt_project.transform_sales
[0m08:38:46.107441 [info ] [Thread-1 (]: 5 of 6 START sql table model main.transform_sales .............................. [RUN]
[0m08:38:46.117098 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.sales_team_dimension, now model.my_dbt_project.transform_sales)
[0m08:38:46.119192 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.transform_sales
[0m08:38:46.141324 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.transform_sales"
[0m08:38:46.173629 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.transform_sales
[0m08:38:46.307111 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.transform_sales"
[0m08:38:46.369877 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m08:38:46.373702 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: BEGIN
[0m08:38:46.377194 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:38:52.862658 [debug] [Thread-1 (]: SQL status: OK in 6.186 seconds
[0m08:38:52.897521 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m08:38:52.907987 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */

  
    
    

    create  table
      "sales_database"."main"."transform_sales__dbt_tmp"
  
    as (
      -- /opt/airflow/dags/dbt_models/transform_users.sql


WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
   *
FROM sales
WHERE name = 'ABC private LTD-0002'
    );
  
  
[0m08:39:49.683696 [debug] [Thread-1 (]: SQL status: OK in 56.757 seconds
[0m08:39:49.723534 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m08:39:49.732120 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */
alter table "sales_database"."main"."transform_sales" rename to "transform_sales__dbt_backup"
[0m08:39:49.816925 [debug] [Thread-1 (]: SQL status: OK in 0.081 seconds
[0m08:39:49.837588 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m08:39:49.839140 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */
alter table "sales_database"."main"."transform_sales__dbt_tmp" rename to "transform_sales"
[0m08:39:49.842681 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:39:49.892715 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: COMMIT
[0m08:39:49.897242 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m08:39:49.900555 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: COMMIT
[0m08:39:49.982076 [debug] [Thread-1 (]: SQL status: OK in 0.079 seconds
[0m08:39:50.014521 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m08:39:50.046330 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */
drop table if exists "sales_database"."main"."transform_sales__dbt_backup" cascade
[0m08:39:50.110657 [debug] [Thread-1 (]: SQL status: OK in 0.046 seconds
[0m08:39:50.117636 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: Close
[0m08:39:50.523817 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '845d3056-c8dd-4f49-9bfa-7d99e81f2dc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6894f82f0>]}
[0m08:39:50.538293 [info ] [Thread-1 (]: 5 of 6 OK created sql table model main.transform_sales ......................... [[32mOK[0m in 64.41s]
[0m08:39:50.571487 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.transform_sales
[0m08:39:50.582538 [debug] [Thread-1 (]: Began running node model.my_dbt_project.sales_fact
[0m08:39:50.614828 [info ] [Thread-1 (]: 6 of 6 START sql table model main.sales_fact ................................... [RUN]
[0m08:39:50.642594 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.transform_sales, now model.my_dbt_project.sales_fact)
[0m08:39:50.678345 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.sales_fact
[0m08:39:50.707457 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.sales_fact"
[0m08:39:50.822797 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.sales_fact
[0m08:39:50.846412 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.sales_fact"
[0m08:39:50.974387 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_fact"
[0m08:39:50.977008 [debug] [Thread-1 (]: On model.my_dbt_project.sales_fact: BEGIN
[0m08:39:50.980262 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:39:51.205355 [debug] [Thread-1 (]: SQL status: OK in 0.225 seconds
[0m08:39:51.220806 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_fact"
[0m08:39:51.226558 [debug] [Thread-1 (]: On model.my_dbt_project.sales_fact: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_fact"} */

  
    
    

    create  table
      "sales_database"."main"."sales_fact__dbt_tmp"
  
    as (
      WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
),
customer AS (
    SELECT * FROM "sales_database"."main"."customer_dimension"
),
product AS (
    SELECT * FROM "sales_database"."main"."product_dimension"
),
sales_team AS (
    SELECT * FROM "sales_database"."main"."sales_team_dimension"
),
date AS (
    SELECT * FROM "sales_database"."main"."date_dimension"
)

SELECT
    sales.name AS sales_id,
    customer.customer_id,
    product.product_id,
    sales_team.sales_team_id,
    date.date_id,
    sales.total_qty,
    sales.total_net_weight,
    sales.total,
    sales.net_total,
    sales.grand_total,
    sales.tax_category
FROM sales
JOIN customer ON sales.customer = customer.customer_id
JOIN product ON sales.items @> ARRAY[product.product_id] -- Assuming `items` stores products as an array
JOIN sales_team ON sales.sales_team @> ARRAY[sales_team.sales_team_id] -- Assuming `sales_team` stores sales team info
JOIN date ON sales.transaction_date = date.date_id
    );
  
  
[0m08:39:51.336008 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_fact"} */

  
    
    

    create  table
      "sales_database"."main"."sales_fact__dbt_tmp"
  
    as (
      WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
),
customer AS (
    SELECT * FROM "sales_database"."main"."customer_dimension"
),
product AS (
    SELECT * FROM "sales_database"."main"."product_dimension"
),
sales_team AS (
    SELECT * FROM "sales_database"."main"."sales_team_dimension"
),
date AS (
    SELECT * FROM "sales_database"."main"."date_dimension"
)

SELECT
    sales.name AS sales_id,
    customer.customer_id,
    product.product_id,
    sales_team.sales_team_id,
    date.date_id,
    sales.total_qty,
    sales.total_net_weight,
    sales.total,
    sales.net_total,
    sales.grand_total,
    sales.tax_category
FROM sales
JOIN customer ON sales.customer = customer.customer_id
JOIN product ON sales.items @> ARRAY[product.product_id] -- Assuming `items` stores products as an array
JOIN sales_team ON sales.sales_team @> ARRAY[sales_team.sales_team_id] -- Assuming `sales_team` stores sales team info
JOIN date ON sales.transaction_date = date.date_id
    );
  
  
[0m08:39:51.349810 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m08:39:51.352388 [debug] [Thread-1 (]: On model.my_dbt_project.sales_fact: ROLLBACK
[0m08:39:51.479212 [debug] [Thread-1 (]: Failed to rollback 'model.my_dbt_project.sales_fact'
[0m08:39:51.490747 [debug] [Thread-1 (]: On model.my_dbt_project.sales_fact: Close
[0m08:39:51.553551 [debug] [Thread-1 (]: Runtime Error in model sales_fact (models/facts/sales_fact.sql)
  Binder Error: Values list "product" does not have a column named "product_id"
  LINE 41: JOIN product ON sales.items @> ARRAY[product.product_id] -- Assuming `items` stores products as an array
  JOIN sales_team ON sales.sales_team @> ARRAY[sales_team.sales_team_id] -- Assuming `sales_team` stores sales team info
  JOIN date ON sales.transaction_date = date.date_id
      );
    
    ...
                                                ^
[0m08:39:51.560679 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '845d3056-c8dd-4f49-9bfa-7d99e81f2dc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6894fa9f0>]}
[0m08:39:51.575918 [error] [Thread-1 (]: 6 of 6 ERROR creating sql table model main.sales_fact .......................... [[31mERROR[0m in 0.93s]
[0m08:39:51.605435 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.sales_fact
[0m08:39:51.641723 [debug] [Thread-4 (]: Marking all children of 'model.my_dbt_project.sales_fact' to be skipped because of status 'error'.  Reason: Runtime Error in model sales_fact (models/facts/sales_fact.sql)
  Binder Error: Values list "product" does not have a column named "product_id"
  LINE 41: JOIN product ON sales.items @> ARRAY[product.product_id] -- Assuming `items` stores products as an array
  JOIN sales_team ON sales.sales_team @> ARRAY[sales_team.sales_team_id] -- Assuming `sales_team` stores sales team info
  JOIN date ON sales.transaction_date = date.date_id
      );
    
    ...
                                                ^.
[0m08:39:51.688998 [debug] [MainThread]: Using duckdb connection "master"
[0m08:39:51.702401 [debug] [MainThread]: On master: BEGIN
[0m08:39:51.704600 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:39:52.059482 [debug] [MainThread]: SQL status: OK in 0.355 seconds
[0m08:39:52.067925 [debug] [MainThread]: On master: COMMIT
[0m08:39:52.077070 [debug] [MainThread]: Using duckdb connection "master"
[0m08:39:52.092892 [debug] [MainThread]: On master: COMMIT
[0m08:39:52.159527 [debug] [MainThread]: SQL status: OK in 0.039 seconds
[0m08:39:52.175310 [debug] [MainThread]: On master: Close
[0m08:39:52.246770 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:39:52.270765 [debug] [MainThread]: Connection 'create_sales_database_main' was properly closed.
[0m08:39:52.282026 [debug] [MainThread]: Connection 'list_sales_database_main' was properly closed.
[0m08:39:52.294903 [debug] [MainThread]: Connection 'model.my_dbt_project.sales_fact' was properly closed.
[0m08:39:52.303912 [info ] [MainThread]: 
[0m08:39:52.319111 [info ] [MainThread]: Finished running 2 table models, 4 view models in 0 hours 1 minutes and 17.25 seconds (77.25s).
[0m08:39:52.340819 [debug] [MainThread]: Command end result
[0m08:39:52.940928 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m08:39:53.084332 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m08:39:53.267862 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dags/dbt_models/target/run_results.json
[0m08:39:53.273188 [info ] [MainThread]: 
[0m08:39:53.287149 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m08:39:53.300304 [info ] [MainThread]: 
[0m08:39:53.311223 [error] [MainThread]:   Runtime Error in model sales_fact (models/facts/sales_fact.sql)
  Binder Error: Values list "product" does not have a column named "product_id"
  LINE 41: JOIN product ON sales.items @> ARRAY[product.product_id] -- Assuming `items` stores products as an array
  JOIN sales_team ON sales.sales_team @> ARRAY[sales_team.sales_team_id] -- Assuming `sales_team` stores sales team info
  JOIN date ON sales.transaction_date = date.date_id
      );
    
    ...
                                                ^
[0m08:39:53.318528 [info ] [MainThread]: 
[0m08:39:53.332875 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m08:39:53.358531 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 86.0354, "process_in_blocks": "4210832", "process_kernel_time": 11.900539, "process_mem_max_rss": "134392", "process_out_blocks": "0", "process_user_time": 21.77609}
[0m08:39:53.374946 [debug] [MainThread]: Command `dbt run` failed at 08:39:53.374255 after 86.06 seconds
[0m08:39:53.390275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc691290500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc690d3ad20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6902e7cb0>]}
[0m08:39:53.397701 [debug] [MainThread]: Flushing usage events
[0m08:39:55.545299 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:48:37.688647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0da189cc20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0da0f54cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0da12f0950>]}


============================== 08:48:37.700809 | f446278d-17fd-4415-9b88-69dff059ee9b ==============================
[0m08:48:37.700809 [info ] [MainThread]: Running with dbt=1.9.1
[0m08:48:37.703030 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/profiles.yml', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dags/dbt_models/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt/profiles.yml --target dev', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m08:48:38.241884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f446278d-17fd-4415-9b88-69dff059ee9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d9b317500>]}
[0m08:48:38.338726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f446278d-17fd-4415-9b88-69dff059ee9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0da0b203b0>]}
[0m08:48:38.351024 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m08:48:38.554275 [debug] [MainThread]: checksum: cac3b9519010e47bfbeb71ca6efb4867dae2858687671594dc23fefc94ecf25d, vars: {}, profile: , target: dev, version: 1.9.1
[0m08:48:39.006688 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:48:39.008215 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/facts/sales_fact.sql
[0m08:48:39.506787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f446278d-17fd-4415-9b88-69dff059ee9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d9a367890>]}
[0m08:48:39.664036 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m08:48:39.677747 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m08:48:39.776638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f446278d-17fd-4415-9b88-69dff059ee9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d9a32d130>]}
[0m08:48:39.778150 [info ] [MainThread]: Found 6 models, 1 source, 424 macros
[0m08:48:39.779362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f446278d-17fd-4415-9b88-69dff059ee9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d9a348ef0>]}
[0m08:48:39.783449 [info ] [MainThread]: 
[0m08:48:39.784782 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:48:39.786077 [info ] [MainThread]: 
[0m08:48:39.787762 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m08:48:39.797450 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_sales_database'
[0m08:48:39.887771 [debug] [ThreadPool]: Using duckdb connection "list_sales_database"
[0m08:48:39.889281 [debug] [ThreadPool]: On list_sales_database: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "list_sales_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"sales_database"'
    
  
  
[0m08:48:39.890653 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:48:39.930724 [debug] [ThreadPool]: SQL status: OK in 0.040 seconds
[0m08:48:39.933997 [debug] [ThreadPool]: On list_sales_database: Close
[0m08:48:39.939958 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_database, now create_sales_database_main)
[0m08:48:39.941707 [debug] [ThreadPool]: Creating schema "database: "sales_database"
schema: "main"
"
[0m08:48:39.954296 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m08:48:39.955771 [debug] [ThreadPool]: On create_sales_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "create_sales_database_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='sales_database'
        and type='sqlite'
    
  
[0m08:48:39.957129 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:48:39.990646 [debug] [ThreadPool]: SQL status: OK in 0.033 seconds
[0m08:48:39.993477 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m08:48:39.994867 [debug] [ThreadPool]: On create_sales_database_main: BEGIN
[0m08:48:39.996784 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m08:48:39.998141 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m08:48:39.999496 [debug] [ThreadPool]: On create_sales_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "create_sales_database_main"} */

    
    
        create schema if not exists "sales_database"."main"
    
[0m08:48:40.001664 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m08:48:40.003918 [debug] [ThreadPool]: On create_sales_database_main: COMMIT
[0m08:48:40.005329 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m08:48:40.006705 [debug] [ThreadPool]: On create_sales_database_main: COMMIT
[0m08:48:40.008515 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:48:40.009968 [debug] [ThreadPool]: On create_sales_database_main: Close
[0m08:48:40.017664 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_sales_database_main, now list_sales_database_main)
[0m08:48:40.027482 [debug] [ThreadPool]: Using duckdb connection "list_sales_database_main"
[0m08:48:40.028927 [debug] [ThreadPool]: On list_sales_database_main: BEGIN
[0m08:48:40.030191 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:48:40.065275 [debug] [ThreadPool]: SQL status: OK in 0.035 seconds
[0m08:48:40.066956 [debug] [ThreadPool]: Using duckdb connection "list_sales_database_main"
[0m08:48:40.068386 [debug] [ThreadPool]: On list_sales_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "list_sales_database_main"} */
select
      'sales_database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'sales_database'
  
[0m08:48:40.133235 [debug] [ThreadPool]: SQL status: OK in 0.063 seconds
[0m08:48:40.139212 [debug] [ThreadPool]: On list_sales_database_main: ROLLBACK
[0m08:48:40.147517 [debug] [ThreadPool]: Failed to rollback 'list_sales_database_main'
[0m08:48:40.149332 [debug] [ThreadPool]: On list_sales_database_main: Close
[0m08:48:40.162602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f446278d-17fd-4415-9b88-69dff059ee9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d9a34b020>]}
[0m08:48:40.165918 [debug] [MainThread]: Using duckdb connection "master"
[0m08:48:40.169474 [debug] [MainThread]: On master: BEGIN
[0m08:48:40.173281 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:48:40.208975 [debug] [MainThread]: SQL status: OK in 0.036 seconds
[0m08:48:40.210285 [debug] [MainThread]: On master: COMMIT
[0m08:48:40.211382 [debug] [MainThread]: Using duckdb connection "master"
[0m08:48:40.212601 [debug] [MainThread]: On master: COMMIT
[0m08:48:40.214373 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m08:48:40.215518 [debug] [MainThread]: On master: Close
[0m08:48:40.223857 [debug] [Thread-1 (]: Began running node model.my_dbt_project.customer_dimension
[0m08:48:40.225211 [info ] [Thread-1 (]: 1 of 6 START sql view model main.customer_dimension ............................ [RUN]
[0m08:48:40.226802 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.my_dbt_project.customer_dimension'
[0m08:48:40.227882 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.customer_dimension
[0m08:48:40.241878 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.customer_dimension"
[0m08:48:40.252945 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.customer_dimension
[0m08:48:40.312278 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.customer_dimension"
[0m08:48:40.323987 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m08:48:40.325172 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: BEGIN
[0m08:48:40.326166 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m08:48:40.352063 [debug] [Thread-1 (]: SQL status: OK in 0.026 seconds
[0m08:48:40.353193 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m08:48:40.354241 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */

  
  create view "sales_database"."main"."customer_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
    DISTINCT
    customer AS customer_id,
    customer_name,
    customer_address,
    customer_group,
    territory,
    language AS customer_language
FROM sales
WHERE customer IS NOT NULL
  );

[0m08:48:40.356690 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:48:40.368576 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m08:48:40.369762 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */
alter view "sales_database"."main"."customer_dimension" rename to "customer_dimension__dbt_backup"
[0m08:48:40.371644 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:48:40.377290 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m08:48:40.378440 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */
alter view "sales_database"."main"."customer_dimension__dbt_tmp" rename to "customer_dimension"
[0m08:48:40.380374 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:48:40.403468 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: COMMIT
[0m08:48:40.404607 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m08:48:40.405584 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: COMMIT
[0m08:48:40.413365 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m08:48:40.422810 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m08:48:40.424043 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */
drop view if exists "sales_database"."main"."customer_dimension__dbt_backup" cascade
[0m08:48:40.428292 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m08:48:40.432550 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: Close
[0m08:48:40.473368 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f446278d-17fd-4415-9b88-69dff059ee9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0da2e2fda0>]}
[0m08:48:40.475102 [info ] [Thread-1 (]: 1 of 6 OK created sql view model main.customer_dimension ....................... [[32mOK[0m in 0.24s]
[0m08:48:40.477416 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.customer_dimension
[0m08:48:40.478826 [debug] [Thread-1 (]: Began running node model.my_dbt_project.date_dimension
[0m08:48:40.480450 [info ] [Thread-1 (]: 2 of 6 START sql view model main.date_dimension ................................ [RUN]
[0m08:48:40.482190 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customer_dimension, now model.my_dbt_project.date_dimension)
[0m08:48:40.483647 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.date_dimension
[0m08:48:40.489293 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.date_dimension"
[0m08:48:40.504515 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.date_dimension
[0m08:48:40.515660 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.date_dimension"
[0m08:48:40.529529 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m08:48:40.530907 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: BEGIN
[0m08:48:40.532293 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:48:40.565726 [debug] [Thread-1 (]: SQL status: OK in 0.034 seconds
[0m08:48:40.567195 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m08:48:40.568723 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.date_dimension"} */

  
  create view "sales_database"."main"."date_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
    transaction_date,
    strftime(transaction_date, '%A') AS weekday_name,  -- Extract weekday name
    strftime(transaction_date, '%m') AS month,          -- Extract month (numeric)
    strftime(transaction_date, '%Y') AS year,           -- Extract year
    strftime(transaction_date, '%d') AS day,            -- Extract day
    EXTRACT(QUARTER FROM transaction_date) AS quarter   -- Extract quarter
FROM sales
WHERE transaction_date IS NOT NULL
  );

[0m08:48:40.572247 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m08:48:40.578708 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m08:48:40.580224 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.date_dimension"} */
alter view "sales_database"."main"."date_dimension" rename to "date_dimension__dbt_backup"
[0m08:48:40.582594 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:48:40.590825 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m08:48:40.592420 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.date_dimension"} */
alter view "sales_database"."main"."date_dimension__dbt_tmp" rename to "date_dimension"
[0m08:48:40.595095 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:48:40.599051 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: COMMIT
[0m08:48:40.600853 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m08:48:40.602772 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: COMMIT
[0m08:48:40.614459 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m08:48:40.620746 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m08:48:40.622208 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.date_dimension"} */
drop view if exists "sales_database"."main"."date_dimension__dbt_backup" cascade
[0m08:48:40.626923 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m08:48:40.629975 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: Close
[0m08:48:40.676794 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f446278d-17fd-4415-9b88-69dff059ee9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d9b3db8c0>]}
[0m08:48:40.679224 [info ] [Thread-1 (]: 2 of 6 OK created sql view model main.date_dimension ........................... [[32mOK[0m in 0.19s]
[0m08:48:40.681510 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.date_dimension
[0m08:48:40.682976 [debug] [Thread-1 (]: Began running node model.my_dbt_project.product_dimension
[0m08:48:40.684720 [info ] [Thread-1 (]: 3 of 6 START sql view model main.product_dimension ............................. [RUN]
[0m08:48:40.686200 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.date_dimension, now model.my_dbt_project.product_dimension)
[0m08:48:40.687589 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.product_dimension
[0m08:48:40.695605 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.product_dimension"
[0m08:48:40.712770 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.product_dimension
[0m08:48:40.721767 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.product_dimension"
[0m08:48:40.738062 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m08:48:40.739289 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: BEGIN
[0m08:48:40.740696 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:48:40.768939 [debug] [Thread-1 (]: SQL status: OK in 0.028 seconds
[0m08:48:40.770346 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m08:48:40.771797 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.product_dimension"} */

  
  create view "sales_database"."main"."product_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * 
    FROM "sales_database"."main"."sales"
)

SELECT 
    sales.name,
    json_extract(items, '$[0].name') AS product_name,  -- Example to extract the first element's "name" field from JSON array
    json_extract(items, '$[0].item_code') AS product_item_code
FROM sales
WHERE json_extract(items, '$[0].name') IS NOT NULL  -- Filter to only keep rows with a non-null product name
  );

[0m08:48:40.774838 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m08:48:40.781557 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m08:48:40.782993 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.product_dimension"} */
alter view "sales_database"."main"."product_dimension" rename to "product_dimension__dbt_backup"
[0m08:48:40.785655 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:48:40.792262 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m08:48:40.793767 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.product_dimension"} */
alter view "sales_database"."main"."product_dimension__dbt_tmp" rename to "product_dimension"
[0m08:48:40.795764 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:48:40.799438 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: COMMIT
[0m08:48:40.801030 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m08:48:40.802205 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: COMMIT
[0m08:48:40.811380 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m08:48:40.817134 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m08:48:40.818498 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.product_dimension"} */
drop view if exists "sales_database"."main"."product_dimension__dbt_backup" cascade
[0m08:48:40.822736 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m08:48:40.825605 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: Close
[0m08:48:40.869800 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f446278d-17fd-4415-9b88-69dff059ee9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d9971e750>]}
[0m08:48:40.871700 [info ] [Thread-1 (]: 3 of 6 OK created sql view model main.product_dimension ........................ [[32mOK[0m in 0.18s]
[0m08:48:40.874245 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.product_dimension
[0m08:48:40.875897 [debug] [Thread-1 (]: Began running node model.my_dbt_project.sales_team_dimension
[0m08:48:40.877427 [info ] [Thread-1 (]: 4 of 6 START sql view model main.sales_team_dimension .......................... [RUN]
[0m08:48:40.878886 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.product_dimension, now model.my_dbt_project.sales_team_dimension)
[0m08:48:40.880283 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.sales_team_dimension
[0m08:48:40.885871 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.sales_team_dimension"
[0m08:48:40.899756 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.sales_team_dimension
[0m08:48:40.907733 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.sales_team_dimension"
[0m08:48:40.923253 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m08:48:40.924588 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: BEGIN
[0m08:48:40.925889 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:48:40.956593 [debug] [Thread-1 (]: SQL status: OK in 0.031 seconds
[0m08:48:40.957924 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m08:48:40.959321 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */

  
  create view "sales_database"."main"."sales_team_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
    DISTINCT
    sales_team->>'name' AS sales_team_id,
    sales_team->>'region' AS sales_team_region
FROM sales
WHERE sales_team IS NOT NULL
  );

[0m08:48:40.962284 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:48:40.970369 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m08:48:40.971533 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */
alter view "sales_database"."main"."sales_team_dimension" rename to "sales_team_dimension__dbt_backup"
[0m08:48:40.973383 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:48:40.981092 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m08:48:40.982250 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */
alter view "sales_database"."main"."sales_team_dimension__dbt_tmp" rename to "sales_team_dimension"
[0m08:48:40.984300 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:48:40.987704 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: COMMIT
[0m08:48:40.988799 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m08:48:40.989787 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: COMMIT
[0m08:48:40.996397 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m08:48:41.001889 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m08:48:41.003021 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */
drop view if exists "sales_database"."main"."sales_team_dimension__dbt_backup" cascade
[0m08:48:41.006835 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m08:48:41.009612 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: Close
[0m08:48:41.046464 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f446278d-17fd-4415-9b88-69dff059ee9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d981b01a0>]}
[0m08:48:41.048301 [info ] [Thread-1 (]: 4 of 6 OK created sql view model main.sales_team_dimension ..................... [[32mOK[0m in 0.17s]
[0m08:48:41.050192 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.sales_team_dimension
[0m08:48:41.051836 [debug] [Thread-1 (]: Began running node model.my_dbt_project.transform_sales
[0m08:48:41.053539 [info ] [Thread-1 (]: 5 of 6 START sql table model main.transform_sales .............................. [RUN]
[0m08:48:41.055100 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.sales_team_dimension, now model.my_dbt_project.transform_sales)
[0m08:48:41.056381 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.transform_sales
[0m08:48:41.061611 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.transform_sales"
[0m08:48:41.076866 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.transform_sales
[0m08:48:41.115153 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.transform_sales"
[0m08:48:41.133087 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m08:48:41.134653 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: BEGIN
[0m08:48:41.136626 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:48:41.168162 [debug] [Thread-1 (]: SQL status: OK in 0.032 seconds
[0m08:48:41.169628 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m08:48:41.171074 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */

  
    
    

    create  table
      "sales_database"."main"."transform_sales__dbt_tmp"
  
    as (
      -- /opt/airflow/dags/dbt_models/transform_users.sql


WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
   *
FROM sales
WHERE name = 'ABC private LTD-0002'
    );
  
  
[0m08:48:41.187930 [debug] [Thread-1 (]: SQL status: OK in 0.015 seconds
[0m08:48:41.194963 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m08:48:41.196583 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */
alter table "sales_database"."main"."transform_sales" rename to "transform_sales__dbt_backup"
[0m08:48:41.199628 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:48:41.208997 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m08:48:41.210550 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */
alter table "sales_database"."main"."transform_sales__dbt_tmp" rename to "transform_sales"
[0m08:48:41.212935 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:48:41.225109 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: COMMIT
[0m08:48:41.227046 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m08:48:41.228365 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: COMMIT
[0m08:48:41.238922 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m08:48:41.246173 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m08:48:41.248051 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */
drop table if exists "sales_database"."main"."transform_sales__dbt_backup" cascade
[0m08:48:41.255223 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m08:48:41.258498 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: Close
[0m08:48:41.347279 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f446278d-17fd-4415-9b88-69dff059ee9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d9add7500>]}
[0m08:48:41.349354 [info ] [Thread-1 (]: 5 of 6 OK created sql table model main.transform_sales ......................... [[32mOK[0m in 0.29s]
[0m08:48:41.351567 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.transform_sales
[0m08:48:41.352911 [debug] [Thread-1 (]: Began running node model.my_dbt_project.sales_fact
[0m08:48:41.354320 [info ] [Thread-1 (]: 6 of 6 START sql table model main.sales_fact ................................... [RUN]
[0m08:48:41.355709 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.transform_sales, now model.my_dbt_project.sales_fact)
[0m08:48:41.356864 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.sales_fact
[0m08:48:41.363775 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.sales_fact"
[0m08:48:41.375451 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.sales_fact
[0m08:48:41.382409 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.sales_fact"
[0m08:48:41.394230 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_fact"
[0m08:48:41.395576 [debug] [Thread-1 (]: On model.my_dbt_project.sales_fact: BEGIN
[0m08:48:41.396988 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:48:41.420807 [debug] [Thread-1 (]: SQL status: OK in 0.024 seconds
[0m08:48:41.421924 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_fact"
[0m08:48:41.423201 [debug] [Thread-1 (]: On model.my_dbt_project.sales_fact: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_fact"} */

  
    
    

    create  table
      "sales_database"."main"."sales_fact__dbt_tmp"
  
    as (
      WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
),
customer AS (
    SELECT * FROM "sales_database"."main"."customer_dimension"
),
product AS (
    SELECT * FROM "sales_database"."main"."product_dimension"
),
sales_team AS (
    SELECT * FROM "sales_database"."main"."sales_team_dimension"
),
date AS (
    SELECT * FROM "sales_database"."main"."date_dimension"
)

SELECT
    sales.name AS sales_id,
    customer.customer_id,
    product.product_id,
    sales_team.sales_team_id,
    date.date_id,
    sales.total_qty,
    sales.total_net_weight,
    sales.total,
    sales.net_total,
    sales.grand_total,
    sales.tax_category
FROM sales
JOIN customer ON sales.customer = customer.customer_id
JOIN LATERAL (
    -- Assuming 'items' is a JSON array, extract 'product_id' from it
    SELECT product_id
    FROM jsonb_array_elements(sales.items) AS item
    WHERE (item->>'product_id')::int = product.product_id
) product ON TRUE
JOIN LATERAL (
    -- Assuming 'sales_team' is a JSON array, extract 'sales_team_id' from it
    SELECT sales_team_id
    FROM jsonb_array_elements(sales.sales_team) AS team
    WHERE (team->>'sales_team_id')::int = sales_team.sales_team_id
) sales_team ON TRUE
JOIN date ON sales.transaction_date = date.date_id;
    );
  
  
[0m08:48:41.433979 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_fact"} */

  
    
    

    create  table
      "sales_database"."main"."sales_fact__dbt_tmp"
  
    as (
      WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
),
customer AS (
    SELECT * FROM "sales_database"."main"."customer_dimension"
),
product AS (
    SELECT * FROM "sales_database"."main"."product_dimension"
),
sales_team AS (
    SELECT * FROM "sales_database"."main"."sales_team_dimension"
),
date AS (
    SELECT * FROM "sales_database"."main"."date_dimension"
)

SELECT
    sales.name AS sales_id,
    customer.customer_id,
    product.product_id,
    sales_team.sales_team_id,
    date.date_id,
    sales.total_qty,
    sales.total_net_weight,
    sales.total,
    sales.net_total,
    sales.grand_total,
    sales.tax_category
FROM sales
JOIN customer ON sales.customer = customer.customer_id
JOIN LATERAL (
    -- Assuming 'items' is a JSON array, extract 'product_id' from it
    SELECT product_id
    FROM jsonb_array_elements(sales.items) AS item
    WHERE (item->>'product_id')::int = product.product_id
) product ON TRUE
JOIN LATERAL (
    -- Assuming 'sales_team' is a JSON array, extract 'sales_team_id' from it
    SELECT sales_team_id
    FROM jsonb_array_elements(sales.sales_team) AS team
    WHERE (team->>'sales_team_id')::int = sales_team.sales_team_id
) sales_team ON TRUE
JOIN date ON sales.transaction_date = date.date_id;
    );
  
  
[0m08:48:41.435549 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m08:48:41.436872 [debug] [Thread-1 (]: On model.my_dbt_project.sales_fact: ROLLBACK
[0m08:48:41.448600 [debug] [Thread-1 (]: Failed to rollback 'model.my_dbt_project.sales_fact'
[0m08:48:41.449748 [debug] [Thread-1 (]: On model.my_dbt_project.sales_fact: Close
[0m08:48:41.456878 [debug] [Thread-1 (]: Runtime Error in model sales_fact (models/facts/sales_fact.sql)
  Parser Error: syntax error at or near ";"
[0m08:48:41.458280 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f446278d-17fd-4415-9b88-69dff059ee9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d997cb3e0>]}
[0m08:48:41.459760 [error] [Thread-1 (]: 6 of 6 ERROR creating sql table model main.sales_fact .......................... [[31mERROR[0m in 0.10s]
[0m08:48:41.461584 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.sales_fact
[0m08:48:41.463168 [debug] [Thread-4 (]: Marking all children of 'model.my_dbt_project.sales_fact' to be skipped because of status 'error'.  Reason: Runtime Error in model sales_fact (models/facts/sales_fact.sql)
  Parser Error: syntax error at or near ";".
[0m08:48:41.468442 [debug] [MainThread]: Using duckdb connection "master"
[0m08:48:41.469798 [debug] [MainThread]: On master: BEGIN
[0m08:48:41.471232 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:48:41.502562 [debug] [MainThread]: SQL status: OK in 0.031 seconds
[0m08:48:41.504335 [debug] [MainThread]: On master: COMMIT
[0m08:48:41.507534 [debug] [MainThread]: Using duckdb connection "master"
[0m08:48:41.494714 [debug] [MainThread]: On master: COMMIT
[0m08:48:41.496814 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m08:48:41.498125 [debug] [MainThread]: On master: Close
[0m08:48:41.502756 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:48:41.504209 [debug] [MainThread]: Connection 'list_sales_database_main' was properly closed.
[0m08:48:41.505179 [debug] [MainThread]: Connection 'model.my_dbt_project.sales_fact' was properly closed.
[0m08:48:41.506460 [info ] [MainThread]: 
[0m08:48:41.507665 [info ] [MainThread]: Finished running 2 table models, 4 view models in 0 hours 0 minutes and 1.72 seconds (1.72s).
[0m08:48:41.510677 [debug] [MainThread]: Command end result
[0m08:48:41.584590 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m08:48:41.596278 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m08:48:41.640234 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dags/dbt_models/target/run_results.json
[0m08:48:41.641729 [info ] [MainThread]: 
[0m08:48:41.648778 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m08:48:41.651597 [info ] [MainThread]: 
[0m08:48:41.655014 [error] [MainThread]:   Runtime Error in model sales_fact (models/facts/sales_fact.sql)
  Parser Error: syntax error at or near ";"
[0m08:48:41.659896 [info ] [MainThread]: 
[0m08:48:41.661802 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m08:48:41.667005 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 4.1547265, "process_in_blocks": "70000", "process_kernel_time": 0.588065, "process_mem_max_rss": "160720", "process_out_blocks": "0", "process_user_time": 6.448787}
[0m08:48:41.668800 [debug] [MainThread]: Command `dbt run` failed at 08:48:41.668497 after 4.16 seconds
[0m08:48:41.670521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0da1098d40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d9a337f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d9a337fb0>]}
[0m08:48:41.671860 [debug] [MainThread]: Flushing usage events
[0m08:48:43.651714 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:53:59.619491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c936d7050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c93a5fd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c936d4860>]}


============================== 08:53:59.653007 | 9dd973d1-bbc8-4fe7-82a0-59afa0e7cc8b ==============================
[0m08:53:59.653007 [info ] [MainThread]: Running with dbt=1.9.1
[0m08:53:59.656329 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/profiles.yml', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dags/dbt_models/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt/profiles.yml --target dev', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m08:54:00.292703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9dd973d1-bbc8-4fe7-82a0-59afa0e7cc8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c9362b740>]}
[0m08:54:00.455476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9dd973d1-bbc8-4fe7-82a0-59afa0e7cc8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c940711f0>]}
[0m08:54:00.470784 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m08:54:00.844983 [debug] [MainThread]: checksum: cac3b9519010e47bfbeb71ca6efb4867dae2858687671594dc23fefc94ecf25d, vars: {}, profile: , target: dev, version: 1.9.1
[0m08:54:01.447079 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:54:01.448350 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:54:01.510939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9dd973d1-bbc8-4fe7-82a0-59afa0e7cc8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c8dd13b30>]}
[0m08:54:01.683106 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m08:54:01.696408 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m08:54:01.793335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9dd973d1-bbc8-4fe7-82a0-59afa0e7cc8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c8dd6c0b0>]}
[0m08:54:01.794895 [info ] [MainThread]: Found 6 models, 1 source, 424 macros
[0m08:54:01.796082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9dd973d1-bbc8-4fe7-82a0-59afa0e7cc8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c8d8fa870>]}
[0m08:54:01.799930 [info ] [MainThread]: 
[0m08:54:01.801208 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:54:01.802508 [info ] [MainThread]: 
[0m08:54:01.804304 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m08:54:01.812440 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_sales_database'
[0m08:54:01.913919 [debug] [ThreadPool]: Using duckdb connection "list_sales_database"
[0m08:54:01.915422 [debug] [ThreadPool]: On list_sales_database: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "list_sales_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"sales_database"'
    
  
  
[0m08:54:01.916586 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:54:02.052688 [debug] [ThreadPool]: SQL status: OK in 0.136 seconds
[0m08:54:02.058809 [debug] [ThreadPool]: On list_sales_database: Close
[0m08:54:02.081800 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_database, now create_sales_database_main)
[0m08:54:02.085100 [debug] [ThreadPool]: Creating schema "database: "sales_database"
schema: "main"
"
[0m08:54:02.129488 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m08:54:02.131382 [debug] [ThreadPool]: On create_sales_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "create_sales_database_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='sales_database'
        and type='sqlite'
    
  
[0m08:54:02.134068 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:54:02.177240 [debug] [ThreadPool]: SQL status: OK in 0.043 seconds
[0m08:54:02.181562 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m08:54:02.183221 [debug] [ThreadPool]: On create_sales_database_main: BEGIN
[0m08:54:02.185204 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m08:54:02.186848 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m08:54:02.188627 [debug] [ThreadPool]: On create_sales_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "create_sales_database_main"} */

    
    
        create schema if not exists "sales_database"."main"
    
[0m08:54:02.193701 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m08:54:02.201046 [debug] [ThreadPool]: On create_sales_database_main: COMMIT
[0m08:54:02.202580 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m08:54:02.204421 [debug] [ThreadPool]: On create_sales_database_main: COMMIT
[0m08:54:02.206300 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m08:54:02.207889 [debug] [ThreadPool]: On create_sales_database_main: Close
[0m08:54:02.215848 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_sales_database_main, now list_sales_database_main)
[0m08:54:02.232932 [debug] [ThreadPool]: Using duckdb connection "list_sales_database_main"
[0m08:54:02.234557 [debug] [ThreadPool]: On list_sales_database_main: BEGIN
[0m08:54:02.236169 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:54:02.272195 [debug] [ThreadPool]: SQL status: OK in 0.036 seconds
[0m08:54:02.273946 [debug] [ThreadPool]: Using duckdb connection "list_sales_database_main"
[0m08:54:02.275870 [debug] [ThreadPool]: On list_sales_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "list_sales_database_main"} */
select
      'sales_database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'sales_database'
  
[0m08:54:02.364509 [debug] [ThreadPool]: SQL status: OK in 0.087 seconds
[0m08:54:02.368713 [debug] [ThreadPool]: On list_sales_database_main: ROLLBACK
[0m08:54:02.378655 [debug] [ThreadPool]: Failed to rollback 'list_sales_database_main'
[0m08:54:02.379898 [debug] [ThreadPool]: On list_sales_database_main: Close
[0m08:54:02.391191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9dd973d1-bbc8-4fe7-82a0-59afa0e7cc8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c8dd6da30>]}
[0m08:54:02.393273 [debug] [MainThread]: Using duckdb connection "master"
[0m08:54:02.395036 [debug] [MainThread]: On master: BEGIN
[0m08:54:02.396571 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:54:02.428270 [debug] [MainThread]: SQL status: OK in 0.032 seconds
[0m08:54:02.429718 [debug] [MainThread]: On master: COMMIT
[0m08:54:02.431100 [debug] [MainThread]: Using duckdb connection "master"
[0m08:54:02.432421 [debug] [MainThread]: On master: COMMIT
[0m08:54:02.434337 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m08:54:02.435486 [debug] [MainThread]: On master: Close
[0m08:54:02.444323 [debug] [Thread-1 (]: Began running node model.my_dbt_project.customer_dimension
[0m08:54:02.446368 [info ] [Thread-1 (]: 1 of 6 START sql view model main.customer_dimension ............................ [RUN]
[0m08:54:02.448369 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.my_dbt_project.customer_dimension'
[0m08:54:02.450014 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.customer_dimension
[0m08:54:02.465408 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.customer_dimension"
[0m08:54:02.478103 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.customer_dimension
[0m08:54:02.560108 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.customer_dimension"
[0m08:54:02.573433 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m08:54:02.575061 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: BEGIN
[0m08:54:02.576304 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m08:54:02.606521 [debug] [Thread-1 (]: SQL status: OK in 0.030 seconds
[0m08:54:02.608216 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m08:54:02.609506 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */

  
  create view "sales_database"."main"."customer_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
    DISTINCT
    customer AS customer_id,
    customer_name,
    customer_address,
    customer_group,
    territory,
    language AS customer_language
FROM sales
WHERE customer IS NOT NULL
  );

[0m08:54:02.612143 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:54:02.627752 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m08:54:02.629344 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */
alter view "sales_database"."main"."customer_dimension" rename to "customer_dimension__dbt_backup"
[0m08:54:02.632086 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:54:02.638699 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m08:54:02.640143 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */
alter view "sales_database"."main"."customer_dimension__dbt_tmp" rename to "customer_dimension"
[0m08:54:02.642484 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:54:02.669096 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: COMMIT
[0m08:54:02.670537 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m08:54:02.671867 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: COMMIT
[0m08:54:02.707273 [debug] [Thread-1 (]: SQL status: OK in 0.034 seconds
[0m08:54:02.722537 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m08:54:02.724509 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */
drop view if exists "sales_database"."main"."customer_dimension__dbt_backup" cascade
[0m08:54:02.743363 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m08:54:02.747801 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: Close
[0m08:54:02.837559 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9dd973d1-bbc8-4fe7-82a0-59afa0e7cc8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c8ff12ab0>]}
[0m08:54:02.839390 [info ] [Thread-1 (]: 1 of 6 OK created sql view model main.customer_dimension ....................... [[32mOK[0m in 0.39s]
[0m08:54:02.841173 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.customer_dimension
[0m08:54:02.842522 [debug] [Thread-1 (]: Began running node model.my_dbt_project.date_dimension
[0m08:54:02.843927 [info ] [Thread-1 (]: 2 of 6 START sql view model main.date_dimension ................................ [RUN]
[0m08:54:02.845536 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customer_dimension, now model.my_dbt_project.date_dimension)
[0m08:54:02.846895 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.date_dimension
[0m08:54:02.852154 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.date_dimension"
[0m08:54:02.866008 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.date_dimension
[0m08:54:02.873045 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.date_dimension"
[0m08:54:02.886521 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m08:54:02.887781 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: BEGIN
[0m08:54:02.888917 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:54:02.915456 [debug] [Thread-1 (]: SQL status: OK in 0.026 seconds
[0m08:54:02.916836 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m08:54:02.918107 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.date_dimension"} */

  
  create view "sales_database"."main"."date_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
    transaction_date,
    strftime(transaction_date, '%A') AS weekday_name,  -- Extract weekday name
    strftime(transaction_date, '%m') AS month,          -- Extract month (numeric)
    strftime(transaction_date, '%Y') AS year,           -- Extract year
    strftime(transaction_date, '%d') AS day,            -- Extract day
    EXTRACT(QUARTER FROM transaction_date) AS quarter   -- Extract quarter
FROM sales
WHERE transaction_date IS NOT NULL
  );

[0m08:54:02.922542 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m08:54:02.928549 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m08:54:02.929759 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.date_dimension"} */
alter view "sales_database"."main"."date_dimension" rename to "date_dimension__dbt_backup"
[0m08:54:02.931697 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:54:02.937581 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m08:54:02.938838 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.date_dimension"} */
alter view "sales_database"."main"."date_dimension__dbt_tmp" rename to "date_dimension"
[0m08:54:02.940817 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:54:02.944497 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: COMMIT
[0m08:54:02.945762 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m08:54:02.946945 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: COMMIT
[0m08:54:02.974362 [debug] [Thread-1 (]: SQL status: OK in 0.025 seconds
[0m08:54:02.982421 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m08:54:02.984512 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.date_dimension"} */
drop view if exists "sales_database"."main"."date_dimension__dbt_backup" cascade
[0m08:54:03.004965 [debug] [Thread-1 (]: SQL status: OK in 0.018 seconds
[0m08:54:03.008384 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: Close
[0m08:54:03.103201 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9dd973d1-bbc8-4fe7-82a0-59afa0e7cc8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c8cb42bd0>]}
[0m08:54:03.105458 [info ] [Thread-1 (]: 2 of 6 OK created sql view model main.date_dimension ........................... [[32mOK[0m in 0.26s]
[0m08:54:03.107381 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.date_dimension
[0m08:54:03.109006 [debug] [Thread-1 (]: Began running node model.my_dbt_project.product_dimension
[0m08:54:03.110774 [info ] [Thread-1 (]: 3 of 6 START sql view model main.product_dimension ............................. [RUN]
[0m08:54:03.112369 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.date_dimension, now model.my_dbt_project.product_dimension)
[0m08:54:03.113821 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.product_dimension
[0m08:54:03.119691 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.product_dimension"
[0m08:54:03.134223 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.product_dimension
[0m08:54:03.142569 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.product_dimension"
[0m08:54:03.158018 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m08:54:03.159286 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: BEGIN
[0m08:54:03.160409 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:54:03.186526 [debug] [Thread-1 (]: SQL status: OK in 0.026 seconds
[0m08:54:03.187958 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m08:54:03.189390 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.product_dimension"} */

  
  create view "sales_database"."main"."product_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * 
    FROM "sales_database"."main"."sales"
)

SELECT 
    sales.name,
    json_extract(items, '$[0].name') AS product_name,  -- Example to extract the first element's "name" field from JSON array
    json_extract(items, '$[0].item_code') AS product_item_code
FROM sales
WHERE json_extract(items, '$[0].name') IS NOT NULL  -- Filter to only keep rows with a non-null product name
  );

[0m08:54:03.192239 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:54:03.198360 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m08:54:03.199851 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.product_dimension"} */
alter view "sales_database"."main"."product_dimension" rename to "product_dimension__dbt_backup"
[0m08:54:03.202316 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:54:03.210011 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m08:54:03.211482 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.product_dimension"} */
alter view "sales_database"."main"."product_dimension__dbt_tmp" rename to "product_dimension"
[0m08:54:03.213602 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:54:03.217429 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: COMMIT
[0m08:54:03.218734 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m08:54:03.219982 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: COMMIT
[0m08:54:03.242617 [debug] [Thread-1 (]: SQL status: OK in 0.021 seconds
[0m08:54:03.248161 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m08:54:03.249568 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.product_dimension"} */
drop view if exists "sales_database"."main"."product_dimension__dbt_backup" cascade
[0m08:54:03.281740 [debug] [Thread-1 (]: SQL status: OK in 0.031 seconds
[0m08:54:03.286063 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: Close
[0m08:54:03.564795 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9dd973d1-bbc8-4fe7-82a0-59afa0e7cc8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c8cbc41a0>]}
[0m08:54:03.567374 [info ] [Thread-1 (]: 3 of 6 OK created sql view model main.product_dimension ........................ [[32mOK[0m in 0.45s]
[0m08:54:03.569848 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.product_dimension
[0m08:54:03.571998 [debug] [Thread-1 (]: Began running node model.my_dbt_project.sales_team_dimension
[0m08:54:03.574227 [info ] [Thread-1 (]: 4 of 6 START sql view model main.sales_team_dimension .......................... [RUN]
[0m08:54:03.576690 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.product_dimension, now model.my_dbt_project.sales_team_dimension)
[0m08:54:03.578494 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.sales_team_dimension
[0m08:54:03.588752 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.sales_team_dimension"
[0m08:54:03.607550 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.sales_team_dimension
[0m08:54:03.624998 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.sales_team_dimension"
[0m08:54:03.665875 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m08:54:03.667685 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: BEGIN
[0m08:54:03.669323 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:54:03.702648 [debug] [Thread-1 (]: SQL status: OK in 0.033 seconds
[0m08:54:03.704588 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m08:54:03.706484 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */

  
  create view "sales_database"."main"."sales_team_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
    DISTINCT
    sales_team->>'name' AS sales_team_id,
    sales_team->>'region' AS sales_team_region
FROM sales
WHERE sales_team IS NOT NULL
  );

[0m08:54:03.710730 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m08:54:03.717647 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m08:54:03.719232 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */
alter view "sales_database"."main"."sales_team_dimension" rename to "sales_team_dimension__dbt_backup"
[0m08:54:03.722134 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:54:03.733545 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m08:54:03.734976 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */
alter view "sales_database"."main"."sales_team_dimension__dbt_tmp" rename to "sales_team_dimension"
[0m08:54:03.737383 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:54:03.741729 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: COMMIT
[0m08:54:03.743062 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m08:54:03.744429 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: COMMIT
[0m08:54:03.752578 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m08:54:03.760090 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m08:54:03.761949 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */
drop view if exists "sales_database"."main"."sales_team_dimension__dbt_backup" cascade
[0m08:54:03.767274 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m08:54:03.771296 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: Close
[0m08:54:03.825851 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9dd973d1-bbc8-4fe7-82a0-59afa0e7cc8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c8cbcd1c0>]}
[0m08:54:03.828508 [info ] [Thread-1 (]: 4 of 6 OK created sql view model main.sales_team_dimension ..................... [[32mOK[0m in 0.25s]
[0m08:54:03.831533 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.sales_team_dimension
[0m08:54:03.833453 [debug] [Thread-1 (]: Began running node model.my_dbt_project.transform_sales
[0m08:54:03.837738 [info ] [Thread-1 (]: 5 of 6 START sql table model main.transform_sales .............................. [RUN]
[0m08:54:03.840862 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.sales_team_dimension, now model.my_dbt_project.transform_sales)
[0m08:54:03.842084 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.transform_sales
[0m08:54:03.847861 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.transform_sales"
[0m08:54:03.860674 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.transform_sales
[0m08:54:03.917811 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.transform_sales"
[0m08:54:03.930314 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m08:54:03.931726 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: BEGIN
[0m08:54:03.932918 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:54:03.957703 [debug] [Thread-1 (]: SQL status: OK in 0.025 seconds
[0m08:54:03.959241 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m08:54:03.960741 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */

  
    
    

    create  table
      "sales_database"."main"."transform_sales__dbt_tmp"
  
    as (
      -- /opt/airflow/dags/dbt_models/transform_users.sql


WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
   *
FROM sales
WHERE name = 'ABC private LTD-0002'
    );
  
  
[0m08:54:03.980508 [debug] [Thread-1 (]: SQL status: OK in 0.018 seconds
[0m08:54:03.987177 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m08:54:03.988671 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */
alter table "sales_database"."main"."transform_sales" rename to "transform_sales__dbt_backup"
[0m08:54:03.991220 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:54:04.002919 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m08:54:04.004788 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */
alter table "sales_database"."main"."transform_sales__dbt_tmp" rename to "transform_sales"
[0m08:54:04.007433 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:54:04.020065 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: COMMIT
[0m08:54:04.021280 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m08:54:04.022385 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: COMMIT
[0m08:54:04.031472 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m08:54:04.038143 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m08:54:04.039522 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */
drop table if exists "sales_database"."main"."transform_sales__dbt_backup" cascade
[0m08:54:04.043872 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m08:54:04.046693 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: Close
[0m08:54:04.129400 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9dd973d1-bbc8-4fe7-82a0-59afa0e7cc8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c7ec94230>]}
[0m08:54:04.131032 [info ] [Thread-1 (]: 5 of 6 OK created sql table model main.transform_sales ......................... [[32mOK[0m in 0.29s]
[0m08:54:04.132823 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.transform_sales
[0m08:54:04.134112 [debug] [Thread-1 (]: Began running node model.my_dbt_project.sales_fact
[0m08:54:04.135473 [info ] [Thread-1 (]: 6 of 6 START sql table model main.sales_fact ................................... [RUN]
[0m08:54:04.136957 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.transform_sales, now model.my_dbt_project.sales_fact)
[0m08:54:04.138024 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.sales_fact
[0m08:54:04.144806 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.sales_fact"
[0m08:54:04.158245 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.sales_fact
[0m08:54:04.166355 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.sales_fact"
[0m08:54:04.179792 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_fact"
[0m08:54:04.181522 [debug] [Thread-1 (]: On model.my_dbt_project.sales_fact: BEGIN
[0m08:54:04.183113 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:54:04.212279 [debug] [Thread-1 (]: SQL status: OK in 0.029 seconds
[0m08:54:04.213731 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_fact"
[0m08:54:04.215965 [debug] [Thread-1 (]: On model.my_dbt_project.sales_fact: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_fact"} */

  
    
    

    create  table
      "sales_database"."main"."sales_fact__dbt_tmp"
  
    as (
      WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
),
customer AS (
    SELECT * FROM "sales_database"."main"."customer_dimension"
),
product AS (
    SELECT * FROM "sales_database"."main"."product_dimension"
),
sales_team AS (
    SELECT * FROM "sales_database"."main"."sales_team_dimension"
),
date AS (
    SELECT * FROM "sales_database"."main"."date_dimension"
)

SELECT
    sales.name AS sales_id,
    customer.customer_id,
    product.product_id,
    sales_team.sales_team_id,
    date.date_id,
    sales.total_qty,
    sales.total_net_weight,
    sales.total,
    sales.net_total,
    sales.grand_total,
    sales.tax_category
FROM sales
JOIN customer ON sales.customer = customer.customer_id
JOIN LATERAL (
    -- Assuming 'items' is a JSON array, extract 'product_id' from it
    SELECT product_id
    FROM jsonb_array_elements(sales.items) AS item
    WHERE (item->>'product_id')::int = product.product_id
) product ON TRUE
JOIN LATERAL (
    -- Assuming 'sales_team' is a JSON array, extract 'sales_team_id' from it
    SELECT sales_team_id
    FROM jsonb_array_elements(sales.sales_team) AS team
    WHERE (team->>'sales_team_id')::int = sales_team.sales_team_id
) sales_team ON TRUE
JOIN date ON sales.transaction_date = date.date_id;
    );
  
  
[0m08:54:04.229032 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_fact"} */

  
    
    

    create  table
      "sales_database"."main"."sales_fact__dbt_tmp"
  
    as (
      WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
),
customer AS (
    SELECT * FROM "sales_database"."main"."customer_dimension"
),
product AS (
    SELECT * FROM "sales_database"."main"."product_dimension"
),
sales_team AS (
    SELECT * FROM "sales_database"."main"."sales_team_dimension"
),
date AS (
    SELECT * FROM "sales_database"."main"."date_dimension"
)

SELECT
    sales.name AS sales_id,
    customer.customer_id,
    product.product_id,
    sales_team.sales_team_id,
    date.date_id,
    sales.total_qty,
    sales.total_net_weight,
    sales.total,
    sales.net_total,
    sales.grand_total,
    sales.tax_category
FROM sales
JOIN customer ON sales.customer = customer.customer_id
JOIN LATERAL (
    -- Assuming 'items' is a JSON array, extract 'product_id' from it
    SELECT product_id
    FROM jsonb_array_elements(sales.items) AS item
    WHERE (item->>'product_id')::int = product.product_id
) product ON TRUE
JOIN LATERAL (
    -- Assuming 'sales_team' is a JSON array, extract 'sales_team_id' from it
    SELECT sales_team_id
    FROM jsonb_array_elements(sales.sales_team) AS team
    WHERE (team->>'sales_team_id')::int = sales_team.sales_team_id
) sales_team ON TRUE
JOIN date ON sales.transaction_date = date.date_id;
    );
  
  
[0m08:54:04.230549 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m08:54:04.231881 [debug] [Thread-1 (]: On model.my_dbt_project.sales_fact: ROLLBACK
[0m08:54:04.245102 [debug] [Thread-1 (]: Failed to rollback 'model.my_dbt_project.sales_fact'
[0m08:54:04.246378 [debug] [Thread-1 (]: On model.my_dbt_project.sales_fact: Close
[0m08:54:04.253614 [debug] [Thread-1 (]: Runtime Error in model sales_fact (models/facts/sales_fact.sql)
  Parser Error: syntax error at or near ";"
[0m08:54:04.255059 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9dd973d1-bbc8-4fe7-82a0-59afa0e7cc8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c7ec97470>]}
[0m08:54:04.256635 [error] [Thread-1 (]: 6 of 6 ERROR creating sql table model main.sales_fact .......................... [[31mERROR[0m in 0.12s]
[0m08:54:04.258376 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.sales_fact
[0m08:54:04.259995 [debug] [Thread-4 (]: Marking all children of 'model.my_dbt_project.sales_fact' to be skipped because of status 'error'.  Reason: Runtime Error in model sales_fact (models/facts/sales_fact.sql)
  Parser Error: syntax error at or near ";".
[0m08:54:04.263684 [debug] [MainThread]: Using duckdb connection "master"
[0m08:54:04.264923 [debug] [MainThread]: On master: BEGIN
[0m08:54:04.265887 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:54:04.291707 [debug] [MainThread]: SQL status: OK in 0.026 seconds
[0m08:54:04.293198 [debug] [MainThread]: On master: COMMIT
[0m08:54:04.294399 [debug] [MainThread]: Using duckdb connection "master"
[0m08:54:04.295585 [debug] [MainThread]: On master: COMMIT
[0m08:54:04.297375 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m08:54:04.298502 [debug] [MainThread]: On master: Close
[0m08:54:04.303325 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:54:04.304443 [debug] [MainThread]: Connection 'list_sales_database_main' was properly closed.
[0m08:54:04.305605 [debug] [MainThread]: Connection 'model.my_dbt_project.sales_fact' was properly closed.
[0m08:54:04.306962 [info ] [MainThread]: 
[0m08:54:04.308293 [info ] [MainThread]: Finished running 2 table models, 4 view models in 0 hours 0 minutes and 2.50 seconds (2.50s).
[0m08:54:04.312179 [debug] [MainThread]: Command end result
[0m08:54:04.397760 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m08:54:04.412106 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m08:54:04.449580 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dags/dbt_models/target/run_results.json
[0m08:54:04.451868 [info ] [MainThread]: 
[0m08:54:04.454341 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m08:54:04.456893 [info ] [MainThread]: 
[0m08:54:04.460198 [error] [MainThread]:   Runtime Error in model sales_fact (models/facts/sales_fact.sql)
  Parser Error: syntax error at or near ";"
[0m08:54:04.462191 [info ] [MainThread]: 
[0m08:54:04.465453 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m08:54:04.471956 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 5.0327964, "process_in_blocks": "111992", "process_kernel_time": 0.916269, "process_mem_max_rss": "160324", "process_out_blocks": "0", "process_user_time": 7.837026}
[0m08:54:04.475168 [debug] [MainThread]: Command `dbt run` failed at 08:54:04.474604 after 5.04 seconds
[0m08:54:04.484280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c94205af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c8ffa5640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c8ffa7050>]}
[0m08:54:04.487817 [debug] [MainThread]: Flushing usage events
[0m08:54:06.287761 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:59:45.206588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1c6d9e240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1c7a14620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1c734ad50>]}


============================== 08:59:45.415274 | 12842634-4b70-44d2-b107-a10a6032aeed ==============================
[0m08:59:45.415274 [info ] [MainThread]: Running with dbt=1.9.1
[0m08:59:45.448989 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/profiles.yml', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dags/dbt_models/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt/profiles.yml --target dev', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:00:47.233443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '12842634-4b70-44d2-b107-a10a6032aeed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1c65ccec0>]}
[0m09:00:48.169981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '12842634-4b70-44d2-b107-a10a6032aeed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1c748f500>]}
[0m09:00:48.260987 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m09:00:49.887908 [debug] [MainThread]: checksum: cac3b9519010e47bfbeb71ca6efb4867dae2858687671594dc23fefc94ecf25d, vars: {}, profile: , target: dev, version: 1.9.1
[0m09:00:50.684819 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:00:50.687129 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/facts/sales_fact.sql
[0m09:00:51.680226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '12842634-4b70-44d2-b107-a10a6032aeed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1b3d6b830>]}
[0m09:00:52.148939 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m09:00:52.176961 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m09:00:52.557838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '12842634-4b70-44d2-b107-a10a6032aeed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1c095ffe0>]}
[0m09:00:52.559808 [info ] [MainThread]: Found 6 models, 1 source, 424 macros
[0m09:00:52.569334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '12842634-4b70-44d2-b107-a10a6032aeed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1c077cf80>]}
[0m09:00:52.580929 [info ] [MainThread]: 
[0m09:00:52.587978 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:00:52.592868 [info ] [MainThread]: 
[0m09:00:52.596705 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m09:00:52.622364 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_sales_database'
[0m09:00:52.771093 [debug] [ThreadPool]: Using duckdb connection "list_sales_database"
[0m09:00:52.773111 [debug] [ThreadPool]: On list_sales_database: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "list_sales_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"sales_database"'
    
  
  
[0m09:00:52.774878 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:00:53.068232 [debug] [ThreadPool]: SQL status: OK in 0.293 seconds
[0m09:00:53.074150 [debug] [ThreadPool]: On list_sales_database: Close
[0m09:00:53.113715 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_database, now create_sales_database_main)
[0m09:00:53.117133 [debug] [ThreadPool]: Creating schema "database: "sales_database"
schema: "main"
"
[0m09:00:53.142141 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m09:00:53.144360 [debug] [ThreadPool]: On create_sales_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "create_sales_database_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='sales_database'
        and type='sqlite'
    
  
[0m09:00:53.146143 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:00:53.215742 [debug] [ThreadPool]: SQL status: OK in 0.070 seconds
[0m09:00:53.221189 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m09:00:53.227076 [debug] [ThreadPool]: On create_sales_database_main: BEGIN
[0m09:00:53.229784 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:00:53.231755 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m09:00:53.234678 [debug] [ThreadPool]: On create_sales_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "create_sales_database_main"} */

    
    
        create schema if not exists "sales_database"."main"
    
[0m09:00:53.240216 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m09:00:53.262806 [debug] [ThreadPool]: On create_sales_database_main: COMMIT
[0m09:00:53.265426 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m09:00:53.282586 [debug] [ThreadPool]: On create_sales_database_main: COMMIT
[0m09:00:53.292117 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:00:53.293879 [debug] [ThreadPool]: On create_sales_database_main: Close
[0m09:00:53.310192 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_sales_database_main'
[0m09:00:53.345616 [debug] [ThreadPool]: Using duckdb connection "list_sales_database_main"
[0m09:00:53.347415 [debug] [ThreadPool]: On list_sales_database_main: BEGIN
[0m09:00:53.349474 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:00:53.394058 [debug] [ThreadPool]: SQL status: OK in 0.045 seconds
[0m09:00:53.396058 [debug] [ThreadPool]: Using duckdb connection "list_sales_database_main"
[0m09:00:53.398416 [debug] [ThreadPool]: On list_sales_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "list_sales_database_main"} */
select
      'sales_database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'sales_database'
  
[0m09:00:53.602663 [debug] [ThreadPool]: SQL status: OK in 0.201 seconds
[0m09:00:53.614419 [debug] [ThreadPool]: On list_sales_database_main: ROLLBACK
[0m09:00:53.632543 [debug] [ThreadPool]: Failed to rollback 'list_sales_database_main'
[0m09:00:53.634472 [debug] [ThreadPool]: On list_sales_database_main: Close
[0m09:00:53.657415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '12842634-4b70-44d2-b107-a10a6032aeed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1b3d53140>]}
[0m09:00:53.659666 [debug] [MainThread]: Using duckdb connection "master"
[0m09:00:53.661612 [debug] [MainThread]: On master: BEGIN
[0m09:00:53.665660 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:00:53.710685 [debug] [MainThread]: SQL status: OK in 0.045 seconds
[0m09:00:53.712825 [debug] [MainThread]: On master: COMMIT
[0m09:00:53.714667 [debug] [MainThread]: Using duckdb connection "master"
[0m09:00:53.716665 [debug] [MainThread]: On master: COMMIT
[0m09:00:53.719048 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m09:00:53.721698 [debug] [MainThread]: On master: Close
[0m09:00:53.739363 [debug] [Thread-1 (]: Began running node model.my_dbt_project.customer_dimension
[0m09:00:53.744312 [info ] [Thread-1 (]: 1 of 6 START sql view model main.customer_dimension ............................ [RUN]
[0m09:00:53.750869 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.my_dbt_project.customer_dimension'
[0m09:00:53.752440 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.customer_dimension
[0m09:00:53.789861 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.customer_dimension"
[0m09:00:53.809747 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.customer_dimension
[0m09:00:53.961354 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.customer_dimension"
[0m09:00:53.983728 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m09:00:53.986283 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: BEGIN
[0m09:00:53.988209 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m09:00:54.027727 [debug] [Thread-1 (]: SQL status: OK in 0.039 seconds
[0m09:00:54.029779 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m09:00:54.031897 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */

  
  create view "sales_database"."main"."customer_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
    DISTINCT
    customer AS customer_id,
    customer_name,
    customer_address,
    customer_group,
    territory,
    language AS customer_language
FROM sales
WHERE customer IS NOT NULL
  );

[0m09:00:54.036210 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m09:00:54.059676 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m09:00:54.061975 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */
alter view "sales_database"."main"."customer_dimension" rename to "customer_dimension__dbt_backup"
[0m09:00:54.065239 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:00:54.076176 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m09:00:54.078213 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */
alter view "sales_database"."main"."customer_dimension__dbt_tmp" rename to "customer_dimension"
[0m09:00:54.081126 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:00:54.120658 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: COMMIT
[0m09:00:54.122711 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m09:00:54.124594 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: COMMIT
[0m09:00:54.150165 [debug] [Thread-1 (]: SQL status: OK in 0.023 seconds
[0m09:00:54.167361 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m09:00:54.169363 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */
drop view if exists "sales_database"."main"."customer_dimension__dbt_backup" cascade
[0m09:00:54.191786 [debug] [Thread-1 (]: SQL status: OK in 0.020 seconds
[0m09:00:54.199440 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: Close
[0m09:00:54.346925 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12842634-4b70-44d2-b107-a10a6032aeed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1b32cc8c0>]}
[0m09:00:54.352760 [info ] [Thread-1 (]: 1 of 6 OK created sql view model main.customer_dimension ....................... [[32mOK[0m in 0.59s]
[0m09:00:54.360380 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.customer_dimension
[0m09:00:54.362403 [debug] [Thread-1 (]: Began running node model.my_dbt_project.date_dimension
[0m09:00:54.367157 [info ] [Thread-1 (]: 2 of 6 START sql view model main.date_dimension ................................ [RUN]
[0m09:00:54.371287 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customer_dimension, now model.my_dbt_project.date_dimension)
[0m09:00:54.373454 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.date_dimension
[0m09:00:54.394976 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.date_dimension"
[0m09:00:54.410466 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.date_dimension
[0m09:00:54.430875 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.date_dimension"
[0m09:00:54.448193 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m09:00:54.450066 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: BEGIN
[0m09:00:54.451639 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:00:54.508872 [debug] [Thread-1 (]: SQL status: OK in 0.057 seconds
[0m09:00:54.516646 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m09:00:54.529303 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.date_dimension"} */

  
  create view "sales_database"."main"."date_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
    transaction_date,
    strftime(transaction_date, '%A') AS weekday_name,  -- Extract weekday name
    strftime(transaction_date, '%m') AS month,          -- Extract month (numeric)
    strftime(transaction_date, '%Y') AS year,           -- Extract year
    strftime(transaction_date, '%d') AS day,            -- Extract day
    EXTRACT(QUARTER FROM transaction_date) AS quarter   -- Extract quarter
FROM sales
WHERE transaction_date IS NOT NULL
  );

[0m09:00:54.538392 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m09:00:54.562843 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m09:00:54.565302 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.date_dimension"} */
alter view "sales_database"."main"."date_dimension" rename to "date_dimension__dbt_backup"
[0m09:00:54.568085 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:00:54.582783 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m09:00:54.589815 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.date_dimension"} */
alter view "sales_database"."main"."date_dimension__dbt_tmp" rename to "date_dimension"
[0m09:00:54.593314 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:00:54.600914 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: COMMIT
[0m09:00:54.605327 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m09:00:54.608013 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: COMMIT
[0m09:00:54.638878 [debug] [Thread-1 (]: SQL status: OK in 0.029 seconds
[0m09:00:54.656061 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m09:00:54.691914 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.date_dimension"} */
drop view if exists "sales_database"."main"."date_dimension__dbt_backup" cascade
[0m09:00:54.719953 [debug] [Thread-1 (]: SQL status: OK in 0.018 seconds
[0m09:00:54.727724 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: Close
[0m09:00:54.843100 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12842634-4b70-44d2-b107-a10a6032aeed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1b0495640>]}
[0m09:00:54.847158 [info ] [Thread-1 (]: 2 of 6 OK created sql view model main.date_dimension ........................... [[32mOK[0m in 0.47s]
[0m09:00:54.857568 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.date_dimension
[0m09:00:54.859528 [debug] [Thread-1 (]: Began running node model.my_dbt_project.product_dimension
[0m09:00:54.865445 [info ] [Thread-1 (]: 3 of 6 START sql view model main.product_dimension ............................. [RUN]
[0m09:00:54.869383 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.date_dimension, now model.my_dbt_project.product_dimension)
[0m09:00:54.878302 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.product_dimension
[0m09:00:54.889085 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.product_dimension"
[0m09:00:54.927461 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.product_dimension
[0m09:00:54.940551 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.product_dimension"
[0m09:00:54.976213 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m09:00:54.978079 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: BEGIN
[0m09:00:54.981700 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:00:55.042281 [debug] [Thread-1 (]: SQL status: OK in 0.061 seconds
[0m09:00:55.044233 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m09:00:55.046617 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.product_dimension"} */

  
  create view "sales_database"."main"."product_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * 
    FROM "sales_database"."main"."sales"
)

SELECT 
    sales.name,
    json_extract(items, '$[0].name') AS product_name,  -- Example to extract the first element's "name" field from JSON array
    json_extract(items, '$[0].item_code') AS product_item_code
FROM sales
WHERE json_extract(items, '$[0].name') IS NOT NULL  -- Filter to only keep rows with a non-null product name
  );

[0m09:00:55.052317 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m09:00:55.072600 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m09:00:55.074462 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.product_dimension"} */
alter view "sales_database"."main"."product_dimension" rename to "product_dimension__dbt_backup"
[0m09:00:55.077319 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:00:55.089881 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m09:00:55.091821 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.product_dimension"} */
alter view "sales_database"."main"."product_dimension__dbt_tmp" rename to "product_dimension"
[0m09:00:55.094691 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:00:55.101061 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: COMMIT
[0m09:00:55.103622 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m09:00:55.105570 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: COMMIT
[0m09:00:55.150429 [debug] [Thread-1 (]: SQL status: OK in 0.043 seconds
[0m09:00:55.170547 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m09:00:55.174271 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.product_dimension"} */
drop view if exists "sales_database"."main"."product_dimension__dbt_backup" cascade
[0m09:00:55.194707 [debug] [Thread-1 (]: SQL status: OK in 0.018 seconds
[0m09:00:55.208341 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: Close
[0m09:00:55.568000 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12842634-4b70-44d2-b107-a10a6032aeed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1b31d5100>]}
[0m09:00:55.573074 [info ] [Thread-1 (]: 3 of 6 OK created sql view model main.product_dimension ........................ [[32mOK[0m in 0.69s]
[0m09:00:55.596171 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.product_dimension
[0m09:00:55.635098 [debug] [Thread-1 (]: Began running node model.my_dbt_project.sales_team_dimension
[0m09:00:55.735202 [info ] [Thread-1 (]: 4 of 6 START sql view model main.sales_team_dimension .......................... [RUN]
[0m09:00:55.751246 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.product_dimension, now model.my_dbt_project.sales_team_dimension)
[0m09:00:55.759465 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.sales_team_dimension
[0m09:00:55.800515 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.sales_team_dimension"
[0m09:00:56.055348 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.sales_team_dimension
[0m09:00:56.093888 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.sales_team_dimension"
[0m09:00:56.152713 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m09:00:56.158083 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: BEGIN
[0m09:00:56.162297 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:00:56.232104 [debug] [Thread-1 (]: SQL status: OK in 0.070 seconds
[0m09:00:56.234293 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m09:00:56.238496 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */

  
  create view "sales_database"."main"."sales_team_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
    DISTINCT
    sales_team->>'name' AS sales_team_id,
    sales_team->>'region' AS sales_team_region
FROM sales
WHERE sales_team IS NOT NULL
  );

[0m09:00:56.243242 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m09:00:56.257164 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m09:00:56.259475 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */
alter view "sales_database"."main"."sales_team_dimension" rename to "sales_team_dimension__dbt_backup"
[0m09:00:56.262728 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:00:56.279738 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m09:00:56.281869 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */
alter view "sales_database"."main"."sales_team_dimension__dbt_tmp" rename to "sales_team_dimension"
[0m09:00:56.285072 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:00:56.294144 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: COMMIT
[0m09:00:56.296258 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m09:00:56.298577 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: COMMIT
[0m09:00:56.327889 [debug] [Thread-1 (]: SQL status: OK in 0.027 seconds
[0m09:00:56.337011 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m09:00:56.339025 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */
drop view if exists "sales_database"."main"."sales_team_dimension__dbt_backup" cascade
[0m09:00:56.368339 [debug] [Thread-1 (]: SQL status: OK in 0.027 seconds
[0m09:00:56.373907 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: Close
[0m09:00:56.491947 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12842634-4b70-44d2-b107-a10a6032aeed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1b04c2f60>]}
[0m09:00:56.508370 [info ] [Thread-1 (]: 4 of 6 OK created sql view model main.sales_team_dimension ..................... [[32mOK[0m in 0.75s]
[0m09:00:56.526721 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.sales_team_dimension
[0m09:00:56.538950 [debug] [Thread-1 (]: Began running node model.my_dbt_project.transform_sales
[0m09:00:56.542890 [info ] [Thread-1 (]: 5 of 6 START sql table model main.transform_sales .............................. [RUN]
[0m09:00:56.553933 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.sales_team_dimension, now model.my_dbt_project.transform_sales)
[0m09:00:56.560163 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.transform_sales
[0m09:00:56.585950 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.transform_sales"
[0m09:00:56.618764 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.transform_sales
[0m09:00:56.757452 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.transform_sales"
[0m09:00:56.776882 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m09:00:56.778893 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: BEGIN
[0m09:00:56.780753 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:00:56.865491 [debug] [Thread-1 (]: SQL status: OK in 0.084 seconds
[0m09:00:56.869000 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m09:00:56.875198 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */

  
    
    

    create  table
      "sales_database"."main"."transform_sales__dbt_tmp"
  
    as (
      -- /opt/airflow/dags/dbt_models/transform_users.sql


WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
   *
FROM sales
WHERE name = 'ABC private LTD-0002'
    );
  
  
[0m09:00:56.936845 [debug] [Thread-1 (]: SQL status: OK in 0.057 seconds
[0m09:00:56.952997 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m09:00:56.957895 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */
alter table "sales_database"."main"."transform_sales" rename to "transform_sales__dbt_backup"
[0m09:00:56.963803 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m09:00:56.981745 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m09:00:56.990114 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */
alter table "sales_database"."main"."transform_sales__dbt_tmp" rename to "transform_sales"
[0m09:00:56.996936 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m09:00:57.051014 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: COMMIT
[0m09:00:57.054621 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m09:00:57.059112 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: COMMIT
[0m09:00:57.100765 [debug] [Thread-1 (]: SQL status: OK in 0.038 seconds
[0m09:00:57.109764 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m09:00:57.112226 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */
drop table if exists "sales_database"."main"."transform_sales__dbt_backup" cascade
[0m09:00:57.137740 [debug] [Thread-1 (]: SQL status: OK in 0.022 seconds
[0m09:00:57.141810 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: Close
[0m09:00:57.430548 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12842634-4b70-44d2-b107-a10a6032aeed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1b04a3bf0>]}
[0m09:00:57.434230 [info ] [Thread-1 (]: 5 of 6 OK created sql table model main.transform_sales ......................... [[32mOK[0m in 0.87s]
[0m09:00:57.438747 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.transform_sales
[0m09:00:57.441445 [debug] [Thread-1 (]: Began running node model.my_dbt_project.sales_fact
[0m09:00:57.445936 [info ] [Thread-1 (]: 6 of 6 START sql table model main.sales_fact ................................... [RUN]
[0m09:00:57.449898 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.transform_sales, now model.my_dbt_project.sales_fact)
[0m09:00:57.455682 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.sales_fact
[0m09:00:57.478829 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.sales_fact"
[0m09:00:57.512677 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.sales_fact
[0m09:00:57.535457 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.sales_fact"
[0m09:00:57.569072 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_fact"
[0m09:00:57.571573 [debug] [Thread-1 (]: On model.my_dbt_project.sales_fact: BEGIN
[0m09:00:57.575163 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:00:57.627175 [debug] [Thread-1 (]: SQL status: OK in 0.053 seconds
[0m09:00:57.628681 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_fact"
[0m09:00:57.630721 [debug] [Thread-1 (]: On model.my_dbt_project.sales_fact: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_fact"} */

  
    
    

    create  table
      "sales_database"."main"."sales_fact__dbt_tmp"
  
    as (
      WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
),
customer AS (
    SELECT * FROM "sales_database"."main"."customer_dimension"
),
product AS (
    SELECT * FROM "sales_database"."main"."product_dimension"
),
sales_team AS (
    SELECT * FROM "sales_database"."main"."sales_team_dimension"
),
date AS (
    SELECT * FROM "sales_database"."main"."date_dimension"
)

SELECT
    sales.name AS sales_id,
    customer.customer_id,
    product.product_id,
    sales_team.sales_team_id,
    date.date_id,
    sales.total_qty,
    sales.total_net_weight,
    sales.total,
    sales.net_total,
    sales.grand_total,
    sales.tax_category
FROM sales
JOIN customer ON sales.customer = customer.customer_id
JOIN LATERAL (
    -- Extract product_id from items JSON array
    SELECT product_id
    FROM jsonb_array_elements(sales.items) AS item
    WHERE (item->>'product_id')::int = product.product_id
) product ON TRUE
JOIN LATERAL (
    -- Extract sales_team_id from sales_team JSON array
    SELECT sales_team_id
    FROM jsonb_array_elements(sales.sales_team) AS team
    WHERE (team->>'sales_team_id')::int = sales_team.sales_team_id
) sales_team ON TRUE
JOIN date ON sales.transaction_date = date.date_id;
    );
  
  
[0m09:00:57.672868 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_fact"} */

  
    
    

    create  table
      "sales_database"."main"."sales_fact__dbt_tmp"
  
    as (
      WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
),
customer AS (
    SELECT * FROM "sales_database"."main"."customer_dimension"
),
product AS (
    SELECT * FROM "sales_database"."main"."product_dimension"
),
sales_team AS (
    SELECT * FROM "sales_database"."main"."sales_team_dimension"
),
date AS (
    SELECT * FROM "sales_database"."main"."date_dimension"
)

SELECT
    sales.name AS sales_id,
    customer.customer_id,
    product.product_id,
    sales_team.sales_team_id,
    date.date_id,
    sales.total_qty,
    sales.total_net_weight,
    sales.total,
    sales.net_total,
    sales.grand_total,
    sales.tax_category
FROM sales
JOIN customer ON sales.customer = customer.customer_id
JOIN LATERAL (
    -- Extract product_id from items JSON array
    SELECT product_id
    FROM jsonb_array_elements(sales.items) AS item
    WHERE (item->>'product_id')::int = product.product_id
) product ON TRUE
JOIN LATERAL (
    -- Extract sales_team_id from sales_team JSON array
    SELECT sales_team_id
    FROM jsonb_array_elements(sales.sales_team) AS team
    WHERE (team->>'sales_team_id')::int = sales_team.sales_team_id
) sales_team ON TRUE
JOIN date ON sales.transaction_date = date.date_id;
    );
  
  
[0m09:00:57.675451 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m09:00:57.678098 [debug] [Thread-1 (]: On model.my_dbt_project.sales_fact: ROLLBACK
[0m09:00:57.724798 [debug] [Thread-1 (]: Failed to rollback 'model.my_dbt_project.sales_fact'
[0m09:00:57.728676 [debug] [Thread-1 (]: On model.my_dbt_project.sales_fact: Close
[0m09:00:57.755317 [debug] [Thread-1 (]: Runtime Error in model sales_fact (models/facts/sales_fact.sql)
  Parser Error: syntax error at or near ";"
[0m09:00:57.758109 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12842634-4b70-44d2-b107-a10a6032aeed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1b31c6420>]}
[0m09:00:57.762140 [error] [Thread-1 (]: 6 of 6 ERROR creating sql table model main.sales_fact .......................... [[31mERROR[0m in 0.31s]
[0m09:00:57.767856 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.sales_fact
[0m09:00:57.775513 [debug] [Thread-4 (]: Marking all children of 'model.my_dbt_project.sales_fact' to be skipped because of status 'error'.  Reason: Runtime Error in model sales_fact (models/facts/sales_fact.sql)
  Parser Error: syntax error at or near ";".
[0m09:00:57.795263 [debug] [MainThread]: Using duckdb connection "master"
[0m09:00:57.797501 [debug] [MainThread]: On master: BEGIN
[0m09:00:57.800414 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:00:57.964778 [debug] [MainThread]: SQL status: OK in 0.164 seconds
[0m09:00:57.968146 [debug] [MainThread]: On master: COMMIT
[0m09:00:57.970888 [debug] [MainThread]: Using duckdb connection "master"
[0m09:00:57.973774 [debug] [MainThread]: On master: COMMIT
[0m09:00:57.977139 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m09:00:57.979032 [debug] [MainThread]: On master: Close
[0m09:00:58.007978 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:00:58.010935 [debug] [MainThread]: Connection 'create_sales_database_main' was properly closed.
[0m09:00:58.013775 [debug] [MainThread]: Connection 'list_sales_database_main' was properly closed.
[0m09:00:58.020406 [debug] [MainThread]: Connection 'model.my_dbt_project.sales_fact' was properly closed.
[0m09:00:58.022807 [info ] [MainThread]: 
[0m09:00:58.026591 [info ] [MainThread]: Finished running 2 table models, 4 view models in 0 hours 0 minutes and 5.43 seconds (5.43s).
[0m09:00:58.042256 [debug] [MainThread]: Command end result
[0m09:00:58.290182 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m09:00:58.327913 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m09:00:58.382270 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dags/dbt_models/target/run_results.json
[0m09:00:58.384778 [info ] [MainThread]: 
[0m09:00:58.388087 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m09:00:58.390461 [info ] [MainThread]: 
[0m09:00:58.394400 [error] [MainThread]:   Runtime Error in model sales_fact (models/facts/sales_fact.sql)
  Parser Error: syntax error at or near ";"
[0m09:00:58.396823 [info ] [MainThread]: 
[0m09:00:58.399265 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m09:00:58.404783 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 75.19009, "process_in_blocks": "4124656", "process_kernel_time": 13.204374, "process_mem_max_rss": "141824", "process_out_blocks": "0", "process_user_time": 14.400165}
[0m09:00:58.414356 [debug] [MainThread]: Command `dbt run` failed at 09:00:58.413944 after 75.20 seconds
[0m09:00:58.417104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1c666eba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1c6ad18b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1b33b2ba0>]}
[0m09:00:58.419542 [debug] [MainThread]: Flushing usage events
[0m09:01:00.494382 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:07:07.790711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a165fe090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a1842b050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a165ff9e0>]}


============================== 09:07:07.808271 | 8c0e9aaa-2f42-4f4a-aa32-c1dc848b058e ==============================
[0m09:07:07.808271 [info ] [MainThread]: Running with dbt=1.9.1
[0m09:07:07.810399 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dags/dbt_models/logs', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt/profiles.yml', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt/profiles.yml --target dev', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:07:09.042689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8c0e9aaa-2f42-4f4a-aa32-c1dc848b058e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a1652be00>]}
[0m09:07:09.363578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8c0e9aaa-2f42-4f4a-aa32-c1dc848b058e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a16b7af60>]}
[0m09:07:09.380570 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m09:07:09.759050 [debug] [MainThread]: checksum: cac3b9519010e47bfbeb71ca6efb4867dae2858687671594dc23fefc94ecf25d, vars: {}, profile: , target: dev, version: 1.9.1
[0m09:07:10.424994 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:07:10.427634 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/facts/sales_fact.sql
[0m09:07:11.184542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8c0e9aaa-2f42-4f4a-aa32-c1dc848b058e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a0365fd40>]}
[0m09:07:11.363886 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m09:07:11.377072 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m09:07:11.472859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8c0e9aaa-2f42-4f4a-aa32-c1dc848b058e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a1019d100>]}
[0m09:07:11.474275 [info ] [MainThread]: Found 6 models, 1 source, 424 macros
[0m09:07:11.475713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8c0e9aaa-2f42-4f4a-aa32-c1dc848b058e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a1000b110>]}
[0m09:07:11.479449 [info ] [MainThread]: 
[0m09:07:11.480742 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:07:11.482500 [info ] [MainThread]: 
[0m09:07:11.486622 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m09:07:11.504598 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_sales_database'
[0m09:07:11.649897 [debug] [ThreadPool]: Using duckdb connection "list_sales_database"
[0m09:07:11.651359 [debug] [ThreadPool]: On list_sales_database: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "list_sales_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"sales_database"'
    
  
  
[0m09:07:11.653316 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:07:11.707620 [debug] [ThreadPool]: SQL status: OK in 0.054 seconds
[0m09:07:11.711609 [debug] [ThreadPool]: On list_sales_database: Close
[0m09:07:11.719349 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_database, now create_sales_database_main)
[0m09:07:11.721536 [debug] [ThreadPool]: Creating schema "database: "sales_database"
schema: "main"
"
[0m09:07:11.736923 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m09:07:11.738311 [debug] [ThreadPool]: On create_sales_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "create_sales_database_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='sales_database'
        and type='sqlite'
    
  
[0m09:07:11.739940 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:07:11.775617 [debug] [ThreadPool]: SQL status: OK in 0.036 seconds
[0m09:07:11.778646 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m09:07:11.780130 [debug] [ThreadPool]: On create_sales_database_main: BEGIN
[0m09:07:11.782385 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:07:11.783489 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m09:07:11.785846 [debug] [ThreadPool]: On create_sales_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "create_sales_database_main"} */

    
    
        create schema if not exists "sales_database"."main"
    
[0m09:07:11.790956 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m09:07:11.792977 [debug] [ThreadPool]: On create_sales_database_main: COMMIT
[0m09:07:11.794341 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m09:07:11.795951 [debug] [ThreadPool]: On create_sales_database_main: COMMIT
[0m09:07:11.797750 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:07:11.799306 [debug] [ThreadPool]: On create_sales_database_main: Close
[0m09:07:11.815046 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_sales_database_main, now list_sales_database_main)
[0m09:07:11.840355 [debug] [ThreadPool]: Using duckdb connection "list_sales_database_main"
[0m09:07:11.842865 [debug] [ThreadPool]: On list_sales_database_main: BEGIN
[0m09:07:11.846219 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:07:11.888745 [debug] [ThreadPool]: SQL status: OK in 0.043 seconds
[0m09:07:11.890429 [debug] [ThreadPool]: Using duckdb connection "list_sales_database_main"
[0m09:07:11.891920 [debug] [ThreadPool]: On list_sales_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "list_sales_database_main"} */
select
      'sales_database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'sales_database'
  
[0m09:07:12.046731 [debug] [ThreadPool]: SQL status: OK in 0.153 seconds
[0m09:07:12.050554 [debug] [ThreadPool]: On list_sales_database_main: ROLLBACK
[0m09:07:12.056266 [debug] [ThreadPool]: Failed to rollback 'list_sales_database_main'
[0m09:07:12.057590 [debug] [ThreadPool]: On list_sales_database_main: Close
[0m09:07:12.066663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8c0e9aaa-2f42-4f4a-aa32-c1dc848b058e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a03f582c0>]}
[0m09:07:12.069118 [debug] [MainThread]: Using duckdb connection "master"
[0m09:07:12.070432 [debug] [MainThread]: On master: BEGIN
[0m09:07:12.071669 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:07:12.101565 [debug] [MainThread]: SQL status: OK in 0.030 seconds
[0m09:07:12.103120 [debug] [MainThread]: On master: COMMIT
[0m09:07:12.104271 [debug] [MainThread]: Using duckdb connection "master"
[0m09:07:12.105320 [debug] [MainThread]: On master: COMMIT
[0m09:07:12.106922 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m09:07:12.107998 [debug] [MainThread]: On master: Close
[0m09:07:12.114295 [debug] [Thread-1 (]: Began running node model.my_dbt_project.customer_dimension
[0m09:07:12.115772 [info ] [Thread-1 (]: 1 of 6 START sql view model main.customer_dimension ............................ [RUN]
[0m09:07:12.117397 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.my_dbt_project.customer_dimension'
[0m09:07:12.119698 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.customer_dimension
[0m09:07:12.143008 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.customer_dimension"
[0m09:07:12.161713 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.customer_dimension
[0m09:07:12.232668 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.customer_dimension"
[0m09:07:12.266741 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m09:07:12.269885 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: BEGIN
[0m09:07:12.271810 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m09:07:12.314208 [debug] [Thread-1 (]: SQL status: OK in 0.042 seconds
[0m09:07:12.315524 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m09:07:12.316757 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */

  
  create view "sales_database"."main"."customer_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
    DISTINCT
    customer AS customer_id,
    customer_name,
    customer_address,
    customer_group,
    territory,
    language AS customer_language
FROM sales
WHERE customer IS NOT NULL
  );

[0m09:07:12.320671 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m09:07:12.347451 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m09:07:12.349479 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */
alter view "sales_database"."main"."customer_dimension" rename to "customer_dimension__dbt_backup"
[0m09:07:12.354864 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:07:12.365943 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m09:07:12.370886 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */
alter view "sales_database"."main"."customer_dimension__dbt_tmp" rename to "customer_dimension"
[0m09:07:12.375312 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:07:12.414939 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: COMMIT
[0m09:07:12.416352 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m09:07:12.417828 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: COMMIT
[0m09:07:12.437378 [debug] [Thread-1 (]: SQL status: OK in 0.018 seconds
[0m09:07:12.453935 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m09:07:12.456116 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */
drop view if exists "sales_database"."main"."customer_dimension__dbt_backup" cascade
[0m09:07:12.475914 [debug] [Thread-1 (]: SQL status: OK in 0.018 seconds
[0m09:07:12.489740 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: Close
[0m09:07:12.641069 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c0e9aaa-2f42-4f4a-aa32-c1dc848b058e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a1810bd40>]}
[0m09:07:12.643793 [info ] [Thread-1 (]: 1 of 6 OK created sql view model main.customer_dimension ....................... [[32mOK[0m in 0.51s]
[0m09:07:12.647502 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.customer_dimension
[0m09:07:12.648950 [debug] [Thread-1 (]: Began running node model.my_dbt_project.date_dimension
[0m09:07:12.650671 [info ] [Thread-1 (]: 2 of 6 START sql view model main.date_dimension ................................ [RUN]
[0m09:07:12.653553 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customer_dimension, now model.my_dbt_project.date_dimension)
[0m09:07:12.655668 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.date_dimension
[0m09:07:12.664306 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.date_dimension"
[0m09:07:12.682762 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.date_dimension
[0m09:07:12.699466 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.date_dimension"
[0m09:07:12.720955 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m09:07:12.722434 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: BEGIN
[0m09:07:12.723917 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:07:12.760151 [debug] [Thread-1 (]: SQL status: OK in 0.036 seconds
[0m09:07:12.761511 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m09:07:12.763161 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.date_dimension"} */

  
  create view "sales_database"."main"."date_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
    transaction_date,
    strftime(transaction_date, '%A') AS weekday_name,  -- Extract weekday name
    strftime(transaction_date, '%m') AS month,          -- Extract month (numeric)
    strftime(transaction_date, '%Y') AS year,           -- Extract year
    strftime(transaction_date, '%d') AS day,            -- Extract day
    EXTRACT(QUARTER FROM transaction_date) AS quarter   -- Extract quarter
FROM sales
WHERE transaction_date IS NOT NULL
  );

[0m09:07:12.788340 [debug] [Thread-1 (]: SQL status: OK in 0.023 seconds
[0m09:07:12.795553 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m09:07:12.797295 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.date_dimension"} */
alter view "sales_database"."main"."date_dimension" rename to "date_dimension__dbt_backup"
[0m09:07:12.799728 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:07:12.809229 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m09:07:12.810767 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.date_dimension"} */
alter view "sales_database"."main"."date_dimension__dbt_tmp" rename to "date_dimension"
[0m09:07:12.813264 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:07:12.819569 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: COMMIT
[0m09:07:12.820968 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m09:07:12.822560 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: COMMIT
[0m09:07:12.837542 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m09:07:12.845940 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m09:07:12.847994 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.date_dimension"} */
drop view if exists "sales_database"."main"."date_dimension__dbt_backup" cascade
[0m09:07:12.856465 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m09:07:12.860390 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: Close
[0m09:07:12.913827 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c0e9aaa-2f42-4f4a-aa32-c1dc848b058e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a1019f770>]}
[0m09:07:12.916499 [info ] [Thread-1 (]: 2 of 6 OK created sql view model main.date_dimension ........................... [[32mOK[0m in 0.26s]
[0m09:07:12.923338 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.date_dimension
[0m09:07:12.925567 [debug] [Thread-1 (]: Began running node model.my_dbt_project.product_dimension
[0m09:07:12.928082 [info ] [Thread-1 (]: 3 of 6 START sql view model main.product_dimension ............................. [RUN]
[0m09:07:12.930196 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.date_dimension, now model.my_dbt_project.product_dimension)
[0m09:07:12.932128 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.product_dimension
[0m09:07:12.942513 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.product_dimension"
[0m09:07:12.958706 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.product_dimension
[0m09:07:12.973103 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.product_dimension"
[0m09:07:12.989347 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m09:07:12.991112 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: BEGIN
[0m09:07:12.992804 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:07:13.060791 [debug] [Thread-1 (]: SQL status: OK in 0.068 seconds
[0m09:07:13.062833 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m09:07:13.065450 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.product_dimension"} */

  
  create view "sales_database"."main"."product_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * 
    FROM "sales_database"."main"."sales"
)

SELECT 
    sales.name,
    json_extract(items, '$[0].name') AS product_name,  -- Example to extract the first element's "name" field from JSON array
    json_extract(items, '$[0].item_code') AS product_item_code
FROM sales
WHERE json_extract(items, '$[0].name') IS NOT NULL  -- Filter to only keep rows with a non-null product name
  );

[0m09:07:13.072303 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m09:07:13.081645 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m09:07:13.083461 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.product_dimension"} */
alter view "sales_database"."main"."product_dimension" rename to "product_dimension__dbt_backup"
[0m09:07:13.087699 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:07:13.096472 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m09:07:13.097996 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.product_dimension"} */
alter view "sales_database"."main"."product_dimension__dbt_tmp" rename to "product_dimension"
[0m09:07:13.100749 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:07:13.109455 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: COMMIT
[0m09:07:13.111252 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m09:07:13.112595 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: COMMIT
[0m09:07:13.125378 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m09:07:13.136153 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m09:07:13.138092 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.product_dimension"} */
drop view if exists "sales_database"."main"."product_dimension__dbt_backup" cascade
[0m09:07:13.142770 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m09:07:13.145875 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: Close
[0m09:07:13.185014 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c0e9aaa-2f42-4f4a-aa32-c1dc848b058e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a02b706e0>]}
[0m09:07:13.187699 [info ] [Thread-1 (]: 3 of 6 OK created sql view model main.product_dimension ........................ [[32mOK[0m in 0.25s]
[0m09:07:13.189601 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.product_dimension
[0m09:07:13.190818 [debug] [Thread-1 (]: Began running node model.my_dbt_project.sales_team_dimension
[0m09:07:13.192183 [info ] [Thread-1 (]: 4 of 6 START sql view model main.sales_team_dimension .......................... [RUN]
[0m09:07:13.193629 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.product_dimension, now model.my_dbt_project.sales_team_dimension)
[0m09:07:13.194730 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.sales_team_dimension
[0m09:07:13.200025 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.sales_team_dimension"
[0m09:07:13.212347 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.sales_team_dimension
[0m09:07:13.221853 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.sales_team_dimension"
[0m09:07:13.233406 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m09:07:13.235005 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: BEGIN
[0m09:07:13.236783 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:07:13.259108 [debug] [Thread-1 (]: SQL status: OK in 0.022 seconds
[0m09:07:13.260308 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m09:07:13.261468 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */

  
  create view "sales_database"."main"."sales_team_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
    DISTINCT
    sales_team->>'name' AS sales_team_id,
    sales_team->>'region' AS sales_team_region
FROM sales
WHERE sales_team IS NOT NULL
  );

[0m09:07:13.264064 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:07:13.271320 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m09:07:13.272515 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */
alter view "sales_database"."main"."sales_team_dimension" rename to "sales_team_dimension__dbt_backup"
[0m09:07:13.274341 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:07:13.284093 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m09:07:13.286604 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */
alter view "sales_database"."main"."sales_team_dimension__dbt_tmp" rename to "sales_team_dimension"
[0m09:07:13.288752 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:07:13.293953 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: COMMIT
[0m09:07:13.295659 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m09:07:13.297314 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: COMMIT
[0m09:07:13.308910 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m09:07:13.316297 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m09:07:13.317961 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */
drop view if exists "sales_database"."main"."sales_team_dimension__dbt_backup" cascade
[0m09:07:13.323640 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m09:07:13.327543 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: Close
[0m09:07:13.375506 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c0e9aaa-2f42-4f4a-aa32-c1dc848b058e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a004b71d0>]}
[0m09:07:13.377115 [info ] [Thread-1 (]: 4 of 6 OK created sql view model main.sales_team_dimension ..................... [[32mOK[0m in 0.18s]
[0m09:07:13.379000 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.sales_team_dimension
[0m09:07:13.380240 [debug] [Thread-1 (]: Began running node model.my_dbt_project.transform_sales
[0m09:07:13.381720 [info ] [Thread-1 (]: 5 of 6 START sql table model main.transform_sales .............................. [RUN]
[0m09:07:13.383155 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.sales_team_dimension, now model.my_dbt_project.transform_sales)
[0m09:07:13.384849 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.transform_sales
[0m09:07:13.391025 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.transform_sales"
[0m09:07:13.402364 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.transform_sales
[0m09:07:13.445760 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.transform_sales"
[0m09:07:13.459131 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m09:07:13.460440 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: BEGIN
[0m09:07:13.461595 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:07:13.488108 [debug] [Thread-1 (]: SQL status: OK in 0.026 seconds
[0m09:07:13.489542 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m09:07:13.490834 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */

  
    
    

    create  table
      "sales_database"."main"."transform_sales__dbt_tmp"
  
    as (
      -- /opt/airflow/dags/dbt_models/transform_users.sql


WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
   *
FROM sales
WHERE name = 'ABC private LTD-0002'
    );
  
  
[0m09:07:13.520816 [debug] [Thread-1 (]: SQL status: OK in 0.028 seconds
[0m09:07:13.549716 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m09:07:13.577731 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */
alter table "sales_database"."main"."transform_sales" rename to "transform_sales__dbt_backup"
[0m09:07:13.581917 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:07:13.616705 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m09:07:13.620642 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */
alter table "sales_database"."main"."transform_sales__dbt_tmp" rename to "transform_sales"
[0m09:07:13.647570 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m09:07:13.710922 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: COMMIT
[0m09:07:13.718191 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m09:07:13.733408 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: COMMIT
[0m09:07:13.958743 [debug] [Thread-1 (]: SQL status: OK in 0.217 seconds
[0m09:07:13.970304 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m09:07:13.982855 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */
drop table if exists "sales_database"."main"."transform_sales__dbt_backup" cascade
[0m09:07:14.007322 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m09:07:14.032709 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: Close
[0m09:07:14.558397 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c0e9aaa-2f42-4f4a-aa32-c1dc848b058e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a02a0da30>]}
[0m09:07:14.562357 [info ] [Thread-1 (]: 5 of 6 OK created sql table model main.transform_sales ......................... [[32mOK[0m in 1.18s]
[0m09:07:14.566871 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.transform_sales
[0m09:07:14.570588 [debug] [Thread-1 (]: Began running node model.my_dbt_project.sales_fact
[0m09:07:14.572826 [info ] [Thread-1 (]: 6 of 6 START sql table model main.sales_fact ................................... [RUN]
[0m09:07:14.576322 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.transform_sales, now model.my_dbt_project.sales_fact)
[0m09:07:14.578340 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.sales_fact
[0m09:07:14.594185 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.sales_fact"
[0m09:07:14.617252 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.sales_fact
[0m09:07:14.634409 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.sales_fact"
[0m09:07:14.656696 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_fact"
[0m09:07:14.659319 [debug] [Thread-1 (]: On model.my_dbt_project.sales_fact: BEGIN
[0m09:07:14.662150 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:07:14.723242 [debug] [Thread-1 (]: SQL status: OK in 0.061 seconds
[0m09:07:14.725434 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_fact"
[0m09:07:14.727857 [debug] [Thread-1 (]: On model.my_dbt_project.sales_fact: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_fact"} */

  
    
    

    create  table
      "sales_database"."main"."sales_fact__dbt_tmp"
  
    as (
      WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
),
customer AS (
    SELECT * FROM "sales_database"."main"."customer_dimension"
),
product AS (
    SELECT * FROM "sales_database"."main"."product_dimension"
),
sales_team AS (
    SELECT * FROM "sales_database"."main"."sales_team_dimension"
),
date AS (
    SELECT * FROM "sales_database"."main"."date_dimension"
)

SELECT
    sales.name AS sales_id,
    customer.customer_id,
    product.product_id,
    sales_team.sales_team_id,
    date.date_id,
    sales.total_qty,
    sales.total_net_weight,
    sales.total,
    sales.net_total,
    sales.grand_total,
    sales.tax_category
FROM sales
JOIN customer ON sales.customer = customer.customer_id
-- Join for product, with correct LATERAL logic
JOIN LATERAL (
    SELECT product_id
    FROM jsonb_array_elements(sales.items) AS item(product_id)
    WHERE (item.product_id) = product.product_id
) product ON TRUE
-- Join for sales_team, with correct LATERAL logic
JOIN LATERAL (
    SELECT sales_team_id
    FROM jsonb_array_elements(sales.sales_team) AS team(sales_team_id)
    WHERE (team.sales_team_id) = sales_team.sales_team_id
) sales_team ON TRUE
JOIN date ON sales.transaction_date = date.date_id;
    );
  
  
[0m09:07:14.744501 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_fact"} */

  
    
    

    create  table
      "sales_database"."main"."sales_fact__dbt_tmp"
  
    as (
      WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
),
customer AS (
    SELECT * FROM "sales_database"."main"."customer_dimension"
),
product AS (
    SELECT * FROM "sales_database"."main"."product_dimension"
),
sales_team AS (
    SELECT * FROM "sales_database"."main"."sales_team_dimension"
),
date AS (
    SELECT * FROM "sales_database"."main"."date_dimension"
)

SELECT
    sales.name AS sales_id,
    customer.customer_id,
    product.product_id,
    sales_team.sales_team_id,
    date.date_id,
    sales.total_qty,
    sales.total_net_weight,
    sales.total,
    sales.net_total,
    sales.grand_total,
    sales.tax_category
FROM sales
JOIN customer ON sales.customer = customer.customer_id
-- Join for product, with correct LATERAL logic
JOIN LATERAL (
    SELECT product_id
    FROM jsonb_array_elements(sales.items) AS item(product_id)
    WHERE (item.product_id) = product.product_id
) product ON TRUE
-- Join for sales_team, with correct LATERAL logic
JOIN LATERAL (
    SELECT sales_team_id
    FROM jsonb_array_elements(sales.sales_team) AS team(sales_team_id)
    WHERE (team.sales_team_id) = sales_team.sales_team_id
) sales_team ON TRUE
JOIN date ON sales.transaction_date = date.date_id;
    );
  
  
[0m09:07:14.746490 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m09:07:14.748200 [debug] [Thread-1 (]: On model.my_dbt_project.sales_fact: ROLLBACK
[0m09:07:14.768107 [debug] [Thread-1 (]: Failed to rollback 'model.my_dbt_project.sales_fact'
[0m09:07:14.770191 [debug] [Thread-1 (]: On model.my_dbt_project.sales_fact: Close
[0m09:07:14.785027 [debug] [Thread-1 (]: Runtime Error in model sales_fact (models/facts/sales_fact.sql)
  Parser Error: syntax error at or near ";"
[0m09:07:14.788037 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c0e9aaa-2f42-4f4a-aa32-c1dc848b058e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a02acec60>]}
[0m09:07:14.790837 [error] [Thread-1 (]: 6 of 6 ERROR creating sql table model main.sales_fact .......................... [[31mERROR[0m in 0.21s]
[0m09:07:14.793841 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.sales_fact
[0m09:07:14.796341 [debug] [Thread-4 (]: Marking all children of 'model.my_dbt_project.sales_fact' to be skipped because of status 'error'.  Reason: Runtime Error in model sales_fact (models/facts/sales_fact.sql)
  Parser Error: syntax error at or near ";".
[0m09:07:14.803059 [debug] [MainThread]: Using duckdb connection "master"
[0m09:07:14.804762 [debug] [MainThread]: On master: BEGIN
[0m09:07:14.806866 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:07:14.848532 [debug] [MainThread]: SQL status: OK in 0.042 seconds
[0m09:07:14.850587 [debug] [MainThread]: On master: COMMIT
[0m09:07:14.854217 [debug] [MainThread]: Using duckdb connection "master"
[0m09:07:14.856017 [debug] [MainThread]: On master: COMMIT
[0m09:07:14.858468 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m09:07:14.860203 [debug] [MainThread]: On master: Close
[0m09:07:14.872638 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:07:14.879074 [debug] [MainThread]: Connection 'list_sales_database_main' was properly closed.
[0m09:07:14.883758 [debug] [MainThread]: Connection 'model.my_dbt_project.sales_fact' was properly closed.
[0m09:07:14.891452 [info ] [MainThread]: 
[0m09:07:14.893984 [info ] [MainThread]: Finished running 2 table models, 4 view models in 0 hours 0 minutes and 3.40 seconds (3.40s).
[0m09:07:14.916789 [debug] [MainThread]: Command end result
[0m09:07:15.061837 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m09:07:15.074513 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m09:07:15.107408 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dags/dbt_models/target/run_results.json
[0m09:07:15.108921 [info ] [MainThread]: 
[0m09:07:15.111138 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m09:07:15.113228 [info ] [MainThread]: 
[0m09:07:15.115598 [error] [MainThread]:   Runtime Error in model sales_fact (models/facts/sales_fact.sql)
  Parser Error: syntax error at or near ";"
[0m09:07:15.117419 [info ] [MainThread]: 
[0m09:07:15.119793 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m09:07:15.125054 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 7.57364, "process_in_blocks": "149856", "process_kernel_time": 1.402292, "process_mem_max_rss": "161856", "process_out_blocks": "0", "process_user_time": 10.698969}
[0m09:07:15.127548 [debug] [MainThread]: Command `dbt run` failed at 09:07:15.127192 after 7.58 seconds
[0m09:07:15.129443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a173b7800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a19a07950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a167c5640>]}
[0m09:07:15.131684 [debug] [MainThread]: Flushing usage events
[0m09:07:16.856351 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:10:17.350193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f166055f0e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16608c9100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f166077a1e0>]}


============================== 09:10:17.406352 | ca15cce2-b3f8-4363-9b7d-85c64b19d56b ==============================
[0m09:10:17.406352 [info ] [MainThread]: Running with dbt=1.9.1
[0m09:10:17.411724 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/profiles.yml', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dags/dbt_models/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt/profiles.yml --target dev', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:10:21.890628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ca15cce2-b3f8-4363-9b7d-85c64b19d56b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f165fceb800>]}
[0m09:10:22.073972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ca15cce2-b3f8-4363-9b7d-85c64b19d56b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f165fd14a70>]}
[0m09:10:22.238385 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m09:10:23.227825 [debug] [MainThread]: checksum: cac3b9519010e47bfbeb71ca6efb4867dae2858687671594dc23fefc94ecf25d, vars: {}, profile: , target: dev, version: 1.9.1
[0m09:10:23.993150 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:10:23.995561 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/facts/sales_fact.sql
[0m09:10:25.846838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ca15cce2-b3f8-4363-9b7d-85c64b19d56b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f165965fc80>]}
[0m09:10:26.388382 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m09:10:26.431466 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m09:10:26.987836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ca15cce2-b3f8-4363-9b7d-85c64b19d56b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f165a1992b0>]}
[0m09:10:26.992587 [info ] [MainThread]: Found 6 models, 1 source, 424 macros
[0m09:10:27.006656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ca15cce2-b3f8-4363-9b7d-85c64b19d56b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f165fd151f0>]}
[0m09:10:27.027012 [info ] [MainThread]: 
[0m09:10:27.048663 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:10:27.051201 [info ] [MainThread]: 
[0m09:10:27.055423 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m09:10:27.078699 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_sales_database'
[0m09:10:27.474369 [debug] [ThreadPool]: Using duckdb connection "list_sales_database"
[0m09:10:27.477095 [debug] [ThreadPool]: On list_sales_database: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "list_sales_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"sales_database"'
    
  
  
[0m09:10:27.481430 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:10:27.917531 [debug] [ThreadPool]: SQL status: OK in 0.436 seconds
[0m09:10:27.923101 [debug] [ThreadPool]: On list_sales_database: Close
[0m09:10:27.933399 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_database, now create_sales_database_main)
[0m09:10:27.955006 [debug] [ThreadPool]: Creating schema "database: "sales_database"
schema: "main"
"
[0m09:10:27.980004 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m09:10:27.984367 [debug] [ThreadPool]: On create_sales_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "create_sales_database_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='sales_database'
        and type='sqlite'
    
  
[0m09:10:27.988057 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:10:28.131148 [debug] [ThreadPool]: SQL status: OK in 0.143 seconds
[0m09:10:28.145862 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m09:10:28.157946 [debug] [ThreadPool]: On create_sales_database_main: BEGIN
[0m09:10:28.161977 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:10:28.176119 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m09:10:28.186938 [debug] [ThreadPool]: On create_sales_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "create_sales_database_main"} */

    
    
        create schema if not exists "sales_database"."main"
    
[0m09:10:28.194660 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m09:10:28.313927 [debug] [ThreadPool]: On create_sales_database_main: COMMIT
[0m09:10:28.352120 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m09:10:28.382083 [debug] [ThreadPool]: On create_sales_database_main: COMMIT
[0m09:10:28.443755 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:10:28.488939 [debug] [ThreadPool]: On create_sales_database_main: Close
[0m09:10:28.658118 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_sales_database_main, now list_sales_database_main)
[0m09:10:28.787284 [debug] [ThreadPool]: Using duckdb connection "list_sales_database_main"
[0m09:10:28.789132 [debug] [ThreadPool]: On list_sales_database_main: BEGIN
[0m09:10:28.791083 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:10:28.996854 [debug] [ThreadPool]: SQL status: OK in 0.206 seconds
[0m09:10:28.999025 [debug] [ThreadPool]: Using duckdb connection "list_sales_database_main"
[0m09:10:29.001421 [debug] [ThreadPool]: On list_sales_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "list_sales_database_main"} */
select
      'sales_database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'sales_database'
  
[0m09:10:29.332428 [debug] [ThreadPool]: SQL status: OK in 0.326 seconds
[0m09:10:29.373173 [debug] [ThreadPool]: On list_sales_database_main: ROLLBACK
[0m09:10:29.412241 [debug] [ThreadPool]: Failed to rollback 'list_sales_database_main'
[0m09:10:29.417940 [debug] [ThreadPool]: On list_sales_database_main: Close
[0m09:10:29.446147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ca15cce2-b3f8-4363-9b7d-85c64b19d56b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f165a199f40>]}
[0m09:10:29.448198 [debug] [MainThread]: Using duckdb connection "master"
[0m09:10:29.449980 [debug] [MainThread]: On master: BEGIN
[0m09:10:29.451687 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:10:29.572965 [debug] [MainThread]: SQL status: OK in 0.121 seconds
[0m09:10:29.584170 [debug] [MainThread]: On master: COMMIT
[0m09:10:29.594030 [debug] [MainThread]: Using duckdb connection "master"
[0m09:10:29.600671 [debug] [MainThread]: On master: COMMIT
[0m09:10:29.629102 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m09:10:29.632169 [debug] [MainThread]: On master: Close
[0m09:10:29.660606 [debug] [Thread-1 (]: Began running node model.my_dbt_project.customer_dimension
[0m09:10:29.667238 [info ] [Thread-1 (]: 1 of 6 START sql view model main.customer_dimension ............................ [RUN]
[0m09:10:29.685746 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.my_dbt_project.customer_dimension'
[0m09:10:29.703254 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.customer_dimension
[0m09:10:29.749675 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.customer_dimension"
[0m09:10:29.776946 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.customer_dimension
[0m09:10:29.954640 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.customer_dimension"
[0m09:10:29.981037 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m09:10:29.982915 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: BEGIN
[0m09:10:29.985710 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m09:10:30.051018 [debug] [Thread-1 (]: SQL status: OK in 0.065 seconds
[0m09:10:30.054392 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m09:10:30.059817 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */

  
  create view "sales_database"."main"."customer_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
    DISTINCT
    customer AS customer_id,
    customer_name,
    customer_address,
    customer_group,
    territory,
    language AS customer_language
FROM sales
WHERE customer IS NOT NULL
  );

[0m09:10:30.064552 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m09:10:30.083362 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m09:10:30.084958 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */
alter view "sales_database"."main"."customer_dimension" rename to "customer_dimension__dbt_backup"
[0m09:10:30.088042 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:10:30.100123 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m09:10:30.102622 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */
alter view "sales_database"."main"."customer_dimension__dbt_tmp" rename to "customer_dimension"
[0m09:10:30.106146 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:10:30.180448 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: COMMIT
[0m09:10:30.185021 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m09:10:30.193564 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: COMMIT
[0m09:10:30.243056 [debug] [Thread-1 (]: SQL status: OK in 0.035 seconds
[0m09:10:30.265865 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m09:10:30.268861 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */
drop view if exists "sales_database"."main"."customer_dimension__dbt_backup" cascade
[0m09:10:30.309683 [debug] [Thread-1 (]: SQL status: OK in 0.029 seconds
[0m09:10:30.323436 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: Close
[0m09:10:30.535125 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca15cce2-b3f8-4363-9b7d-85c64b19d56b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1659f793d0>]}
[0m09:10:30.538612 [info ] [Thread-1 (]: 1 of 6 OK created sql view model main.customer_dimension ....................... [[32mOK[0m in 0.84s]
[0m09:10:30.543205 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.customer_dimension
[0m09:10:30.549274 [debug] [Thread-1 (]: Began running node model.my_dbt_project.date_dimension
[0m09:10:30.557734 [info ] [Thread-1 (]: 2 of 6 START sql view model main.date_dimension ................................ [RUN]
[0m09:10:30.559830 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customer_dimension, now model.my_dbt_project.date_dimension)
[0m09:10:30.562853 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.date_dimension
[0m09:10:30.574848 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.date_dimension"
[0m09:10:30.601888 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.date_dimension
[0m09:10:30.630680 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.date_dimension"
[0m09:10:30.656623 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m09:10:30.658719 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: BEGIN
[0m09:10:30.671918 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:10:30.765201 [debug] [Thread-1 (]: SQL status: OK in 0.093 seconds
[0m09:10:30.767868 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m09:10:30.776654 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.date_dimension"} */

  
  create view "sales_database"."main"."date_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
    transaction_date,
    strftime(transaction_date, '%A') AS weekday_name,  -- Extract weekday name
    strftime(transaction_date, '%m') AS month,          -- Extract month (numeric)
    strftime(transaction_date, '%Y') AS year,           -- Extract year
    strftime(transaction_date, '%d') AS day,            -- Extract day
    EXTRACT(QUARTER FROM transaction_date) AS quarter   -- Extract quarter
FROM sales
WHERE transaction_date IS NOT NULL
  );

[0m09:10:30.816882 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m09:10:30.845106 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m09:10:30.850090 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.date_dimension"} */
alter view "sales_database"."main"."date_dimension" rename to "date_dimension__dbt_backup"
[0m09:10:30.857494 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m09:10:30.879208 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m09:10:30.923694 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.date_dimension"} */
alter view "sales_database"."main"."date_dimension__dbt_tmp" rename to "date_dimension"
[0m09:10:30.931729 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:10:30.957037 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: COMMIT
[0m09:10:30.960836 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m09:10:30.963500 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: COMMIT
[0m09:10:31.048406 [debug] [Thread-1 (]: SQL status: OK in 0.080 seconds
[0m09:10:31.070142 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m09:10:31.076155 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.date_dimension"} */
drop view if exists "sales_database"."main"."date_dimension__dbt_backup" cascade
[0m09:10:31.120419 [debug] [Thread-1 (]: SQL status: OK in 0.031 seconds
[0m09:10:31.133423 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: Close
[0m09:10:31.352005 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca15cce2-b3f8-4363-9b7d-85c64b19d56b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1658117cb0>]}
[0m09:10:31.367729 [info ] [Thread-1 (]: 2 of 6 OK created sql view model main.date_dimension ........................... [[32mOK[0m in 0.79s]
[0m09:10:31.371169 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.date_dimension
[0m09:10:31.374341 [debug] [Thread-1 (]: Began running node model.my_dbt_project.product_dimension
[0m09:10:31.379454 [info ] [Thread-1 (]: 3 of 6 START sql view model main.product_dimension ............................. [RUN]
[0m09:10:31.382712 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.date_dimension, now model.my_dbt_project.product_dimension)
[0m09:10:31.384665 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.product_dimension
[0m09:10:31.397125 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.product_dimension"
[0m09:10:31.574027 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.product_dimension
[0m09:10:31.599977 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.product_dimension"
[0m09:10:31.631970 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m09:10:31.634383 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: BEGIN
[0m09:10:31.636924 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:10:31.796543 [debug] [Thread-1 (]: SQL status: OK in 0.160 seconds
[0m09:10:31.799101 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m09:10:31.806884 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.product_dimension"} */

  
  create view "sales_database"."main"."product_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * 
    FROM "sales_database"."main"."sales"
)

SELECT 
    sales.name,
    json_extract(items, '$[0].name') AS product_name,  -- Example to extract the first element's "name" field from JSON array
    json_extract(items, '$[0].item_code') AS product_item_code
FROM sales
WHERE json_extract(items, '$[0].name') IS NOT NULL  -- Filter to only keep rows with a non-null product name
  );

[0m09:10:31.836944 [debug] [Thread-1 (]: SQL status: OK in 0.023 seconds
[0m09:10:31.882452 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m09:10:31.899797 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.product_dimension"} */
alter view "sales_database"."main"."product_dimension" rename to "product_dimension__dbt_backup"
[0m09:10:31.909663 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m09:10:31.926788 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m09:10:31.931803 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.product_dimension"} */
alter view "sales_database"."main"."product_dimension__dbt_tmp" rename to "product_dimension"
[0m09:10:31.940501 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:10:31.958496 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: COMMIT
[0m09:10:31.961395 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m09:10:31.964327 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: COMMIT
[0m09:10:31.993191 [debug] [Thread-1 (]: SQL status: OK in 0.026 seconds
[0m09:10:32.005159 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m09:10:32.013059 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.product_dimension"} */
drop view if exists "sales_database"."main"."product_dimension__dbt_backup" cascade
[0m09:10:32.047875 [debug] [Thread-1 (]: SQL status: OK in 0.027 seconds
[0m09:10:32.051921 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: Close
[0m09:10:32.229558 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca15cce2-b3f8-4363-9b7d-85c64b19d56b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1658acb9b0>]}
[0m09:10:32.236361 [info ] [Thread-1 (]: 3 of 6 OK created sql view model main.product_dimension ........................ [[32mOK[0m in 0.85s]
[0m09:10:32.244284 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.product_dimension
[0m09:10:32.248803 [debug] [Thread-1 (]: Began running node model.my_dbt_project.sales_team_dimension
[0m09:10:32.254592 [info ] [Thread-1 (]: 4 of 6 START sql view model main.sales_team_dimension .......................... [RUN]
[0m09:10:32.263058 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.product_dimension, now model.my_dbt_project.sales_team_dimension)
[0m09:10:32.265885 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.sales_team_dimension
[0m09:10:32.279381 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.sales_team_dimension"
[0m09:10:32.332691 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.sales_team_dimension
[0m09:10:32.348758 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.sales_team_dimension"
[0m09:10:32.388619 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m09:10:32.390442 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: BEGIN
[0m09:10:32.392283 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:10:32.577900 [debug] [Thread-1 (]: SQL status: OK in 0.185 seconds
[0m09:10:32.580201 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m09:10:32.592025 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */

  
  create view "sales_database"."main"."sales_team_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
    DISTINCT
    sales_team->>'name' AS sales_team_id,
    sales_team->>'region' AS sales_team_region
FROM sales
WHERE sales_team IS NOT NULL
  );

[0m09:10:32.682688 [debug] [Thread-1 (]: SQL status: OK in 0.088 seconds
[0m09:10:32.703183 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m09:10:32.704998 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */
alter view "sales_database"."main"."sales_team_dimension" rename to "sales_team_dimension__dbt_backup"
[0m09:10:32.707720 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:10:32.730458 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m09:10:32.733319 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */
alter view "sales_database"."main"."sales_team_dimension__dbt_tmp" rename to "sales_team_dimension"
[0m09:10:32.738203 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m09:10:32.753243 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: COMMIT
[0m09:10:32.755520 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m09:10:32.757404 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: COMMIT
[0m09:10:32.791062 [debug] [Thread-1 (]: SQL status: OK in 0.032 seconds
[0m09:10:32.806385 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m09:10:32.808680 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */
drop view if exists "sales_database"."main"."sales_team_dimension__dbt_backup" cascade
[0m09:10:32.852645 [debug] [Thread-1 (]: SQL status: OK in 0.026 seconds
[0m09:10:32.859367 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: Close
[0m09:10:33.152787 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca15cce2-b3f8-4363-9b7d-85c64b19d56b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f165813b020>]}
[0m09:10:33.168727 [info ] [Thread-1 (]: 4 of 6 OK created sql view model main.sales_team_dimension ..................... [[32mOK[0m in 0.89s]
[0m09:10:33.184718 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.sales_team_dimension
[0m09:10:33.197888 [debug] [Thread-1 (]: Began running node model.my_dbt_project.transform_sales
[0m09:10:33.204233 [info ] [Thread-1 (]: 5 of 6 START sql table model main.transform_sales .............................. [RUN]
[0m09:10:33.218879 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.sales_team_dimension, now model.my_dbt_project.transform_sales)
[0m09:10:33.225423 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.transform_sales
[0m09:10:33.256067 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.transform_sales"
[0m09:10:33.323193 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.transform_sales
[0m09:10:33.481900 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.transform_sales"
[0m09:10:33.811439 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m09:10:33.814678 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: BEGIN
[0m09:10:33.820700 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:10:34.633361 [debug] [Thread-1 (]: SQL status: OK in 0.812 seconds
[0m09:10:34.635491 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m09:10:34.641498 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */

  
    
    

    create  table
      "sales_database"."main"."transform_sales__dbt_tmp"
  
    as (
      -- /opt/airflow/dags/dbt_models/transform_users.sql


WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
   *
FROM sales
WHERE name = 'ABC private LTD-0002'
    );
  
  
[0m09:10:34.724248 [debug] [Thread-1 (]: SQL status: OK in 0.074 seconds
[0m09:10:34.758823 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m09:10:34.766557 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */
alter table "sales_database"."main"."transform_sales" rename to "transform_sales__dbt_backup"
[0m09:10:34.771414 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m09:10:34.790461 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m09:10:34.797165 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */
alter table "sales_database"."main"."transform_sales__dbt_tmp" rename to "transform_sales"
[0m09:10:34.802258 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m09:10:34.846573 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: COMMIT
[0m09:10:34.850169 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m09:10:34.853432 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: COMMIT
[0m09:10:34.907886 [debug] [Thread-1 (]: SQL status: OK in 0.052 seconds
[0m09:10:34.913992 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m09:10:34.915240 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */
drop table if exists "sales_database"."main"."transform_sales__dbt_backup" cascade
[0m09:10:34.949357 [debug] [Thread-1 (]: SQL status: OK in 0.031 seconds
[0m09:10:34.960191 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: Close
[0m09:10:35.275360 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca15cce2-b3f8-4363-9b7d-85c64b19d56b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1658a0ccb0>]}
[0m09:10:35.288213 [info ] [Thread-1 (]: 5 of 6 OK created sql table model main.transform_sales ......................... [[32mOK[0m in 2.06s]
[0m09:10:35.305767 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.transform_sales
[0m09:10:35.312793 [debug] [Thread-1 (]: Began running node model.my_dbt_project.sales_fact
[0m09:10:35.324820 [info ] [Thread-1 (]: 6 of 6 START sql table model main.sales_fact ................................... [RUN]
[0m09:10:35.329909 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.transform_sales, now model.my_dbt_project.sales_fact)
[0m09:10:35.334982 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.sales_fact
[0m09:10:35.360704 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.sales_fact"
[0m09:10:35.401225 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.sales_fact
[0m09:10:35.455653 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.sales_fact"
[0m09:10:35.476811 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_fact"
[0m09:10:35.480189 [debug] [Thread-1 (]: On model.my_dbt_project.sales_fact: BEGIN
[0m09:10:35.506796 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:10:36.421235 [debug] [Thread-1 (]: SQL status: OK in 0.895 seconds
[0m09:10:36.431500 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_fact"
[0m09:10:36.436238 [debug] [Thread-1 (]: On model.my_dbt_project.sales_fact: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_fact"} */

  
    
    

    create  table
      "sales_database"."main"."sales_fact__dbt_tmp"
  
    as (
      WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
),
customer AS (
    SELECT * FROM "sales_database"."main"."customer_dimension"
),
product AS (
    SELECT * FROM "sales_database"."main"."product_dimension"
),
sales_team AS (
    SELECT * FROM "sales_database"."main"."sales_team_dimension"
),
date AS (
    SELECT * FROM "sales_database"."main"."date_dimension"
)

SELECT
    sales.name AS sales_id,
    customer.customer_id,
    product.product_id,
    sales_team.sales_team_id,
    date.date_id,
    sales.total_qty,
    sales.total_net_weight,
    sales.total,
    sales.net_total,
    sales.grand_total,
    sales.tax_category
FROM sales
JOIN customer ON sales.customer = customer.customer_id
-- Correctly handling product as a lateral join
JOIN LATERAL (
    SELECT product_id
    FROM jsonb_array_elements(sales.items) AS product(item)
    WHERE item->>'product_id' = product.product_id
) AS product ON TRUE
-- Correctly handling sales_team as a lateral join
JOIN LATERAL (
    SELECT sales_team_id
    FROM jsonb_array_elements(sales.sales_team) AS team(item)
    WHERE item->>'sales_team_id' = sales_team.sales_team_id
) AS sales_team ON TRUE
JOIN date ON sales.transaction_date = date.date_id;
    );
  
  
[0m09:10:36.769773 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_fact"} */

  
    
    

    create  table
      "sales_database"."main"."sales_fact__dbt_tmp"
  
    as (
      WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
),
customer AS (
    SELECT * FROM "sales_database"."main"."customer_dimension"
),
product AS (
    SELECT * FROM "sales_database"."main"."product_dimension"
),
sales_team AS (
    SELECT * FROM "sales_database"."main"."sales_team_dimension"
),
date AS (
    SELECT * FROM "sales_database"."main"."date_dimension"
)

SELECT
    sales.name AS sales_id,
    customer.customer_id,
    product.product_id,
    sales_team.sales_team_id,
    date.date_id,
    sales.total_qty,
    sales.total_net_weight,
    sales.total,
    sales.net_total,
    sales.grand_total,
    sales.tax_category
FROM sales
JOIN customer ON sales.customer = customer.customer_id
-- Correctly handling product as a lateral join
JOIN LATERAL (
    SELECT product_id
    FROM jsonb_array_elements(sales.items) AS product(item)
    WHERE item->>'product_id' = product.product_id
) AS product ON TRUE
-- Correctly handling sales_team as a lateral join
JOIN LATERAL (
    SELECT sales_team_id
    FROM jsonb_array_elements(sales.sales_team) AS team(item)
    WHERE item->>'sales_team_id' = sales_team.sales_team_id
) AS sales_team ON TRUE
JOIN date ON sales.transaction_date = date.date_id;
    );
  
  
[0m09:10:36.804323 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m09:10:36.820703 [debug] [Thread-1 (]: On model.my_dbt_project.sales_fact: ROLLBACK
[0m09:10:37.000307 [debug] [Thread-1 (]: Failed to rollback 'model.my_dbt_project.sales_fact'
[0m09:10:37.021210 [debug] [Thread-1 (]: On model.my_dbt_project.sales_fact: Close
[0m09:10:37.153319 [debug] [Thread-1 (]: Runtime Error in model sales_fact (models/facts/sales_fact.sql)
  Parser Error: syntax error at or near ";"
[0m09:10:37.157322 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca15cce2-b3f8-4363-9b7d-85c64b19d56b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1658acc920>]}
[0m09:10:37.172935 [error] [Thread-1 (]: 6 of 6 ERROR creating sql table model main.sales_fact .......................... [[31mERROR[0m in 1.83s]
[0m09:10:37.180340 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.sales_fact
[0m09:10:37.190447 [debug] [Thread-4 (]: Marking all children of 'model.my_dbt_project.sales_fact' to be skipped because of status 'error'.  Reason: Runtime Error in model sales_fact (models/facts/sales_fact.sql)
  Parser Error: syntax error at or near ";".
[0m09:10:37.210985 [debug] [MainThread]: Using duckdb connection "master"
[0m09:10:37.218172 [debug] [MainThread]: On master: BEGIN
[0m09:10:37.221200 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:10:37.626573 [debug] [MainThread]: SQL status: OK in 0.405 seconds
[0m09:10:37.629665 [debug] [MainThread]: On master: COMMIT
[0m09:10:37.631710 [debug] [MainThread]: Using duckdb connection "master"
[0m09:10:37.633745 [debug] [MainThread]: On master: COMMIT
[0m09:10:37.637344 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m09:10:37.641064 [debug] [MainThread]: On master: Close
[0m09:10:37.650894 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:10:37.652817 [debug] [MainThread]: Connection 'list_sales_database_main' was properly closed.
[0m09:10:37.653944 [debug] [MainThread]: Connection 'model.my_dbt_project.sales_fact' was properly closed.
[0m09:10:37.670436 [info ] [MainThread]: 
[0m09:10:37.673810 [info ] [MainThread]: Finished running 2 table models, 4 view models in 0 hours 0 minutes and 10.60 seconds (10.60s).
[0m09:10:37.682896 [debug] [MainThread]: Command end result
[0m09:10:37.861423 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m09:10:37.881555 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m09:10:38.017542 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dags/dbt_models/target/run_results.json
[0m09:10:38.019697 [info ] [MainThread]: 
[0m09:10:38.023836 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m09:10:38.036426 [info ] [MainThread]: 
[0m09:10:38.050379 [error] [MainThread]:   Runtime Error in model sales_fact (models/facts/sales_fact.sql)
  Parser Error: syntax error at or near ";"
[0m09:10:38.065622 [info ] [MainThread]: 
[0m09:10:38.070112 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m09:10:38.093213 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 21.411207, "process_in_blocks": "525016", "process_kernel_time": 5.01471, "process_mem_max_rss": "135544", "process_out_blocks": "0", "process_user_time": 13.335932}
[0m09:10:38.133018 [debug] [MainThread]: Command `dbt run` failed at 09:10:38.132588 after 21.45 seconds
[0m09:10:38.135253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16608c9100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f165a550710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f165a5507d0>]}
[0m09:10:38.137917 [debug] [MainThread]: Flushing usage events
[0m09:10:43.021884 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:14:12.447723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8640b6f260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f863f5250a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f863ed84c50>]}


============================== 09:14:12.537521 | 3cfb92ce-fc14-44b7-92fe-f8a4743f568d ==============================
[0m09:14:12.537521 [info ] [MainThread]: Running with dbt=1.9.1
[0m09:14:12.562885 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dags/dbt_models/logs', 'profiles_dir': '/opt/airflow/dbt/profiles.yml', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt/profiles.yml --target dev', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:14:19.553761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3cfb92ce-fc14-44b7-92fe-f8a4743f568d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f863e7e7fb0>]}
[0m09:14:21.087239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3cfb92ce-fc14-44b7-92fe-f8a4743f568d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f863f229280>]}
[0m09:14:22.513274 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m09:14:25.868099 [debug] [MainThread]: checksum: cac3b9519010e47bfbeb71ca6efb4867dae2858687671594dc23fefc94ecf25d, vars: {}, profile: , target: dev, version: 1.9.1
[0m09:14:28.754930 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:14:28.769472 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/facts/sales_fact.sql
[0m09:14:31.105960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3cfb92ce-fc14-44b7-92fe-f8a4743f568d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f861bf7bd70>]}
[0m09:14:31.721755 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m09:14:31.744029 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m09:14:31.977448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3cfb92ce-fc14-44b7-92fe-f8a4743f568d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f861bf51040>]}
[0m09:14:31.990772 [info ] [MainThread]: Found 6 models, 1 source, 424 macros
[0m09:14:31.997593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3cfb92ce-fc14-44b7-92fe-f8a4743f568d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f861bf4eba0>]}
[0m09:14:32.046918 [info ] [MainThread]: 
[0m09:14:32.061101 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:14:32.090488 [info ] [MainThread]: 
[0m09:14:32.116177 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m09:14:32.182708 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_sales_database'
[0m09:14:32.559332 [debug] [ThreadPool]: Using duckdb connection "list_sales_database"
[0m09:14:32.563650 [debug] [ThreadPool]: On list_sales_database: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "list_sales_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"sales_database"'
    
  
  
[0m09:14:32.570211 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:14:32.862995 [debug] [ThreadPool]: SQL status: OK in 0.293 seconds
[0m09:14:32.874233 [debug] [ThreadPool]: On list_sales_database: Close
[0m09:14:32.884109 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_database, now create_sales_database_main)
[0m09:14:32.893616 [debug] [ThreadPool]: Creating schema "database: "sales_database"
schema: "main"
"
[0m09:14:32.930457 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m09:14:32.932094 [debug] [ThreadPool]: On create_sales_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "create_sales_database_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='sales_database'
        and type='sqlite'
    
  
[0m09:14:32.933778 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:14:32.987013 [debug] [ThreadPool]: SQL status: OK in 0.053 seconds
[0m09:14:32.993380 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m09:14:32.995646 [debug] [ThreadPool]: On create_sales_database_main: BEGIN
[0m09:14:32.998651 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:14:33.000734 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m09:14:33.004093 [debug] [ThreadPool]: On create_sales_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "create_sales_database_main"} */

    
    
        create schema if not exists "sales_database"."main"
    
[0m09:14:33.013696 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m09:14:33.017620 [debug] [ThreadPool]: On create_sales_database_main: COMMIT
[0m09:14:33.021686 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m09:14:33.027802 [debug] [ThreadPool]: On create_sales_database_main: COMMIT
[0m09:14:33.030800 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:14:33.032577 [debug] [ThreadPool]: On create_sales_database_main: Close
[0m09:14:33.043099 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_sales_database_main, now list_sales_database_main)
[0m09:14:33.066111 [debug] [ThreadPool]: Using duckdb connection "list_sales_database_main"
[0m09:14:33.067955 [debug] [ThreadPool]: On list_sales_database_main: BEGIN
[0m09:14:33.070907 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:14:33.140149 [debug] [ThreadPool]: SQL status: OK in 0.069 seconds
[0m09:14:33.156479 [debug] [ThreadPool]: Using duckdb connection "list_sales_database_main"
[0m09:14:33.162265 [debug] [ThreadPool]: On list_sales_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "list_sales_database_main"} */
select
      'sales_database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'sales_database'
  
[0m09:14:33.467810 [debug] [ThreadPool]: SQL status: OK in 0.302 seconds
[0m09:14:33.477583 [debug] [ThreadPool]: On list_sales_database_main: ROLLBACK
[0m09:14:33.493085 [debug] [ThreadPool]: Failed to rollback 'list_sales_database_main'
[0m09:14:33.495536 [debug] [ThreadPool]: On list_sales_database_main: Close
[0m09:14:33.539121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3cfb92ce-fc14-44b7-92fe-f8a4743f568d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f863efdd010>]}
[0m09:14:33.545705 [debug] [MainThread]: Using duckdb connection "master"
[0m09:14:33.547706 [debug] [MainThread]: On master: BEGIN
[0m09:14:33.550347 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:14:33.627174 [debug] [MainThread]: SQL status: OK in 0.077 seconds
[0m09:14:33.629059 [debug] [MainThread]: On master: COMMIT
[0m09:14:33.631794 [debug] [MainThread]: Using duckdb connection "master"
[0m09:14:33.634741 [debug] [MainThread]: On master: COMMIT
[0m09:14:33.639760 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m09:14:33.642228 [debug] [MainThread]: On master: Close
[0m09:14:33.661752 [debug] [Thread-1 (]: Began running node model.my_dbt_project.customer_dimension
[0m09:14:33.664454 [info ] [Thread-1 (]: 1 of 6 START sql view model main.customer_dimension ............................ [RUN]
[0m09:14:33.669209 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.my_dbt_project.customer_dimension'
[0m09:14:33.671922 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.customer_dimension
[0m09:14:33.717698 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.customer_dimension"
[0m09:14:33.738568 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.customer_dimension
[0m09:14:34.000833 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.customer_dimension"
[0m09:14:34.028283 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m09:14:34.030577 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: BEGIN
[0m09:14:34.032861 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m09:14:34.120516 [debug] [Thread-1 (]: SQL status: OK in 0.088 seconds
[0m09:14:34.123789 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m09:14:34.132133 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */

  
  create view "sales_database"."main"."customer_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
    DISTINCT
    customer AS customer_id,
    customer_name,
    customer_address,
    customer_group,
    territory,
    language AS customer_language
FROM sales
WHERE customer IS NOT NULL
  );

[0m09:14:34.141122 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m09:14:34.192640 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m09:14:34.195134 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */
alter view "sales_database"."main"."customer_dimension" rename to "customer_dimension__dbt_backup"
[0m09:14:34.198942 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:14:34.220937 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m09:14:34.230351 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */
alter view "sales_database"."main"."customer_dimension__dbt_tmp" rename to "customer_dimension"
[0m09:14:34.233461 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:14:34.352457 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: COMMIT
[0m09:14:34.367687 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m09:14:34.372686 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: COMMIT
[0m09:14:34.400373 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m09:14:34.441538 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m09:14:34.444081 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */
drop view if exists "sales_database"."main"."customer_dimension__dbt_backup" cascade
[0m09:14:34.450367 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m09:14:34.472699 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: Close
[0m09:14:34.572263 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3cfb92ce-fc14-44b7-92fe-f8a4743f568d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8640ad8b00>]}
[0m09:14:34.576076 [info ] [Thread-1 (]: 1 of 6 OK created sql view model main.customer_dimension ....................... [[32mOK[0m in 0.89s]
[0m09:14:34.585030 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.customer_dimension
[0m09:14:34.587837 [debug] [Thread-1 (]: Began running node model.my_dbt_project.date_dimension
[0m09:14:34.590614 [info ] [Thread-1 (]: 2 of 6 START sql view model main.date_dimension ................................ [RUN]
[0m09:14:34.593180 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customer_dimension, now model.my_dbt_project.date_dimension)
[0m09:14:34.601119 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.date_dimension
[0m09:14:34.620161 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.date_dimension"
[0m09:14:34.666509 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.date_dimension
[0m09:14:34.707631 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.date_dimension"
[0m09:14:34.782629 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m09:14:34.785342 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: BEGIN
[0m09:14:34.789524 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:14:35.074684 [debug] [Thread-1 (]: SQL status: OK in 0.285 seconds
[0m09:14:35.079112 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m09:14:35.096519 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.date_dimension"} */

  
  create view "sales_database"."main"."date_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
    transaction_date,
    strftime(transaction_date, '%A') AS weekday_name,  -- Extract weekday name
    strftime(transaction_date, '%m') AS month,          -- Extract month (numeric)
    strftime(transaction_date, '%Y') AS year,           -- Extract year
    strftime(transaction_date, '%d') AS day,            -- Extract day
    EXTRACT(QUARTER FROM transaction_date) AS quarter   -- Extract quarter
FROM sales
WHERE transaction_date IS NOT NULL
  );

[0m09:14:35.118524 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m09:14:35.173850 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m09:14:35.181792 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.date_dimension"} */
alter view "sales_database"."main"."date_dimension" rename to "date_dimension__dbt_backup"
[0m09:14:35.199185 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m09:14:35.250761 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m09:14:35.264979 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.date_dimension"} */
alter view "sales_database"."main"."date_dimension__dbt_tmp" rename to "date_dimension"
[0m09:14:35.278982 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:14:35.296901 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: COMMIT
[0m09:14:35.299223 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m09:14:35.301954 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: COMMIT
[0m09:14:35.356292 [debug] [Thread-1 (]: SQL status: OK in 0.051 seconds
[0m09:14:35.417735 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m09:14:35.440966 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.date_dimension"} */
drop view if exists "sales_database"."main"."date_dimension__dbt_backup" cascade
[0m09:14:35.570283 [debug] [Thread-1 (]: SQL status: OK in 0.126 seconds
[0m09:14:35.587870 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: Close
[0m09:14:35.961316 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3cfb92ce-fc14-44b7-92fe-f8a4743f568d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86185af440>]}
[0m09:14:35.969821 [info ] [Thread-1 (]: 2 of 6 OK created sql view model main.date_dimension ........................... [[32mOK[0m in 1.37s]
[0m09:14:35.978985 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.date_dimension
[0m09:14:35.981401 [debug] [Thread-1 (]: Began running node model.my_dbt_project.product_dimension
[0m09:14:35.994274 [info ] [Thread-1 (]: 3 of 6 START sql view model main.product_dimension ............................. [RUN]
[0m09:14:36.001210 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.date_dimension, now model.my_dbt_project.product_dimension)
[0m09:14:36.017281 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.product_dimension
[0m09:14:36.039249 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.product_dimension"
[0m09:14:36.080136 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.product_dimension
[0m09:14:36.116842 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.product_dimension"
[0m09:14:36.150514 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m09:14:36.153026 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: BEGIN
[0m09:14:36.160156 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:14:36.248970 [debug] [Thread-1 (]: SQL status: OK in 0.089 seconds
[0m09:14:36.251144 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m09:14:36.255311 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.product_dimension"} */

  
  create view "sales_database"."main"."product_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * 
    FROM "sales_database"."main"."sales"
)

SELECT 
    sales.name,
    json_extract(items, '$[0].name') AS product_name,  -- Example to extract the first element's "name" field from JSON array
    json_extract(items, '$[0].item_code') AS product_item_code
FROM sales
WHERE json_extract(items, '$[0].name') IS NOT NULL  -- Filter to only keep rows with a non-null product name
  );

[0m09:14:36.270800 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m09:14:36.295001 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m09:14:36.307409 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.product_dimension"} */
alter view "sales_database"."main"."product_dimension" rename to "product_dimension__dbt_backup"
[0m09:14:36.310512 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:14:36.344128 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m09:14:36.348620 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.product_dimension"} */
alter view "sales_database"."main"."product_dimension__dbt_tmp" rename to "product_dimension"
[0m09:14:36.360095 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:14:36.378682 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: COMMIT
[0m09:14:36.382004 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m09:14:36.384706 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: COMMIT
[0m09:14:36.495069 [debug] [Thread-1 (]: SQL status: OK in 0.098 seconds
[0m09:14:36.527350 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m09:14:36.529636 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.product_dimension"} */
drop view if exists "sales_database"."main"."product_dimension__dbt_backup" cascade
[0m09:14:36.551892 [debug] [Thread-1 (]: SQL status: OK in 0.020 seconds
[0m09:14:36.559749 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: Close
[0m09:14:37.172896 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3cfb92ce-fc14-44b7-92fe-f8a4743f568d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f861b318500>]}
[0m09:14:37.181220 [info ] [Thread-1 (]: 3 of 6 OK created sql view model main.product_dimension ........................ [[32mOK[0m in 1.17s]
[0m09:14:37.191750 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.product_dimension
[0m09:14:37.194577 [debug] [Thread-1 (]: Began running node model.my_dbt_project.sales_team_dimension
[0m09:14:37.204383 [info ] [Thread-1 (]: 4 of 6 START sql view model main.sales_team_dimension .......................... [RUN]
[0m09:14:37.207960 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.product_dimension, now model.my_dbt_project.sales_team_dimension)
[0m09:14:37.220087 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.sales_team_dimension
[0m09:14:37.240540 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.sales_team_dimension"
[0m09:14:37.300370 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.sales_team_dimension
[0m09:14:37.348016 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.sales_team_dimension"
[0m09:14:37.377669 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m09:14:37.379993 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: BEGIN
[0m09:14:37.382590 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:14:37.480851 [debug] [Thread-1 (]: SQL status: OK in 0.098 seconds
[0m09:14:37.494474 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m09:14:37.504237 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */

  
  create view "sales_database"."main"."sales_team_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
    DISTINCT
    sales_team->>'name' AS sales_team_id,
    sales_team->>'region' AS sales_team_region
FROM sales
WHERE sales_team IS NOT NULL
  );

[0m09:14:37.510638 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m09:14:37.569434 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m09:14:37.585321 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */
alter view "sales_database"."main"."sales_team_dimension" rename to "sales_team_dimension__dbt_backup"
[0m09:14:37.589667 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:14:37.642424 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m09:14:37.657453 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */
alter view "sales_database"."main"."sales_team_dimension__dbt_tmp" rename to "sales_team_dimension"
[0m09:14:37.671224 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:14:37.690436 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: COMMIT
[0m09:14:37.703455 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m09:14:37.706161 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: COMMIT
[0m09:14:37.738991 [debug] [Thread-1 (]: SQL status: OK in 0.027 seconds
[0m09:14:37.759335 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m09:14:37.761635 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */
drop view if exists "sales_database"."main"."sales_team_dimension__dbt_backup" cascade
[0m09:14:37.777355 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m09:14:37.782592 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: Close
[0m09:14:38.235015 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3cfb92ce-fc14-44b7-92fe-f8a4743f568d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86185d37d0>]}
[0m09:14:38.267504 [info ] [Thread-1 (]: 4 of 6 OK created sql view model main.sales_team_dimension ..................... [[32mOK[0m in 1.03s]
[0m09:14:38.286323 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.sales_team_dimension
[0m09:14:38.299338 [debug] [Thread-1 (]: Began running node model.my_dbt_project.transform_sales
[0m09:14:38.305579 [info ] [Thread-1 (]: 5 of 6 START sql table model main.transform_sales .............................. [RUN]
[0m09:14:38.321887 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.sales_team_dimension, now model.my_dbt_project.transform_sales)
[0m09:14:38.337904 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.transform_sales
[0m09:14:38.374198 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.transform_sales"
[0m09:14:38.683247 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.transform_sales
[0m09:14:38.956293 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.transform_sales"
[0m09:14:39.151512 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m09:14:39.156443 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: BEGIN
[0m09:14:39.158526 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:14:39.261082 [debug] [Thread-1 (]: SQL status: OK in 0.102 seconds
[0m09:14:39.267321 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m09:14:39.271385 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */

  
    
    

    create  table
      "sales_database"."main"."transform_sales__dbt_tmp"
  
    as (
      -- /opt/airflow/dags/dbt_models/transform_users.sql


WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
   *
FROM sales
WHERE name = 'ABC private LTD-0002'
    );
  
  
[0m09:14:39.322360 [debug] [Thread-1 (]: SQL status: OK in 0.048 seconds
[0m09:14:39.342634 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m09:14:39.355034 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */
alter table "sales_database"."main"."transform_sales" rename to "transform_sales__dbt_backup"
[0m09:14:39.358432 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:14:39.378098 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m09:14:39.390758 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */
alter table "sales_database"."main"."transform_sales__dbt_tmp" rename to "transform_sales"
[0m09:14:39.397127 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m09:14:39.435421 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: COMMIT
[0m09:14:39.438743 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m09:14:39.441410 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: COMMIT
[0m09:14:39.473996 [debug] [Thread-1 (]: SQL status: OK in 0.027 seconds
[0m09:14:39.494029 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m09:14:39.496184 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */
drop table if exists "sales_database"."main"."transform_sales__dbt_backup" cascade
[0m09:14:39.513589 [debug] [Thread-1 (]: SQL status: OK in 0.015 seconds
[0m09:14:39.526807 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: Close
[0m09:14:39.729112 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3cfb92ce-fc14-44b7-92fe-f8a4743f568d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86185b2690>]}
[0m09:14:39.743291 [info ] [Thread-1 (]: 5 of 6 OK created sql table model main.transform_sales ......................... [[32mOK[0m in 1.41s]
[0m09:14:39.746726 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.transform_sales
[0m09:14:39.759389 [debug] [Thread-1 (]: Began running node model.my_dbt_project.sales_fact
[0m09:14:39.762091 [info ] [Thread-1 (]: 6 of 6 START sql table model main.sales_fact ................................... [RUN]
[0m09:14:39.775619 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.transform_sales, now model.my_dbt_project.sales_fact)
[0m09:14:39.779295 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.sales_fact
[0m09:14:39.801935 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.sales_fact"
[0m09:14:39.855714 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.sales_fact
[0m09:14:39.877853 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.sales_fact"
[0m09:14:39.911125 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_fact"
[0m09:14:39.928097 [debug] [Thread-1 (]: On model.my_dbt_project.sales_fact: BEGIN
[0m09:14:39.937754 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:14:40.119520 [debug] [Thread-1 (]: SQL status: OK in 0.185 seconds
[0m09:14:40.123227 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_fact"
[0m09:14:40.126107 [debug] [Thread-1 (]: On model.my_dbt_project.sales_fact: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_fact"} */

  
    
    

    create  table
      "sales_database"."main"."sales_fact__dbt_tmp"
  
    as (
      WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
),
customer AS (
    SELECT * FROM "sales_database"."main"."customer_dimension"
),
product AS (
    SELECT * FROM "sales_database"."main"."product_dimension"
),
sales_team AS (
    SELECT * FROM "sales_database"."main"."sales_team_dimension"
),
date AS (
    SELECT * FROM "sales_database"."main"."date_dimension"
)

SELECT
    sales.name AS sales_id,
    customer.customer_id,
    product.product_id,
    sales_team.sales_team_id,
    date.date_id,
    sales.total_qty,
    sales.total_net_weight,
    sales.total,
    sales.net_total,
    sales.grand_total,
    sales.tax_category
FROM sales
JOIN customer ON sales.customer = customer.customer_id
-- Handling product as a lateral join (Check if the structure of sales.items matches this logic)
JOIN LATERAL (
    SELECT product_id
    FROM jsonb_array_elements(sales.items) AS product(item)
    WHERE item->>'product_id' = product.product_id
) AS product ON TRUE
-- Handling sales_team as a lateral join (Check if sales_team JSON structure matches this logic)
JOIN LATERAL (
    SELECT sales_team_id
    FROM jsonb_array_elements(sales.sales_team) AS team(item)
    WHERE item->>'sales_team_id' = sales_team.sales_team_id
) AS sales_team ON TRUE
JOIN date ON sales.transaction_date = date.date_id
;
    );
  
  
[0m09:14:40.149705 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_fact"} */

  
    
    

    create  table
      "sales_database"."main"."sales_fact__dbt_tmp"
  
    as (
      WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
),
customer AS (
    SELECT * FROM "sales_database"."main"."customer_dimension"
),
product AS (
    SELECT * FROM "sales_database"."main"."product_dimension"
),
sales_team AS (
    SELECT * FROM "sales_database"."main"."sales_team_dimension"
),
date AS (
    SELECT * FROM "sales_database"."main"."date_dimension"
)

SELECT
    sales.name AS sales_id,
    customer.customer_id,
    product.product_id,
    sales_team.sales_team_id,
    date.date_id,
    sales.total_qty,
    sales.total_net_weight,
    sales.total,
    sales.net_total,
    sales.grand_total,
    sales.tax_category
FROM sales
JOIN customer ON sales.customer = customer.customer_id
-- Handling product as a lateral join (Check if the structure of sales.items matches this logic)
JOIN LATERAL (
    SELECT product_id
    FROM jsonb_array_elements(sales.items) AS product(item)
    WHERE item->>'product_id' = product.product_id
) AS product ON TRUE
-- Handling sales_team as a lateral join (Check if sales_team JSON structure matches this logic)
JOIN LATERAL (
    SELECT sales_team_id
    FROM jsonb_array_elements(sales.sales_team) AS team(item)
    WHERE item->>'sales_team_id' = sales_team.sales_team_id
) AS sales_team ON TRUE
JOIN date ON sales.transaction_date = date.date_id
;
    );
  
  
[0m09:14:40.152517 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m09:14:40.158771 [debug] [Thread-1 (]: On model.my_dbt_project.sales_fact: ROLLBACK
[0m09:14:40.204339 [debug] [Thread-1 (]: Failed to rollback 'model.my_dbt_project.sales_fact'
[0m09:14:40.216111 [debug] [Thread-1 (]: On model.my_dbt_project.sales_fact: Close
[0m09:14:40.243751 [debug] [Thread-1 (]: Runtime Error in model sales_fact (models/facts/sales_fact.sql)
  Parser Error: syntax error at or near ";"
[0m09:14:40.329150 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3cfb92ce-fc14-44b7-92fe-f8a4743f568d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f861b3ed4c0>]}
[0m09:14:40.376782 [error] [Thread-1 (]: 6 of 6 ERROR creating sql table model main.sales_fact .......................... [[31mERROR[0m in 0.55s]
[0m09:14:40.384424 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.sales_fact
[0m09:14:40.387995 [debug] [Thread-4 (]: Marking all children of 'model.my_dbt_project.sales_fact' to be skipped because of status 'error'.  Reason: Runtime Error in model sales_fact (models/facts/sales_fact.sql)
  Parser Error: syntax error at or near ";".
[0m09:14:40.411235 [debug] [MainThread]: Using duckdb connection "master"
[0m09:14:40.418080 [debug] [MainThread]: On master: BEGIN
[0m09:14:40.420276 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:14:40.515193 [debug] [MainThread]: SQL status: OK in 0.095 seconds
[0m09:14:40.517080 [debug] [MainThread]: On master: COMMIT
[0m09:14:40.519135 [debug] [MainThread]: Using duckdb connection "master"
[0m09:14:40.521215 [debug] [MainThread]: On master: COMMIT
[0m09:14:40.523938 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m09:14:40.526672 [debug] [MainThread]: On master: Close
[0m09:14:40.538647 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:14:40.540654 [debug] [MainThread]: Connection 'list_sales_database_main' was properly closed.
[0m09:14:40.545280 [debug] [MainThread]: Connection 'model.my_dbt_project.sales_fact' was properly closed.
[0m09:14:40.553417 [info ] [MainThread]: 
[0m09:14:40.555761 [info ] [MainThread]: Finished running 2 table models, 4 view models in 0 hours 0 minutes and 8.44 seconds (8.44s).
[0m09:14:40.561935 [debug] [MainThread]: Command end result
[0m09:14:40.849142 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m09:14:40.873741 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m09:14:40.922543 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dags/dbt_models/target/run_results.json
[0m09:14:40.924831 [info ] [MainThread]: 
[0m09:14:40.927090 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m09:14:40.929218 [info ] [MainThread]: 
[0m09:14:40.932100 [error] [MainThread]:   Runtime Error in model sales_fact (models/facts/sales_fact.sql)
  Parser Error: syntax error at or near ";"
[0m09:14:40.934180 [info ] [MainThread]: 
[0m09:14:40.941662 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m09:14:40.965301 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 29.08582, "process_in_blocks": "2281104", "process_kernel_time": 8.504536, "process_mem_max_rss": "148232", "process_out_blocks": "0", "process_user_time": 18.497877}
[0m09:14:40.967845 [debug] [MainThread]: Command `dbt run` failed at 09:14:40.967465 after 29.09 seconds
[0m09:14:40.970023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f863ec730b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f863f7032f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f863f703440>]}
[0m09:14:40.972486 [debug] [MainThread]: Flushing usage events
[0m09:14:42.728618 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:18:41.486688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f969d0e7c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f969c3c7d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f969dd08350>]}


============================== 09:18:41.513564 | c5e89230-65be-4928-acf0-edb90379cd26 ==============================
[0m09:18:41.513564 [info ] [MainThread]: Running with dbt=1.9.1
[0m09:18:41.516786 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dags/dbt_models/logs', 'profiles_dir': '/opt/airflow/dbt/profiles.yml', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt/profiles.yml --target dev', 'send_anonymous_usage_stats': 'True'}
[0m09:18:43.161855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c5e89230-65be-4928-acf0-edb90379cd26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f969c807d70>]}
[0m09:18:43.413717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c5e89230-65be-4928-acf0-edb90379cd26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f969b9dfe60>]}
[0m09:18:43.433297 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m09:18:44.309351 [debug] [MainThread]: checksum: cac3b9519010e47bfbeb71ca6efb4867dae2858687671594dc23fefc94ecf25d, vars: {}, profile: , target: dev, version: 1.9.1
[0m09:18:45.858159 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:18:45.879548 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/facts/sales_fact.sql
[0m09:18:48.304884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c5e89230-65be-4928-acf0-edb90379cd26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9695c79ca0>]}
[0m09:18:48.770255 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m09:18:48.806763 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m09:18:49.169039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c5e89230-65be-4928-acf0-edb90379cd26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9695e9bc80>]}
[0m09:18:49.173559 [info ] [MainThread]: Found 6 models, 1 source, 424 macros
[0m09:18:49.185891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c5e89230-65be-4928-acf0-edb90379cd26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f969533f6e0>]}
[0m09:18:49.206826 [info ] [MainThread]: 
[0m09:18:49.219609 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:18:49.223852 [info ] [MainThread]: 
[0m09:18:49.236414 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m09:18:49.313066 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_sales_database'
[0m09:18:49.789551 [debug] [ThreadPool]: Using duckdb connection "list_sales_database"
[0m09:18:49.792229 [debug] [ThreadPool]: On list_sales_database: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "list_sales_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"sales_database"'
    
  
  
[0m09:18:49.804437 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:18:50.086715 [debug] [ThreadPool]: SQL status: OK in 0.282 seconds
[0m09:18:50.094642 [debug] [ThreadPool]: On list_sales_database: Close
[0m09:18:50.118826 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_database, now create_sales_database_main)
[0m09:18:50.144481 [debug] [ThreadPool]: Creating schema "database: "sales_database"
schema: "main"
"
[0m09:18:50.223006 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m09:18:50.225713 [debug] [ThreadPool]: On create_sales_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "create_sales_database_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='sales_database'
        and type='sqlite'
    
  
[0m09:18:50.235234 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:18:50.323541 [debug] [ThreadPool]: SQL status: OK in 0.089 seconds
[0m09:18:50.331250 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m09:18:50.333952 [debug] [ThreadPool]: On create_sales_database_main: BEGIN
[0m09:18:50.336887 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:18:50.351619 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m09:18:50.355143 [debug] [ThreadPool]: On create_sales_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "create_sales_database_main"} */

    
    
        create schema if not exists "sales_database"."main"
    
[0m09:18:50.359158 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m09:18:50.366888 [debug] [ThreadPool]: On create_sales_database_main: COMMIT
[0m09:18:50.371571 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m09:18:50.374452 [debug] [ThreadPool]: On create_sales_database_main: COMMIT
[0m09:18:50.381061 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:18:50.383905 [debug] [ThreadPool]: On create_sales_database_main: Close
[0m09:18:50.400384 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_sales_database_main, now list_sales_database_main)
[0m09:18:50.463352 [debug] [ThreadPool]: Using duckdb connection "list_sales_database_main"
[0m09:18:50.466357 [debug] [ThreadPool]: On list_sales_database_main: BEGIN
[0m09:18:50.475810 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:18:50.580114 [debug] [ThreadPool]: SQL status: OK in 0.104 seconds
[0m09:18:50.583428 [debug] [ThreadPool]: Using duckdb connection "list_sales_database_main"
[0m09:18:50.585789 [debug] [ThreadPool]: On list_sales_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "list_sales_database_main"} */
select
      'sales_database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'sales_database'
  
[0m09:18:50.808527 [debug] [ThreadPool]: SQL status: OK in 0.219 seconds
[0m09:18:50.814555 [debug] [ThreadPool]: On list_sales_database_main: ROLLBACK
[0m09:18:50.834946 [debug] [ThreadPool]: Failed to rollback 'list_sales_database_main'
[0m09:18:50.838289 [debug] [ThreadPool]: On list_sales_database_main: Close
[0m09:18:50.869657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c5e89230-65be-4928-acf0-edb90379cd26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9695367a10>]}
[0m09:18:50.889976 [debug] [MainThread]: Using duckdb connection "master"
[0m09:18:50.891732 [debug] [MainThread]: On master: BEGIN
[0m09:18:50.894021 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:18:50.991273 [debug] [MainThread]: SQL status: OK in 0.097 seconds
[0m09:18:50.995282 [debug] [MainThread]: On master: COMMIT
[0m09:18:51.001779 [debug] [MainThread]: Using duckdb connection "master"
[0m09:18:51.005943 [debug] [MainThread]: On master: COMMIT
[0m09:18:51.008470 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m09:18:51.017180 [debug] [MainThread]: On master: Close
[0m09:18:51.036187 [debug] [Thread-1 (]: Began running node model.my_dbt_project.customer_dimension
[0m09:18:51.038711 [info ] [Thread-1 (]: 1 of 6 START sql view model main.customer_dimension ............................ [RUN]
[0m09:18:51.041928 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.my_dbt_project.customer_dimension'
[0m09:18:51.044989 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.customer_dimension
[0m09:18:51.091294 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.customer_dimension"
[0m09:18:51.135384 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.customer_dimension
[0m09:18:51.271047 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.customer_dimension"
[0m09:18:51.289983 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m09:18:51.291884 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: BEGIN
[0m09:18:51.293912 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m09:18:51.345527 [debug] [Thread-1 (]: SQL status: OK in 0.051 seconds
[0m09:18:51.349792 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m09:18:51.353523 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */

  
  create view "sales_database"."main"."customer_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
    DISTINCT
    customer AS customer_id,
    customer_name,
    customer_address,
    customer_group,
    territory,
    language AS customer_language
FROM sales
WHERE customer IS NOT NULL
  );

[0m09:18:51.358165 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m09:18:51.405602 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m09:18:51.408445 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */
alter view "sales_database"."main"."customer_dimension" rename to "customer_dimension__dbt_backup"
[0m09:18:51.412333 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:18:51.427667 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m09:18:51.429973 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */
alter view "sales_database"."main"."customer_dimension__dbt_tmp" rename to "customer_dimension"
[0m09:18:51.433375 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:18:51.493744 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: COMMIT
[0m09:18:51.496200 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m09:18:51.498189 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: COMMIT
[0m09:18:51.509091 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m09:18:51.523432 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m09:18:51.525334 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */
drop view if exists "sales_database"."main"."customer_dimension__dbt_backup" cascade
[0m09:18:51.531147 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m09:18:51.538249 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: Close
[0m09:18:51.601169 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5e89230-65be-4928-acf0-edb90379cd26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96963fbfe0>]}
[0m09:18:51.604523 [info ] [Thread-1 (]: 1 of 6 OK created sql view model main.customer_dimension ....................... [[32mOK[0m in 0.55s]
[0m09:18:51.607528 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.customer_dimension
[0m09:18:51.609361 [debug] [Thread-1 (]: Began running node model.my_dbt_project.date_dimension
[0m09:18:51.611583 [info ] [Thread-1 (]: 2 of 6 START sql view model main.date_dimension ................................ [RUN]
[0m09:18:51.614026 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customer_dimension, now model.my_dbt_project.date_dimension)
[0m09:18:51.616144 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.date_dimension
[0m09:18:51.624950 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.date_dimension"
[0m09:18:51.641820 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.date_dimension
[0m09:18:51.661089 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.date_dimension"
[0m09:18:51.680011 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m09:18:51.681844 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: BEGIN
[0m09:18:51.683743 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:18:51.725743 [debug] [Thread-1 (]: SQL status: OK in 0.042 seconds
[0m09:18:51.727661 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m09:18:51.729877 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.date_dimension"} */

  
  create view "sales_database"."main"."date_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
    transaction_date,
    strftime(transaction_date, '%A') AS weekday_name,  -- Extract weekday name
    strftime(transaction_date, '%m') AS month,          -- Extract month (numeric)
    strftime(transaction_date, '%Y') AS year,           -- Extract year
    strftime(transaction_date, '%d') AS day,            -- Extract day
    EXTRACT(QUARTER FROM transaction_date) AS quarter   -- Extract quarter
FROM sales
WHERE transaction_date IS NOT NULL
  );

[0m09:18:51.739879 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m09:18:51.751727 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m09:18:51.753862 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.date_dimension"} */
alter view "sales_database"."main"."date_dimension" rename to "date_dimension__dbt_backup"
[0m09:18:51.758450 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:18:51.770485 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m09:18:51.772472 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.date_dimension"} */
alter view "sales_database"."main"."date_dimension__dbt_tmp" rename to "date_dimension"
[0m09:18:51.775446 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:18:51.781476 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: COMMIT
[0m09:18:51.783919 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m09:18:51.785556 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: COMMIT
[0m09:18:51.801521 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m09:18:51.811211 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m09:18:51.814714 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.date_dimension"} */
drop view if exists "sales_database"."main"."date_dimension__dbt_backup" cascade
[0m09:18:51.821480 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m09:18:51.825607 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: Close
[0m09:18:51.885485 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5e89230-65be-4928-acf0-edb90379cd26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9694193e90>]}
[0m09:18:51.888416 [info ] [Thread-1 (]: 2 of 6 OK created sql view model main.date_dimension ........................... [[32mOK[0m in 0.27s]
[0m09:18:51.891215 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.date_dimension
[0m09:18:51.893089 [debug] [Thread-1 (]: Began running node model.my_dbt_project.product_dimension
[0m09:18:51.895089 [info ] [Thread-1 (]: 3 of 6 START sql view model main.product_dimension ............................. [RUN]
[0m09:18:51.897046 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.date_dimension, now model.my_dbt_project.product_dimension)
[0m09:18:51.898846 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.product_dimension
[0m09:18:51.909123 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.product_dimension"
[0m09:18:51.929480 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.product_dimension
[0m09:18:51.944114 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.product_dimension"
[0m09:18:51.966558 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m09:18:51.968263 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: BEGIN
[0m09:18:51.970159 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:18:52.045793 [debug] [Thread-1 (]: SQL status: OK in 0.076 seconds
[0m09:18:52.047847 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m09:18:52.050325 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.product_dimension"} */

  
  create view "sales_database"."main"."product_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * 
    FROM "sales_database"."main"."sales"
)

SELECT 
    sales.name,
    json_extract(items, '$[0].name') AS product_name,  -- Example to extract the first element's "name" field from JSON array
    json_extract(items, '$[0].item_code') AS product_item_code
FROM sales
WHERE json_extract(items, '$[0].name') IS NOT NULL  -- Filter to only keep rows with a non-null product name
  );

[0m09:18:52.054783 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m09:18:52.065572 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m09:18:52.067472 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.product_dimension"} */
alter view "sales_database"."main"."product_dimension" rename to "product_dimension__dbt_backup"
[0m09:18:52.070524 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:18:52.079876 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m09:18:52.082418 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.product_dimension"} */
alter view "sales_database"."main"."product_dimension__dbt_tmp" rename to "product_dimension"
[0m09:18:52.085115 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:18:52.089894 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: COMMIT
[0m09:18:52.091384 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m09:18:52.093080 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: COMMIT
[0m09:18:52.105880 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m09:18:52.114729 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m09:18:52.116837 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.product_dimension"} */
drop view if exists "sales_database"."main"."product_dimension__dbt_backup" cascade
[0m09:18:52.122306 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m09:18:52.127257 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: Close
[0m09:18:52.216940 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5e89230-65be-4928-acf0-edb90379cd26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96947c7b00>]}
[0m09:18:52.220149 [info ] [Thread-1 (]: 3 of 6 OK created sql view model main.product_dimension ........................ [[32mOK[0m in 0.32s]
[0m09:18:52.224862 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.product_dimension
[0m09:18:52.235362 [debug] [Thread-1 (]: Began running node model.my_dbt_project.sales_team_dimension
[0m09:18:52.238635 [info ] [Thread-1 (]: 4 of 6 START sql view model main.sales_team_dimension .......................... [RUN]
[0m09:18:52.242025 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.product_dimension, now model.my_dbt_project.sales_team_dimension)
[0m09:18:52.263263 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.sales_team_dimension
[0m09:18:52.274756 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.sales_team_dimension"
[0m09:18:52.326626 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.sales_team_dimension
[0m09:18:52.357792 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.sales_team_dimension"
[0m09:18:52.377040 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m09:18:52.379799 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: BEGIN
[0m09:18:52.392878 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:18:52.479587 [debug] [Thread-1 (]: SQL status: OK in 0.097 seconds
[0m09:18:52.482058 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m09:18:52.495283 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */

  
  create view "sales_database"."main"."sales_team_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
    DISTINCT
    sales_team->>'name' AS sales_team_id,
    sales_team->>'region' AS sales_team_region
FROM sales
WHERE sales_team IS NOT NULL
  );

[0m09:18:52.511273 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m09:18:52.548560 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m09:18:52.551795 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */
alter view "sales_database"."main"."sales_team_dimension" rename to "sales_team_dimension__dbt_backup"
[0m09:18:52.563997 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m09:18:52.608740 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m09:18:52.611495 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */
alter view "sales_database"."main"."sales_team_dimension__dbt_tmp" rename to "sales_team_dimension"
[0m09:18:52.624393 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m09:18:52.633272 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: COMMIT
[0m09:18:52.645221 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m09:18:52.648932 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: COMMIT
[0m09:18:52.748730 [debug] [Thread-1 (]: SQL status: OK in 0.090 seconds
[0m09:18:52.771352 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m09:18:52.780250 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */
drop view if exists "sales_database"."main"."sales_team_dimension__dbt_backup" cascade
[0m09:18:52.799395 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m09:18:52.804777 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: Close
[0m09:18:52.958429 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5e89230-65be-4928-acf0-edb90379cd26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96941c00b0>]}
[0m09:18:52.971317 [info ] [Thread-1 (]: 4 of 6 OK created sql view model main.sales_team_dimension ..................... [[32mOK[0m in 0.72s]
[0m09:18:52.974598 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.sales_team_dimension
[0m09:18:52.986648 [debug] [Thread-1 (]: Began running node model.my_dbt_project.transform_sales
[0m09:18:52.990615 [info ] [Thread-1 (]: 5 of 6 START sql table model main.transform_sales .............................. [RUN]
[0m09:18:53.002432 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.sales_team_dimension, now model.my_dbt_project.transform_sales)
[0m09:18:53.004750 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.transform_sales
[0m09:18:53.036582 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.transform_sales"
[0m09:18:53.101611 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.transform_sales
[0m09:18:53.270628 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.transform_sales"
[0m09:18:53.290558 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m09:18:53.292471 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: BEGIN
[0m09:18:53.294535 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:18:53.344175 [debug] [Thread-1 (]: SQL status: OK in 0.050 seconds
[0m09:18:53.346632 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m09:18:53.348362 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */

  
    
    

    create  table
      "sales_database"."main"."transform_sales__dbt_tmp"
  
    as (
      -- /opt/airflow/dags/dbt_models/transform_users.sql


WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
   *
FROM sales
WHERE name = 'ABC private LTD-0002'
    );
  
  
[0m09:18:53.379479 [debug] [Thread-1 (]: SQL status: OK in 0.029 seconds
[0m09:18:53.390992 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m09:18:53.393168 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */
alter table "sales_database"."main"."transform_sales" rename to "transform_sales__dbt_backup"
[0m09:18:53.400407 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m09:18:53.412110 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m09:18:53.414474 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */
alter table "sales_database"."main"."transform_sales__dbt_tmp" rename to "transform_sales"
[0m09:18:53.417945 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:18:53.439429 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: COMMIT
[0m09:18:53.442926 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m09:18:53.445025 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: COMMIT
[0m09:18:53.478587 [debug] [Thread-1 (]: SQL status: OK in 0.031 seconds
[0m09:18:53.498148 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m09:18:53.500613 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */
drop table if exists "sales_database"."main"."transform_sales__dbt_backup" cascade
[0m09:18:53.511546 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m09:18:53.518950 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: Close
[0m09:18:53.652997 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5e89230-65be-4928-acf0-edb90379cd26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96948569c0>]}
[0m09:18:53.660194 [info ] [Thread-1 (]: 5 of 6 OK created sql table model main.transform_sales ......................... [[32mOK[0m in 0.66s]
[0m09:18:53.664188 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.transform_sales
[0m09:18:53.668455 [debug] [Thread-1 (]: Began running node model.my_dbt_project.sales_fact
[0m09:18:53.671207 [info ] [Thread-1 (]: 6 of 6 START sql table model main.sales_fact ................................... [RUN]
[0m09:18:53.675191 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.transform_sales, now model.my_dbt_project.sales_fact)
[0m09:18:53.677425 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.sales_fact
[0m09:18:53.691524 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.sales_fact"
[0m09:18:53.708781 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.sales_fact
[0m09:18:53.721090 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.sales_fact"
[0m09:18:53.740145 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_fact"
[0m09:18:53.742823 [debug] [Thread-1 (]: On model.my_dbt_project.sales_fact: BEGIN
[0m09:18:53.744718 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:18:53.791867 [debug] [Thread-1 (]: SQL status: OK in 0.047 seconds
[0m09:18:53.794837 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_fact"
[0m09:18:53.797637 [debug] [Thread-1 (]: On model.my_dbt_project.sales_fact: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_fact"} */

  
    
    

    create  table
      "sales_database"."main"."sales_fact__dbt_tmp"
  
    as (
      WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
),
customer AS (
    SELECT * FROM "sales_database"."main"."customer_dimension"
),
product AS (
    SELECT * FROM "sales_database"."main"."product_dimension"
),
sales_team AS (
    SELECT * FROM "sales_database"."main"."sales_team_dimension"
),
date AS (
    SELECT * FROM "sales_database"."main"."date_dimension"
)

SELECT
    sales.name AS sales_id,
    customer.customer_id,
    product.product_id,
    sales_team.sales_team_id,
    date.date_id,
    sales.total_qty,
    sales.total_net_weight,
    sales.total,
    sales.net_total,
    sales.grand_total,
    sales.tax_category
FROM sales
JOIN customer ON sales.customer = customer.customer_id
-- Handling product as a lateral join
JOIN LATERAL (
    SELECT item->>'product_id' AS product_id
    FROM jsonb_array_elements(sales.items) AS product(item)
    WHERE item->>'product_id' IS NOT NULL
) AS product ON TRUE
-- Handling sales_team as a lateral join
JOIN LATERAL (
    SELECT item->>'sales_team_id' AS sales_team_id
    FROM jsonb_array_elements(sales.sales_team) AS team(item)
    WHERE item->>'sales_team_id' IS NOT NULL
) AS sales_team ON TRUE
JOIN date ON sales.transaction_date = date.date_id;
    );
  
  
[0m09:18:53.820154 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_fact"} */

  
    
    

    create  table
      "sales_database"."main"."sales_fact__dbt_tmp"
  
    as (
      WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
),
customer AS (
    SELECT * FROM "sales_database"."main"."customer_dimension"
),
product AS (
    SELECT * FROM "sales_database"."main"."product_dimension"
),
sales_team AS (
    SELECT * FROM "sales_database"."main"."sales_team_dimension"
),
date AS (
    SELECT * FROM "sales_database"."main"."date_dimension"
)

SELECT
    sales.name AS sales_id,
    customer.customer_id,
    product.product_id,
    sales_team.sales_team_id,
    date.date_id,
    sales.total_qty,
    sales.total_net_weight,
    sales.total,
    sales.net_total,
    sales.grand_total,
    sales.tax_category
FROM sales
JOIN customer ON sales.customer = customer.customer_id
-- Handling product as a lateral join
JOIN LATERAL (
    SELECT item->>'product_id' AS product_id
    FROM jsonb_array_elements(sales.items) AS product(item)
    WHERE item->>'product_id' IS NOT NULL
) AS product ON TRUE
-- Handling sales_team as a lateral join
JOIN LATERAL (
    SELECT item->>'sales_team_id' AS sales_team_id
    FROM jsonb_array_elements(sales.sales_team) AS team(item)
    WHERE item->>'sales_team_id' IS NOT NULL
) AS sales_team ON TRUE
JOIN date ON sales.transaction_date = date.date_id;
    );
  
  
[0m09:18:53.822687 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m09:18:53.825296 [debug] [Thread-1 (]: On model.my_dbt_project.sales_fact: ROLLBACK
[0m09:18:53.883816 [debug] [Thread-1 (]: Failed to rollback 'model.my_dbt_project.sales_fact'
[0m09:18:53.885820 [debug] [Thread-1 (]: On model.my_dbt_project.sales_fact: Close
[0m09:18:53.899534 [debug] [Thread-1 (]: Runtime Error in model sales_fact (models/facts/sales_fact.sql)
  Parser Error: syntax error at or near ";"
[0m09:18:53.902058 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5e89230-65be-4928-acf0-edb90379cd26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9694856f00>]}
[0m09:18:53.904788 [error] [Thread-1 (]: 6 of 6 ERROR creating sql table model main.sales_fact .......................... [[31mERROR[0m in 0.23s]
[0m09:18:53.909445 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.sales_fact
[0m09:18:53.912953 [debug] [Thread-4 (]: Marking all children of 'model.my_dbt_project.sales_fact' to be skipped because of status 'error'.  Reason: Runtime Error in model sales_fact (models/facts/sales_fact.sql)
  Parser Error: syntax error at or near ";".
[0m09:18:53.920488 [debug] [MainThread]: Using duckdb connection "master"
[0m09:18:53.922066 [debug] [MainThread]: On master: BEGIN
[0m09:18:53.923582 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:18:53.961303 [debug] [MainThread]: SQL status: OK in 0.038 seconds
[0m09:18:53.963008 [debug] [MainThread]: On master: COMMIT
[0m09:18:53.964705 [debug] [MainThread]: Using duckdb connection "master"
[0m09:18:53.966473 [debug] [MainThread]: On master: COMMIT
[0m09:18:53.969528 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m09:18:53.971199 [debug] [MainThread]: On master: Close
[0m09:18:53.978049 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:18:53.979900 [debug] [MainThread]: Connection 'list_sales_database_main' was properly closed.
[0m09:18:53.981517 [debug] [MainThread]: Connection 'model.my_dbt_project.sales_fact' was properly closed.
[0m09:18:53.984001 [info ] [MainThread]: 
[0m09:18:53.986876 [info ] [MainThread]: Finished running 2 table models, 4 view models in 0 hours 0 minutes and 4.75 seconds (4.75s).
[0m09:18:53.994251 [debug] [MainThread]: Command end result
[0m09:18:54.131876 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m09:18:54.148463 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m09:18:54.240152 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dags/dbt_models/target/run_results.json
[0m09:18:54.243041 [info ] [MainThread]: 
[0m09:18:54.245842 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m09:18:54.252656 [info ] [MainThread]: 
[0m09:18:54.259531 [error] [MainThread]:   Runtime Error in model sales_fact (models/facts/sales_fact.sql)
  Parser Error: syntax error at or near ";"
[0m09:18:54.263692 [info ] [MainThread]: 
[0m09:18:54.269326 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m09:18:54.276239 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 13.086744, "process_in_blocks": "1784560", "process_kernel_time": 5.585762, "process_mem_max_rss": "144344", "process_out_blocks": "0", "process_user_time": 14.227504}
[0m09:18:54.285965 [debug] [MainThread]: Command `dbt run` failed at 09:18:54.285587 after 13.10 seconds
[0m09:18:54.288721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f969bdd0bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f969bebfb60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9695d0aa50>]}
[0m09:18:54.290979 [debug] [MainThread]: Flushing usage events
[0m09:18:55.999535 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:24:22.971050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8e35043b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8e35073b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8e3504320>]}


============================== 09:24:23.013329 | d37aea19-828e-4840-bba1-cd8baec9e088 ==============================
[0m09:24:23.013329 [info ] [MainThread]: Running with dbt=1.9.1
[0m09:24:23.014967 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dags/dbt_models/logs', 'profiles_dir': '/opt/airflow/dbt/profiles.yml', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt/profiles.yml --target dev', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:24:24.388692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd37aea19-828e-4840-bba1-cd8baec9e088', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8ddd67dd0>]}
[0m09:24:24.535047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd37aea19-828e-4840-bba1-cd8baec9e088', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8e4a62e70>]}
[0m09:24:24.550087 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m09:24:24.807686 [debug] [MainThread]: checksum: cac3b9519010e47bfbeb71ca6efb4867dae2858687671594dc23fefc94ecf25d, vars: {}, profile: , target: dev, version: 1.9.1
[0m09:24:25.664370 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:24:25.665405 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:24:25.726390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd37aea19-828e-4840-bba1-cd8baec9e088', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8ddd97740>]}
[0m09:24:25.910458 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m09:24:25.919448 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m09:24:26.000972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd37aea19-828e-4840-bba1-cd8baec9e088', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8dd601700>]}
[0m09:24:26.002243 [info ] [MainThread]: Found 6 models, 1 source, 424 macros
[0m09:24:26.003806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd37aea19-828e-4840-bba1-cd8baec9e088', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8e33e3e00>]}
[0m09:24:26.009419 [info ] [MainThread]: 
[0m09:24:26.010836 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:24:26.012226 [info ] [MainThread]: 
[0m09:24:26.014531 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m09:24:26.024623 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_sales_database'
[0m09:24:26.115816 [debug] [ThreadPool]: Using duckdb connection "list_sales_database"
[0m09:24:26.117211 [debug] [ThreadPool]: On list_sales_database: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "list_sales_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"sales_database"'
    
  
  
[0m09:24:26.118476 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:24:26.193622 [debug] [ThreadPool]: SQL status: OK in 0.075 seconds
[0m09:24:26.197148 [debug] [ThreadPool]: On list_sales_database: Close
[0m09:24:26.203266 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_database, now create_sales_database_main)
[0m09:24:26.205077 [debug] [ThreadPool]: Creating schema "database: "sales_database"
schema: "main"
"
[0m09:24:26.218463 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m09:24:26.219579 [debug] [ThreadPool]: On create_sales_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "create_sales_database_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='sales_database'
        and type='sqlite'
    
  
[0m09:24:26.220635 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:24:26.253492 [debug] [ThreadPool]: SQL status: OK in 0.033 seconds
[0m09:24:26.256574 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m09:24:26.257701 [debug] [ThreadPool]: On create_sales_database_main: BEGIN
[0m09:24:26.259295 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:24:26.260519 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m09:24:26.261847 [debug] [ThreadPool]: On create_sales_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "create_sales_database_main"} */

    
    
        create schema if not exists "sales_database"."main"
    
[0m09:24:26.264456 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:24:26.266509 [debug] [ThreadPool]: On create_sales_database_main: COMMIT
[0m09:24:26.267631 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m09:24:26.268835 [debug] [ThreadPool]: On create_sales_database_main: COMMIT
[0m09:24:26.271352 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:24:26.273105 [debug] [ThreadPool]: On create_sales_database_main: Close
[0m09:24:26.279684 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_sales_database_main, now list_sales_database_main)
[0m09:24:26.291393 [debug] [ThreadPool]: Using duckdb connection "list_sales_database_main"
[0m09:24:26.292811 [debug] [ThreadPool]: On list_sales_database_main: BEGIN
[0m09:24:26.294295 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:24:26.319765 [debug] [ThreadPool]: SQL status: OK in 0.025 seconds
[0m09:24:26.321147 [debug] [ThreadPool]: Using duckdb connection "list_sales_database_main"
[0m09:24:26.322740 [debug] [ThreadPool]: On list_sales_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "list_sales_database_main"} */
select
      'sales_database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'sales_database'
  
[0m09:24:26.374211 [debug] [ThreadPool]: SQL status: OK in 0.050 seconds
[0m09:24:26.377186 [debug] [ThreadPool]: On list_sales_database_main: ROLLBACK
[0m09:24:26.380913 [debug] [ThreadPool]: Failed to rollback 'list_sales_database_main'
[0m09:24:26.382248 [debug] [ThreadPool]: On list_sales_database_main: Close
[0m09:24:26.390368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd37aea19-828e-4840-bba1-cd8baec9e088', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8ddd96ba0>]}
[0m09:24:26.391681 [debug] [MainThread]: Using duckdb connection "master"
[0m09:24:26.392674 [debug] [MainThread]: On master: BEGIN
[0m09:24:26.393690 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:24:26.417412 [debug] [MainThread]: SQL status: OK in 0.024 seconds
[0m09:24:26.418576 [debug] [MainThread]: On master: COMMIT
[0m09:24:26.419606 [debug] [MainThread]: Using duckdb connection "master"
[0m09:24:26.420693 [debug] [MainThread]: On master: COMMIT
[0m09:24:26.423011 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m09:24:26.424207 [debug] [MainThread]: On master: Close
[0m09:24:26.431224 [debug] [Thread-1 (]: Began running node model.my_dbt_project.customer_dimension
[0m09:24:26.432735 [info ] [Thread-1 (]: 1 of 6 START sql view model main.customer_dimension ............................ [RUN]
[0m09:24:26.434397 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.my_dbt_project.customer_dimension'
[0m09:24:26.435630 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.customer_dimension
[0m09:24:26.450367 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.customer_dimension"
[0m09:24:26.466787 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.customer_dimension
[0m09:24:26.556935 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.customer_dimension"
[0m09:24:26.575521 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m09:24:26.576921 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: BEGIN
[0m09:24:26.578138 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m09:24:26.605627 [debug] [Thread-1 (]: SQL status: OK in 0.027 seconds
[0m09:24:26.606932 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m09:24:26.608263 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */

  
  create view "sales_database"."main"."customer_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
    DISTINCT
    customer AS customer_id,
    customer_name,
    customer_address,
    customer_group,
    territory,
    language AS customer_language
FROM sales
WHERE customer IS NOT NULL
  );

[0m09:24:26.610836 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:24:26.625819 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m09:24:26.627196 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */
alter view "sales_database"."main"."customer_dimension" rename to "customer_dimension__dbt_backup"
[0m09:24:26.629647 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:24:26.636836 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m09:24:26.638662 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */
alter view "sales_database"."main"."customer_dimension__dbt_tmp" rename to "customer_dimension"
[0m09:24:26.640808 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:24:26.668468 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: COMMIT
[0m09:24:26.670702 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m09:24:26.673196 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: COMMIT
[0m09:24:26.703522 [debug] [Thread-1 (]: SQL status: OK in 0.028 seconds
[0m09:24:26.727880 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m09:24:26.729486 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */
drop view if exists "sales_database"."main"."customer_dimension__dbt_backup" cascade
[0m09:24:26.761906 [debug] [Thread-1 (]: SQL status: OK in 0.030 seconds
[0m09:24:26.776207 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: Close
[0m09:24:26.912084 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd37aea19-828e-4840-bba1-cd8baec9e088', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8e5736450>]}
[0m09:24:26.914631 [info ] [Thread-1 (]: 1 of 6 OK created sql view model main.customer_dimension ....................... [[32mOK[0m in 0.47s]
[0m09:24:26.916701 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.customer_dimension
[0m09:24:26.918473 [debug] [Thread-1 (]: Began running node model.my_dbt_project.date_dimension
[0m09:24:26.919936 [info ] [Thread-1 (]: 2 of 6 START sql view model main.date_dimension ................................ [RUN]
[0m09:24:26.922816 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customer_dimension, now model.my_dbt_project.date_dimension)
[0m09:24:26.924148 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.date_dimension
[0m09:24:26.930316 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.date_dimension"
[0m09:24:26.944933 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.date_dimension
[0m09:24:26.956538 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.date_dimension"
[0m09:24:26.970527 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m09:24:26.972503 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: BEGIN
[0m09:24:26.974175 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:24:27.008884 [debug] [Thread-1 (]: SQL status: OK in 0.035 seconds
[0m09:24:27.014458 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m09:24:27.016373 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.date_dimension"} */

  
  create view "sales_database"."main"."date_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
    transaction_date,
    strftime(transaction_date, '%A') AS weekday_name,  -- Extract weekday name
    strftime(transaction_date, '%m') AS month,          -- Extract month (numeric)
    strftime(transaction_date, '%Y') AS year,           -- Extract year
    strftime(transaction_date, '%d') AS day,            -- Extract day
    EXTRACT(QUARTER FROM transaction_date) AS quarter   -- Extract quarter
FROM sales
WHERE transaction_date IS NOT NULL
  );

[0m09:24:27.022752 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m09:24:27.033803 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m09:24:27.035260 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.date_dimension"} */
alter view "sales_database"."main"."date_dimension" rename to "date_dimension__dbt_backup"
[0m09:24:27.037859 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:24:27.048884 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m09:24:27.050419 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.date_dimension"} */
alter view "sales_database"."main"."date_dimension__dbt_tmp" rename to "date_dimension"
[0m09:24:27.052740 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:24:27.058994 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: COMMIT
[0m09:24:27.060435 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m09:24:27.063281 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: COMMIT
[0m09:24:27.101899 [debug] [Thread-1 (]: SQL status: OK in 0.037 seconds
[0m09:24:27.110557 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m09:24:27.113313 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.date_dimension"} */
drop view if exists "sales_database"."main"."date_dimension__dbt_backup" cascade
[0m09:24:27.136752 [debug] [Thread-1 (]: SQL status: OK in 0.022 seconds
[0m09:24:27.141606 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: Close
[0m09:24:27.274840 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd37aea19-828e-4840-bba1-cd8baec9e088', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8ddd4e0c0>]}
[0m09:24:27.276830 [info ] [Thread-1 (]: 2 of 6 OK created sql view model main.date_dimension ........................... [[32mOK[0m in 0.35s]
[0m09:24:27.279217 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.date_dimension
[0m09:24:27.280856 [debug] [Thread-1 (]: Began running node model.my_dbt_project.product_dimension
[0m09:24:27.282966 [info ] [Thread-1 (]: 3 of 6 START sql view model main.product_dimension ............................. [RUN]
[0m09:24:27.285647 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.date_dimension, now model.my_dbt_project.product_dimension)
[0m09:24:27.288089 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.product_dimension
[0m09:24:27.295645 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.product_dimension"
[0m09:24:27.310094 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.product_dimension
[0m09:24:27.317748 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.product_dimension"
[0m09:24:27.331352 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m09:24:27.332881 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: BEGIN
[0m09:24:27.334656 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:24:27.360577 [debug] [Thread-1 (]: SQL status: OK in 0.026 seconds
[0m09:24:27.361890 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m09:24:27.363167 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.product_dimension"} */

  
  create view "sales_database"."main"."product_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * 
    FROM "sales_database"."main"."sales"
)

SELECT 
    sales.name,
    json_extract(items, '$[0].name') AS product_name,  -- Example to extract the first element's "name" field from JSON array
    json_extract(items, '$[0].item_code') AS product_item_code
FROM sales
WHERE json_extract(items, '$[0].name') IS NOT NULL  -- Filter to only keep rows with a non-null product name
  );

[0m09:24:27.366332 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m09:24:27.372918 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m09:24:27.374507 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.product_dimension"} */
alter view "sales_database"."main"."product_dimension" rename to "product_dimension__dbt_backup"
[0m09:24:27.376489 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:24:27.384583 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m09:24:27.385920 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.product_dimension"} */
alter view "sales_database"."main"."product_dimension__dbt_tmp" rename to "product_dimension"
[0m09:24:27.388021 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:24:27.392459 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: COMMIT
[0m09:24:27.393639 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m09:24:27.394739 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: COMMIT
[0m09:24:27.423279 [debug] [Thread-1 (]: SQL status: OK in 0.027 seconds
[0m09:24:27.428327 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m09:24:27.429784 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.product_dimension"} */
drop view if exists "sales_database"."main"."product_dimension__dbt_backup" cascade
[0m09:24:27.456970 [debug] [Thread-1 (]: SQL status: OK in 0.025 seconds
[0m09:24:27.468064 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: Close
[0m09:24:27.604891 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd37aea19-828e-4840-bba1-cd8baec9e088', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8dcac5130>]}
[0m09:24:27.606812 [info ] [Thread-1 (]: 3 of 6 OK created sql view model main.product_dimension ........................ [[32mOK[0m in 0.32s]
[0m09:24:27.608784 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.product_dimension
[0m09:24:27.610099 [debug] [Thread-1 (]: Began running node model.my_dbt_project.sales_team_dimension
[0m09:24:27.611578 [info ] [Thread-1 (]: 4 of 6 START sql view model main.sales_team_dimension .......................... [RUN]
[0m09:24:27.613350 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.product_dimension, now model.my_dbt_project.sales_team_dimension)
[0m09:24:27.614697 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.sales_team_dimension
[0m09:24:27.623184 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.sales_team_dimension"
[0m09:24:27.637393 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.sales_team_dimension
[0m09:24:27.649976 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.sales_team_dimension"
[0m09:24:27.664199 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m09:24:27.665489 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: BEGIN
[0m09:24:27.666604 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:24:27.691082 [debug] [Thread-1 (]: SQL status: OK in 0.024 seconds
[0m09:24:27.692245 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m09:24:27.693731 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */

  
  create view "sales_database"."main"."sales_team_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
    DISTINCT
    sales_team->>'name' AS sales_team_id,
    sales_team->>'region' AS sales_team_region
FROM sales
WHERE sales_team IS NOT NULL
  );

[0m09:24:27.696605 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:24:27.702800 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m09:24:27.704065 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */
alter view "sales_database"."main"."sales_team_dimension" rename to "sales_team_dimension__dbt_backup"
[0m09:24:27.706803 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:24:27.713284 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m09:24:27.714582 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */
alter view "sales_database"."main"."sales_team_dimension__dbt_tmp" rename to "sales_team_dimension"
[0m09:24:27.716522 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:24:27.720274 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: COMMIT
[0m09:24:27.721687 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m09:24:27.723159 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: COMMIT
[0m09:24:27.749620 [debug] [Thread-1 (]: SQL status: OK in 0.025 seconds
[0m09:24:27.755358 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m09:24:27.756747 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */
drop view if exists "sales_database"."main"."sales_team_dimension__dbt_backup" cascade
[0m09:24:27.780898 [debug] [Thread-1 (]: SQL status: OK in 0.023 seconds
[0m09:24:27.786464 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: Close
[0m09:24:27.940224 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd37aea19-828e-4840-bba1-cd8baec9e088', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8dd67e570>]}
[0m09:24:27.942842 [info ] [Thread-1 (]: 4 of 6 OK created sql view model main.sales_team_dimension ..................... [[32mOK[0m in 0.33s]
[0m09:24:27.944841 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.sales_team_dimension
[0m09:24:27.946597 [debug] [Thread-1 (]: Began running node model.my_dbt_project.transform_sales
[0m09:24:27.948678 [info ] [Thread-1 (]: 5 of 6 START sql table model main.transform_sales .............................. [RUN]
[0m09:24:27.951178 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.sales_team_dimension, now model.my_dbt_project.transform_sales)
[0m09:24:27.952551 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.transform_sales
[0m09:24:27.958986 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.transform_sales"
[0m09:24:27.970203 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.transform_sales
[0m09:24:28.032421 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.transform_sales"
[0m09:24:28.047823 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m09:24:28.049054 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: BEGIN
[0m09:24:28.050265 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:24:28.112007 [debug] [Thread-1 (]: SQL status: OK in 0.061 seconds
[0m09:24:28.115809 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m09:24:28.117487 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */

  
    
    

    create  table
      "sales_database"."main"."transform_sales__dbt_tmp"
  
    as (
      -- /opt/airflow/dags/dbt_models/transform_users.sql


WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
   *
FROM sales
WHERE name = 'ABC private LTD-0002'
    );
  
  
[0m09:24:28.177238 [debug] [Thread-1 (]: SQL status: OK in 0.058 seconds
[0m09:24:28.185736 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m09:24:28.191953 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */
alter table "sales_database"."main"."transform_sales" rename to "transform_sales__dbt_backup"
[0m09:24:28.200066 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m09:24:28.221485 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m09:24:28.228328 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */
alter table "sales_database"."main"."transform_sales__dbt_tmp" rename to "transform_sales"
[0m09:24:28.236507 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m09:24:28.263756 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: COMMIT
[0m09:24:28.265086 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m09:24:28.266712 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: COMMIT
[0m09:24:28.299395 [debug] [Thread-1 (]: SQL status: OK in 0.031 seconds
[0m09:24:28.312311 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m09:24:28.314224 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */
drop table if exists "sales_database"."main"."transform_sales__dbt_backup" cascade
[0m09:24:28.340398 [debug] [Thread-1 (]: SQL status: OK in 0.025 seconds
[0m09:24:28.349692 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: Close
[0m09:24:28.646496 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd37aea19-828e-4840-bba1-cd8baec9e088', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8dcaf5f70>]}
[0m09:24:28.649741 [info ] [Thread-1 (]: 5 of 6 OK created sql table model main.transform_sales ......................... [[32mOK[0m in 0.70s]
[0m09:24:28.653691 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.transform_sales
[0m09:24:28.656500 [debug] [Thread-1 (]: Began running node model.my_dbt_project.sales_fact
[0m09:24:28.659025 [info ] [Thread-1 (]: 6 of 6 START sql table model main.sales_fact ................................... [RUN]
[0m09:24:28.662382 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.transform_sales, now model.my_dbt_project.sales_fact)
[0m09:24:28.663628 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.sales_fact
[0m09:24:28.684878 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.sales_fact"
[0m09:24:28.713015 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.sales_fact
[0m09:24:28.728482 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.sales_fact"
[0m09:24:28.751789 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_fact"
[0m09:24:28.753111 [debug] [Thread-1 (]: On model.my_dbt_project.sales_fact: BEGIN
[0m09:24:28.754610 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:24:28.810467 [debug] [Thread-1 (]: SQL status: OK in 0.056 seconds
[0m09:24:28.813342 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_fact"
[0m09:24:28.815796 [debug] [Thread-1 (]: On model.my_dbt_project.sales_fact: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_fact"} */

  
    
    

    create  table
      "sales_database"."main"."sales_fact__dbt_tmp"
  
    as (
      WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
),
customer AS (
    SELECT * FROM "sales_database"."main"."customer_dimension"
),
product AS (
    SELECT * FROM "sales_database"."main"."product_dimension"
),
sales_team AS (
    SELECT * FROM "sales_database"."main"."sales_team_dimension"
),
date AS (
    SELECT * FROM "sales_database"."main"."date_dimension"
)

SELECT
    sales.name AS sales_id,
    customer.customer_id,
    product.product_id,
    sales_team.sales_team_id,
    date.date_id,
    sales.total_qty,
    sales.total_net_weight,
    sales.total,
    sales.net_total,
    sales.grand_total,
    sales.tax_category
FROM sales
JOIN customer ON sales.customer = customer.customer_id
-- Handling product as a lateral join
JOIN LATERAL (
    SELECT item->>'product_id' AS product_id
    FROM jsonb_array_elements(sales.items) AS product(item)
    WHERE item->>'product_id' IS NOT NULL
) AS product ON TRUE
-- Handling sales_team as a lateral join
JOIN LATERAL (
    SELECT item->>'sales_team_id' AS sales_team_id
    FROM jsonb_array_elements(sales.sales_team) AS team(item)
    WHERE item->>'sales_team_id' IS NOT NULL
) AS sales_team ON TRUE
JOIN date ON sales.transaction_date = date.date_id;
    );
  
  
[0m09:24:28.834476 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_fact"} */

  
    
    

    create  table
      "sales_database"."main"."sales_fact__dbt_tmp"
  
    as (
      WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
),
customer AS (
    SELECT * FROM "sales_database"."main"."customer_dimension"
),
product AS (
    SELECT * FROM "sales_database"."main"."product_dimension"
),
sales_team AS (
    SELECT * FROM "sales_database"."main"."sales_team_dimension"
),
date AS (
    SELECT * FROM "sales_database"."main"."date_dimension"
)

SELECT
    sales.name AS sales_id,
    customer.customer_id,
    product.product_id,
    sales_team.sales_team_id,
    date.date_id,
    sales.total_qty,
    sales.total_net_weight,
    sales.total,
    sales.net_total,
    sales.grand_total,
    sales.tax_category
FROM sales
JOIN customer ON sales.customer = customer.customer_id
-- Handling product as a lateral join
JOIN LATERAL (
    SELECT item->>'product_id' AS product_id
    FROM jsonb_array_elements(sales.items) AS product(item)
    WHERE item->>'product_id' IS NOT NULL
) AS product ON TRUE
-- Handling sales_team as a lateral join
JOIN LATERAL (
    SELECT item->>'sales_team_id' AS sales_team_id
    FROM jsonb_array_elements(sales.sales_team) AS team(item)
    WHERE item->>'sales_team_id' IS NOT NULL
) AS sales_team ON TRUE
JOIN date ON sales.transaction_date = date.date_id;
    );
  
  
[0m09:24:28.836877 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m09:24:28.840154 [debug] [Thread-1 (]: On model.my_dbt_project.sales_fact: ROLLBACK
[0m09:24:28.874607 [debug] [Thread-1 (]: Failed to rollback 'model.my_dbt_project.sales_fact'
[0m09:24:28.876079 [debug] [Thread-1 (]: On model.my_dbt_project.sales_fact: Close
[0m09:24:28.884548 [debug] [Thread-1 (]: Runtime Error in model sales_fact (models/facts/sales_fact.sql)
  Parser Error: syntax error at or near ";"
[0m09:24:28.886253 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd37aea19-828e-4840-bba1-cd8baec9e088', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8dcaf5430>]}
[0m09:24:28.891823 [error] [Thread-1 (]: 6 of 6 ERROR creating sql table model main.sales_fact .......................... [[31mERROR[0m in 0.22s]
[0m09:24:28.897829 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.sales_fact
[0m09:24:28.899977 [debug] [Thread-4 (]: Marking all children of 'model.my_dbt_project.sales_fact' to be skipped because of status 'error'.  Reason: Runtime Error in model sales_fact (models/facts/sales_fact.sql)
  Parser Error: syntax error at or near ";".
[0m09:24:28.905631 [debug] [MainThread]: Using duckdb connection "master"
[0m09:24:28.907327 [debug] [MainThread]: On master: BEGIN
[0m09:24:28.908609 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:24:28.937035 [debug] [MainThread]: SQL status: OK in 0.028 seconds
[0m09:24:28.938347 [debug] [MainThread]: On master: COMMIT
[0m09:24:28.940029 [debug] [MainThread]: Using duckdb connection "master"
[0m09:24:28.941588 [debug] [MainThread]: On master: COMMIT
[0m09:24:28.944388 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m09:24:28.945884 [debug] [MainThread]: On master: Close
[0m09:24:28.949812 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:24:28.951018 [debug] [MainThread]: Connection 'list_sales_database_main' was properly closed.
[0m09:24:28.951926 [debug] [MainThread]: Connection 'model.my_dbt_project.sales_fact' was properly closed.
[0m09:24:28.952920 [info ] [MainThread]: 
[0m09:24:28.954070 [info ] [MainThread]: Finished running 2 table models, 4 view models in 0 hours 0 minutes and 2.94 seconds (2.94s).
[0m09:24:28.959589 [debug] [MainThread]: Command end result
[0m09:24:29.062283 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m09:24:29.070614 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m09:24:29.097967 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dags/dbt_models/target/run_results.json
[0m09:24:29.099120 [info ] [MainThread]: 
[0m09:24:29.100751 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m09:24:29.102259 [info ] [MainThread]: 
[0m09:24:29.103758 [error] [MainThread]:   Runtime Error in model sales_fact (models/facts/sales_fact.sql)
  Parser Error: syntax error at or near ";"
[0m09:24:29.106101 [info ] [MainThread]: 
[0m09:24:29.108170 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m09:24:29.111523 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 6.4153986, "process_in_blocks": "93160", "process_kernel_time": 1.006346, "process_mem_max_rss": "155672", "process_out_blocks": "0", "process_user_time": 8.302357}
[0m09:24:29.112988 [debug] [MainThread]: Command `dbt run` failed at 09:24:29.112750 after 6.42 seconds
[0m09:24:29.114167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8dca97920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8ddd67b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8e3504320>]}
[0m09:24:29.115432 [debug] [MainThread]: Flushing usage events
[0m09:24:30.738913 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:28:33.496227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc4d4b2840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc4dcf9100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc4d51ae10>]}


============================== 09:28:33.519126 | 6a4835e7-c632-4bed-8bc9-78b976cd6257 ==============================
[0m09:28:33.519126 [info ] [MainThread]: Running with dbt=1.9.1
[0m09:28:33.522985 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dags/dbt_models/logs', 'profiles_dir': '/opt/airflow/dbt/profiles.yml', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt/profiles.yml --target dev', 'send_anonymous_usage_stats': 'True'}
[0m09:28:34.540925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6a4835e7-c632-4bed-8bc9-78b976cd6257', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc4c68c800>]}
[0m09:28:34.712514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6a4835e7-c632-4bed-8bc9-78b976cd6257', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc4d18dd00>]}
[0m09:28:34.728079 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m09:28:35.036531 [debug] [MainThread]: checksum: cac3b9519010e47bfbeb71ca6efb4867dae2858687671594dc23fefc94ecf25d, vars: {}, profile: , target: dev, version: 1.9.1
[0m09:28:35.710198 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:28:35.712032 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/facts/sales_fact.sql
[0m09:28:36.465426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6a4835e7-c632-4bed-8bc9-78b976cd6257', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc469fe120>]}
[0m09:28:36.905723 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m09:28:36.918470 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m09:28:37.024561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6a4835e7-c632-4bed-8bc9-78b976cd6257', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc46b2c710>]}
[0m09:28:37.025895 [info ] [MainThread]: Found 6 models, 1 source, 424 macros
[0m09:28:37.027128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6a4835e7-c632-4bed-8bc9-78b976cd6257', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc469f3920>]}
[0m09:28:37.030943 [info ] [MainThread]: 
[0m09:28:37.034664 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:28:37.036503 [info ] [MainThread]: 
[0m09:28:37.038706 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m09:28:37.049544 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_sales_database'
[0m09:28:37.153977 [debug] [ThreadPool]: Using duckdb connection "list_sales_database"
[0m09:28:37.155446 [debug] [ThreadPool]: On list_sales_database: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "list_sales_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"sales_database"'
    
  
  
[0m09:28:37.157034 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:28:37.219955 [debug] [ThreadPool]: SQL status: OK in 0.062 seconds
[0m09:28:37.225003 [debug] [ThreadPool]: On list_sales_database: Close
[0m09:28:37.231123 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_database, now create_sales_database_main)
[0m09:28:37.234759 [debug] [ThreadPool]: Creating schema "database: "sales_database"
schema: "main"
"
[0m09:28:37.249994 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m09:28:37.252223 [debug] [ThreadPool]: On create_sales_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "create_sales_database_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='sales_database'
        and type='sqlite'
    
  
[0m09:28:37.253514 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:28:37.282434 [debug] [ThreadPool]: SQL status: OK in 0.029 seconds
[0m09:28:37.288007 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m09:28:37.289579 [debug] [ThreadPool]: On create_sales_database_main: BEGIN
[0m09:28:37.291633 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:28:37.293000 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m09:28:37.294522 [debug] [ThreadPool]: On create_sales_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "create_sales_database_main"} */

    
    
        create schema if not exists "sales_database"."main"
    
[0m09:28:37.297568 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:28:37.302861 [debug] [ThreadPool]: On create_sales_database_main: COMMIT
[0m09:28:37.304116 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m09:28:37.305411 [debug] [ThreadPool]: On create_sales_database_main: COMMIT
[0m09:28:37.307357 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:28:37.308699 [debug] [ThreadPool]: On create_sales_database_main: Close
[0m09:28:37.317315 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_sales_database_main, now list_sales_database_main)
[0m09:28:37.335272 [debug] [ThreadPool]: Using duckdb connection "list_sales_database_main"
[0m09:28:37.337353 [debug] [ThreadPool]: On list_sales_database_main: BEGIN
[0m09:28:37.339346 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:28:37.377423 [debug] [ThreadPool]: SQL status: OK in 0.038 seconds
[0m09:28:37.379230 [debug] [ThreadPool]: Using duckdb connection "list_sales_database_main"
[0m09:28:37.380874 [debug] [ThreadPool]: On list_sales_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "list_sales_database_main"} */
select
      'sales_database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'sales_database'
  
[0m09:28:37.545921 [debug] [ThreadPool]: SQL status: OK in 0.161 seconds
[0m09:28:37.553954 [debug] [ThreadPool]: On list_sales_database_main: ROLLBACK
[0m09:28:37.565746 [debug] [ThreadPool]: Failed to rollback 'list_sales_database_main'
[0m09:28:37.568998 [debug] [ThreadPool]: On list_sales_database_main: Close
[0m09:28:37.605698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6a4835e7-c632-4bed-8bc9-78b976cd6257', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc46018e90>]}
[0m09:28:37.609796 [debug] [MainThread]: Using duckdb connection "master"
[0m09:28:37.612792 [debug] [MainThread]: On master: BEGIN
[0m09:28:37.618202 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:28:37.675901 [debug] [MainThread]: SQL status: OK in 0.058 seconds
[0m09:28:37.678091 [debug] [MainThread]: On master: COMMIT
[0m09:28:37.680040 [debug] [MainThread]: Using duckdb connection "master"
[0m09:28:37.682175 [debug] [MainThread]: On master: COMMIT
[0m09:28:37.685950 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m09:28:37.687936 [debug] [MainThread]: On master: Close
[0m09:28:37.703460 [debug] [Thread-1 (]: Began running node model.my_dbt_project.customer_dimension
[0m09:28:37.707630 [info ] [Thread-1 (]: 1 of 6 START sql view model main.customer_dimension ............................ [RUN]
[0m09:28:37.710912 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.my_dbt_project.customer_dimension'
[0m09:28:37.714669 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.customer_dimension
[0m09:28:37.752239 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.customer_dimension"
[0m09:28:37.766112 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.customer_dimension
[0m09:28:37.847270 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.customer_dimension"
[0m09:28:37.863120 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m09:28:37.864540 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: BEGIN
[0m09:28:37.865849 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m09:28:37.901296 [debug] [Thread-1 (]: SQL status: OK in 0.035 seconds
[0m09:28:37.902823 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m09:28:37.905141 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */

  
  create view "sales_database"."main"."customer_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
    DISTINCT
    customer AS customer_id,
    customer_name,
    customer_address,
    customer_group,
    territory,
    language AS customer_language
FROM sales
WHERE customer IS NOT NULL
  );

[0m09:28:37.908427 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:28:37.924666 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m09:28:37.926563 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */
alter view "sales_database"."main"."customer_dimension" rename to "customer_dimension__dbt_backup"
[0m09:28:37.928823 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:28:37.937238 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m09:28:37.938983 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */
alter view "sales_database"."main"."customer_dimension__dbt_tmp" rename to "customer_dimension"
[0m09:28:37.941679 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:28:37.985806 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: COMMIT
[0m09:28:37.987425 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m09:28:37.988832 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: COMMIT
[0m09:28:37.997320 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m09:28:38.012931 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m09:28:38.014741 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */
drop view if exists "sales_database"."main"."customer_dimension__dbt_backup" cascade
[0m09:28:38.021554 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m09:28:38.026618 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: Close
[0m09:28:38.084928 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a4835e7-c632-4bed-8bc9-78b976cd6257', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc4c75bda0>]}
[0m09:28:38.087013 [info ] [Thread-1 (]: 1 of 6 OK created sql view model main.customer_dimension ....................... [[32mOK[0m in 0.37s]
[0m09:28:38.089158 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.customer_dimension
[0m09:28:38.090727 [debug] [Thread-1 (]: Began running node model.my_dbt_project.date_dimension
[0m09:28:38.092912 [info ] [Thread-1 (]: 2 of 6 START sql view model main.date_dimension ................................ [RUN]
[0m09:28:38.095037 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customer_dimension, now model.my_dbt_project.date_dimension)
[0m09:28:38.096855 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.date_dimension
[0m09:28:38.105240 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.date_dimension"
[0m09:28:38.120549 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.date_dimension
[0m09:28:38.137583 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.date_dimension"
[0m09:28:38.156493 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m09:28:38.158433 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: BEGIN
[0m09:28:38.160188 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:28:38.203683 [debug] [Thread-1 (]: SQL status: OK in 0.043 seconds
[0m09:28:38.205830 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m09:28:38.208191 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.date_dimension"} */

  
  create view "sales_database"."main"."date_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
    transaction_date,
    strftime(transaction_date, '%A') AS weekday_name,  -- Extract weekday name
    strftime(transaction_date, '%m') AS month,          -- Extract month (numeric)
    strftime(transaction_date, '%Y') AS year,           -- Extract year
    strftime(transaction_date, '%d') AS day,            -- Extract day
    EXTRACT(QUARTER FROM transaction_date) AS quarter   -- Extract quarter
FROM sales
WHERE transaction_date IS NOT NULL
  );

[0m09:28:38.213090 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m09:28:38.236402 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m09:28:38.242791 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.date_dimension"} */
alter view "sales_database"."main"."date_dimension" rename to "date_dimension__dbt_backup"
[0m09:28:38.249276 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:28:38.291345 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m09:28:38.293132 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.date_dimension"} */
alter view "sales_database"."main"."date_dimension__dbt_tmp" rename to "date_dimension"
[0m09:28:38.295773 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:28:38.302761 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: COMMIT
[0m09:28:38.304572 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m09:28:38.306337 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: COMMIT
[0m09:28:38.316647 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m09:28:38.325516 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m09:28:38.327335 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.date_dimension"} */
drop view if exists "sales_database"."main"."date_dimension__dbt_backup" cascade
[0m09:28:38.332063 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m09:28:38.336493 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: Close
[0m09:28:38.427889 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a4835e7-c632-4bed-8bc9-78b976cd6257', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc454d9ee0>]}
[0m09:28:38.431306 [info ] [Thread-1 (]: 2 of 6 OK created sql view model main.date_dimension ........................... [[32mOK[0m in 0.33s]
[0m09:28:38.445920 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.date_dimension
[0m09:28:38.447910 [debug] [Thread-1 (]: Began running node model.my_dbt_project.product_dimension
[0m09:28:38.452533 [info ] [Thread-1 (]: 3 of 6 START sql view model main.product_dimension ............................. [RUN]
[0m09:28:38.455330 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.date_dimension, now model.my_dbt_project.product_dimension)
[0m09:28:38.457797 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.product_dimension
[0m09:28:38.484296 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.product_dimension"
[0m09:28:38.575896 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.product_dimension
[0m09:28:38.589283 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.product_dimension"
[0m09:28:38.621972 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m09:28:38.623648 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: BEGIN
[0m09:28:38.625493 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:28:38.668828 [debug] [Thread-1 (]: SQL status: OK in 0.043 seconds
[0m09:28:38.670646 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m09:28:38.676606 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.product_dimension"} */

  
  create view "sales_database"."main"."product_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * 
    FROM "sales_database"."main"."sales"
)

SELECT 
    sales.name,
    json_extract(items, '$[0].name') AS product_name,  -- Example to extract the first element's "name" field from JSON array
    json_extract(items, '$[0].item_code') AS product_item_code
FROM sales
WHERE json_extract(items, '$[0].name') IS NOT NULL  -- Filter to only keep rows with a non-null product name
  );

[0m09:28:38.680421 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m09:28:38.693207 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m09:28:38.694800 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.product_dimension"} */
alter view "sales_database"."main"."product_dimension" rename to "product_dimension__dbt_backup"
[0m09:28:38.697522 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:28:38.706348 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m09:28:38.708288 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.product_dimension"} */
alter view "sales_database"."main"."product_dimension__dbt_tmp" rename to "product_dimension"
[0m09:28:38.711516 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:28:38.715479 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: COMMIT
[0m09:28:38.717468 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m09:28:38.719499 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: COMMIT
[0m09:28:38.727983 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m09:28:38.736144 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m09:28:38.737655 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.product_dimension"} */
drop view if exists "sales_database"."main"."product_dimension__dbt_backup" cascade
[0m09:28:38.743059 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m09:28:38.748420 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: Close
[0m09:28:38.805561 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a4835e7-c632-4bed-8bc9-78b976cd6257', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc4549f890>]}
[0m09:28:38.809626 [info ] [Thread-1 (]: 3 of 6 OK created sql view model main.product_dimension ........................ [[32mOK[0m in 0.35s]
[0m09:28:38.821916 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.product_dimension
[0m09:28:38.824839 [debug] [Thread-1 (]: Began running node model.my_dbt_project.sales_team_dimension
[0m09:28:38.827438 [info ] [Thread-1 (]: 4 of 6 START sql view model main.sales_team_dimension .......................... [RUN]
[0m09:28:38.838310 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.product_dimension, now model.my_dbt_project.sales_team_dimension)
[0m09:28:38.840436 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.sales_team_dimension
[0m09:28:38.854486 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.sales_team_dimension"
[0m09:28:38.874611 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.sales_team_dimension
[0m09:28:38.888485 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.sales_team_dimension"
[0m09:28:38.903247 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m09:28:38.904642 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: BEGIN
[0m09:28:38.906113 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:28:38.936618 [debug] [Thread-1 (]: SQL status: OK in 0.030 seconds
[0m09:28:38.938628 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m09:28:38.941951 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */

  
  create view "sales_database"."main"."sales_team_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
    DISTINCT
    sales_team->>'name' AS sales_team_id,
    sales_team->>'region' AS sales_team_region
FROM sales
WHERE sales_team IS NOT NULL
  );

[0m09:28:38.946919 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m09:28:38.959149 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m09:28:38.960959 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */
alter view "sales_database"."main"."sales_team_dimension" rename to "sales_team_dimension__dbt_backup"
[0m09:28:38.963536 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:28:38.976067 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m09:28:38.977805 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */
alter view "sales_database"."main"."sales_team_dimension__dbt_tmp" rename to "sales_team_dimension"
[0m09:28:38.980355 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:28:38.985395 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: COMMIT
[0m09:28:38.987004 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m09:28:38.988202 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: COMMIT
[0m09:28:38.995856 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m09:28:39.002288 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m09:28:39.003868 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */
drop view if exists "sales_database"."main"."sales_team_dimension__dbt_backup" cascade
[0m09:28:39.008278 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m09:28:39.011039 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: Close
[0m09:28:39.056833 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a4835e7-c632-4bed-8bc9-78b976cd6257', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc4410b140>]}
[0m09:28:39.058896 [info ] [Thread-1 (]: 4 of 6 OK created sql view model main.sales_team_dimension ..................... [[32mOK[0m in 0.22s]
[0m09:28:39.060968 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.sales_team_dimension
[0m09:28:39.062467 [debug] [Thread-1 (]: Began running node model.my_dbt_project.transform_sales
[0m09:28:39.064784 [info ] [Thread-1 (]: 5 of 6 START sql table model main.transform_sales .............................. [RUN]
[0m09:28:39.068548 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.sales_team_dimension, now model.my_dbt_project.transform_sales)
[0m09:28:39.070240 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.transform_sales
[0m09:28:39.078215 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.transform_sales"
[0m09:28:39.095653 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.transform_sales
[0m09:28:39.146698 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.transform_sales"
[0m09:28:39.161077 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m09:28:39.162455 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: BEGIN
[0m09:28:39.163715 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:28:39.200953 [debug] [Thread-1 (]: SQL status: OK in 0.037 seconds
[0m09:28:39.202700 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m09:28:39.204516 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */

  
    
    

    create  table
      "sales_database"."main"."transform_sales__dbt_tmp"
  
    as (
      -- /opt/airflow/dags/dbt_models/transform_users.sql


WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
   *
FROM sales
WHERE name = 'ABC private LTD-0002'
    );
  
  
[0m09:28:39.225471 [debug] [Thread-1 (]: SQL status: OK in 0.019 seconds
[0m09:28:39.232332 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m09:28:39.234706 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */
alter table "sales_database"."main"."transform_sales" rename to "transform_sales__dbt_backup"
[0m09:28:39.237252 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:28:39.244399 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m09:28:39.245887 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */
alter table "sales_database"."main"."transform_sales__dbt_tmp" rename to "transform_sales"
[0m09:28:39.248337 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:28:39.261530 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: COMMIT
[0m09:28:39.263218 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m09:28:39.264742 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: COMMIT
[0m09:28:39.278983 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m09:28:39.289457 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m09:28:39.291725 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */
drop table if exists "sales_database"."main"."transform_sales__dbt_backup" cascade
[0m09:28:39.298890 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m09:28:39.306448 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: Close
[0m09:28:39.461357 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a4835e7-c632-4bed-8bc9-78b976cd6257', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc4544c9e0>]}
[0m09:28:39.469663 [info ] [Thread-1 (]: 5 of 6 OK created sql table model main.transform_sales ......................... [[32mOK[0m in 0.39s]
[0m09:28:39.473240 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.transform_sales
[0m09:28:39.477754 [debug] [Thread-1 (]: Began running node model.my_dbt_project.sales_fact
[0m09:28:39.487830 [info ] [Thread-1 (]: 6 of 6 START sql table model main.sales_fact ................................... [RUN]
[0m09:28:39.490381 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.transform_sales, now model.my_dbt_project.sales_fact)
[0m09:28:39.492019 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.sales_fact
[0m09:28:39.505891 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.sales_fact"
[0m09:28:39.523888 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.sales_fact
[0m09:28:39.532323 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.sales_fact"
[0m09:28:39.549427 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_fact"
[0m09:28:39.552009 [debug] [Thread-1 (]: On model.my_dbt_project.sales_fact: BEGIN
[0m09:28:39.553776 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:28:39.590781 [debug] [Thread-1 (]: SQL status: OK in 0.037 seconds
[0m09:28:39.592838 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_fact"
[0m09:28:39.595037 [debug] [Thread-1 (]: On model.my_dbt_project.sales_fact: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_fact"} */

  
    
    

    create  table
      "sales_database"."main"."sales_fact__dbt_tmp"
  
    as (
      WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
),
customer AS (
    SELECT * FROM "sales_database"."main"."customer_dimension"
),
product AS (
    SELECT * FROM "sales_database"."main"."product_dimension"
),
sales_team AS (
    SELECT * FROM "sales_database"."main"."sales_team_dimension"
),
date AS (
    SELECT * FROM "sales_database"."main"."date_dimension"
)

SELECT
    sales.name AS sales_id,
    customer.customer_id,
    product.product_id,
    sales_team.sales_team_id,
    date.date_id,
    sales.total_qty,
    sales.total_net_weight,
    sales.total,
    sales.net_total,
    sales.grand_total,
    sales.tax_category
FROM sales
JOIN customer 
    ON sales.customer = customer.customer_id
-- Handling product as a lateral join
JOIN LATERAL (
    SELECT item->>'product_id' AS product_id
    FROM jsonb_array_elements(sales.items) AS product(item)
    WHERE item->>'product_id' IS NOT NULL
) AS product ON TRUE
-- Handling sales_team as a lateral join
JOIN LATERAL (
    SELECT item->>'sales_team_id' AS sales_team_id
    FROM jsonb_array_elements(sales.sales_team) AS team(item)
    WHERE item->>'sales_team_id' IS NOT NULL
) AS sales_team ON TRUE
JOIN date 
    ON sales.transaction_date = date.date_id;
    );
  
  
[0m09:28:39.611090 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_fact"} */

  
    
    

    create  table
      "sales_database"."main"."sales_fact__dbt_tmp"
  
    as (
      WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
),
customer AS (
    SELECT * FROM "sales_database"."main"."customer_dimension"
),
product AS (
    SELECT * FROM "sales_database"."main"."product_dimension"
),
sales_team AS (
    SELECT * FROM "sales_database"."main"."sales_team_dimension"
),
date AS (
    SELECT * FROM "sales_database"."main"."date_dimension"
)

SELECT
    sales.name AS sales_id,
    customer.customer_id,
    product.product_id,
    sales_team.sales_team_id,
    date.date_id,
    sales.total_qty,
    sales.total_net_weight,
    sales.total,
    sales.net_total,
    sales.grand_total,
    sales.tax_category
FROM sales
JOIN customer 
    ON sales.customer = customer.customer_id
-- Handling product as a lateral join
JOIN LATERAL (
    SELECT item->>'product_id' AS product_id
    FROM jsonb_array_elements(sales.items) AS product(item)
    WHERE item->>'product_id' IS NOT NULL
) AS product ON TRUE
-- Handling sales_team as a lateral join
JOIN LATERAL (
    SELECT item->>'sales_team_id' AS sales_team_id
    FROM jsonb_array_elements(sales.sales_team) AS team(item)
    WHERE item->>'sales_team_id' IS NOT NULL
) AS sales_team ON TRUE
JOIN date 
    ON sales.transaction_date = date.date_id;
    );
  
  
[0m09:28:39.613521 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m09:28:39.615727 [debug] [Thread-1 (]: On model.my_dbt_project.sales_fact: ROLLBACK
[0m09:28:39.635153 [debug] [Thread-1 (]: Failed to rollback 'model.my_dbt_project.sales_fact'
[0m09:28:39.636586 [debug] [Thread-1 (]: On model.my_dbt_project.sales_fact: Close
[0m09:28:39.645099 [debug] [Thread-1 (]: Runtime Error in model sales_fact (models/facts/sales_fact.sql)
  Parser Error: syntax error at or near ";"
[0m09:28:39.646898 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a4835e7-c632-4bed-8bc9-78b976cd6257', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc4548c6b0>]}
[0m09:28:39.649166 [error] [Thread-1 (]: 6 of 6 ERROR creating sql table model main.sales_fact .......................... [[31mERROR[0m in 0.16s]
[0m09:28:39.653246 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.sales_fact
[0m09:28:39.655025 [debug] [Thread-4 (]: Marking all children of 'model.my_dbt_project.sales_fact' to be skipped because of status 'error'.  Reason: Runtime Error in model sales_fact (models/facts/sales_fact.sql)
  Parser Error: syntax error at or near ";".
[0m09:28:39.659414 [debug] [MainThread]: Using duckdb connection "master"
[0m09:28:39.660731 [debug] [MainThread]: On master: BEGIN
[0m09:28:39.662307 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:28:39.693479 [debug] [MainThread]: SQL status: OK in 0.031 seconds
[0m09:28:39.694890 [debug] [MainThread]: On master: COMMIT
[0m09:28:39.696508 [debug] [MainThread]: Using duckdb connection "master"
[0m09:28:39.698005 [debug] [MainThread]: On master: COMMIT
[0m09:28:39.700577 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m09:28:39.702463 [debug] [MainThread]: On master: Close
[0m09:28:39.707178 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:28:39.708393 [debug] [MainThread]: Connection 'list_sales_database_main' was properly closed.
[0m09:28:39.709530 [debug] [MainThread]: Connection 'model.my_dbt_project.sales_fact' was properly closed.
[0m09:28:39.711170 [info ] [MainThread]: 
[0m09:28:39.713038 [info ] [MainThread]: Finished running 2 table models, 4 view models in 0 hours 0 minutes and 2.67 seconds (2.67s).
[0m09:28:39.718553 [debug] [MainThread]: Command end result
[0m09:28:39.812986 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m09:28:39.825424 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m09:28:39.855385 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dags/dbt_models/target/run_results.json
[0m09:28:39.856908 [info ] [MainThread]: 
[0m09:28:39.858575 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m09:28:39.860273 [info ] [MainThread]: 
[0m09:28:39.862130 [error] [MainThread]:   Runtime Error in model sales_fact (models/facts/sales_fact.sql)
  Parser Error: syntax error at or near ";"
[0m09:28:39.863413 [info ] [MainThread]: 
[0m09:28:39.865240 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m09:28:39.870226 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 6.667389, "process_in_blocks": "142688", "process_kernel_time": 2.169725, "process_mem_max_rss": "160868", "process_out_blocks": "0", "process_user_time": 14.028227}
[0m09:28:39.872492 [debug] [MainThread]: Command `dbt run` failed at 09:28:39.872161 after 6.67 seconds
[0m09:28:39.874252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc4cfd45c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc4d51ae10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc4c68e0f0>]}
[0m09:28:39.876108 [debug] [MainThread]: Flushing usage events
[0m09:28:41.484161 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:31:29.924179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f399b55b2f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f399c73ca70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f399b5582c0>]}


============================== 09:31:30.018444 | 4f5fba8c-b2ac-411c-b6b5-06e2df5ee4b8 ==============================
[0m09:31:30.018444 [info ] [MainThread]: Running with dbt=1.9.1
[0m09:31:30.024301 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dags/dbt_models/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt/profiles.yml', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt/profiles.yml --target dev', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:31:32.972333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4f5fba8c-b2ac-411c-b6b5-06e2df5ee4b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f399b1fe5a0>]}
[0m09:31:33.245706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4f5fba8c-b2ac-411c-b6b5-06e2df5ee4b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f399b8922d0>]}
[0m09:31:33.353213 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m09:31:35.039503 [debug] [MainThread]: checksum: cac3b9519010e47bfbeb71ca6efb4867dae2858687671594dc23fefc94ecf25d, vars: {}, profile: , target: dev, version: 1.9.1
[0m09:31:36.512866 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:31:36.535049 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:31:36.936724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4f5fba8c-b2ac-411c-b6b5-06e2df5ee4b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3995717920>]}
[0m09:31:37.807696 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m09:31:37.923789 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m09:31:38.407053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4f5fba8c-b2ac-411c-b6b5-06e2df5ee4b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f399b1fe6f0>]}
[0m09:31:38.463419 [info ] [MainThread]: Found 6 models, 1 source, 424 macros
[0m09:31:38.477911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4f5fba8c-b2ac-411c-b6b5-06e2df5ee4b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3995585490>]}
[0m09:31:38.507120 [info ] [MainThread]: 
[0m09:31:38.534088 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:31:38.539388 [info ] [MainThread]: 
[0m09:31:38.554882 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m09:31:38.646499 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_sales_database'
[0m09:31:39.338593 [debug] [ThreadPool]: Using duckdb connection "list_sales_database"
[0m09:31:39.398306 [debug] [ThreadPool]: On list_sales_database: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "list_sales_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"sales_database"'
    
  
  
[0m09:31:39.498906 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:32:31.220712 [debug] [ThreadPool]: SQL status: OK in 51.762 seconds
[0m09:32:31.236338 [debug] [ThreadPool]: On list_sales_database: Close
[0m09:32:31.271224 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_database, now create_sales_database_main)
[0m09:32:31.273983 [debug] [ThreadPool]: Creating schema "database: "sales_database"
schema: "main"
"
[0m09:32:31.315996 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m09:32:31.323494 [debug] [ThreadPool]: On create_sales_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "create_sales_database_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='sales_database'
        and type='sqlite'
    
  
[0m09:32:31.330938 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:32:31.460346 [debug] [ThreadPool]: SQL status: OK in 0.129 seconds
[0m09:32:31.497458 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m09:32:31.509173 [debug] [ThreadPool]: On create_sales_database_main: BEGIN
[0m09:32:31.555465 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:32:31.576871 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m09:32:31.592998 [debug] [ThreadPool]: On create_sales_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "create_sales_database_main"} */

    
    
        create schema if not exists "sales_database"."main"
    
[0m09:32:31.622144 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:32:31.626300 [debug] [ThreadPool]: On create_sales_database_main: COMMIT
[0m09:32:31.629030 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m09:32:31.631401 [debug] [ThreadPool]: On create_sales_database_main: COMMIT
[0m09:32:31.643896 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:32:31.657077 [debug] [ThreadPool]: On create_sales_database_main: Close
[0m09:32:31.785136 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_sales_database_main'
[0m09:32:31.911261 [debug] [ThreadPool]: Using duckdb connection "list_sales_database_main"
[0m09:32:31.934575 [debug] [ThreadPool]: On list_sales_database_main: BEGIN
[0m09:32:32.015192 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:32:32.417882 [debug] [ThreadPool]: SQL status: OK in 0.403 seconds
[0m09:32:32.432830 [debug] [ThreadPool]: Using duckdb connection "list_sales_database_main"
[0m09:32:32.438071 [debug] [ThreadPool]: On list_sales_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "list_sales_database_main"} */
select
      'sales_database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'sales_database'
  
[0m09:32:33.043136 [debug] [ThreadPool]: SQL status: OK in 0.601 seconds
[0m09:32:33.050217 [debug] [ThreadPool]: On list_sales_database_main: ROLLBACK
[0m09:32:33.090924 [debug] [ThreadPool]: Failed to rollback 'list_sales_database_main'
[0m09:32:33.095946 [debug] [ThreadPool]: On list_sales_database_main: Close
[0m09:32:33.164431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4f5fba8c-b2ac-411c-b6b5-06e2df5ee4b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f399576c0b0>]}
[0m09:32:33.179215 [debug] [MainThread]: Using duckdb connection "master"
[0m09:32:33.182097 [debug] [MainThread]: On master: BEGIN
[0m09:32:33.198959 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:32:33.489513 [debug] [MainThread]: SQL status: OK in 0.291 seconds
[0m09:32:33.502585 [debug] [MainThread]: On master: COMMIT
[0m09:32:33.505914 [debug] [MainThread]: Using duckdb connection "master"
[0m09:32:33.523227 [debug] [MainThread]: On master: COMMIT
[0m09:32:33.563197 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m09:32:33.602936 [debug] [MainThread]: On master: Close
[0m09:32:33.649547 [debug] [Thread-1 (]: Began running node model.my_dbt_project.customer_dimension
[0m09:32:33.654427 [info ] [Thread-1 (]: 1 of 6 START sql view model main.customer_dimension ............................ [RUN]
[0m09:32:33.670030 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.my_dbt_project.customer_dimension'
[0m09:32:33.676462 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.customer_dimension
[0m09:32:33.758151 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.customer_dimension"
[0m09:32:33.834045 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.customer_dimension
[0m09:32:34.277903 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.customer_dimension"
[0m09:32:34.371238 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m09:32:34.382890 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: BEGIN
[0m09:32:34.388881 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m09:32:34.694542 [debug] [Thread-1 (]: SQL status: OK in 0.305 seconds
[0m09:32:34.709219 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m09:32:34.712371 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */

  
  create view "sales_database"."main"."customer_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
    DISTINCT
    customer AS customer_id,
    customer_name,
    customer_address,
    customer_group,
    territory,
    language AS customer_language
FROM sales
WHERE customer IS NOT NULL
  );

[0m09:32:34.730635 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m09:32:34.868189 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m09:32:34.872387 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */
alter view "sales_database"."main"."customer_dimension" rename to "customer_dimension__dbt_backup"
[0m09:32:34.903805 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:32:34.970503 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m09:32:34.979985 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */
alter view "sales_database"."main"."customer_dimension__dbt_tmp" rename to "customer_dimension"
[0m09:32:35.000659 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:32:35.155054 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: COMMIT
[0m09:32:35.168000 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m09:32:35.171111 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: COMMIT
[0m09:32:35.202054 [debug] [Thread-1 (]: SQL status: OK in 0.016 seconds
[0m09:32:35.242763 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m09:32:35.256027 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */
drop view if exists "sales_database"."main"."customer_dimension__dbt_backup" cascade
[0m09:32:35.263015 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m09:32:35.296654 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: Close
[0m09:32:35.487545 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f5fba8c-b2ac-411c-b6b5-06e2df5ee4b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f399483e960>]}
[0m09:32:35.499271 [info ] [Thread-1 (]: 1 of 6 OK created sql view model main.customer_dimension ....................... [[32mOK[0m in 1.81s]
[0m09:32:35.504859 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.customer_dimension
[0m09:32:35.507360 [debug] [Thread-1 (]: Began running node model.my_dbt_project.date_dimension
[0m09:32:35.517730 [info ] [Thread-1 (]: 2 of 6 START sql view model main.date_dimension ................................ [RUN]
[0m09:32:35.521404 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customer_dimension, now model.my_dbt_project.date_dimension)
[0m09:32:35.523547 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.date_dimension
[0m09:32:35.555061 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.date_dimension"
[0m09:32:35.670080 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.date_dimension
[0m09:32:35.707308 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.date_dimension"
[0m09:32:35.754439 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m09:32:35.758529 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: BEGIN
[0m09:32:35.760841 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:32:35.891499 [debug] [Thread-1 (]: SQL status: OK in 0.131 seconds
[0m09:32:35.903810 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m09:32:35.906893 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.date_dimension"} */

  
  create view "sales_database"."main"."date_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
    transaction_date,
    strftime(transaction_date, '%A') AS weekday_name,  -- Extract weekday name
    strftime(transaction_date, '%m') AS month,          -- Extract month (numeric)
    strftime(transaction_date, '%Y') AS year,           -- Extract year
    strftime(transaction_date, '%d') AS day,            -- Extract day
    EXTRACT(QUARTER FROM transaction_date) AS quarter   -- Extract quarter
FROM sales
WHERE transaction_date IS NOT NULL
  );

[0m09:32:35.924485 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m09:32:35.961749 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m09:32:35.964449 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.date_dimension"} */
alter view "sales_database"."main"."date_dimension" rename to "date_dimension__dbt_backup"
[0m09:32:35.989315 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m09:32:36.031018 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m09:32:36.044574 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.date_dimension"} */
alter view "sales_database"."main"."date_dimension__dbt_tmp" rename to "date_dimension"
[0m09:32:36.049362 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:32:36.074145 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: COMMIT
[0m09:32:36.087155 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m09:32:36.103724 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: COMMIT
[0m09:32:36.221412 [debug] [Thread-1 (]: SQL status: OK in 0.105 seconds
[0m09:32:36.276043 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m09:32:36.279874 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.date_dimension"} */
drop view if exists "sales_database"."main"."date_dimension__dbt_backup" cascade
[0m09:32:36.311426 [debug] [Thread-1 (]: SQL status: OK in 0.029 seconds
[0m09:32:36.334826 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: Close
[0m09:32:36.495258 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f5fba8c-b2ac-411c-b6b5-06e2df5ee4b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3994884800>]}
[0m09:32:36.506718 [info ] [Thread-1 (]: 2 of 6 OK created sql view model main.date_dimension ........................... [[32mOK[0m in 0.97s]
[0m09:32:36.520152 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.date_dimension
[0m09:32:36.539698 [debug] [Thread-1 (]: Began running node model.my_dbt_project.product_dimension
[0m09:32:36.578989 [info ] [Thread-1 (]: 3 of 6 START sql view model main.product_dimension ............................. [RUN]
[0m09:32:36.587142 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.date_dimension, now model.my_dbt_project.product_dimension)
[0m09:32:36.589643 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.product_dimension
[0m09:32:36.611383 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.product_dimension"
[0m09:32:36.661486 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.product_dimension
[0m09:32:36.686771 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.product_dimension"
[0m09:32:36.786521 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m09:32:36.799684 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: BEGIN
[0m09:32:36.805560 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:32:37.004481 [debug] [Thread-1 (]: SQL status: OK in 0.199 seconds
[0m09:32:37.007051 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m09:32:37.020503 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.product_dimension"} */

  
  create view "sales_database"."main"."product_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * 
    FROM "sales_database"."main"."sales"
)

SELECT 
    sales.name,
    json_extract(items, '$[0].name') AS product_name,  -- Example to extract the first element's "name" field from JSON array
    json_extract(items, '$[0].item_code') AS product_item_code
FROM sales
WHERE json_extract(items, '$[0].name') IS NOT NULL  -- Filter to only keep rows with a non-null product name
  );

[0m09:32:37.025399 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m09:32:37.046892 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m09:32:37.058535 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.product_dimension"} */
alter view "sales_database"."main"."product_dimension" rename to "product_dimension__dbt_backup"
[0m09:32:37.062647 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:32:37.101165 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m09:32:37.109525 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.product_dimension"} */
alter view "sales_database"."main"."product_dimension__dbt_tmp" rename to "product_dimension"
[0m09:32:37.119440 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:32:37.136243 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: COMMIT
[0m09:32:37.152886 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m09:32:37.156095 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: COMMIT
[0m09:32:37.253222 [debug] [Thread-1 (]: SQL status: OK in 0.091 seconds
[0m09:32:37.287327 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m09:32:37.301361 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.product_dimension"} */
drop view if exists "sales_database"."main"."product_dimension__dbt_backup" cascade
[0m09:32:37.323177 [debug] [Thread-1 (]: SQL status: OK in 0.018 seconds
[0m09:32:37.341363 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: Close
[0m09:32:37.709197 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f5fba8c-b2ac-411c-b6b5-06e2df5ee4b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39948d3f20>]}
[0m09:32:37.723848 [info ] [Thread-1 (]: 3 of 6 OK created sql view model main.product_dimension ........................ [[32mOK[0m in 1.12s]
[0m09:32:37.737392 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.product_dimension
[0m09:32:37.739309 [debug] [Thread-1 (]: Began running node model.my_dbt_project.sales_team_dimension
[0m09:32:37.742088 [info ] [Thread-1 (]: 4 of 6 START sql view model main.sales_team_dimension .......................... [RUN]
[0m09:32:37.749137 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.product_dimension, now model.my_dbt_project.sales_team_dimension)
[0m09:32:37.755059 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.sales_team_dimension
[0m09:32:37.795988 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.sales_team_dimension"
[0m09:32:37.919979 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.sales_team_dimension
[0m09:32:37.975280 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.sales_team_dimension"
[0m09:32:38.108158 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m09:32:38.110785 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: BEGIN
[0m09:32:38.113113 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:32:38.279777 [debug] [Thread-1 (]: SQL status: OK in 0.167 seconds
[0m09:32:38.285170 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m09:32:38.293819 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */

  
  create view "sales_database"."main"."sales_team_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
    DISTINCT
    sales_team->>'name' AS sales_team_id,
    sales_team->>'region' AS sales_team_region
FROM sales
WHERE sales_team IS NOT NULL
  );

[0m09:32:38.299431 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m09:32:38.337303 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m09:32:38.353296 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */
alter view "sales_database"."main"."sales_team_dimension" rename to "sales_team_dimension__dbt_backup"
[0m09:32:38.356433 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:32:38.372941 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m09:32:38.375013 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */
alter view "sales_database"."main"."sales_team_dimension__dbt_tmp" rename to "sales_team_dimension"
[0m09:32:38.379860 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:32:38.394179 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: COMMIT
[0m09:32:38.396386 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m09:32:38.403707 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: COMMIT
[0m09:32:38.425162 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m09:32:38.436854 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m09:32:38.440668 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */
drop view if exists "sales_database"."main"."sales_team_dimension__dbt_backup" cascade
[0m09:32:38.449169 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m09:32:38.458126 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: Close
[0m09:32:38.567410 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f5fba8c-b2ac-411c-b6b5-06e2df5ee4b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3994921f70>]}
[0m09:32:38.579387 [info ] [Thread-1 (]: 4 of 6 OK created sql view model main.sales_team_dimension ..................... [[32mOK[0m in 0.82s]
[0m09:32:38.597605 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.sales_team_dimension
[0m09:32:38.599908 [debug] [Thread-1 (]: Began running node model.my_dbt_project.transform_sales
[0m09:32:38.618201 [info ] [Thread-1 (]: 5 of 6 START sql table model main.transform_sales .............................. [RUN]
[0m09:32:38.633794 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.sales_team_dimension, now model.my_dbt_project.transform_sales)
[0m09:32:38.639726 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.transform_sales
[0m09:32:38.670308 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.transform_sales"
[0m09:32:38.706461 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.transform_sales
[0m09:32:38.859520 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.transform_sales"
[0m09:32:38.884586 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m09:32:38.888430 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: BEGIN
[0m09:32:38.890959 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:32:38.976190 [debug] [Thread-1 (]: SQL status: OK in 0.085 seconds
[0m09:32:38.978236 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m09:32:38.980793 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */

  
    
    

    create  table
      "sales_database"."main"."transform_sales__dbt_tmp"
  
    as (
      -- /opt/airflow/dags/dbt_models/transform_users.sql


WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
   *
FROM sales
WHERE name = 'ABC private LTD-0002'
    );
  
  
[0m09:32:39.050017 [debug] [Thread-1 (]: SQL status: OK in 0.061 seconds
[0m09:32:39.076979 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m09:32:39.079445 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */
alter table "sales_database"."main"."transform_sales" rename to "transform_sales__dbt_backup"
[0m09:32:39.094793 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m09:32:39.115745 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m09:32:39.117942 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */
alter table "sales_database"."main"."transform_sales__dbt_tmp" rename to "transform_sales"
[0m09:32:39.126181 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m09:32:39.169298 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: COMMIT
[0m09:32:39.185710 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m09:32:39.196922 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: COMMIT
[0m09:32:39.422633 [debug] [Thread-1 (]: SQL status: OK in 0.205 seconds
[0m09:32:39.460049 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m09:32:39.489545 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */
drop table if exists "sales_database"."main"."transform_sales__dbt_backup" cascade
[0m09:32:39.523403 [debug] [Thread-1 (]: SQL status: OK in 0.026 seconds
[0m09:32:39.540640 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: Close
[0m09:32:39.882163 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f5fba8c-b2ac-411c-b6b5-06e2df5ee4b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39948af920>]}
[0m09:32:39.892736 [info ] [Thread-1 (]: 5 of 6 OK created sql table model main.transform_sales ......................... [[32mOK[0m in 1.25s]
[0m09:32:39.899160 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.transform_sales
[0m09:32:39.901814 [debug] [Thread-1 (]: Began running node model.my_dbt_project.sales_fact
[0m09:32:39.914396 [info ] [Thread-1 (]: 6 of 6 START sql table model main.sales_fact ................................... [RUN]
[0m09:32:39.917599 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.transform_sales, now model.my_dbt_project.sales_fact)
[0m09:32:39.919713 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.sales_fact
[0m09:32:39.952191 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.sales_fact"
[0m09:32:39.977860 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.sales_fact
[0m09:32:40.010150 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.sales_fact"
[0m09:32:40.039204 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_fact"
[0m09:32:40.041183 [debug] [Thread-1 (]: On model.my_dbt_project.sales_fact: BEGIN
[0m09:32:40.043307 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:32:40.124892 [debug] [Thread-1 (]: SQL status: OK in 0.081 seconds
[0m09:32:40.127049 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_fact"
[0m09:32:40.129730 [debug] [Thread-1 (]: On model.my_dbt_project.sales_fact: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_fact"} */

  
    
    

    create  table
      "sales_database"."main"."sales_fact__dbt_tmp"
  
    as (
      WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
),
customer AS (
    SELECT * FROM "sales_database"."main"."customer_dimension"
),
product AS (
    SELECT * FROM "sales_database"."main"."product_dimension"
),
sales_team AS (
    SELECT * FROM "sales_database"."main"."sales_team_dimension"
),
date AS (
    SELECT * FROM "sales_database"."main"."date_dimension"
)

SELECT
    sales.name AS sales_id,
    customer.customer_id,
    product.product_id,
    sales_team.sales_team_id,
    date.date_id,
    sales.total_qty,
    sales.total_net_weight,
    sales.total,
    sales.net_total,
    sales.grand_total,
    sales.tax_category
FROM sales
JOIN customer 
    ON sales.customer = customer.customer_id
-- Handling product as a lateral join
JOIN LATERAL (
    SELECT item->>'product_id' AS product_id
    FROM jsonb_array_elements(sales.items) AS product(item)
    WHERE item->>'product_id' IS NOT NULL
) AS product ON TRUE
-- Handling sales_team as a lateral join
JOIN LATERAL (
    SELECT item->>'sales_team_id' AS sales_team_id
    FROM jsonb_array_elements(sales.sales_team) AS team(item)
    WHERE item->>'sales_team_id' IS NOT NULL
) AS sales_team ON TRUE
JOIN date 
    ON sales.transaction_date = date.date_id;
    );
  
  
[0m09:32:40.154574 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_fact"} */

  
    
    

    create  table
      "sales_database"."main"."sales_fact__dbt_tmp"
  
    as (
      WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
),
customer AS (
    SELECT * FROM "sales_database"."main"."customer_dimension"
),
product AS (
    SELECT * FROM "sales_database"."main"."product_dimension"
),
sales_team AS (
    SELECT * FROM "sales_database"."main"."sales_team_dimension"
),
date AS (
    SELECT * FROM "sales_database"."main"."date_dimension"
)

SELECT
    sales.name AS sales_id,
    customer.customer_id,
    product.product_id,
    sales_team.sales_team_id,
    date.date_id,
    sales.total_qty,
    sales.total_net_weight,
    sales.total,
    sales.net_total,
    sales.grand_total,
    sales.tax_category
FROM sales
JOIN customer 
    ON sales.customer = customer.customer_id
-- Handling product as a lateral join
JOIN LATERAL (
    SELECT item->>'product_id' AS product_id
    FROM jsonb_array_elements(sales.items) AS product(item)
    WHERE item->>'product_id' IS NOT NULL
) AS product ON TRUE
-- Handling sales_team as a lateral join
JOIN LATERAL (
    SELECT item->>'sales_team_id' AS sales_team_id
    FROM jsonb_array_elements(sales.sales_team) AS team(item)
    WHERE item->>'sales_team_id' IS NOT NULL
) AS sales_team ON TRUE
JOIN date 
    ON sales.transaction_date = date.date_id;
    );
  
  
[0m09:32:40.157058 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m09:32:40.159801 [debug] [Thread-1 (]: On model.my_dbt_project.sales_fact: ROLLBACK
[0m09:32:40.208253 [debug] [Thread-1 (]: Failed to rollback 'model.my_dbt_project.sales_fact'
[0m09:32:40.210620 [debug] [Thread-1 (]: On model.my_dbt_project.sales_fact: Close
[0m09:32:40.239733 [debug] [Thread-1 (]: Runtime Error in model sales_fact (models/facts/sales_fact.sql)
  Parser Error: syntax error at or near ";"
[0m09:32:40.243277 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f5fba8c-b2ac-411c-b6b5-06e2df5ee4b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39948f2030>]}
[0m09:32:40.246709 [error] [Thread-1 (]: 6 of 6 ERROR creating sql table model main.sales_fact .......................... [[31mERROR[0m in 0.33s]
[0m09:32:40.250882 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.sales_fact
[0m09:32:40.253869 [debug] [Thread-4 (]: Marking all children of 'model.my_dbt_project.sales_fact' to be skipped because of status 'error'.  Reason: Runtime Error in model sales_fact (models/facts/sales_fact.sql)
  Parser Error: syntax error at or near ";".
[0m09:32:40.262254 [debug] [MainThread]: Using duckdb connection "master"
[0m09:32:40.266072 [debug] [MainThread]: On master: BEGIN
[0m09:32:40.268164 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:32:40.331050 [debug] [MainThread]: SQL status: OK in 0.063 seconds
[0m09:32:40.342489 [debug] [MainThread]: On master: COMMIT
[0m09:32:40.356573 [debug] [MainThread]: Using duckdb connection "master"
[0m09:32:40.360086 [debug] [MainThread]: On master: COMMIT
[0m09:32:40.363655 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m09:32:40.368050 [debug] [MainThread]: On master: Close
[0m09:32:40.385621 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:32:40.387636 [debug] [MainThread]: Connection 'create_sales_database_main' was properly closed.
[0m09:32:40.399109 [debug] [MainThread]: Connection 'list_sales_database_main' was properly closed.
[0m09:32:40.402978 [debug] [MainThread]: Connection 'model.my_dbt_project.sales_fact' was properly closed.
[0m09:32:40.417935 [info ] [MainThread]: 
[0m09:32:40.436069 [info ] [MainThread]: Finished running 2 table models, 4 view models in 0 hours 1 minutes and 1.87 seconds (61.87s).
[0m09:32:40.455387 [debug] [MainThread]: Command end result
[0m09:32:40.637696 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m09:32:40.658340 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m09:32:40.711122 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dags/dbt_models/target/run_results.json
[0m09:32:40.714077 [info ] [MainThread]: 
[0m09:32:40.722878 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m09:32:40.727606 [info ] [MainThread]: 
[0m09:32:40.730514 [error] [MainThread]:   Runtime Error in model sales_fact (models/facts/sales_fact.sql)
  Parser Error: syntax error at or near ";"
[0m09:32:40.733374 [info ] [MainThread]: 
[0m09:32:40.738331 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m09:32:40.744978 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 71.46731, "process_in_blocks": "3660496", "process_kernel_time": 11.155402, "process_mem_max_rss": "139344", "process_out_blocks": "0", "process_user_time": 14.973029}
[0m09:32:40.749293 [debug] [MainThread]: Command `dbt run` failed at 09:32:40.748597 after 71.47 seconds
[0m09:32:40.753553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f399be49580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f399bf9e120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f399c8a82f0>]}
[0m09:32:40.755978 [debug] [MainThread]: Flushing usage events
[0m09:32:42.419804 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:49:05.511633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e13be2600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e13638ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e13638da0>]}


============================== 09:49:05.600347 | 390cf7c8-981f-4e75-b969-0a728d136c67 ==============================
[0m09:49:05.600347 [info ] [MainThread]: Running with dbt=1.9.1
[0m09:49:05.608747 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/profiles.yml', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dags/dbt_models/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt/profiles.yml --target dev', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:49:08.863781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '390cf7c8-981f-4e75-b969-0a728d136c67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e13637110>]}
[0m09:49:09.287974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '390cf7c8-981f-4e75-b969-0a728d136c67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e13afd310>]}
[0m09:49:09.381282 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m09:49:10.520866 [debug] [MainThread]: checksum: cac3b9519010e47bfbeb71ca6efb4867dae2858687671594dc23fefc94ecf25d, vars: {}, profile: , target: dev, version: 1.9.1
[0m09:49:14.147500 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:49:14.151131 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/facts/sales_fact.sql
[0m09:49:16.393849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '390cf7c8-981f-4e75-b969-0a728d136c67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e0dbecd70>]}
[0m09:49:17.263596 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m09:49:17.342908 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m09:49:18.248677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '390cf7c8-981f-4e75-b969-0a728d136c67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e0cb44f80>]}
[0m09:49:18.265607 [info ] [MainThread]: Found 6 models, 1 source, 424 macros
[0m09:49:18.274496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '390cf7c8-981f-4e75-b969-0a728d136c67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e0d6b28d0>]}
[0m09:49:18.297520 [info ] [MainThread]: 
[0m09:49:18.327539 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:49:18.340344 [info ] [MainThread]: 
[0m09:49:18.353036 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m09:49:18.390148 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_sales_database'
[0m09:49:19.384996 [debug] [ThreadPool]: Using duckdb connection "list_sales_database"
[0m09:49:19.401671 [debug] [ThreadPool]: On list_sales_database: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "list_sales_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"sales_database"'
    
  
  
[0m09:49:19.419113 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:49:20.422216 [debug] [ThreadPool]: SQL status: OK in 1.003 seconds
[0m09:49:20.451809 [debug] [ThreadPool]: On list_sales_database: Close
[0m09:49:20.498013 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_database, now create_sales_database_main)
[0m09:49:20.501724 [debug] [ThreadPool]: Creating schema "database: "sales_database"
schema: "main"
"
[0m09:49:20.611853 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m09:49:20.613682 [debug] [ThreadPool]: On create_sales_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "create_sales_database_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='sales_database'
        and type='sqlite'
    
  
[0m09:49:20.615457 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:49:20.786689 [debug] [ThreadPool]: SQL status: OK in 0.171 seconds
[0m09:49:20.802170 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m09:49:20.815119 [debug] [ThreadPool]: On create_sales_database_main: BEGIN
[0m09:49:20.818585 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:49:20.831019 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m09:49:20.836435 [debug] [ThreadPool]: On create_sales_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "create_sales_database_main"} */

    
    
        create schema if not exists "sales_database"."main"
    
[0m09:49:20.851352 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m09:49:20.865639 [debug] [ThreadPool]: On create_sales_database_main: COMMIT
[0m09:49:20.879453 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m09:49:20.881642 [debug] [ThreadPool]: On create_sales_database_main: COMMIT
[0m09:49:20.884625 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:49:20.897383 [debug] [ThreadPool]: On create_sales_database_main: Close
[0m09:49:20.943631 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_sales_database_main, now list_sales_database_main)
[0m09:49:21.021718 [debug] [ThreadPool]: Using duckdb connection "list_sales_database_main"
[0m09:49:21.037146 [debug] [ThreadPool]: On list_sales_database_main: BEGIN
[0m09:49:21.052651 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:49:21.146689 [debug] [ThreadPool]: SQL status: OK in 0.094 seconds
[0m09:49:21.148772 [debug] [ThreadPool]: Using duckdb connection "list_sales_database_main"
[0m09:49:21.150873 [debug] [ThreadPool]: On list_sales_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "list_sales_database_main"} */
select
      'sales_database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'sales_database'
  
[0m09:49:21.452351 [debug] [ThreadPool]: SQL status: OK in 0.271 seconds
[0m09:49:21.458529 [debug] [ThreadPool]: On list_sales_database_main: ROLLBACK
[0m09:49:21.464403 [debug] [ThreadPool]: Failed to rollback 'list_sales_database_main'
[0m09:49:21.468510 [debug] [ThreadPool]: On list_sales_database_main: Close
[0m09:49:21.510424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '390cf7c8-981f-4e75-b969-0a728d136c67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e14985b80>]}
[0m09:49:21.523254 [debug] [MainThread]: Using duckdb connection "master"
[0m09:49:21.525598 [debug] [MainThread]: On master: BEGIN
[0m09:49:21.538842 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:49:21.643905 [debug] [MainThread]: SQL status: OK in 0.106 seconds
[0m09:49:21.660542 [debug] [MainThread]: On master: COMMIT
[0m09:49:21.669569 [debug] [MainThread]: Using duckdb connection "master"
[0m09:49:21.674862 [debug] [MainThread]: On master: COMMIT
[0m09:49:21.687613 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m09:49:21.689911 [debug] [MainThread]: On master: Close
[0m09:49:21.715340 [debug] [Thread-1 (]: Began running node model.my_dbt_project.customer_dimension
[0m09:49:21.718255 [info ] [Thread-1 (]: 1 of 6 START sql view model main.customer_dimension ............................ [RUN]
[0m09:49:21.730470 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.my_dbt_project.customer_dimension'
[0m09:49:21.732846 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.customer_dimension
[0m09:49:21.815599 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.customer_dimension"
[0m09:49:21.844128 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.customer_dimension
[0m09:49:22.065642 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.customer_dimension"
[0m09:49:22.098431 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m09:49:22.101418 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: BEGIN
[0m09:49:22.105210 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m09:49:22.225931 [debug] [Thread-1 (]: SQL status: OK in 0.121 seconds
[0m09:49:22.230631 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m09:49:22.232807 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */

  
  create view "sales_database"."main"."customer_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
    DISTINCT
    customer AS customer_id,
    customer_name,
    customer_address,
    customer_group,
    territory,
    language AS customer_language
FROM sales
WHERE customer IS NOT NULL
  );

[0m09:49:22.238738 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m09:49:22.265552 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m09:49:22.268374 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */
alter view "sales_database"."main"."customer_dimension" rename to "customer_dimension__dbt_backup"
[0m09:49:22.272413 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:49:22.292638 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m09:49:22.301714 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */
alter view "sales_database"."main"."customer_dimension__dbt_tmp" rename to "customer_dimension"
[0m09:49:22.311416 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m09:49:22.460514 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: COMMIT
[0m09:49:22.462219 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m09:49:22.464134 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: COMMIT
[0m09:49:22.488254 [debug] [Thread-1 (]: SQL status: OK in 0.020 seconds
[0m09:49:22.513078 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m09:49:22.515279 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */
drop view if exists "sales_database"."main"."customer_dimension__dbt_backup" cascade
[0m09:49:22.529864 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m09:49:22.546058 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: Close
[0m09:49:22.646900 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '390cf7c8-981f-4e75-b969-0a728d136c67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8df7eafe00>]}
[0m09:49:22.649636 [info ] [Thread-1 (]: 1 of 6 OK created sql view model main.customer_dimension ....................... [[32mOK[0m in 0.91s]
[0m09:49:22.655932 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.customer_dimension
[0m09:49:22.658628 [debug] [Thread-1 (]: Began running node model.my_dbt_project.date_dimension
[0m09:49:22.665661 [info ] [Thread-1 (]: 2 of 6 START sql view model main.date_dimension ................................ [RUN]
[0m09:49:22.670868 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customer_dimension, now model.my_dbt_project.date_dimension)
[0m09:49:22.673376 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.date_dimension
[0m09:49:22.700671 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.date_dimension"
[0m09:49:22.734433 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.date_dimension
[0m09:49:22.767573 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.date_dimension"
[0m09:49:22.852882 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m09:49:22.856794 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: BEGIN
[0m09:49:22.859069 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:49:22.911505 [debug] [Thread-1 (]: SQL status: OK in 0.052 seconds
[0m09:49:22.914407 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m09:49:22.917781 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.date_dimension"} */

  
  create view "sales_database"."main"."date_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
    transaction_date,
    strftime(transaction_date, '%A') AS weekday_name,  -- Extract weekday name
    strftime(transaction_date, '%m') AS month,          -- Extract month (numeric)
    strftime(transaction_date, '%Y') AS year,           -- Extract year
    strftime(transaction_date, '%d') AS day,            -- Extract day
    EXTRACT(QUARTER FROM transaction_date) AS quarter   -- Extract quarter
FROM sales
WHERE transaction_date IS NOT NULL
  );

[0m09:49:22.922938 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m09:49:22.934912 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m09:49:22.938870 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.date_dimension"} */
alter view "sales_database"."main"."date_dimension" rename to "date_dimension__dbt_backup"
[0m09:49:22.942453 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:49:22.958923 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m09:49:22.961070 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.date_dimension"} */
alter view "sales_database"."main"."date_dimension__dbt_tmp" rename to "date_dimension"
[0m09:49:22.964166 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:49:22.977111 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: COMMIT
[0m09:49:22.979224 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m09:49:22.981552 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: COMMIT
[0m09:49:22.994316 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m09:49:23.006244 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m09:49:23.008557 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.date_dimension"} */
drop view if exists "sales_database"."main"."date_dimension__dbt_backup" cascade
[0m09:49:23.014160 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m09:49:23.019545 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: Close
[0m09:49:23.101282 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '390cf7c8-981f-4e75-b969-0a728d136c67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8df6309040>]}
[0m09:49:23.104052 [info ] [Thread-1 (]: 2 of 6 OK created sql view model main.date_dimension ........................... [[32mOK[0m in 0.43s]
[0m09:49:23.110207 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.date_dimension
[0m09:49:23.115395 [debug] [Thread-1 (]: Began running node model.my_dbt_project.product_dimension
[0m09:49:23.118179 [info ] [Thread-1 (]: 3 of 6 START sql view model main.product_dimension ............................. [RUN]
[0m09:49:23.122217 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.date_dimension, now model.my_dbt_project.product_dimension)
[0m09:49:23.124410 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.product_dimension
[0m09:49:23.138405 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.product_dimension"
[0m09:49:23.165156 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.product_dimension
[0m09:49:23.193236 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.product_dimension"
[0m09:49:23.219219 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m09:49:23.222455 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: BEGIN
[0m09:49:23.224510 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:49:23.313209 [debug] [Thread-1 (]: SQL status: OK in 0.089 seconds
[0m09:49:23.315338 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m09:49:23.317653 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.product_dimension"} */

  
  create view "sales_database"."main"."product_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * 
    FROM "sales_database"."main"."sales"
)

SELECT 
    sales.name,
    json_extract(items, '$[0].name') AS product_name,  -- Example to extract the first element's "name" field from JSON array
    json_extract(items, '$[0].item_code') AS product_item_code
FROM sales
WHERE json_extract(items, '$[0].name') IS NOT NULL  -- Filter to only keep rows with a non-null product name
  );

[0m09:49:23.322571 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m09:49:23.338352 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m09:49:23.340755 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.product_dimension"} */
alter view "sales_database"."main"."product_dimension" rename to "product_dimension__dbt_backup"
[0m09:49:23.349302 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m09:49:23.366136 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m09:49:23.369080 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.product_dimension"} */
alter view "sales_database"."main"."product_dimension__dbt_tmp" rename to "product_dimension"
[0m09:49:23.373573 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:49:23.384218 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: COMMIT
[0m09:49:23.390495 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m09:49:23.398128 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: COMMIT
[0m09:49:23.453054 [debug] [Thread-1 (]: SQL status: OK in 0.051 seconds
[0m09:49:23.462965 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m09:49:23.465129 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.product_dimension"} */
drop view if exists "sales_database"."main"."product_dimension__dbt_backup" cascade
[0m09:49:23.473256 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m09:49:23.478297 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: Close
[0m09:49:23.584860 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '390cf7c8-981f-4e75-b969-0a728d136c67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8df7e93980>]}
[0m09:49:23.592194 [info ] [Thread-1 (]: 3 of 6 OK created sql view model main.product_dimension ........................ [[32mOK[0m in 0.46s]
[0m09:49:23.595931 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.product_dimension
[0m09:49:23.598459 [debug] [Thread-1 (]: Began running node model.my_dbt_project.sales_team_dimension
[0m09:49:23.605270 [info ] [Thread-1 (]: 4 of 6 START sql view model main.sales_team_dimension .......................... [RUN]
[0m09:49:23.608794 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.product_dimension, now model.my_dbt_project.sales_team_dimension)
[0m09:49:23.611351 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.sales_team_dimension
[0m09:49:23.626328 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.sales_team_dimension"
[0m09:49:23.700163 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.sales_team_dimension
[0m09:49:23.733616 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.sales_team_dimension"
[0m09:49:23.784101 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m09:49:23.789044 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: BEGIN
[0m09:49:23.792734 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:49:23.840665 [debug] [Thread-1 (]: SQL status: OK in 0.048 seconds
[0m09:49:23.842577 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m09:49:23.844602 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */

  
  create view "sales_database"."main"."sales_team_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
    DISTINCT
    sales_team->>'name' AS sales_team_id,
    sales_team->>'region' AS sales_team_region
FROM sales
WHERE sales_team IS NOT NULL
  );

[0m09:49:23.848982 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m09:49:23.860148 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m09:49:23.861617 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */
alter view "sales_database"."main"."sales_team_dimension" rename to "sales_team_dimension__dbt_backup"
[0m09:49:23.866728 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:49:23.882425 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m09:49:23.885585 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */
alter view "sales_database"."main"."sales_team_dimension__dbt_tmp" rename to "sales_team_dimension"
[0m09:49:23.891269 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:49:23.897436 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: COMMIT
[0m09:49:23.901982 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m09:49:23.906670 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: COMMIT
[0m09:49:23.917154 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m09:49:23.928976 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m09:49:23.943056 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */
drop view if exists "sales_database"."main"."sales_team_dimension__dbt_backup" cascade
[0m09:49:23.968384 [debug] [Thread-1 (]: SQL status: OK in 0.023 seconds
[0m09:49:23.985189 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: Close
[0m09:49:24.209324 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '390cf7c8-981f-4e75-b969-0a728d136c67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8df63440b0>]}
[0m09:49:24.211998 [info ] [Thread-1 (]: 4 of 6 OK created sql view model main.sales_team_dimension ..................... [[32mOK[0m in 0.60s]
[0m09:49:24.225265 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.sales_team_dimension
[0m09:49:24.227742 [debug] [Thread-1 (]: Began running node model.my_dbt_project.transform_sales
[0m09:49:24.230667 [info ] [Thread-1 (]: 5 of 6 START sql table model main.transform_sales .............................. [RUN]
[0m09:49:24.245089 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.sales_team_dimension, now model.my_dbt_project.transform_sales)
[0m09:49:24.247145 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.transform_sales
[0m09:49:24.278675 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.transform_sales"
[0m09:49:24.359915 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.transform_sales
[0m09:49:24.604548 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.transform_sales"
[0m09:49:24.666749 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m09:49:24.668995 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: BEGIN
[0m09:49:24.672917 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:49:24.758302 [debug] [Thread-1 (]: SQL status: OK in 0.085 seconds
[0m09:49:24.791432 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m09:49:24.813103 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */

  
    
    

    create  table
      "sales_database"."main"."transform_sales__dbt_tmp"
  
    as (
      -- /opt/airflow/dags/dbt_models/transform_users.sql


WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
   *
FROM sales
WHERE name = 'ABC private LTD-0002'
    );
  
  
[0m09:49:24.866927 [debug] [Thread-1 (]: SQL status: OK in 0.048 seconds
[0m09:49:24.891105 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m09:49:24.900605 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */
alter table "sales_database"."main"."transform_sales" rename to "transform_sales__dbt_backup"
[0m09:49:24.912684 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:49:24.929568 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m09:49:24.940429 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */
alter table "sales_database"."main"."transform_sales__dbt_tmp" rename to "transform_sales"
[0m09:49:24.943872 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:49:24.979687 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: COMMIT
[0m09:49:24.985855 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m09:49:24.993845 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: COMMIT
[0m09:49:25.091290 [debug] [Thread-1 (]: SQL status: OK in 0.095 seconds
[0m09:49:25.111021 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m09:49:25.138751 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */
drop table if exists "sales_database"."main"."transform_sales__dbt_backup" cascade
[0m09:49:25.257263 [debug] [Thread-1 (]: SQL status: OK in 0.107 seconds
[0m09:49:25.275188 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: Close
[0m09:49:25.883260 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '390cf7c8-981f-4e75-b969-0a728d136c67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8df7f6f1a0>]}
[0m09:49:25.895513 [info ] [Thread-1 (]: 5 of 6 OK created sql table model main.transform_sales ......................... [[32mOK[0m in 1.64s]
[0m09:49:25.932603 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.transform_sales
[0m09:49:25.947574 [debug] [Thread-1 (]: Began running node model.my_dbt_project.sales_fact
[0m09:49:25.956334 [info ] [Thread-1 (]: 6 of 6 START sql table model main.sales_fact ................................... [RUN]
[0m09:49:25.965644 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.transform_sales, now model.my_dbt_project.sales_fact)
[0m09:49:25.979098 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.sales_fact
[0m09:49:26.004482 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.sales_fact"
[0m09:49:26.106461 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.sales_fact
[0m09:49:26.129727 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.sales_fact"
[0m09:49:26.174867 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_fact"
[0m09:49:26.176907 [debug] [Thread-1 (]: On model.my_dbt_project.sales_fact: BEGIN
[0m09:49:26.182086 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:49:26.267944 [debug] [Thread-1 (]: SQL status: OK in 0.086 seconds
[0m09:49:26.270050 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_fact"
[0m09:49:26.273039 [debug] [Thread-1 (]: On model.my_dbt_project.sales_fact: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_fact"} */

  
    
    

    create  table
      "sales_database"."main"."sales_fact__dbt_tmp"
  
    as (
      WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
),
customer AS (
    SELECT * FROM "sales_database"."main"."customer_dimension"
),
product AS (
    SELECT * FROM "sales_database"."main"."product_dimension"
),
sales_team AS (
    SELECT * FROM "sales_database"."main"."sales_team_dimension"
),
date AS (
    SELECT * FROM "sales_database"."main"."date_dimension"
)

SELECT
    sales.name AS sales_id,
    customer.customer_id,
    product.product_id,
    sales_team.sales_team_id,
    date.date_id,
    sales.total_qty,
    sales.total_net_weight,
    sales.total,
    sales.net_total,
    sales.grand_total,
    sales.tax_category
FROM sales
JOIN customer 
    ON sales.customer = customer.customer_id
-- Handling product as a lateral join
JOIN LATERAL (
    SELECT json_extract_string(items, '$[0].product_id') AS product_id
    FROM unnest(json_extract(sales.items, '$')) AS product(items)
    WHERE json_extract_string(items, '$[0].product_id') IS NOT NULL
) AS product ON TRUE
-- Handling sales_team as a lateral join
JOIN LATERAL (
    SELECT json_extract_string(sales_team, '$[0].sales_team_id') AS sales_team_id
    FROM unnest(json_extract(sales.sales_team, '$')) AS team(sales_team)
    WHERE json_extract_string(sales_team, '$[0].sales_team_id') IS NOT NULL
) AS sales_team ON TRUE
JOIN date 
    ON sales.transaction_date = date.date_id;
    );
  
  
[0m09:49:26.305469 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_fact"} */

  
    
    

    create  table
      "sales_database"."main"."sales_fact__dbt_tmp"
  
    as (
      WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
),
customer AS (
    SELECT * FROM "sales_database"."main"."customer_dimension"
),
product AS (
    SELECT * FROM "sales_database"."main"."product_dimension"
),
sales_team AS (
    SELECT * FROM "sales_database"."main"."sales_team_dimension"
),
date AS (
    SELECT * FROM "sales_database"."main"."date_dimension"
)

SELECT
    sales.name AS sales_id,
    customer.customer_id,
    product.product_id,
    sales_team.sales_team_id,
    date.date_id,
    sales.total_qty,
    sales.total_net_weight,
    sales.total,
    sales.net_total,
    sales.grand_total,
    sales.tax_category
FROM sales
JOIN customer 
    ON sales.customer = customer.customer_id
-- Handling product as a lateral join
JOIN LATERAL (
    SELECT json_extract_string(items, '$[0].product_id') AS product_id
    FROM unnest(json_extract(sales.items, '$')) AS product(items)
    WHERE json_extract_string(items, '$[0].product_id') IS NOT NULL
) AS product ON TRUE
-- Handling sales_team as a lateral join
JOIN LATERAL (
    SELECT json_extract_string(sales_team, '$[0].sales_team_id') AS sales_team_id
    FROM unnest(json_extract(sales.sales_team, '$')) AS team(sales_team)
    WHERE json_extract_string(sales_team, '$[0].sales_team_id') IS NOT NULL
) AS sales_team ON TRUE
JOIN date 
    ON sales.transaction_date = date.date_id;
    );
  
  
[0m09:49:26.314736 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m09:49:26.317249 [debug] [Thread-1 (]: On model.my_dbt_project.sales_fact: ROLLBACK
[0m09:49:26.402569 [debug] [Thread-1 (]: Failed to rollback 'model.my_dbt_project.sales_fact'
[0m09:49:26.415465 [debug] [Thread-1 (]: On model.my_dbt_project.sales_fact: Close
[0m09:49:26.441669 [debug] [Thread-1 (]: Runtime Error in model sales_fact (models/facts/sales_fact.sql)
  Parser Error: syntax error at or near ";"
[0m09:49:26.447677 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '390cf7c8-981f-4e75-b969-0a728d136c67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8df7eae840>]}
[0m09:49:26.450806 [error] [Thread-1 (]: 6 of 6 ERROR creating sql table model main.sales_fact .......................... [[31mERROR[0m in 0.48s]
[0m09:49:26.456828 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.sales_fact
[0m09:49:26.474104 [debug] [Thread-4 (]: Marking all children of 'model.my_dbt_project.sales_fact' to be skipped because of status 'error'.  Reason: Runtime Error in model sales_fact (models/facts/sales_fact.sql)
  Parser Error: syntax error at or near ";".
[0m09:49:26.493928 [debug] [MainThread]: Using duckdb connection "master"
[0m09:49:26.501344 [debug] [MainThread]: On master: BEGIN
[0m09:49:26.508692 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:49:27.083491 [debug] [MainThread]: SQL status: OK in 0.546 seconds
[0m09:49:27.101247 [debug] [MainThread]: On master: COMMIT
[0m09:49:27.119186 [debug] [MainThread]: Using duckdb connection "master"
[0m09:49:27.130243 [debug] [MainThread]: On master: COMMIT
[0m09:49:27.141225 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m09:49:27.155651 [debug] [MainThread]: On master: Close
[0m09:49:27.191763 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:49:27.204991 [debug] [MainThread]: Connection 'list_sales_database_main' was properly closed.
[0m09:49:27.209974 [debug] [MainThread]: Connection 'model.my_dbt_project.sales_fact' was properly closed.
[0m09:49:27.218238 [info ] [MainThread]: 
[0m09:49:27.226675 [info ] [MainThread]: Finished running 2 table models, 4 view models in 0 hours 0 minutes and 8.87 seconds (8.87s).
[0m09:49:27.246721 [debug] [MainThread]: Command end result
[0m09:49:27.732980 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m09:49:27.796641 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m09:49:28.129327 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dags/dbt_models/target/run_results.json
[0m09:49:28.143707 [info ] [MainThread]: 
[0m09:49:28.150353 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m09:49:28.176594 [info ] [MainThread]: 
[0m09:49:28.180376 [error] [MainThread]:   Runtime Error in model sales_fact (models/facts/sales_fact.sql)
  Parser Error: syntax error at or near ";"
[0m09:49:28.191249 [info ] [MainThread]: 
[0m09:49:28.195270 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m09:49:28.214640 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 23.381643, "process_in_blocks": "330600", "process_kernel_time": 5.88504, "process_mem_max_rss": "140916", "process_out_blocks": "0", "process_user_time": 15.552603}
[0m09:49:28.241438 [debug] [MainThread]: Command `dbt run` failed at 09:49:28.230324 after 23.40 seconds
[0m09:49:28.243657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e13637140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e14079df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e1407b200>]}
[0m09:49:28.247880 [debug] [MainThread]: Flushing usage events
[0m09:49:30.242471 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:55:42.797160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2038a26c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc205334080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2038a1eb0>]}


============================== 09:55:42.841277 | 7c225a6f-2ca7-48f1-a1b6-911afcad6d6d ==============================
[0m09:55:42.841277 [info ] [MainThread]: Running with dbt=1.9.1
[0m09:55:42.850527 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dags/dbt_models/logs', 'profiles_dir': '/opt/airflow/dbt/profiles.yml', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt/profiles.yml --target dev', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:55:45.289978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7c225a6f-2ca7-48f1-a1b6-911afcad6d6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc20538b350>]}
[0m09:55:45.707164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7c225a6f-2ca7-48f1-a1b6-911afcad6d6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc203e86f30>]}
[0m09:55:45.914023 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m09:55:47.862940 [debug] [MainThread]: checksum: cac3b9519010e47bfbeb71ca6efb4867dae2858687671594dc23fefc94ecf25d, vars: {}, profile: , target: dev, version: 1.9.1
[0m09:55:51.101521 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:55:51.105960 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/facts/sales_fact.sql
[0m09:55:52.796642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7c225a6f-2ca7-48f1-a1b6-911afcad6d6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1fcc77920>]}
[0m09:55:53.183106 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m09:55:53.200048 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m09:55:53.426472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7c225a6f-2ca7-48f1-a1b6-911afcad6d6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1fd79d010>]}
[0m09:55:53.428839 [info ] [MainThread]: Found 6 models, 1 source, 424 macros
[0m09:55:53.431973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7c225a6f-2ca7-48f1-a1b6-911afcad6d6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1fcc4a540>]}
[0m09:55:53.443195 [info ] [MainThread]: 
[0m09:55:53.447594 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:55:53.449782 [info ] [MainThread]: 
[0m09:55:53.452445 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m09:55:53.476747 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_sales_database'
[0m09:55:53.657958 [debug] [ThreadPool]: Using duckdb connection "list_sales_database"
[0m09:55:53.660174 [debug] [ThreadPool]: On list_sales_database: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "list_sales_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"sales_database"'
    
  
  
[0m09:55:53.662028 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:55:53.939252 [debug] [ThreadPool]: SQL status: OK in 0.277 seconds
[0m09:55:53.944500 [debug] [ThreadPool]: On list_sales_database: Close
[0m09:55:53.972188 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_database, now create_sales_database_main)
[0m09:55:53.974284 [debug] [ThreadPool]: Creating schema "database: "sales_database"
schema: "main"
"
[0m09:55:54.016197 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m09:55:54.018008 [debug] [ThreadPool]: On create_sales_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "create_sales_database_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='sales_database'
        and type='sqlite'
    
  
[0m09:55:54.019830 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:55:54.132559 [debug] [ThreadPool]: SQL status: OK in 0.112 seconds
[0m09:55:54.146093 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m09:55:54.148222 [debug] [ThreadPool]: On create_sales_database_main: BEGIN
[0m09:55:54.152381 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:55:54.160052 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m09:55:54.167113 [debug] [ThreadPool]: On create_sales_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "create_sales_database_main"} */

    
    
        create schema if not exists "sales_database"."main"
    
[0m09:55:54.179235 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m09:55:54.192660 [debug] [ThreadPool]: On create_sales_database_main: COMMIT
[0m09:55:54.203887 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m09:55:54.206184 [debug] [ThreadPool]: On create_sales_database_main: COMMIT
[0m09:55:54.212234 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:55:54.216525 [debug] [ThreadPool]: On create_sales_database_main: Close
[0m09:55:54.248928 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_sales_database_main'
[0m09:55:54.290969 [debug] [ThreadPool]: Using duckdb connection "list_sales_database_main"
[0m09:55:54.299986 [debug] [ThreadPool]: On list_sales_database_main: BEGIN
[0m09:55:54.304495 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:55:54.374296 [debug] [ThreadPool]: SQL status: OK in 0.070 seconds
[0m09:55:54.376580 [debug] [ThreadPool]: Using duckdb connection "list_sales_database_main"
[0m09:55:54.382525 [debug] [ThreadPool]: On list_sales_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "list_sales_database_main"} */
select
      'sales_database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'sales_database'
  
[0m09:55:54.621379 [debug] [ThreadPool]: SQL status: OK in 0.234 seconds
[0m09:55:54.629768 [debug] [ThreadPool]: On list_sales_database_main: ROLLBACK
[0m09:55:54.648430 [debug] [ThreadPool]: Failed to rollback 'list_sales_database_main'
[0m09:55:54.651628 [debug] [ThreadPool]: On list_sales_database_main: Close
[0m09:55:54.673469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7c225a6f-2ca7-48f1-a1b6-911afcad6d6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc203087fe0>]}
[0m09:55:54.675520 [debug] [MainThread]: Using duckdb connection "master"
[0m09:55:54.686361 [debug] [MainThread]: On master: BEGIN
[0m09:55:54.690533 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:55:54.750985 [debug] [MainThread]: SQL status: OK in 0.060 seconds
[0m09:55:54.752597 [debug] [MainThread]: On master: COMMIT
[0m09:55:54.754546 [debug] [MainThread]: Using duckdb connection "master"
[0m09:55:54.756425 [debug] [MainThread]: On master: COMMIT
[0m09:55:54.759012 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m09:55:54.760922 [debug] [MainThread]: On master: Close
[0m09:55:54.789990 [debug] [Thread-1 (]: Began running node model.my_dbt_project.customer_dimension
[0m09:55:54.792491 [info ] [Thread-1 (]: 1 of 6 START sql view model main.customer_dimension ............................ [RUN]
[0m09:55:54.795131 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.my_dbt_project.customer_dimension'
[0m09:55:54.797723 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.customer_dimension
[0m09:55:54.830374 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.customer_dimension"
[0m09:55:54.854628 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.customer_dimension
[0m09:55:55.035410 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.customer_dimension"
[0m09:55:55.071055 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m09:55:55.073329 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: BEGIN
[0m09:55:55.076746 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m09:55:55.229602 [debug] [Thread-1 (]: SQL status: OK in 0.149 seconds
[0m09:55:55.235999 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m09:55:55.239702 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */

  
  create view "sales_database"."main"."customer_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
    DISTINCT
    customer AS customer_id,
    customer_name,
    customer_address,
    customer_group,
    territory,
    language AS customer_language
FROM sales
WHERE customer IS NOT NULL
  );

[0m09:55:55.267464 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m09:55:55.334225 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m09:55:55.342775 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */
alter view "sales_database"."main"."customer_dimension" rename to "customer_dimension__dbt_backup"
[0m09:55:55.356787 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m09:55:55.402799 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m09:55:55.407873 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */
alter view "sales_database"."main"."customer_dimension__dbt_tmp" rename to "customer_dimension"
[0m09:55:55.416154 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m09:55:55.515923 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: COMMIT
[0m09:55:55.518076 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m09:55:55.520304 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: COMMIT
[0m09:55:55.569744 [debug] [Thread-1 (]: SQL status: OK in 0.045 seconds
[0m09:55:55.606806 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m09:55:55.611019 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */
drop view if exists "sales_database"."main"."customer_dimension__dbt_backup" cascade
[0m09:55:55.625446 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m09:55:55.647977 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: Close
[0m09:55:55.746705 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c225a6f-2ca7-48f1-a1b6-911afcad6d6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc205386120>]}
[0m09:55:55.749849 [info ] [Thread-1 (]: 1 of 6 OK created sql view model main.customer_dimension ....................... [[32mOK[0m in 0.95s]
[0m09:55:55.753086 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.customer_dimension
[0m09:55:55.755419 [debug] [Thread-1 (]: Began running node model.my_dbt_project.date_dimension
[0m09:55:55.758434 [info ] [Thread-1 (]: 2 of 6 START sql view model main.date_dimension ................................ [RUN]
[0m09:55:55.763209 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customer_dimension, now model.my_dbt_project.date_dimension)
[0m09:55:55.765285 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.date_dimension
[0m09:55:55.782021 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.date_dimension"
[0m09:55:55.808458 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.date_dimension
[0m09:55:55.827920 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.date_dimension"
[0m09:55:55.854035 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m09:55:55.867651 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: BEGIN
[0m09:55:55.873375 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:55:55.952712 [debug] [Thread-1 (]: SQL status: OK in 0.079 seconds
[0m09:55:55.955312 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m09:55:55.957842 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.date_dimension"} */

  
  create view "sales_database"."main"."date_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
    transaction_date,
    strftime(transaction_date, '%A') AS weekday_name,  -- Extract weekday name
    strftime(transaction_date, '%m') AS month,          -- Extract month (numeric)
    strftime(transaction_date, '%Y') AS year,           -- Extract year
    strftime(transaction_date, '%d') AS day,            -- Extract day
    EXTRACT(QUARTER FROM transaction_date) AS quarter   -- Extract quarter
FROM sales
WHERE transaction_date IS NOT NULL
  );

[0m09:55:55.964419 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m09:55:55.979245 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m09:55:55.981864 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.date_dimension"} */
alter view "sales_database"."main"."date_dimension" rename to "date_dimension__dbt_backup"
[0m09:55:55.985002 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:55:55.998277 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m09:55:56.000491 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.date_dimension"} */
alter view "sales_database"."main"."date_dimension__dbt_tmp" rename to "date_dimension"
[0m09:55:56.004488 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m09:55:56.011556 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: COMMIT
[0m09:55:56.013733 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m09:55:56.015809 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: COMMIT
[0m09:55:56.031129 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m09:55:56.041223 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m09:55:56.045046 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.date_dimension"} */
drop view if exists "sales_database"."main"."date_dimension__dbt_backup" cascade
[0m09:55:56.057319 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m09:55:56.063232 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: Close
[0m09:55:56.155697 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c225a6f-2ca7-48f1-a1b6-911afcad6d6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1fcc41730>]}
[0m09:55:56.160424 [info ] [Thread-1 (]: 2 of 6 OK created sql view model main.date_dimension ........................... [[32mOK[0m in 0.39s]
[0m09:55:56.163018 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.date_dimension
[0m09:55:56.166263 [debug] [Thread-1 (]: Began running node model.my_dbt_project.product_dimension
[0m09:55:56.169255 [info ] [Thread-1 (]: 3 of 6 START sql view model main.product_dimension ............................. [RUN]
[0m09:55:56.173690 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.date_dimension, now model.my_dbt_project.product_dimension)
[0m09:55:56.176988 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.product_dimension
[0m09:55:56.197835 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.product_dimension"
[0m09:55:56.218124 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.product_dimension
[0m09:55:56.239948 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.product_dimension"
[0m09:55:56.314802 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m09:55:56.317726 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: BEGIN
[0m09:55:56.319502 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:55:56.371504 [debug] [Thread-1 (]: SQL status: OK in 0.052 seconds
[0m09:55:56.373775 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m09:55:56.390848 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.product_dimension"} */

  
  create view "sales_database"."main"."product_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * 
    FROM "sales_database"."main"."sales"
)

SELECT 
    sales.name,
    json_extract(items, '$[0].name') AS product_name,  -- Example to extract the first element's "name" field from JSON array
    json_extract(items, '$[0].item_code') AS product_item_code
FROM sales
WHERE json_extract(items, '$[0].name') IS NOT NULL  -- Filter to only keep rows with a non-null product name
  );

[0m09:55:56.397360 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m09:55:56.408658 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m09:55:56.411839 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.product_dimension"} */
alter view "sales_database"."main"."product_dimension" rename to "product_dimension__dbt_backup"
[0m09:55:56.421407 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:55:56.443375 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m09:55:56.446358 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.product_dimension"} */
alter view "sales_database"."main"."product_dimension__dbt_tmp" rename to "product_dimension"
[0m09:55:56.458664 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:55:56.468997 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: COMMIT
[0m09:55:56.471873 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m09:55:56.476814 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: COMMIT
[0m09:55:56.497752 [debug] [Thread-1 (]: SQL status: OK in 0.019 seconds
[0m09:55:56.516003 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m09:55:56.533400 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.product_dimension"} */
drop view if exists "sales_database"."main"."product_dimension__dbt_backup" cascade
[0m09:55:56.574212 [debug] [Thread-1 (]: SQL status: OK in 0.038 seconds
[0m09:55:56.583106 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: Close
[0m09:55:56.716930 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c225a6f-2ca7-48f1-a1b6-911afcad6d6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1fc1d1700>]}
[0m09:55:56.720797 [info ] [Thread-1 (]: 3 of 6 OK created sql view model main.product_dimension ........................ [[32mOK[0m in 0.54s]
[0m09:55:56.723603 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.product_dimension
[0m09:55:56.725704 [debug] [Thread-1 (]: Began running node model.my_dbt_project.sales_fact
[0m09:55:56.728376 [info ] [Thread-1 (]: 4 of 6 START sql table model main.sales_fact ................................... [RUN]
[0m09:55:56.731218 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.product_dimension, now model.my_dbt_project.sales_fact)
[0m09:55:56.733305 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.sales_fact
[0m09:55:56.746054 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.sales_fact"
[0m09:55:56.765020 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.sales_fact
[0m09:55:56.931828 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.sales_fact"
[0m09:55:56.964901 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_fact"
[0m09:55:56.968536 [debug] [Thread-1 (]: On model.my_dbt_project.sales_fact: BEGIN
[0m09:55:56.970348 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:55:57.112559 [debug] [Thread-1 (]: SQL status: OK in 0.142 seconds
[0m09:55:57.123754 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_fact"
[0m09:55:57.126384 [debug] [Thread-1 (]: On model.my_dbt_project.sales_fact: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_fact"} */

  
    
    

    create  table
      "sales_database"."main"."sales_fact__dbt_tmp"
  
    as (
      WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)
SELECT
    sales.name AS sales_id,
    sales.customer,
    sales.transaction_date
FROM sales
LIMIT 10;
    );
  
  
[0m09:55:57.153121 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_fact"} */

  
    
    

    create  table
      "sales_database"."main"."sales_fact__dbt_tmp"
  
    as (
      WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)
SELECT
    sales.name AS sales_id,
    sales.customer,
    sales.transaction_date
FROM sales
LIMIT 10;
    );
  
  
[0m09:55:57.155865 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m09:55:57.166169 [debug] [Thread-1 (]: On model.my_dbt_project.sales_fact: ROLLBACK
[0m09:55:57.258043 [debug] [Thread-1 (]: Failed to rollback 'model.my_dbt_project.sales_fact'
[0m09:55:57.261025 [debug] [Thread-1 (]: On model.my_dbt_project.sales_fact: Close
[0m09:55:57.280072 [debug] [Thread-1 (]: Runtime Error in model sales_fact (models/facts/sales_fact.sql)
  Parser Error: syntax error at or near ";"
[0m09:55:57.284437 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c225a6f-2ca7-48f1-a1b6-911afcad6d6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1f59c7da0>]}
[0m09:55:57.286996 [error] [Thread-1 (]: 4 of 6 ERROR creating sql table model main.sales_fact .......................... [[31mERROR[0m in 0.55s]
[0m09:55:57.301493 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.sales_fact
[0m09:55:57.332357 [debug] [Thread-4 (]: Marking all children of 'model.my_dbt_project.sales_fact' to be skipped because of status 'error'.  Reason: Runtime Error in model sales_fact (models/facts/sales_fact.sql)
  Parser Error: syntax error at or near ";".
[0m09:55:57.326601 [debug] [Thread-1 (]: Began running node model.my_dbt_project.sales_team_dimension
[0m09:55:57.339947 [info ] [Thread-1 (]: 5 of 6 START sql view model main.sales_team_dimension .......................... [RUN]
[0m09:55:57.343625 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.sales_fact, now model.my_dbt_project.sales_team_dimension)
[0m09:55:57.345565 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.sales_team_dimension
[0m09:55:57.359168 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.sales_team_dimension"
[0m09:55:57.386867 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.sales_team_dimension
[0m09:55:57.404552 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.sales_team_dimension"
[0m09:55:57.436429 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m09:55:57.438496 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: BEGIN
[0m09:55:57.440632 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:55:57.483715 [debug] [Thread-1 (]: SQL status: OK in 0.043 seconds
[0m09:55:57.486069 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m09:55:57.488539 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */

  
  create view "sales_database"."main"."sales_team_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
    DISTINCT
    sales_team->>'name' AS sales_team_id,
    sales_team->>'region' AS sales_team_region
FROM sales
WHERE sales_team IS NOT NULL
  );

[0m09:55:57.494576 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m09:55:57.508081 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m09:55:57.511228 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */
alter view "sales_database"."main"."sales_team_dimension" rename to "sales_team_dimension__dbt_backup"
[0m09:55:57.514410 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:55:57.525441 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m09:55:57.527921 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */
alter view "sales_database"."main"."sales_team_dimension__dbt_tmp" rename to "sales_team_dimension"
[0m09:55:57.530843 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:55:57.537468 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: COMMIT
[0m09:55:57.539560 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m09:55:57.541463 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: COMMIT
[0m09:55:57.550735 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m09:55:57.559747 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m09:55:57.561404 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */
drop view if exists "sales_database"."main"."sales_team_dimension__dbt_backup" cascade
[0m09:55:57.566226 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m09:55:57.570950 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: Close
[0m09:55:57.634485 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c225a6f-2ca7-48f1-a1b6-911afcad6d6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1f59c3bf0>]}
[0m09:55:57.637134 [info ] [Thread-1 (]: 5 of 6 OK created sql view model main.sales_team_dimension ..................... [[32mOK[0m in 0.29s]
[0m09:55:57.640107 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.sales_team_dimension
[0m09:55:57.641922 [debug] [Thread-1 (]: Began running node model.my_dbt_project.transform_sales
[0m09:55:57.644166 [info ] [Thread-1 (]: 6 of 6 START sql table model main.transform_sales .............................. [RUN]
[0m09:55:57.646266 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.sales_team_dimension, now model.my_dbt_project.transform_sales)
[0m09:55:57.648210 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.transform_sales
[0m09:55:57.656172 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.transform_sales"
[0m09:55:57.673530 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.transform_sales
[0m09:55:57.683114 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.transform_sales"
[0m09:55:57.698756 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m09:55:57.700365 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: BEGIN
[0m09:55:57.702034 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:55:57.737289 [debug] [Thread-1 (]: SQL status: OK in 0.035 seconds
[0m09:55:57.739155 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m09:55:57.741164 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */

  
    
    

    create  table
      "sales_database"."main"."transform_sales__dbt_tmp"
  
    as (
      -- /opt/airflow/dags/dbt_models/transform_users.sql


WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
   *
FROM sales
WHERE name = 'ABC private LTD-0002'
    );
  
  
[0m09:55:57.767032 [debug] [Thread-1 (]: SQL status: OK in 0.024 seconds
[0m09:55:57.776718 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m09:55:57.778482 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */
alter table "sales_database"."main"."transform_sales" rename to "transform_sales__dbt_backup"
[0m09:55:57.781703 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:55:57.793346 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m09:55:57.795228 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */
alter table "sales_database"."main"."transform_sales__dbt_tmp" rename to "transform_sales"
[0m09:55:57.798653 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:55:57.822953 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: COMMIT
[0m09:55:57.826427 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m09:55:57.828395 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: COMMIT
[0m09:55:57.856593 [debug] [Thread-1 (]: SQL status: OK in 0.024 seconds
[0m09:55:57.867789 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m09:55:57.869853 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */
drop table if exists "sales_database"."main"."transform_sales__dbt_backup" cascade
[0m09:55:57.883944 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m09:55:57.889715 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: Close
[0m09:55:57.997793 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c225a6f-2ca7-48f1-a1b6-911afcad6d6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1f7fa3500>]}
[0m09:55:58.000485 [info ] [Thread-1 (]: 6 of 6 OK created sql table model main.transform_sales ......................... [[32mOK[0m in 0.35s]
[0m09:55:58.004351 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.transform_sales
[0m09:55:58.007958 [debug] [MainThread]: Using duckdb connection "master"
[0m09:55:58.009628 [debug] [MainThread]: On master: BEGIN
[0m09:55:58.011453 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:55:58.049789 [debug] [MainThread]: SQL status: OK in 0.038 seconds
[0m09:55:58.051669 [debug] [MainThread]: On master: COMMIT
[0m09:55:58.053567 [debug] [MainThread]: Using duckdb connection "master"
[0m09:55:58.055590 [debug] [MainThread]: On master: COMMIT
[0m09:55:58.057786 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m09:55:58.059646 [debug] [MainThread]: On master: Close
[0m09:55:58.065240 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:55:58.066865 [debug] [MainThread]: Connection 'create_sales_database_main' was properly closed.
[0m09:55:58.068541 [debug] [MainThread]: Connection 'list_sales_database_main' was properly closed.
[0m09:55:58.069949 [debug] [MainThread]: Connection 'model.my_dbt_project.transform_sales' was properly closed.
[0m09:55:58.071907 [info ] [MainThread]: 
[0m09:55:58.073461 [info ] [MainThread]: Finished running 2 table models, 4 view models in 0 hours 0 minutes and 4.62 seconds (4.62s).
[0m09:55:58.077649 [debug] [MainThread]: Command end result
[0m09:55:58.289438 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m09:55:58.307402 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m09:55:58.412424 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dags/dbt_models/target/run_results.json
[0m09:55:58.414114 [info ] [MainThread]: 
[0m09:55:58.416978 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m09:55:58.419145 [info ] [MainThread]: 
[0m09:55:58.423098 [error] [MainThread]:   Runtime Error in model sales_fact (models/facts/sales_fact.sql)
  Parser Error: syntax error at or near ";"
[0m09:55:58.427925 [info ] [MainThread]: 
[0m09:55:58.435030 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m09:55:58.441380 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 16.116486, "process_in_blocks": "1350312", "process_kernel_time": 6.506343, "process_mem_max_rss": "153292", "process_out_blocks": "0", "process_user_time": 14.617124}
[0m09:55:58.445475 [debug] [MainThread]: Command `dbt run` failed at 09:55:58.445111 after 16.12 seconds
[0m09:55:58.447719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc205334080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1fcc4a5a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc203087fe0>]}
[0m09:55:58.451573 [debug] [MainThread]: Flushing usage events
[0m09:56:00.163043 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:58:08.591311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5daa179f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5daa083590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5daa6acda0>]}


============================== 09:58:08.624197 | 7d788a0c-f4d6-4858-8a5c-c9ac1acb15df ==============================
[0m09:58:08.624197 [info ] [MainThread]: Running with dbt=1.9.1
[0m09:58:08.631540 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dags/dbt_models/logs', 'profiles_dir': '/opt/airflow/dbt/profiles.yml', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt/profiles.yml --target dev', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:58:11.414820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7d788a0c-f4d6-4858-8a5c-c9ac1acb15df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5dabc0c3e0>]}
[0m09:58:11.899540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7d788a0c-f4d6-4858-8a5c-c9ac1acb15df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5da9df9370>]}
[0m09:58:12.154136 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m09:58:15.371346 [debug] [MainThread]: checksum: cac3b9519010e47bfbeb71ca6efb4867dae2858687671594dc23fefc94ecf25d, vars: {}, profile: , target: dev, version: 1.9.1
[0m09:58:50.808555 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:58:50.811541 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/facts/sales_fact.sql
[0m09:58:53.730405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7d788a0c-f4d6-4858-8a5c-c9ac1acb15df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5da98ba0c0>]}
[0m09:58:54.161466 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m09:58:54.196454 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m09:58:54.421554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7d788a0c-f4d6-4858-8a5c-c9ac1acb15df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d9fcb0980>]}
[0m09:58:54.423662 [info ] [MainThread]: Found 6 models, 1 source, 424 macros
[0m09:58:54.425363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7d788a0c-f4d6-4858-8a5c-c9ac1acb15df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5da9ff1970>]}
[0m09:58:54.432217 [info ] [MainThread]: 
[0m09:58:54.440042 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:58:54.443092 [info ] [MainThread]: 
[0m09:58:54.446494 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m09:58:54.463777 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_sales_database'
[0m09:58:54.914450 [debug] [ThreadPool]: Using duckdb connection "list_sales_database"
[0m09:58:54.921502 [debug] [ThreadPool]: On list_sales_database: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "list_sales_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"sales_database"'
    
  
  
[0m09:58:54.923533 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:58:58.003964 [debug] [ThreadPool]: SQL status: OK in 3.041 seconds
[0m09:58:58.172442 [debug] [ThreadPool]: On list_sales_database: Close
[0m09:58:58.605025 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_database, now create_sales_database_main)
[0m09:58:58.624387 [debug] [ThreadPool]: Creating schema "database: "sales_database"
schema: "main"
"
[0m09:58:58.708371 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m09:58:58.725344 [debug] [ThreadPool]: On create_sales_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "create_sales_database_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='sales_database'
        and type='sqlite'
    
  
[0m09:58:58.729727 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:59:01.242933 [debug] [ThreadPool]: SQL status: OK in 2.504 seconds
[0m09:59:01.282439 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m09:59:01.286575 [debug] [ThreadPool]: On create_sales_database_main: BEGIN
[0m09:59:01.295176 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:59:01.297664 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m09:59:01.305842 [debug] [ThreadPool]: On create_sales_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "create_sales_database_main"} */

    
    
        create schema if not exists "sales_database"."main"
    
[0m09:59:01.314244 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m09:59:01.318504 [debug] [ThreadPool]: On create_sales_database_main: COMMIT
[0m09:59:01.321407 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m09:59:01.323692 [debug] [ThreadPool]: On create_sales_database_main: COMMIT
[0m09:59:01.328556 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m09:59:01.331440 [debug] [ThreadPool]: On create_sales_database_main: Close
[0m09:59:01.356228 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_sales_database_main'
[0m09:59:01.422777 [debug] [ThreadPool]: Using duckdb connection "list_sales_database_main"
[0m09:59:01.424974 [debug] [ThreadPool]: On list_sales_database_main: BEGIN
[0m09:59:01.427170 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:59:01.604290 [debug] [ThreadPool]: SQL status: OK in 0.177 seconds
[0m09:59:01.606489 [debug] [ThreadPool]: Using duckdb connection "list_sales_database_main"
[0m09:59:01.608514 [debug] [ThreadPool]: On list_sales_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "list_sales_database_main"} */
select
      'sales_database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'sales_database'
  
[0m09:59:01.846346 [debug] [ThreadPool]: SQL status: OK in 0.235 seconds
[0m09:59:01.855955 [debug] [ThreadPool]: On list_sales_database_main: ROLLBACK
[0m09:59:01.884310 [debug] [ThreadPool]: Failed to rollback 'list_sales_database_main'
[0m09:59:01.897312 [debug] [ThreadPool]: On list_sales_database_main: Close
[0m09:59:01.915638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7d788a0c-f4d6-4858-8a5c-c9ac1acb15df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d9fd6d520>]}
[0m09:59:01.921398 [debug] [MainThread]: Using duckdb connection "master"
[0m09:59:01.923932 [debug] [MainThread]: On master: BEGIN
[0m09:59:01.925947 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:59:02.024186 [debug] [MainThread]: SQL status: OK in 0.098 seconds
[0m09:59:02.027831 [debug] [MainThread]: On master: COMMIT
[0m09:59:02.030671 [debug] [MainThread]: Using duckdb connection "master"
[0m09:59:02.037156 [debug] [MainThread]: On master: COMMIT
[0m09:59:02.041981 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m09:59:02.044532 [debug] [MainThread]: On master: Close
[0m09:59:02.082514 [debug] [Thread-1 (]: Began running node model.my_dbt_project.customer_dimension
[0m09:59:02.087325 [info ] [Thread-1 (]: 1 of 6 START sql view model main.customer_dimension ............................ [RUN]
[0m09:59:02.091150 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.my_dbt_project.customer_dimension'
[0m09:59:02.093773 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.customer_dimension
[0m09:59:02.129775 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.customer_dimension"
[0m09:59:02.187922 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.customer_dimension
[0m09:59:02.429400 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.customer_dimension"
[0m09:59:02.545467 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m09:59:02.547942 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: BEGIN
[0m09:59:02.550780 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m09:59:02.927840 [debug] [Thread-1 (]: SQL status: OK in 0.377 seconds
[0m09:59:02.930635 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m09:59:02.933435 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */

  
  create view "sales_database"."main"."customer_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
    DISTINCT
    customer AS customer_id,
    customer_name,
    customer_address,
    customer_group,
    territory,
    language AS customer_language
FROM sales
WHERE customer IS NOT NULL
  );

[0m09:59:02.963805 [debug] [Thread-1 (]: SQL status: OK in 0.025 seconds
[0m09:59:02.998249 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m09:59:03.002985 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */
alter view "sales_database"."main"."customer_dimension" rename to "customer_dimension__dbt_backup"
[0m09:59:03.013072 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m09:59:03.025901 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m09:59:03.028912 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */
alter view "sales_database"."main"."customer_dimension__dbt_tmp" rename to "customer_dimension"
[0m09:59:03.032576 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:59:03.096375 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: COMMIT
[0m09:59:03.106830 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m09:59:03.109421 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: COMMIT
[0m09:59:03.145784 [debug] [Thread-1 (]: SQL status: OK in 0.034 seconds
[0m09:59:03.182899 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m09:59:03.193227 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */
drop view if exists "sales_database"."main"."customer_dimension__dbt_backup" cascade
[0m09:59:03.233165 [debug] [Thread-1 (]: SQL status: OK in 0.036 seconds
[0m09:59:03.255868 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: Close
[0m09:59:03.404790 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d788a0c-f4d6-4858-8a5c-c9ac1acb15df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d9e5e3260>]}
[0m09:59:03.409063 [info ] [Thread-1 (]: 1 of 6 OK created sql view model main.customer_dimension ....................... [[32mOK[0m in 1.30s]
[0m09:59:03.415562 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.customer_dimension
[0m09:59:03.418141 [debug] [Thread-1 (]: Began running node model.my_dbt_project.date_dimension
[0m09:59:03.422465 [info ] [Thread-1 (]: 2 of 6 START sql view model main.date_dimension ................................ [RUN]
[0m09:59:03.433768 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customer_dimension, now model.my_dbt_project.date_dimension)
[0m09:59:03.441836 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.date_dimension
[0m09:59:03.466057 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.date_dimension"
[0m09:59:03.488883 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.date_dimension
[0m09:59:03.506134 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.date_dimension"
[0m09:59:03.530825 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m09:59:03.539976 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: BEGIN
[0m09:59:03.542637 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:59:03.662985 [debug] [Thread-1 (]: SQL status: OK in 0.121 seconds
[0m09:59:03.675236 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m09:59:03.679029 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.date_dimension"} */

  
  create view "sales_database"."main"."date_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
    transaction_date,
    strftime(transaction_date, '%A') AS weekday_name,  -- Extract weekday name
    strftime(transaction_date, '%m') AS month,          -- Extract month (numeric)
    strftime(transaction_date, '%Y') AS year,           -- Extract year
    strftime(transaction_date, '%d') AS day,            -- Extract day
    EXTRACT(QUARTER FROM transaction_date) AS quarter   -- Extract quarter
FROM sales
WHERE transaction_date IS NOT NULL
  );

[0m09:59:03.705019 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m09:59:03.782227 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m09:59:03.787691 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.date_dimension"} */
alter view "sales_database"."main"."date_dimension" rename to "date_dimension__dbt_backup"
[0m09:59:03.799426 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:59:03.830130 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m09:59:03.833758 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.date_dimension"} */
alter view "sales_database"."main"."date_dimension__dbt_tmp" rename to "date_dimension"
[0m09:59:03.846038 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m09:59:03.880373 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: COMMIT
[0m09:59:03.888925 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m09:59:03.894695 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: COMMIT
[0m09:59:03.960864 [debug] [Thread-1 (]: SQL status: OK in 0.062 seconds
[0m09:59:04.023376 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m09:59:04.027632 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.date_dimension"} */
drop view if exists "sales_database"."main"."date_dimension__dbt_backup" cascade
[0m09:59:04.049683 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m09:59:04.059735 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: Close
[0m09:59:04.233370 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d788a0c-f4d6-4858-8a5c-c9ac1acb15df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d9e58cbf0>]}
[0m09:59:04.243929 [info ] [Thread-1 (]: 2 of 6 OK created sql view model main.date_dimension ........................... [[32mOK[0m in 0.80s]
[0m09:59:04.248614 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.date_dimension
[0m09:59:04.261438 [debug] [Thread-1 (]: Began running node model.my_dbt_project.product_dimension
[0m09:59:04.274272 [info ] [Thread-1 (]: 3 of 6 START sql view model main.product_dimension ............................. [RUN]
[0m09:59:04.276938 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.date_dimension, now model.my_dbt_project.product_dimension)
[0m09:59:04.279496 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.product_dimension
[0m09:59:04.307907 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.product_dimension"
[0m09:59:04.340416 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.product_dimension
[0m09:59:04.389870 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.product_dimension"
[0m09:59:04.477917 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m09:59:04.480790 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: BEGIN
[0m09:59:04.483275 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:59:04.600605 [debug] [Thread-1 (]: SQL status: OK in 0.117 seconds
[0m09:59:04.616394 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m09:59:04.679416 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.product_dimension"} */

  
  create view "sales_database"."main"."product_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * 
    FROM "sales_database"."main"."sales"
)

SELECT 
    sales.name,
    json_extract(items, '$[0].name') AS product_name,  -- Example to extract the first element's "name" field from JSON array
    json_extract(items, '$[0].item_code') AS product_item_code
FROM sales
WHERE json_extract(items, '$[0].name') IS NOT NULL  -- Filter to only keep rows with a non-null product name
  );

[0m09:59:04.773981 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m09:59:04.828829 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m09:59:04.856300 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.product_dimension"} */
alter view "sales_database"."main"."product_dimension" rename to "product_dimension__dbt_backup"
[0m09:59:04.877658 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m09:59:04.941752 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m09:59:04.957945 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.product_dimension"} */
alter view "sales_database"."main"."product_dimension__dbt_tmp" rename to "product_dimension"
[0m09:59:04.967756 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:59:04.987595 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: COMMIT
[0m09:59:04.997140 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m09:59:05.013812 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: COMMIT
[0m09:59:05.080726 [debug] [Thread-1 (]: SQL status: OK in 0.058 seconds
[0m09:59:05.099609 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m09:59:05.116962 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.product_dimension"} */
drop view if exists "sales_database"."main"."product_dimension__dbt_backup" cascade
[0m09:59:05.189640 [debug] [Thread-1 (]: SQL status: OK in 0.068 seconds
[0m09:59:05.196098 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: Close
[0m09:59:05.356658 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d788a0c-f4d6-4858-8a5c-c9ac1acb15df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d9e5e9130>]}
[0m09:59:05.365675 [info ] [Thread-1 (]: 3 of 6 OK created sql view model main.product_dimension ........................ [[32mOK[0m in 1.08s]
[0m09:59:05.390252 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.product_dimension
[0m09:59:05.400430 [debug] [Thread-1 (]: Began running node model.my_dbt_project.sales_fact
[0m09:59:05.404897 [info ] [Thread-1 (]: 4 of 6 START sql table model main.sales_fact ................................... [RUN]
[0m09:59:05.415887 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.product_dimension, now model.my_dbt_project.sales_fact)
[0m09:59:05.418433 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.sales_fact
[0m09:59:05.429408 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.sales_fact"
[0m09:59:05.480984 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.sales_fact
[0m09:59:05.605474 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.sales_fact"
[0m09:59:05.641438 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_fact"
[0m09:59:05.643463 [debug] [Thread-1 (]: On model.my_dbt_project.sales_fact: BEGIN
[0m09:59:05.645828 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:59:05.764522 [debug] [Thread-1 (]: SQL status: OK in 0.118 seconds
[0m09:59:05.766653 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_fact"
[0m09:59:05.777069 [debug] [Thread-1 (]: On model.my_dbt_project.sales_fact: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_fact"} */

  
    
    

    create  table
      "sales_database"."main"."sales_fact__dbt_tmp"
  
    as (
      WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)
SELECT
    sales.name AS sales_id,
    sales.customer,
    sales.transaction_date
FROM sales
LIMIT 10
    );
  
  
[0m09:59:05.832667 [debug] [Thread-1 (]: SQL status: OK in 0.051 seconds
[0m09:59:05.851548 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_fact"
[0m09:59:05.858482 [debug] [Thread-1 (]: On model.my_dbt_project.sales_fact: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_fact"} */
alter table "sales_database"."main"."sales_fact__dbt_tmp" rename to "sales_fact"
[0m09:59:05.863740 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m09:59:05.890891 [debug] [Thread-1 (]: On model.my_dbt_project.sales_fact: COMMIT
[0m09:59:05.893006 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_fact"
[0m09:59:05.895125 [debug] [Thread-1 (]: On model.my_dbt_project.sales_fact: COMMIT
[0m09:59:05.912231 [debug] [Thread-1 (]: SQL status: OK in 0.015 seconds
[0m09:59:05.923015 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_fact"
[0m09:59:05.926271 [debug] [Thread-1 (]: On model.my_dbt_project.sales_fact: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_fact"} */
drop table if exists "sales_database"."main"."sales_fact__dbt_backup" cascade
[0m09:59:05.938266 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:59:05.943978 [debug] [Thread-1 (]: On model.my_dbt_project.sales_fact: Close
[0m09:59:06.100877 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d788a0c-f4d6-4858-8a5c-c9ac1acb15df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d96f44b00>]}
[0m09:59:06.106463 [info ] [Thread-1 (]: 4 of 6 OK created sql table model main.sales_fact .............................. [[32mOK[0m in 0.68s]
[0m09:59:06.110059 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.sales_fact
[0m09:59:06.112480 [debug] [Thread-1 (]: Began running node model.my_dbt_project.sales_team_dimension
[0m09:59:06.114707 [info ] [Thread-1 (]: 5 of 6 START sql view model main.sales_team_dimension .......................... [RUN]
[0m09:59:06.117115 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.sales_fact, now model.my_dbt_project.sales_team_dimension)
[0m09:59:06.120571 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.sales_team_dimension
[0m09:59:06.135935 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.sales_team_dimension"
[0m09:59:06.160223 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.sales_team_dimension
[0m09:59:06.171258 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.sales_team_dimension"
[0m09:59:06.208095 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m09:59:06.210221 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: BEGIN
[0m09:59:06.212795 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:59:06.274916 [debug] [Thread-1 (]: SQL status: OK in 0.062 seconds
[0m09:59:06.277431 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m09:59:06.284343 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */

  
  create view "sales_database"."main"."sales_team_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
    DISTINCT
    sales_team->>'name' AS sales_team_id,
    sales_team->>'region' AS sales_team_region
FROM sales
WHERE sales_team IS NOT NULL
  );

[0m09:59:06.294177 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m09:59:06.317066 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m09:59:06.321932 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */
alter view "sales_database"."main"."sales_team_dimension" rename to "sales_team_dimension__dbt_backup"
[0m09:59:06.325858 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:59:06.343984 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m09:59:06.347199 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */
alter view "sales_database"."main"."sales_team_dimension__dbt_tmp" rename to "sales_team_dimension"
[0m09:59:06.349754 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:59:06.357845 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: COMMIT
[0m09:59:06.360282 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m09:59:06.362617 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: COMMIT
[0m09:59:06.431973 [debug] [Thread-1 (]: SQL status: OK in 0.067 seconds
[0m09:59:06.458600 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m09:59:06.467676 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */
drop view if exists "sales_database"."main"."sales_team_dimension__dbt_backup" cascade
[0m09:59:06.504025 [debug] [Thread-1 (]: SQL status: OK in 0.032 seconds
[0m09:59:06.522502 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: Close
[0m09:59:07.069603 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d788a0c-f4d6-4858-8a5c-c9ac1acb15df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d9e5eac00>]}
[0m09:59:07.108909 [info ] [Thread-1 (]: 5 of 6 OK created sql view model main.sales_team_dimension ..................... [[32mOK[0m in 0.95s]
[0m09:59:07.131262 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.sales_team_dimension
[0m09:59:07.162866 [debug] [Thread-1 (]: Began running node model.my_dbt_project.transform_sales
[0m09:59:07.195363 [info ] [Thread-1 (]: 6 of 6 START sql table model main.transform_sales .............................. [RUN]
[0m09:59:07.211559 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.sales_team_dimension, now model.my_dbt_project.transform_sales)
[0m09:59:07.242588 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.transform_sales
[0m09:59:07.307580 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.transform_sales"
[0m09:59:07.453697 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.transform_sales
[0m09:59:07.476884 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.transform_sales"
[0m09:59:07.532877 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m09:59:07.555383 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: BEGIN
[0m09:59:07.578390 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:59:07.708633 [debug] [Thread-1 (]: SQL status: OK in 0.130 seconds
[0m09:59:07.713485 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m09:59:07.716215 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */

  
    
    

    create  table
      "sales_database"."main"."transform_sales__dbt_tmp"
  
    as (
      -- /opt/airflow/dags/dbt_models/transform_users.sql


WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
   *
FROM sales
WHERE name = 'ABC private LTD-0002'
    );
  
  
[0m09:59:07.767788 [debug] [Thread-1 (]: SQL status: OK in 0.047 seconds
[0m09:59:07.788917 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m09:59:07.804184 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */
alter table "sales_database"."main"."transform_sales" rename to "transform_sales__dbt_backup"
[0m09:59:07.807652 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:59:07.826658 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m09:59:07.834651 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */
alter table "sales_database"."main"."transform_sales__dbt_tmp" rename to "transform_sales"
[0m09:59:07.838501 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:59:07.853164 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: COMMIT
[0m09:59:07.855490 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m09:59:07.857925 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: COMMIT
[0m09:59:07.910126 [debug] [Thread-1 (]: SQL status: OK in 0.046 seconds
[0m09:59:07.940378 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m09:59:07.942497 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */
drop table if exists "sales_database"."main"."transform_sales__dbt_backup" cascade
[0m09:59:07.971923 [debug] [Thread-1 (]: SQL status: OK in 0.025 seconds
[0m09:59:07.978987 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: Close
[0m09:59:08.404107 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d788a0c-f4d6-4858-8a5c-c9ac1acb15df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d96f8fc50>]}
[0m09:59:08.419299 [info ] [Thread-1 (]: 6 of 6 OK created sql table model main.transform_sales ......................... [[32mOK[0m in 1.19s]
[0m09:59:08.437021 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.transform_sales
[0m09:59:08.461035 [debug] [MainThread]: Using duckdb connection "master"
[0m09:59:08.497866 [debug] [MainThread]: On master: BEGIN
[0m09:59:08.508900 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:59:08.714057 [debug] [MainThread]: SQL status: OK in 0.205 seconds
[0m09:59:08.720684 [debug] [MainThread]: On master: COMMIT
[0m09:59:08.723648 [debug] [MainThread]: Using duckdb connection "master"
[0m09:59:08.741142 [debug] [MainThread]: On master: COMMIT
[0m09:59:08.748545 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m09:59:08.756371 [debug] [MainThread]: On master: Close
[0m09:59:08.783457 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:59:08.789748 [debug] [MainThread]: Connection 'create_sales_database_main' was properly closed.
[0m09:59:08.791660 [debug] [MainThread]: Connection 'list_sales_database_main' was properly closed.
[0m09:59:08.793971 [debug] [MainThread]: Connection 'model.my_dbt_project.transform_sales' was properly closed.
[0m09:59:08.796420 [info ] [MainThread]: 
[0m09:59:08.799797 [info ] [MainThread]: Finished running 2 table models, 4 view models in 0 hours 0 minutes and 14.35 seconds (14.35s).
[0m09:59:08.817649 [debug] [MainThread]: Command end result
[0m09:59:08.997772 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m09:59:09.025847 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m09:59:09.063854 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dags/dbt_models/target/run_results.json
[0m09:59:09.065497 [info ] [MainThread]: 
[0m09:59:09.067458 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:59:09.070609 [info ] [MainThread]: 
[0m09:59:09.073889 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m09:59:09.081444 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 61.190105, "process_in_blocks": "2870016", "process_kernel_time": 10.372034, "process_mem_max_rss": "133608", "process_out_blocks": "0", "process_user_time": 16.754042}
[0m09:59:09.083187 [debug] [MainThread]: Command `dbt run` succeeded at 09:59:09.082913 after 61.19 seconds
[0m09:59:09.084551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5da99dc440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d9fabb140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d9fbf67e0>]}
[0m09:59:09.087134 [debug] [MainThread]: Flushing usage events
[0m09:59:10.999091 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:00:27.713948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe07d009040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe07f1e40e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe07d00bd70>]}


============================== 10:00:27.726356 | 54334164-84c1-4a2b-9786-faca77e44927 ==============================
[0m10:00:27.726356 [info ] [MainThread]: Running with dbt=1.9.1
[0m10:00:27.727945 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt/profiles.yml', 'log_path': '/opt/airflow/dags/dbt_models/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt/profiles.yml --target dev', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:00:28.367877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '54334164-84c1-4a2b-9786-faca77e44927', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe07cf5ef90>]}
[0m10:00:28.492177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '54334164-84c1-4a2b-9786-faca77e44927', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe07d9ed2b0>]}
[0m10:00:28.503999 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m10:00:28.723821 [debug] [MainThread]: checksum: cac3b9519010e47bfbeb71ca6efb4867dae2858687671594dc23fefc94ecf25d, vars: {}, profile: , target: dev, version: 1.9.1
[0m10:00:29.229516 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:00:29.231987 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/facts/sales_fact.sql
[0m10:00:30.029995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '54334164-84c1-4a2b-9786-faca77e44927', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe077131d60>]}
[0m10:00:30.209277 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m10:00:30.222307 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m10:00:30.314833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '54334164-84c1-4a2b-9786-faca77e44927', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe07735c470>]}
[0m10:00:30.317420 [info ] [MainThread]: Found 6 models, 1 source, 424 macros
[0m10:00:30.318956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '54334164-84c1-4a2b-9786-faca77e44927', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0768576b0>]}
[0m10:00:30.324038 [info ] [MainThread]: 
[0m10:00:30.325315 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:00:30.326608 [info ] [MainThread]: 
[0m10:00:30.328350 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m10:00:30.338876 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_sales_database'
[0m10:00:30.427684 [debug] [ThreadPool]: Using duckdb connection "list_sales_database"
[0m10:00:30.428982 [debug] [ThreadPool]: On list_sales_database: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "list_sales_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"sales_database"'
    
  
  
[0m10:00:30.430107 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:00:30.468117 [debug] [ThreadPool]: SQL status: OK in 0.038 seconds
[0m10:00:30.470873 [debug] [ThreadPool]: On list_sales_database: Close
[0m10:00:30.476448 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_database, now create_sales_database_main)
[0m10:00:30.478050 [debug] [ThreadPool]: Creating schema "database: "sales_database"
schema: "main"
"
[0m10:00:30.492992 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m10:00:30.494396 [debug] [ThreadPool]: On create_sales_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "create_sales_database_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='sales_database'
        and type='sqlite'
    
  
[0m10:00:30.495842 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:00:30.536230 [debug] [ThreadPool]: SQL status: OK in 0.040 seconds
[0m10:00:30.539147 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m10:00:30.540452 [debug] [ThreadPool]: On create_sales_database_main: BEGIN
[0m10:00:30.542169 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:00:30.543434 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m10:00:30.544761 [debug] [ThreadPool]: On create_sales_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "create_sales_database_main"} */

    
    
        create schema if not exists "sales_database"."main"
    
[0m10:00:30.546585 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:00:30.549438 [debug] [ThreadPool]: On create_sales_database_main: COMMIT
[0m10:00:30.551216 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m10:00:30.552562 [debug] [ThreadPool]: On create_sales_database_main: COMMIT
[0m10:00:30.554433 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:00:30.555742 [debug] [ThreadPool]: On create_sales_database_main: Close
[0m10:00:30.562840 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_sales_database_main, now list_sales_database_main)
[0m10:00:30.573447 [debug] [ThreadPool]: Using duckdb connection "list_sales_database_main"
[0m10:00:30.574940 [debug] [ThreadPool]: On list_sales_database_main: BEGIN
[0m10:00:30.576123 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:00:30.609420 [debug] [ThreadPool]: SQL status: OK in 0.033 seconds
[0m10:00:30.610853 [debug] [ThreadPool]: Using duckdb connection "list_sales_database_main"
[0m10:00:30.612186 [debug] [ThreadPool]: On list_sales_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "list_sales_database_main"} */
select
      'sales_database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'sales_database'
  
[0m10:00:30.661469 [debug] [ThreadPool]: SQL status: OK in 0.048 seconds
[0m10:00:30.664623 [debug] [ThreadPool]: On list_sales_database_main: ROLLBACK
[0m10:00:30.669352 [debug] [ThreadPool]: Failed to rollback 'list_sales_database_main'
[0m10:00:30.670618 [debug] [ThreadPool]: On list_sales_database_main: Close
[0m10:00:30.679128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '54334164-84c1-4a2b-9786-faca77e44927', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0772ee6c0>]}
[0m10:00:30.680733 [debug] [MainThread]: Using duckdb connection "master"
[0m10:00:30.682103 [debug] [MainThread]: On master: BEGIN
[0m10:00:30.684012 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:00:30.720909 [debug] [MainThread]: SQL status: OK in 0.037 seconds
[0m10:00:30.722285 [debug] [MainThread]: On master: COMMIT
[0m10:00:30.723780 [debug] [MainThread]: Using duckdb connection "master"
[0m10:00:30.725123 [debug] [MainThread]: On master: COMMIT
[0m10:00:30.727313 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m10:00:30.728663 [debug] [MainThread]: On master: Close
[0m10:00:30.737610 [debug] [Thread-1 (]: Began running node model.my_dbt_project.customer_dimension
[0m10:00:30.739326 [info ] [Thread-1 (]: 1 of 6 START sql view model main.customer_dimension ............................ [RUN]
[0m10:00:30.740957 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.my_dbt_project.customer_dimension'
[0m10:00:30.742378 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.customer_dimension
[0m10:00:30.756573 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.customer_dimension"
[0m10:00:30.777462 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.customer_dimension
[0m10:00:30.843039 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.customer_dimension"
[0m10:00:30.864269 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m10:00:30.866170 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: BEGIN
[0m10:00:30.867962 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:00:30.905951 [debug] [Thread-1 (]: SQL status: OK in 0.038 seconds
[0m10:00:30.907455 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m10:00:30.908936 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */

  
  create view "sales_database"."main"."customer_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
    DISTINCT
    customer AS customer_id,
    customer_name,
    customer_address,
    customer_group,
    territory,
    language AS customer_language
FROM sales
WHERE customer IS NOT NULL
  );

[0m10:00:30.911738 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:00:30.926073 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m10:00:30.927745 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */
alter view "sales_database"."main"."customer_dimension" rename to "customer_dimension__dbt_backup"
[0m10:00:30.929901 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:00:30.937808 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m10:00:30.939343 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */
alter view "sales_database"."main"."customer_dimension__dbt_tmp" rename to "customer_dimension"
[0m10:00:30.941503 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:00:30.965656 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: COMMIT
[0m10:00:30.967784 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m10:00:30.969338 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: COMMIT
[0m10:00:30.984121 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m10:00:30.995161 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m10:00:30.997034 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */
drop view if exists "sales_database"."main"."customer_dimension__dbt_backup" cascade
[0m10:00:31.005801 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m10:00:31.014411 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: Close
[0m10:00:31.097089 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '54334164-84c1-4a2b-9786-faca77e44927', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe075ccf620>]}
[0m10:00:31.105336 [info ] [Thread-1 (]: 1 of 6 OK created sql view model main.customer_dimension ....................... [[32mOK[0m in 0.35s]
[0m10:00:31.108707 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.customer_dimension
[0m10:00:31.111235 [debug] [Thread-1 (]: Began running node model.my_dbt_project.date_dimension
[0m10:00:31.118093 [info ] [Thread-1 (]: 2 of 6 START sql view model main.date_dimension ................................ [RUN]
[0m10:00:31.122387 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customer_dimension, now model.my_dbt_project.date_dimension)
[0m10:00:31.125010 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.date_dimension
[0m10:00:31.144297 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.date_dimension"
[0m10:00:31.160599 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.date_dimension
[0m10:00:31.174653 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.date_dimension"
[0m10:00:31.192242 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m10:00:31.193688 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: BEGIN
[0m10:00:31.195755 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:00:31.225676 [debug] [Thread-1 (]: SQL status: OK in 0.030 seconds
[0m10:00:31.227088 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m10:00:31.229326 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.date_dimension"} */

  
  create view "sales_database"."main"."date_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
    transaction_date,
    strftime(transaction_date, '%A') AS weekday_name,  -- Extract weekday name
    strftime(transaction_date, '%m') AS month,          -- Extract month (numeric)
    strftime(transaction_date, '%Y') AS year,           -- Extract year
    strftime(transaction_date, '%d') AS day,            -- Extract day
    EXTRACT(QUARTER FROM transaction_date) AS quarter   -- Extract quarter
FROM sales
WHERE transaction_date IS NOT NULL
  );

[0m10:00:31.237625 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m10:00:31.244898 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m10:00:31.246316 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.date_dimension"} */
alter view "sales_database"."main"."date_dimension" rename to "date_dimension__dbt_backup"
[0m10:00:31.250766 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m10:00:31.257815 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m10:00:31.259223 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.date_dimension"} */
alter view "sales_database"."main"."date_dimension__dbt_tmp" rename to "date_dimension"
[0m10:00:31.261404 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:00:31.267647 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: COMMIT
[0m10:00:31.269030 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m10:00:31.270331 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: COMMIT
[0m10:00:31.280951 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m10:00:31.288895 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m10:00:31.290335 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.date_dimension"} */
drop view if exists "sales_database"."main"."date_dimension__dbt_backup" cascade
[0m10:00:31.295013 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m10:00:31.298510 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: Close
[0m10:00:31.357317 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '54334164-84c1-4a2b-9786-faca77e44927', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe076857410>]}
[0m10:00:31.359535 [info ] [Thread-1 (]: 2 of 6 OK created sql view model main.date_dimension ........................... [[32mOK[0m in 0.24s]
[0m10:00:31.362252 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.date_dimension
[0m10:00:31.364479 [debug] [Thread-1 (]: Began running node model.my_dbt_project.product_dimension
[0m10:00:31.367722 [info ] [Thread-1 (]: 3 of 6 START sql view model main.product_dimension ............................. [RUN]
[0m10:00:31.370037 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.date_dimension, now model.my_dbt_project.product_dimension)
[0m10:00:31.371986 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.product_dimension
[0m10:00:31.380537 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.product_dimension"
[0m10:00:31.404871 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.product_dimension
[0m10:00:31.426092 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.product_dimension"
[0m10:00:31.447850 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m10:00:31.450596 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: BEGIN
[0m10:00:31.452717 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:00:31.489274 [debug] [Thread-1 (]: SQL status: OK in 0.036 seconds
[0m10:00:31.491507 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m10:00:31.493923 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.product_dimension"} */

  
  create view "sales_database"."main"."product_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * 
    FROM "sales_database"."main"."sales"
)

SELECT 
    sales.name,
    json_extract(items, '$[0].name') AS product_name,  -- Example to extract the first element's "name" field from JSON array
    json_extract(items, '$[0].item_code') AS product_item_code
FROM sales
WHERE json_extract(items, '$[0].name') IS NOT NULL  -- Filter to only keep rows with a non-null product name
  );

[0m10:00:31.505242 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m10:00:31.516822 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m10:00:31.518687 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.product_dimension"} */
alter view "sales_database"."main"."product_dimension" rename to "product_dimension__dbt_backup"
[0m10:00:31.522059 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:00:31.531820 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m10:00:31.533950 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.product_dimension"} */
alter view "sales_database"."main"."product_dimension__dbt_tmp" rename to "product_dimension"
[0m10:00:31.536576 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:00:31.541872 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: COMMIT
[0m10:00:31.543273 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m10:00:31.545631 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: COMMIT
[0m10:00:31.557086 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m10:00:31.567758 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m10:00:31.569097 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.product_dimension"} */
drop view if exists "sales_database"."main"."product_dimension__dbt_backup" cascade
[0m10:00:31.573999 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m10:00:31.578257 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: Close
[0m10:00:31.649721 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '54334164-84c1-4a2b-9786-faca77e44927', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe075dbf590>]}
[0m10:00:31.652357 [info ] [Thread-1 (]: 3 of 6 OK created sql view model main.product_dimension ........................ [[32mOK[0m in 0.28s]
[0m10:00:31.660948 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.product_dimension
[0m10:00:31.664005 [debug] [Thread-1 (]: Began running node model.my_dbt_project.sales_team_dimension
[0m10:00:31.667209 [info ] [Thread-1 (]: 4 of 6 START sql view model main.sales_team_dimension .......................... [RUN]
[0m10:00:31.669160 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.product_dimension, now model.my_dbt_project.sales_team_dimension)
[0m10:00:31.672012 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.sales_team_dimension
[0m10:00:31.681462 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.sales_team_dimension"
[0m10:00:31.698027 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.sales_team_dimension
[0m10:00:31.706856 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.sales_team_dimension"
[0m10:00:31.717806 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m10:00:31.718979 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: BEGIN
[0m10:00:31.720024 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:00:31.742811 [debug] [Thread-1 (]: SQL status: OK in 0.023 seconds
[0m10:00:31.744101 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m10:00:31.745313 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */

  
  create view "sales_database"."main"."sales_team_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
    DISTINCT
    sales_team->>'name' AS sales_team_id,
    sales_team->>'region' AS sales_team_region
FROM sales
WHERE sales_team IS NOT NULL
  );

[0m10:00:31.747874 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:00:31.757125 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m10:00:31.758441 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */
alter view "sales_database"."main"."sales_team_dimension" rename to "sales_team_dimension__dbt_backup"
[0m10:00:31.760402 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:00:31.767381 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m10:00:31.768619 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */
alter view "sales_database"."main"."sales_team_dimension__dbt_tmp" rename to "sales_team_dimension"
[0m10:00:31.770488 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:00:31.774062 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: COMMIT
[0m10:00:31.775279 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m10:00:31.776438 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: COMMIT
[0m10:00:31.786180 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m10:00:31.791297 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m10:00:31.792629 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */
drop view if exists "sales_database"."main"."sales_team_dimension__dbt_backup" cascade
[0m10:00:31.797791 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m10:00:31.803401 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: Close
[0m10:00:31.859300 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '54334164-84c1-4a2b-9786-faca77e44927', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe074136210>]}
[0m10:00:31.862094 [info ] [Thread-1 (]: 4 of 6 OK created sql view model main.sales_team_dimension ..................... [[32mOK[0m in 0.19s]
[0m10:00:31.867753 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.sales_team_dimension
[0m10:00:31.870187 [debug] [Thread-1 (]: Began running node model.my_dbt_project.transform_sales
[0m10:00:31.872363 [info ] [Thread-1 (]: 5 of 6 START sql table model main.transform_sales .............................. [RUN]
[0m10:00:31.874393 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.sales_team_dimension, now model.my_dbt_project.transform_sales)
[0m10:00:31.875805 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.transform_sales
[0m10:00:31.884247 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.transform_sales"
[0m10:00:31.896568 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.transform_sales
[0m10:00:31.939704 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.transform_sales"
[0m10:00:31.952232 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m10:00:31.953420 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: BEGIN
[0m10:00:31.954820 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:00:31.982478 [debug] [Thread-1 (]: SQL status: OK in 0.027 seconds
[0m10:00:31.984198 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m10:00:31.985617 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */

  
    
    

    create  table
      "sales_database"."main"."transform_sales__dbt_tmp"
  
    as (
      -- /opt/airflow/dags/dbt_models/transform_users.sql


WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
   *
FROM sales
WHERE name = 'ABC private LTD-0002'
    );
  
  
[0m10:00:32.003026 [debug] [Thread-1 (]: SQL status: OK in 0.016 seconds
[0m10:00:32.008530 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m10:00:32.009821 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */
alter table "sales_database"."main"."transform_sales" rename to "transform_sales__dbt_backup"
[0m10:00:32.011831 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:00:32.018972 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m10:00:32.020665 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */
alter table "sales_database"."main"."transform_sales__dbt_tmp" rename to "transform_sales"
[0m10:00:32.023515 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:00:32.035271 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: COMMIT
[0m10:00:32.036531 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m10:00:32.037750 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: COMMIT
[0m10:00:32.048831 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m10:00:32.054297 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m10:00:32.055605 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */
drop table if exists "sales_database"."main"."transform_sales__dbt_backup" cascade
[0m10:00:32.060547 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m10:00:32.063826 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: Close
[0m10:00:32.133633 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '54334164-84c1-4a2b-9786-faca77e44927', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe07412fb90>]}
[0m10:00:32.135970 [info ] [Thread-1 (]: 5 of 6 OK created sql table model main.transform_sales ......................... [[32mOK[0m in 0.26s]
[0m10:00:32.139343 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.transform_sales
[0m10:00:32.141876 [debug] [Thread-1 (]: Began running node model.my_dbt_project.sales_fact
[0m10:00:32.144333 [info ] [Thread-1 (]: 6 of 6 START sql table model main.sales_fact ................................... [RUN]
[0m10:00:32.148159 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.transform_sales, now model.my_dbt_project.sales_fact)
[0m10:00:32.152076 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.sales_fact
[0m10:00:32.163676 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.sales_fact"
[0m10:00:32.181111 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.sales_fact
[0m10:00:32.191095 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.sales_fact"
[0m10:00:32.206288 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_fact"
[0m10:00:32.207489 [debug] [Thread-1 (]: On model.my_dbt_project.sales_fact: BEGIN
[0m10:00:32.208548 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:00:32.235326 [debug] [Thread-1 (]: SQL status: OK in 0.027 seconds
[0m10:00:32.236543 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_fact"
[0m10:00:32.237949 [debug] [Thread-1 (]: On model.my_dbt_project.sales_fact: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_fact"} */

  
    
    

    create  table
      "sales_database"."main"."sales_fact__dbt_tmp"
  
    as (
      WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
),
customer AS (
    SELECT * FROM "sales_database"."main"."customer_dimension"
),
product AS (
    SELECT * FROM "sales_database"."main"."product_dimension"
),
sales_team AS (
    SELECT * FROM "sales_database"."main"."sales_team_dimension"
),
date AS (
    SELECT * FROM "sales_database"."main"."date_dimension"
)

SELECT
    sales.name AS sales_id,
    customer.customer_id,
    product.product_id,
    sales_team.sales_team_id,
    date.date_id,
    sales.total_qty,
    sales.total_net_weight,
    sales.total,
    sales.net_total,
    sales.grand_total,
    sales.tax_category
FROM sales
JOIN customer 
    ON sales.customer = customer.customer_id
-- Handling product as a lateral join
JOIN LATERAL (
    SELECT json_extract_string(items, '$[0].product_id') AS product_id
    FROM unnest(json_extract(sales.items, '$')) AS product(items)
    WHERE json_extract_string(items, '$[0].product_id') IS NOT NULL
) AS product ON TRUE
-- Handling sales_team as a lateral join
JOIN LATERAL (
    SELECT json_extract_string(sales_team, '$[0].sales_team_id') AS sales_team_id
    FROM unnest(json_extract(sales.sales_team, '$')) AS team(sales_team)
    WHERE json_extract_string(sales_team, '$[0].sales_team_id') IS NOT NULL
) AS sales_team ON TRUE
JOIN date 
    ON sales.transaction_date = date.date_id
    );
  
  
[0m10:00:32.253389 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_fact"} */

  
    
    

    create  table
      "sales_database"."main"."sales_fact__dbt_tmp"
  
    as (
      WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
),
customer AS (
    SELECT * FROM "sales_database"."main"."customer_dimension"
),
product AS (
    SELECT * FROM "sales_database"."main"."product_dimension"
),
sales_team AS (
    SELECT * FROM "sales_database"."main"."sales_team_dimension"
),
date AS (
    SELECT * FROM "sales_database"."main"."date_dimension"
)

SELECT
    sales.name AS sales_id,
    customer.customer_id,
    product.product_id,
    sales_team.sales_team_id,
    date.date_id,
    sales.total_qty,
    sales.total_net_weight,
    sales.total,
    sales.net_total,
    sales.grand_total,
    sales.tax_category
FROM sales
JOIN customer 
    ON sales.customer = customer.customer_id
-- Handling product as a lateral join
JOIN LATERAL (
    SELECT json_extract_string(items, '$[0].product_id') AS product_id
    FROM unnest(json_extract(sales.items, '$')) AS product(items)
    WHERE json_extract_string(items, '$[0].product_id') IS NOT NULL
) AS product ON TRUE
-- Handling sales_team as a lateral join
JOIN LATERAL (
    SELECT json_extract_string(sales_team, '$[0].sales_team_id') AS sales_team_id
    FROM unnest(json_extract(sales.sales_team, '$')) AS team(sales_team)
    WHERE json_extract_string(sales_team, '$[0].sales_team_id') IS NOT NULL
) AS sales_team ON TRUE
JOIN date 
    ON sales.transaction_date = date.date_id
    );
  
  
[0m10:00:32.254971 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m10:00:32.256388 [debug] [Thread-1 (]: On model.my_dbt_project.sales_fact: ROLLBACK
[0m10:00:32.270546 [debug] [Thread-1 (]: Failed to rollback 'model.my_dbt_project.sales_fact'
[0m10:00:32.271735 [debug] [Thread-1 (]: On model.my_dbt_project.sales_fact: Close
[0m10:00:32.278822 [debug] [Thread-1 (]: Runtime Error in model sales_fact (models/facts/sales_fact.sql)
  Binder Error: UNNEST requires a single list as input
[0m10:00:32.280262 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '54334164-84c1-4a2b-9786-faca77e44927', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe075d649b0>]}
[0m10:00:32.282930 [error] [Thread-1 (]: 6 of 6 ERROR creating sql table model main.sales_fact .......................... [[31mERROR[0m in 0.13s]
[0m10:00:32.284913 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.sales_fact
[0m10:00:32.286422 [debug] [Thread-4 (]: Marking all children of 'model.my_dbt_project.sales_fact' to be skipped because of status 'error'.  Reason: Runtime Error in model sales_fact (models/facts/sales_fact.sql)
  Binder Error: UNNEST requires a single list as input.
[0m10:00:32.290533 [debug] [MainThread]: Using duckdb connection "master"
[0m10:00:32.291751 [debug] [MainThread]: On master: BEGIN
[0m10:00:32.292785 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:00:32.320455 [debug] [MainThread]: SQL status: OK in 0.028 seconds
[0m10:00:32.321707 [debug] [MainThread]: On master: COMMIT
[0m10:00:32.322754 [debug] [MainThread]: Using duckdb connection "master"
[0m10:00:32.323889 [debug] [MainThread]: On master: COMMIT
[0m10:00:32.325675 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m10:00:32.326867 [debug] [MainThread]: On master: Close
[0m10:00:32.331269 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:00:32.332871 [debug] [MainThread]: Connection 'list_sales_database_main' was properly closed.
[0m10:00:32.334419 [debug] [MainThread]: Connection 'model.my_dbt_project.sales_fact' was properly closed.
[0m10:00:32.335714 [info ] [MainThread]: 
[0m10:00:32.336868 [info ] [MainThread]: Finished running 2 table models, 4 view models in 0 hours 0 minutes and 2.01 seconds (2.01s).
[0m10:00:32.339817 [debug] [MainThread]: Command end result
[0m10:00:32.430347 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m10:00:32.442387 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m10:00:32.463092 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dags/dbt_models/target/run_results.json
[0m10:00:32.464287 [info ] [MainThread]: 
[0m10:00:32.466517 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m10:00:32.468049 [info ] [MainThread]: 
[0m10:00:32.469610 [error] [MainThread]:   Runtime Error in model sales_fact (models/facts/sales_fact.sql)
  Binder Error: UNNEST requires a single list as input
[0m10:00:32.470876 [info ] [MainThread]: 
[0m10:00:32.472259 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m10:00:32.475447 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 4.932329, "process_in_blocks": "78024", "process_kernel_time": 1.056403, "process_mem_max_rss": "160532", "process_out_blocks": "0", "process_user_time": 8.268385}
[0m10:00:32.476781 [debug] [MainThread]: Command `dbt run` failed at 10:00:32.476596 after 4.93 seconds
[0m10:00:32.477907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe07ef2a9f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe07717c470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe07d705f70>]}
[0m10:00:32.478990 [debug] [MainThread]: Flushing usage events
[0m10:00:34.028547 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:02:36.895063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fcc33d070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fcbb05730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fcbe7a1b0>]}


============================== 10:02:37.146975 | 0d43d64d-a701-4822-946d-8baded9056e7 ==============================
[0m10:02:37.146975 [info ] [MainThread]: Running with dbt=1.9.1
[0m10:02:37.165812 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt/profiles.yml', 'log_path': '/opt/airflow/dags/dbt_models/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt/profiles.yml --target dev', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:02:41.831170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0d43d64d-a701-4822-946d-8baded9056e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fcb5c3650>]}
[0m10:02:42.495061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0d43d64d-a701-4822-946d-8baded9056e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fcbd96870>]}
[0m10:02:42.530581 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m10:02:43.956907 [debug] [MainThread]: checksum: cac3b9519010e47bfbeb71ca6efb4867dae2858687671594dc23fefc94ecf25d, vars: {}, profile: , target: dev, version: 1.9.1
[0m10:02:45.852313 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:02:45.861955 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/facts/sales_fact.sql
[0m10:02:48.493494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0d43d64d-a701-4822-946d-8baded9056e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fc7e8b920>]}
[0m10:02:49.332389 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m10:02:49.444212 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m10:02:49.760855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0d43d64d-a701-4822-946d-8baded9056e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fc5d80740>]}
[0m10:02:49.779121 [info ] [MainThread]: Found 6 models, 1 source, 424 macros
[0m10:02:49.797746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0d43d64d-a701-4822-946d-8baded9056e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fcb66f410>]}
[0m10:02:49.805815 [info ] [MainThread]: 
[0m10:02:49.835911 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:02:49.841101 [info ] [MainThread]: 
[0m10:02:49.844476 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m10:02:49.899620 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_sales_database'
[0m10:02:50.183979 [debug] [ThreadPool]: Using duckdb connection "list_sales_database"
[0m10:02:50.188391 [debug] [ThreadPool]: On list_sales_database: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "list_sales_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"sales_database"'
    
  
  
[0m10:02:50.192939 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:02:50.292461 [debug] [ThreadPool]: SQL status: OK in 0.100 seconds
[0m10:02:50.298800 [debug] [ThreadPool]: On list_sales_database: Close
[0m10:02:50.315416 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_database, now create_sales_database_main)
[0m10:02:50.321824 [debug] [ThreadPool]: Creating schema "database: "sales_database"
schema: "main"
"
[0m10:02:50.362880 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m10:02:50.367135 [debug] [ThreadPool]: On create_sales_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "create_sales_database_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='sales_database'
        and type='sqlite'
    
  
[0m10:02:50.371381 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:02:50.482726 [debug] [ThreadPool]: SQL status: OK in 0.111 seconds
[0m10:02:50.489338 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m10:02:50.493018 [debug] [ThreadPool]: On create_sales_database_main: BEGIN
[0m10:02:50.496174 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:02:50.498604 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m10:02:50.501183 [debug] [ThreadPool]: On create_sales_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "create_sales_database_main"} */

    
    
        create schema if not exists "sales_database"."main"
    
[0m10:02:50.511434 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m10:02:50.515344 [debug] [ThreadPool]: On create_sales_database_main: COMMIT
[0m10:02:50.517772 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m10:02:50.522531 [debug] [ThreadPool]: On create_sales_database_main: COMMIT
[0m10:02:50.527484 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:02:50.529466 [debug] [ThreadPool]: On create_sales_database_main: Close
[0m10:02:50.544478 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_sales_database_main, now list_sales_database_main)
[0m10:02:50.578843 [debug] [ThreadPool]: Using duckdb connection "list_sales_database_main"
[0m10:02:50.582089 [debug] [ThreadPool]: On list_sales_database_main: BEGIN
[0m10:02:50.584479 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:02:50.667248 [debug] [ThreadPool]: SQL status: OK in 0.083 seconds
[0m10:02:50.669409 [debug] [ThreadPool]: Using duckdb connection "list_sales_database_main"
[0m10:02:50.671755 [debug] [ThreadPool]: On list_sales_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "list_sales_database_main"} */
select
      'sales_database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'sales_database'
  
[0m10:02:50.834363 [debug] [ThreadPool]: SQL status: OK in 0.159 seconds
[0m10:02:50.850125 [debug] [ThreadPool]: On list_sales_database_main: ROLLBACK
[0m10:02:50.874652 [debug] [ThreadPool]: Failed to rollback 'list_sales_database_main'
[0m10:02:50.876509 [debug] [ThreadPool]: On list_sales_database_main: Close
[0m10:02:50.891752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0d43d64d-a701-4822-946d-8baded9056e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fcb5c0260>]}
[0m10:02:50.895297 [debug] [MainThread]: Using duckdb connection "master"
[0m10:02:50.897143 [debug] [MainThread]: On master: BEGIN
[0m10:02:50.899017 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:02:50.981687 [debug] [MainThread]: SQL status: OK in 0.083 seconds
[0m10:02:50.983681 [debug] [MainThread]: On master: COMMIT
[0m10:02:50.985416 [debug] [MainThread]: Using duckdb connection "master"
[0m10:02:50.990645 [debug] [MainThread]: On master: COMMIT
[0m10:02:50.993366 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m10:02:50.995165 [debug] [MainThread]: On master: Close
[0m10:02:51.007643 [debug] [Thread-1 (]: Began running node model.my_dbt_project.customer_dimension
[0m10:02:51.010177 [info ] [Thread-1 (]: 1 of 6 START sql view model main.customer_dimension ............................ [RUN]
[0m10:02:51.016798 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.my_dbt_project.customer_dimension'
[0m10:02:51.023427 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.customer_dimension
[0m10:02:51.110772 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.customer_dimension"
[0m10:02:51.141642 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.customer_dimension
[0m10:02:51.356700 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.customer_dimension"
[0m10:02:51.395392 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m10:02:51.398198 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: BEGIN
[0m10:02:51.405532 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:02:51.485177 [debug] [Thread-1 (]: SQL status: OK in 0.080 seconds
[0m10:02:51.490183 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m10:02:51.496089 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */

  
  create view "sales_database"."main"."customer_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
    DISTINCT
    customer AS customer_id,
    customer_name,
    customer_address,
    customer_group,
    territory,
    language AS customer_language
FROM sales
WHERE customer IS NOT NULL
  );

[0m10:02:51.501229 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:02:51.536407 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m10:02:51.538741 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */
alter view "sales_database"."main"."customer_dimension" rename to "customer_dimension__dbt_backup"
[0m10:02:51.548899 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m10:02:51.562510 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m10:02:51.564973 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */
alter view "sales_database"."main"."customer_dimension__dbt_tmp" rename to "customer_dimension"
[0m10:02:51.568320 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:02:51.622890 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: COMMIT
[0m10:02:51.624970 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m10:02:51.627774 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: COMMIT
[0m10:02:51.650948 [debug] [Thread-1 (]: SQL status: OK in 0.019 seconds
[0m10:02:51.696307 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m10:02:51.711703 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */
drop view if exists "sales_database"."main"."customer_dimension__dbt_backup" cascade
[0m10:02:51.729919 [debug] [Thread-1 (]: SQL status: OK in 0.016 seconds
[0m10:02:51.749469 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: Close
[0m10:02:52.031069 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d43d64d-a701-4822-946d-8baded9056e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fc42e44d0>]}
[0m10:02:52.049143 [info ] [Thread-1 (]: 1 of 6 OK created sql view model main.customer_dimension ....................... [[32mOK[0m in 0.97s]
[0m10:02:52.065926 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.customer_dimension
[0m10:02:52.069681 [debug] [Thread-1 (]: Began running node model.my_dbt_project.date_dimension
[0m10:02:52.086788 [info ] [Thread-1 (]: 2 of 6 START sql view model main.date_dimension ................................ [RUN]
[0m10:02:52.108649 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customer_dimension, now model.my_dbt_project.date_dimension)
[0m10:02:52.118097 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.date_dimension
[0m10:02:52.159002 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.date_dimension"
[0m10:02:52.261721 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.date_dimension
[0m10:02:52.302226 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.date_dimension"
[0m10:02:52.329028 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m10:02:52.332304 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: BEGIN
[0m10:02:52.346535 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:02:52.406640 [debug] [Thread-1 (]: SQL status: OK in 0.060 seconds
[0m10:02:52.409903 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m10:02:52.412130 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.date_dimension"} */

  
  create view "sales_database"."main"."date_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
    transaction_date,
    strftime(transaction_date, '%A') AS weekday_name,  -- Extract weekday name
    strftime(transaction_date, '%m') AS month,          -- Extract month (numeric)
    strftime(transaction_date, '%Y') AS year,           -- Extract year
    strftime(transaction_date, '%d') AS day,            -- Extract day
    EXTRACT(QUARTER FROM transaction_date) AS quarter   -- Extract quarter
FROM sales
WHERE transaction_date IS NOT NULL
  );

[0m10:02:52.426668 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m10:02:52.442587 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m10:02:52.444908 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.date_dimension"} */
alter view "sales_database"."main"."date_dimension" rename to "date_dimension__dbt_backup"
[0m10:02:52.448318 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:02:52.463799 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m10:02:52.465836 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.date_dimension"} */
alter view "sales_database"."main"."date_dimension__dbt_tmp" rename to "date_dimension"
[0m10:02:52.469060 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:02:52.480505 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: COMMIT
[0m10:02:52.482882 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m10:02:52.484806 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: COMMIT
[0m10:02:52.497898 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m10:02:52.508319 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m10:02:52.512201 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.date_dimension"} */
drop view if exists "sales_database"."main"."date_dimension__dbt_backup" cascade
[0m10:02:52.517901 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m10:02:52.524353 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: Close
[0m10:02:52.605763 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d43d64d-a701-4822-946d-8baded9056e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fcc3104a0>]}
[0m10:02:52.617509 [info ] [Thread-1 (]: 2 of 6 OK created sql view model main.date_dimension ........................... [[32mOK[0m in 0.50s]
[0m10:02:52.622843 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.date_dimension
[0m10:02:52.625575 [debug] [Thread-1 (]: Began running node model.my_dbt_project.product_dimension
[0m10:02:52.629259 [info ] [Thread-1 (]: 3 of 6 START sql view model main.product_dimension ............................. [RUN]
[0m10:02:52.638236 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.date_dimension, now model.my_dbt_project.product_dimension)
[0m10:02:52.640354 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.product_dimension
[0m10:02:52.651963 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.product_dimension"
[0m10:02:52.674682 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.product_dimension
[0m10:02:52.699704 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.product_dimension"
[0m10:02:52.730127 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m10:02:52.732345 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: BEGIN
[0m10:02:52.734489 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:02:52.818074 [debug] [Thread-1 (]: SQL status: OK in 0.084 seconds
[0m10:02:52.823622 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m10:02:52.825731 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.product_dimension"} */

  
  create view "sales_database"."main"."product_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * 
    FROM "sales_database"."main"."sales"
)

SELECT 
    sales.name,
    json_extract(items, '$[0].name') AS product_name,  -- Example to extract the first element's "name" field from JSON array
    json_extract(items, '$[0].item_code') AS product_item_code
FROM sales
WHERE json_extract(items, '$[0].name') IS NOT NULL  -- Filter to only keep rows with a non-null product name
  );

[0m10:02:52.830699 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:02:52.842633 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m10:02:52.844637 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.product_dimension"} */
alter view "sales_database"."main"."product_dimension" rename to "product_dimension__dbt_backup"
[0m10:02:52.847642 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:02:52.859021 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m10:02:52.861224 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.product_dimension"} */
alter view "sales_database"."main"."product_dimension__dbt_tmp" rename to "product_dimension"
[0m10:02:52.864141 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:02:52.873180 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: COMMIT
[0m10:02:52.876030 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m10:02:52.878253 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: COMMIT
[0m10:02:52.894228 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m10:02:52.907909 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m10:02:52.910145 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.product_dimension"} */
drop view if exists "sales_database"."main"."product_dimension__dbt_backup" cascade
[0m10:02:52.927031 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m10:02:52.932272 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: Close
[0m10:02:53.030431 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d43d64d-a701-4822-946d-8baded9056e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fc42e10a0>]}
[0m10:02:53.033909 [info ] [Thread-1 (]: 3 of 6 OK created sql view model main.product_dimension ........................ [[32mOK[0m in 0.39s]
[0m10:02:53.040383 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.product_dimension
[0m10:02:53.044906 [debug] [Thread-1 (]: Began running node model.my_dbt_project.sales_team_dimension
[0m10:02:53.048128 [info ] [Thread-1 (]: 4 of 6 START sql view model main.sales_team_dimension .......................... [RUN]
[0m10:02:53.050589 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.product_dimension, now model.my_dbt_project.sales_team_dimension)
[0m10:02:53.054748 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.sales_team_dimension
[0m10:02:53.067491 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.sales_team_dimension"
[0m10:02:53.114661 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.sales_team_dimension
[0m10:02:53.175207 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.sales_team_dimension"
[0m10:02:53.229537 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m10:02:53.231613 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: BEGIN
[0m10:02:53.233958 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:02:53.311387 [debug] [Thread-1 (]: SQL status: OK in 0.077 seconds
[0m10:02:53.313775 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m10:02:53.315939 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */

  
  create view "sales_database"."main"."sales_team_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
    DISTINCT
    sales_team->>'name' AS sales_team_id,
    sales_team->>'region' AS sales_team_region
FROM sales
WHERE sales_team IS NOT NULL
  );

[0m10:02:53.331765 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m10:02:53.346688 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m10:02:53.349179 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */
alter view "sales_database"."main"."sales_team_dimension" rename to "sales_team_dimension__dbt_backup"
[0m10:02:53.354839 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m10:02:53.375305 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m10:02:53.380840 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */
alter view "sales_database"."main"."sales_team_dimension__dbt_tmp" rename to "sales_team_dimension"
[0m10:02:53.383788 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:02:53.391070 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: COMMIT
[0m10:02:53.393261 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m10:02:53.395380 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: COMMIT
[0m10:02:53.414586 [debug] [Thread-1 (]: SQL status: OK in 0.015 seconds
[0m10:02:53.425848 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m10:02:53.427994 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */
drop view if exists "sales_database"."main"."sales_team_dimension__dbt_backup" cascade
[0m10:02:53.433940 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m10:02:53.441619 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: Close
[0m10:02:53.514161 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d43d64d-a701-4822-946d-8baded9056e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fc4153050>]}
[0m10:02:53.517841 [info ] [Thread-1 (]: 4 of 6 OK created sql view model main.sales_team_dimension ..................... [[32mOK[0m in 0.46s]
[0m10:02:53.528524 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.sales_team_dimension
[0m10:02:53.530911 [debug] [Thread-1 (]: Began running node model.my_dbt_project.transform_sales
[0m10:02:53.533596 [info ] [Thread-1 (]: 5 of 6 START sql table model main.transform_sales .............................. [RUN]
[0m10:02:53.535906 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.sales_team_dimension, now model.my_dbt_project.transform_sales)
[0m10:02:53.542086 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.transform_sales
[0m10:02:53.556329 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.transform_sales"
[0m10:02:53.578453 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.transform_sales
[0m10:02:53.674245 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.transform_sales"
[0m10:02:53.693483 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m10:02:53.695479 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: BEGIN
[0m10:02:53.697679 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:02:53.746764 [debug] [Thread-1 (]: SQL status: OK in 0.049 seconds
[0m10:02:53.748873 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m10:02:53.751114 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */

  
    
    

    create  table
      "sales_database"."main"."transform_sales__dbt_tmp"
  
    as (
      -- /opt/airflow/dags/dbt_models/transform_users.sql


WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
   *
FROM sales
WHERE name = 'ABC private LTD-0002'
    );
  
  
[0m10:02:53.790319 [debug] [Thread-1 (]: SQL status: OK in 0.035 seconds
[0m10:02:53.802522 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m10:02:53.806357 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */
alter table "sales_database"."main"."transform_sales" rename to "transform_sales__dbt_backup"
[0m10:02:53.811211 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:02:53.824126 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m10:02:53.829996 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */
alter table "sales_database"."main"."transform_sales__dbt_tmp" rename to "transform_sales"
[0m10:02:53.835839 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:02:53.863310 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: COMMIT
[0m10:02:53.866308 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m10:02:53.870577 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: COMMIT
[0m10:02:53.894497 [debug] [Thread-1 (]: SQL status: OK in 0.021 seconds
[0m10:02:53.912277 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m10:02:53.914586 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */
drop table if exists "sales_database"."main"."transform_sales__dbt_backup" cascade
[0m10:02:53.923931 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m10:02:53.929703 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: Close
[0m10:02:54.074728 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d43d64d-a701-4822-946d-8baded9056e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fc4133ec0>]}
[0m10:02:54.077002 [info ] [Thread-1 (]: 5 of 6 OK created sql table model main.transform_sales ......................... [[32mOK[0m in 0.54s]
[0m10:02:54.081659 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.transform_sales
[0m10:02:54.084465 [debug] [Thread-1 (]: Began running node model.my_dbt_project.sales_fact
[0m10:02:54.091740 [info ] [Thread-1 (]: 6 of 6 START sql table model main.sales_fact ................................... [RUN]
[0m10:02:54.095523 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.transform_sales, now model.my_dbt_project.sales_fact)
[0m10:02:54.097521 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.sales_fact
[0m10:02:54.117212 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.sales_fact"
[0m10:02:54.150252 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.sales_fact
[0m10:02:54.168013 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.sales_fact"
[0m10:02:54.192283 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_fact"
[0m10:02:54.194876 [debug] [Thread-1 (]: On model.my_dbt_project.sales_fact: BEGIN
[0m10:02:54.196839 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:02:54.283136 [debug] [Thread-1 (]: SQL status: OK in 0.086 seconds
[0m10:02:54.289866 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_fact"
[0m10:02:54.293730 [debug] [Thread-1 (]: On model.my_dbt_project.sales_fact: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_fact"} */

  
    
    

    create  table
      "sales_database"."main"."sales_fact__dbt_tmp"
  
    as (
      WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
),
customer AS (
    SELECT * FROM "sales_database"."main"."customer_dimension"
),
product AS (
    SELECT * FROM "sales_database"."main"."product_dimension"
),
sales_team AS (
    SELECT * FROM "sales_database"."main"."sales_team_dimension"
),
date AS (
    SELECT * FROM "sales_database"."main"."date_dimension"
)

SELECT
    sales.name AS sales_id,
    customer.customer_id,
    product.product_id,
    sales_team.sales_team_id,
    date.date_id,
    sales.total_qty,
    sales.total_net_weight,
    sales.total,
    sales.net_total,
    sales.grand_total,
    sales.tax_category
FROM sales
JOIN customer 
    ON sales.customer = customer.customer_id
-- Handling product as a lateral join
JOIN LATERAL (
    SELECT item->>'product_id' AS product_id
    FROM jsonb_array_elements(sales.items) AS product(item)
    WHERE item->>'product_id' IS NOT NULL
) AS product ON TRUE
-- Handling sales_team as a lateral join
JOIN LATERAL (
    SELECT item->>'sales_team_id' AS sales_team_id
    FROM jsonb_array_elements(sales.sales_team) AS team(item)
    WHERE item->>'sales_team_id' IS NOT NULL
) AS sales_team ON TRUE
JOIN date 
    ON sales.transaction_date = date.date_id
    );
  
  
[0m10:02:54.351293 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_fact"} */

  
    
    

    create  table
      "sales_database"."main"."sales_fact__dbt_tmp"
  
    as (
      WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
),
customer AS (
    SELECT * FROM "sales_database"."main"."customer_dimension"
),
product AS (
    SELECT * FROM "sales_database"."main"."product_dimension"
),
sales_team AS (
    SELECT * FROM "sales_database"."main"."sales_team_dimension"
),
date AS (
    SELECT * FROM "sales_database"."main"."date_dimension"
)

SELECT
    sales.name AS sales_id,
    customer.customer_id,
    product.product_id,
    sales_team.sales_team_id,
    date.date_id,
    sales.total_qty,
    sales.total_net_weight,
    sales.total,
    sales.net_total,
    sales.grand_total,
    sales.tax_category
FROM sales
JOIN customer 
    ON sales.customer = customer.customer_id
-- Handling product as a lateral join
JOIN LATERAL (
    SELECT item->>'product_id' AS product_id
    FROM jsonb_array_elements(sales.items) AS product(item)
    WHERE item->>'product_id' IS NOT NULL
) AS product ON TRUE
-- Handling sales_team as a lateral join
JOIN LATERAL (
    SELECT item->>'sales_team_id' AS sales_team_id
    FROM jsonb_array_elements(sales.sales_team) AS team(item)
    WHERE item->>'sales_team_id' IS NOT NULL
) AS sales_team ON TRUE
JOIN date 
    ON sales.transaction_date = date.date_id
    );
  
  
[0m10:02:54.355058 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m10:02:54.357754 [debug] [Thread-1 (]: On model.my_dbt_project.sales_fact: ROLLBACK
[0m10:02:54.381004 [debug] [Thread-1 (]: Failed to rollback 'model.my_dbt_project.sales_fact'
[0m10:02:54.383023 [debug] [Thread-1 (]: On model.my_dbt_project.sales_fact: Close
[0m10:02:54.399243 [debug] [Thread-1 (]: Runtime Error in model sales_fact (models/facts/sales_fact.sql)
  Catalog Error: Table Function with name jsonb_array_elements does not exist!
  Did you mean "read_ndjson_objects"?
  LINE 45:     FROM jsonb_array_elements(sales.items) AS product(item)
      WHERE item->>'product_id' IS NOT NULL
  ) AS product ON TRUE
  -- Handling sales_team as a lateral join
  JOIN LATERAL (
      SELECT item->>'sales_team_id' AS sales_team_id
      FROM jsonb_array_elements(sales.sales_team) AS team(item)
      WHERE item->>'sales_team_id' IS NOT NULL
  ) AS sales_team ON TRUE
  JOIN date 
      ON sales.transaction_date = date.date_id
      );
    
    ...
                    ^
[0m10:02:54.404267 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d43d64d-a701-4822-946d-8baded9056e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fc42e9cd0>]}
[0m10:02:54.407446 [error] [Thread-1 (]: 6 of 6 ERROR creating sql table model main.sales_fact .......................... [[31mERROR[0m in 0.31s]
[0m10:02:54.410822 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.sales_fact
[0m10:02:54.413916 [debug] [Thread-4 (]: Marking all children of 'model.my_dbt_project.sales_fact' to be skipped because of status 'error'.  Reason: Runtime Error in model sales_fact (models/facts/sales_fact.sql)
  Catalog Error: Table Function with name jsonb_array_elements does not exist!
  Did you mean "read_ndjson_objects"?
  LINE 45:     FROM jsonb_array_elements(sales.items) AS product(item)
      WHERE item->>'product_id' IS NOT NULL
  ) AS product ON TRUE
  -- Handling sales_team as a lateral join
  JOIN LATERAL (
      SELECT item->>'sales_team_id' AS sales_team_id
      FROM jsonb_array_elements(sales.sales_team) AS team(item)
      WHERE item->>'sales_team_id' IS NOT NULL
  ) AS sales_team ON TRUE
  JOIN date 
      ON sales.transaction_date = date.date_id
      );
    
    ...
                    ^.
[0m10:02:54.422423 [debug] [MainThread]: Using duckdb connection "master"
[0m10:02:54.424582 [debug] [MainThread]: On master: BEGIN
[0m10:02:54.426485 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:02:54.474096 [debug] [MainThread]: SQL status: OK in 0.048 seconds
[0m10:02:54.476180 [debug] [MainThread]: On master: COMMIT
[0m10:02:54.478215 [debug] [MainThread]: Using duckdb connection "master"
[0m10:02:54.480191 [debug] [MainThread]: On master: COMMIT
[0m10:02:54.483147 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m10:02:54.485284 [debug] [MainThread]: On master: Close
[0m10:02:54.496014 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:02:54.498140 [debug] [MainThread]: Connection 'list_sales_database_main' was properly closed.
[0m10:02:54.499967 [debug] [MainThread]: Connection 'model.my_dbt_project.sales_fact' was properly closed.
[0m10:02:54.503876 [info ] [MainThread]: 
[0m10:02:54.506584 [info ] [MainThread]: Finished running 2 table models, 4 view models in 0 hours 0 minutes and 4.66 seconds (4.66s).
[0m10:02:54.513453 [debug] [MainThread]: Command end result
[0m10:02:54.655325 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m10:02:54.671204 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m10:02:54.707282 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dags/dbt_models/target/run_results.json
[0m10:02:54.709077 [info ] [MainThread]: 
[0m10:02:54.711344 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m10:02:54.713465 [info ] [MainThread]: 
[0m10:02:54.727408 [error] [MainThread]:   Runtime Error in model sales_fact (models/facts/sales_fact.sql)
  Catalog Error: Table Function with name jsonb_array_elements does not exist!
  Did you mean "read_ndjson_objects"?
  LINE 45:     FROM jsonb_array_elements(sales.items) AS product(item)
      WHERE item->>'product_id' IS NOT NULL
  ) AS product ON TRUE
  -- Handling sales_team as a lateral join
  JOIN LATERAL (
      SELECT item->>'sales_team_id' AS sales_team_id
      FROM jsonb_array_elements(sales.sales_team) AS team(item)
      WHERE item->>'sales_team_id' IS NOT NULL
  ) AS sales_team ON TRUE
  JOIN date 
      ON sales.transaction_date = date.date_id
      );
    
    ...
                    ^
[0m10:02:54.732209 [info ] [MainThread]: 
[0m10:02:54.735135 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m10:02:54.754984 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 19.021736, "process_in_blocks": "2192504", "process_kernel_time": 8.087995, "process_mem_max_rss": "147168", "process_out_blocks": "0", "process_user_time": 16.924877}
[0m10:02:54.761634 [debug] [MainThread]: Command `dbt run` failed at 10:02:54.761238 after 19.03 seconds
[0m10:02:54.766559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fcdba0f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fcc3132c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fcc3128a0>]}
[0m10:02:54.773888 [debug] [MainThread]: Flushing usage events
[0m10:02:56.676781 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:04:37.023014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb86fc46480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb86fa3e600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb86fc47c20>]}


============================== 10:04:37.081747 | d98d2eed-5a30-4e7a-a188-e7124b14eeb0 ==============================
[0m10:04:37.081747 [info ] [MainThread]: Running with dbt=1.9.1
[0m10:04:37.085559 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/profiles.yml', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dags/dbt_models/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt/profiles.yml --target dev', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:04:38.996248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd98d2eed-5a30-4e7a-a188-e7124b14eeb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb86b812330>]}
[0m10:04:39.691886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd98d2eed-5a30-4e7a-a188-e7124b14eeb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb86f6d0530>]}
[0m10:04:39.723017 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m10:04:40.505483 [debug] [MainThread]: checksum: cac3b9519010e47bfbeb71ca6efb4867dae2858687671594dc23fefc94ecf25d, vars: {}, profile: , target: dev, version: 1.9.1
[0m10:04:41.588655 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:04:41.591037 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/facts/sales_fact.sql
[0m10:04:42.996962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd98d2eed-5a30-4e7a-a188-e7124b14eeb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb869179190>]}
[0m10:04:43.428894 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m10:04:43.453165 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m10:04:43.898402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd98d2eed-5a30-4e7a-a188-e7124b14eeb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb86882d310>]}
[0m10:04:43.900520 [info ] [MainThread]: Found 6 models, 1 source, 424 macros
[0m10:04:43.908472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd98d2eed-5a30-4e7a-a188-e7124b14eeb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb868834c50>]}
[0m10:04:43.922330 [info ] [MainThread]: 
[0m10:04:43.923774 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:04:43.928455 [info ] [MainThread]: 
[0m10:04:43.931802 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m10:04:43.973113 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_sales_database'
[0m10:04:44.177190 [debug] [ThreadPool]: Using duckdb connection "list_sales_database"
[0m10:04:44.179646 [debug] [ThreadPool]: On list_sales_database: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "list_sales_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"sales_database"'
    
  
  
[0m10:04:44.181810 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:04:44.365605 [debug] [ThreadPool]: SQL status: OK in 0.184 seconds
[0m10:04:44.371839 [debug] [ThreadPool]: On list_sales_database: Close
[0m10:04:44.391745 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_database, now create_sales_database_main)
[0m10:04:44.400526 [debug] [ThreadPool]: Creating schema "database: "sales_database"
schema: "main"
"
[0m10:04:44.449037 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m10:04:44.452811 [debug] [ThreadPool]: On create_sales_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "create_sales_database_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='sales_database'
        and type='sqlite'
    
  
[0m10:04:44.454847 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:04:44.530188 [debug] [ThreadPool]: SQL status: OK in 0.075 seconds
[0m10:04:44.535504 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m10:04:44.537255 [debug] [ThreadPool]: On create_sales_database_main: BEGIN
[0m10:04:44.540119 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:04:44.542172 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m10:04:44.547179 [debug] [ThreadPool]: On create_sales_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "create_sales_database_main"} */

    
    
        create schema if not exists "sales_database"."main"
    
[0m10:04:44.551522 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m10:04:44.564874 [debug] [ThreadPool]: On create_sales_database_main: COMMIT
[0m10:04:44.566990 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m10:04:44.569256 [debug] [ThreadPool]: On create_sales_database_main: COMMIT
[0m10:04:44.571714 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:04:44.573119 [debug] [ThreadPool]: On create_sales_database_main: Close
[0m10:04:44.589130 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_sales_database_main'
[0m10:04:44.647603 [debug] [ThreadPool]: Using duckdb connection "list_sales_database_main"
[0m10:04:44.649771 [debug] [ThreadPool]: On list_sales_database_main: BEGIN
[0m10:04:44.651972 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:04:44.714207 [debug] [ThreadPool]: SQL status: OK in 0.062 seconds
[0m10:04:44.728935 [debug] [ThreadPool]: Using duckdb connection "list_sales_database_main"
[0m10:04:44.738565 [debug] [ThreadPool]: On list_sales_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "list_sales_database_main"} */
select
      'sales_database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'sales_database'
  
[0m10:04:44.885448 [debug] [ThreadPool]: SQL status: OK in 0.137 seconds
[0m10:04:44.895430 [debug] [ThreadPool]: On list_sales_database_main: ROLLBACK
[0m10:04:44.900825 [debug] [ThreadPool]: Failed to rollback 'list_sales_database_main'
[0m10:04:44.902142 [debug] [ThreadPool]: On list_sales_database_main: Close
[0m10:04:44.921029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd98d2eed-5a30-4e7a-a188-e7124b14eeb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb868837ef0>]}
[0m10:04:44.923404 [debug] [MainThread]: Using duckdb connection "master"
[0m10:04:44.925458 [debug] [MainThread]: On master: BEGIN
[0m10:04:44.929738 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:04:44.975088 [debug] [MainThread]: SQL status: OK in 0.045 seconds
[0m10:04:44.979872 [debug] [MainThread]: On master: COMMIT
[0m10:04:44.981926 [debug] [MainThread]: Using duckdb connection "master"
[0m10:04:44.983676 [debug] [MainThread]: On master: COMMIT
[0m10:04:44.986351 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m10:04:44.988082 [debug] [MainThread]: On master: Close
[0m10:04:45.002070 [debug] [Thread-1 (]: Began running node model.my_dbt_project.customer_dimension
[0m10:04:45.004399 [info ] [Thread-1 (]: 1 of 6 START sql view model main.customer_dimension ............................ [RUN]
[0m10:04:45.006818 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.my_dbt_project.customer_dimension'
[0m10:04:45.012156 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.customer_dimension
[0m10:04:45.041204 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.customer_dimension"
[0m10:04:45.062845 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.customer_dimension
[0m10:04:45.201454 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.customer_dimension"
[0m10:04:45.223099 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m10:04:45.225211 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: BEGIN
[0m10:04:45.230079 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:04:45.281111 [debug] [Thread-1 (]: SQL status: OK in 0.051 seconds
[0m10:04:45.283203 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m10:04:45.286000 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */

  
  create view "sales_database"."main"."customer_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
    DISTINCT
    customer AS customer_id,
    customer_name,
    customer_address,
    customer_group,
    territory,
    language AS customer_language
FROM sales
WHERE customer IS NOT NULL
  );

[0m10:04:45.292169 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m10:04:45.318475 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m10:04:45.320571 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */
alter view "sales_database"."main"."customer_dimension" rename to "customer_dimension__dbt_backup"
[0m10:04:45.324822 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:04:45.338239 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m10:04:45.341214 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */
alter view "sales_database"."main"."customer_dimension__dbt_tmp" rename to "customer_dimension"
[0m10:04:45.346379 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m10:04:45.421080 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: COMMIT
[0m10:04:45.425418 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m10:04:45.427711 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: COMMIT
[0m10:04:45.446621 [debug] [Thread-1 (]: SQL status: OK in 0.016 seconds
[0m10:04:45.467000 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m10:04:45.469046 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */
drop view if exists "sales_database"."main"."customer_dimension__dbt_backup" cascade
[0m10:04:45.508575 [debug] [Thread-1 (]: SQL status: OK in 0.037 seconds
[0m10:04:45.527648 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: Close
[0m10:04:45.656017 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd98d2eed-5a30-4e7a-a188-e7124b14eeb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8685dac30>]}
[0m10:04:45.659150 [info ] [Thread-1 (]: 1 of 6 OK created sql view model main.customer_dimension ....................... [[32mOK[0m in 0.63s]
[0m10:04:45.663745 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.customer_dimension
[0m10:04:45.672673 [debug] [Thread-1 (]: Began running node model.my_dbt_project.date_dimension
[0m10:04:45.675540 [info ] [Thread-1 (]: 2 of 6 START sql view model main.date_dimension ................................ [RUN]
[0m10:04:45.680828 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customer_dimension, now model.my_dbt_project.date_dimension)
[0m10:04:45.682926 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.date_dimension
[0m10:04:45.710770 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.date_dimension"
[0m10:04:45.805773 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.date_dimension
[0m10:04:45.836477 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.date_dimension"
[0m10:04:45.900126 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m10:04:45.902202 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: BEGIN
[0m10:04:45.904759 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:04:45.989692 [debug] [Thread-1 (]: SQL status: OK in 0.085 seconds
[0m10:04:45.992166 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m10:04:45.996867 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.date_dimension"} */

  
  create view "sales_database"."main"."date_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
    transaction_date,
    strftime(transaction_date, '%A') AS weekday_name,  -- Extract weekday name
    strftime(transaction_date, '%m') AS month,          -- Extract month (numeric)
    strftime(transaction_date, '%Y') AS year,           -- Extract year
    strftime(transaction_date, '%d') AS day,            -- Extract day
    EXTRACT(QUARTER FROM transaction_date) AS quarter   -- Extract quarter
FROM sales
WHERE transaction_date IS NOT NULL
  );

[0m10:04:46.004180 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m10:04:46.019544 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m10:04:46.022021 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.date_dimension"} */
alter view "sales_database"."main"."date_dimension" rename to "date_dimension__dbt_backup"
[0m10:04:46.025207 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:04:46.041965 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m10:04:46.044280 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.date_dimension"} */
alter view "sales_database"."main"."date_dimension__dbt_tmp" rename to "date_dimension"
[0m10:04:46.047477 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:04:46.055489 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: COMMIT
[0m10:04:46.058458 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m10:04:46.060418 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: COMMIT
[0m10:04:46.071780 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m10:04:46.082302 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m10:04:46.084667 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.date_dimension"} */
drop view if exists "sales_database"."main"."date_dimension__dbt_backup" cascade
[0m10:04:46.092266 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m10:04:46.099503 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: Close
[0m10:04:46.163345 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd98d2eed-5a30-4e7a-a188-e7124b14eeb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb868107fb0>]}
[0m10:04:46.167225 [info ] [Thread-1 (]: 2 of 6 OK created sql view model main.date_dimension ........................... [[32mOK[0m in 0.48s]
[0m10:04:46.169949 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.date_dimension
[0m10:04:46.171524 [debug] [Thread-1 (]: Began running node model.my_dbt_project.product_dimension
[0m10:04:46.173642 [info ] [Thread-1 (]: 3 of 6 START sql view model main.product_dimension ............................. [RUN]
[0m10:04:46.175986 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.date_dimension, now model.my_dbt_project.product_dimension)
[0m10:04:46.177683 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.product_dimension
[0m10:04:46.186188 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.product_dimension"
[0m10:04:46.202771 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.product_dimension
[0m10:04:46.216418 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.product_dimension"
[0m10:04:46.235299 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m10:04:46.237076 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: BEGIN
[0m10:04:46.238655 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:04:46.282306 [debug] [Thread-1 (]: SQL status: OK in 0.043 seconds
[0m10:04:46.284399 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m10:04:46.286919 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.product_dimension"} */

  
  create view "sales_database"."main"."product_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * 
    FROM "sales_database"."main"."sales"
)

SELECT 
    sales.name,
    json_extract(items, '$[0].name') AS product_name,  -- Example to extract the first element's "name" field from JSON array
    json_extract(items, '$[0].item_code') AS product_item_code
FROM sales
WHERE json_extract(items, '$[0].name') IS NOT NULL  -- Filter to only keep rows with a non-null product name
  );

[0m10:04:46.291874 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:04:46.303361 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m10:04:46.305208 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.product_dimension"} */
alter view "sales_database"."main"."product_dimension" rename to "product_dimension__dbt_backup"
[0m10:04:46.308347 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:04:46.319108 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m10:04:46.321324 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.product_dimension"} */
alter view "sales_database"."main"."product_dimension__dbt_tmp" rename to "product_dimension"
[0m10:04:46.324537 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:04:46.331759 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: COMMIT
[0m10:04:46.333727 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m10:04:46.335425 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: COMMIT
[0m10:04:46.347809 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m10:04:46.356260 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m10:04:46.358502 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.product_dimension"} */
drop view if exists "sales_database"."main"."product_dimension__dbt_backup" cascade
[0m10:04:46.366040 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m10:04:46.370690 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: Close
[0m10:04:46.432545 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd98d2eed-5a30-4e7a-a188-e7124b14eeb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8684b8350>]}
[0m10:04:46.434919 [info ] [Thread-1 (]: 3 of 6 OK created sql view model main.product_dimension ........................ [[32mOK[0m in 0.26s]
[0m10:04:46.438213 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.product_dimension
[0m10:04:46.440116 [debug] [Thread-1 (]: Began running node model.my_dbt_project.sales_team_dimension
[0m10:04:46.442251 [info ] [Thread-1 (]: 4 of 6 START sql view model main.sales_team_dimension .......................... [RUN]
[0m10:04:46.446525 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.product_dimension, now model.my_dbt_project.sales_team_dimension)
[0m10:04:46.448488 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.sales_team_dimension
[0m10:04:46.457646 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.sales_team_dimension"
[0m10:04:46.484090 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.sales_team_dimension
[0m10:04:46.498468 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.sales_team_dimension"
[0m10:04:46.526042 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m10:04:46.532188 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: BEGIN
[0m10:04:46.537687 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:04:46.595114 [debug] [Thread-1 (]: SQL status: OK in 0.057 seconds
[0m10:04:46.598744 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m10:04:46.603024 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */

  
  create view "sales_database"."main"."sales_team_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
    DISTINCT
    sales_team->>'name' AS sales_team_id,
    sales_team->>'region' AS sales_team_region
FROM sales
WHERE sales_team IS NOT NULL
  );

[0m10:04:46.613870 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m10:04:46.625503 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m10:04:46.637193 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */
alter view "sales_database"."main"."sales_team_dimension" rename to "sales_team_dimension__dbt_backup"
[0m10:04:46.640602 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:04:46.672015 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m10:04:46.690361 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */
alter view "sales_database"."main"."sales_team_dimension__dbt_tmp" rename to "sales_team_dimension"
[0m10:04:46.693725 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:04:46.710815 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: COMMIT
[0m10:04:46.715151 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m10:04:46.720224 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: COMMIT
[0m10:04:46.789534 [debug] [Thread-1 (]: SQL status: OK in 0.051 seconds
[0m10:04:46.803525 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m10:04:46.805550 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */
drop view if exists "sales_database"."main"."sales_team_dimension__dbt_backup" cascade
[0m10:04:46.814941 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m10:04:46.819498 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: Close
[0m10:04:46.913409 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd98d2eed-5a30-4e7a-a188-e7124b14eeb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb86812bec0>]}
[0m10:04:46.926268 [info ] [Thread-1 (]: 4 of 6 OK created sql view model main.sales_team_dimension ..................... [[32mOK[0m in 0.47s]
[0m10:04:46.932446 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.sales_team_dimension
[0m10:04:46.934665 [debug] [Thread-1 (]: Began running node model.my_dbt_project.transform_sales
[0m10:04:46.937650 [info ] [Thread-1 (]: 5 of 6 START sql table model main.transform_sales .............................. [RUN]
[0m10:04:46.944099 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.sales_team_dimension, now model.my_dbt_project.transform_sales)
[0m10:04:46.953585 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.transform_sales
[0m10:04:46.972586 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.transform_sales"
[0m10:04:47.012012 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.transform_sales
[0m10:04:47.166364 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.transform_sales"
[0m10:04:47.194954 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m10:04:47.198653 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: BEGIN
[0m10:04:47.204536 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:04:47.247961 [debug] [Thread-1 (]: SQL status: OK in 0.046 seconds
[0m10:04:47.250040 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m10:04:47.251924 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */

  
    
    

    create  table
      "sales_database"."main"."transform_sales__dbt_tmp"
  
    as (
      -- /opt/airflow/dags/dbt_models/transform_users.sql


WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
   *
FROM sales
WHERE name = 'ABC private LTD-0002'
    );
  
  
[0m10:04:47.309698 [debug] [Thread-1 (]: SQL status: OK in 0.055 seconds
[0m10:04:47.330024 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m10:04:47.332423 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */
alter table "sales_database"."main"."transform_sales" rename to "transform_sales__dbt_backup"
[0m10:04:47.338801 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m10:04:47.352186 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m10:04:47.354562 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */
alter table "sales_database"."main"."transform_sales__dbt_tmp" rename to "transform_sales"
[0m10:04:47.358510 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:04:47.381046 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: COMMIT
[0m10:04:47.382980 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m10:04:47.384582 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: COMMIT
[0m10:04:47.408315 [debug] [Thread-1 (]: SQL status: OK in 0.021 seconds
[0m10:04:47.422528 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m10:04:47.424931 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */
drop table if exists "sales_database"."main"."transform_sales__dbt_backup" cascade
[0m10:04:47.434891 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m10:04:47.439945 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: Close
[0m10:04:47.560045 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd98d2eed-5a30-4e7a-a188-e7124b14eeb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb868134650>]}
[0m10:04:47.562515 [info ] [Thread-1 (]: 5 of 6 OK created sql table model main.transform_sales ......................... [[32mOK[0m in 0.62s]
[0m10:04:47.569046 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.transform_sales
[0m10:04:47.571152 [debug] [Thread-1 (]: Began running node model.my_dbt_project.sales_fact
[0m10:04:47.573777 [info ] [Thread-1 (]: 6 of 6 START sql table model main.sales_fact ................................... [RUN]
[0m10:04:47.576902 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.transform_sales, now model.my_dbt_project.sales_fact)
[0m10:04:47.580808 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.sales_fact
[0m10:04:47.592940 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.sales_fact"
[0m10:04:47.614189 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.sales_fact
[0m10:04:47.623454 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.sales_fact"
[0m10:04:47.643976 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_fact"
[0m10:04:47.647183 [debug] [Thread-1 (]: On model.my_dbt_project.sales_fact: BEGIN
[0m10:04:47.649131 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:04:47.689561 [debug] [Thread-1 (]: SQL status: OK in 0.040 seconds
[0m10:04:47.691523 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_fact"
[0m10:04:47.693762 [debug] [Thread-1 (]: On model.my_dbt_project.sales_fact: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_fact"} */

  
    
    

    create  table
      "sales_database"."main"."sales_fact__dbt_tmp"
  
    as (
      WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
),
customer AS (
    SELECT * FROM "sales_database"."main"."customer_dimension"
),
product AS (
    SELECT * FROM "sales_database"."main"."product_dimension"
),
sales_team AS (
    SELECT * FROM "sales_database"."main"."sales_team_dimension"
),
date AS (
    SELECT * FROM "sales_database"."main"."date_dimension"
)

SELECT
    sales.name AS sales_id,
    customer.customer_id,
    product.product_id,
    sales_team.sales_team_id,
    date.date_id,
    sales.total_qty,
    sales.total_net_weight,
    sales.total,
    sales.net_total,
    sales.grand_total,
    sales.tax_category
FROM sales
JOIN customer ON sales.customer = customer.customer_id
JOIN product ON sales.items @> ARRAY[product.product_id] -- Assuming `items` stores products as an array
JOIN sales_team ON sales.sales_team @> ARRAY[sales_team.sales_team_id] -- Assuming `sales_team` stores sales team info
JOIN date ON sales.transaction_date = date.date_id
    );
  
  
[0m10:04:47.725057 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_fact"} */

  
    
    

    create  table
      "sales_database"."main"."sales_fact__dbt_tmp"
  
    as (
      WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
),
customer AS (
    SELECT * FROM "sales_database"."main"."customer_dimension"
),
product AS (
    SELECT * FROM "sales_database"."main"."product_dimension"
),
sales_team AS (
    SELECT * FROM "sales_database"."main"."sales_team_dimension"
),
date AS (
    SELECT * FROM "sales_database"."main"."date_dimension"
)

SELECT
    sales.name AS sales_id,
    customer.customer_id,
    product.product_id,
    sales_team.sales_team_id,
    date.date_id,
    sales.total_qty,
    sales.total_net_weight,
    sales.total,
    sales.net_total,
    sales.grand_total,
    sales.tax_category
FROM sales
JOIN customer ON sales.customer = customer.customer_id
JOIN product ON sales.items @> ARRAY[product.product_id] -- Assuming `items` stores products as an array
JOIN sales_team ON sales.sales_team @> ARRAY[sales_team.sales_team_id] -- Assuming `sales_team` stores sales team info
JOIN date ON sales.transaction_date = date.date_id
    );
  
  
[0m10:04:47.726770 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m10:04:47.728802 [debug] [Thread-1 (]: On model.my_dbt_project.sales_fact: ROLLBACK
[0m10:04:47.750648 [debug] [Thread-1 (]: Failed to rollback 'model.my_dbt_project.sales_fact'
[0m10:04:47.752676 [debug] [Thread-1 (]: On model.my_dbt_project.sales_fact: Close
[0m10:04:47.765669 [debug] [Thread-1 (]: Runtime Error in model sales_fact (models/facts/sales_fact.sql)
  Binder Error: Values list "product" does not have a column named "product_id"
  LINE 41: JOIN product ON sales.items @> ARRAY[product.product_id] -- Assuming `items` stores products as an array
  JOIN sales_team ON sales.sales_team @> ARRAY[sales_team.sales_team_id] -- Assuming `sales_team` stores sales team info
  JOIN date ON sales.transaction_date = date.date_id
      );
    
    ...
                                                ^
[0m10:04:47.767889 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd98d2eed-5a30-4e7a-a188-e7124b14eeb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8684b8a70>]}
[0m10:04:47.770458 [error] [Thread-1 (]: 6 of 6 ERROR creating sql table model main.sales_fact .......................... [[31mERROR[0m in 0.19s]
[0m10:04:47.773415 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.sales_fact
[0m10:04:47.775838 [debug] [Thread-4 (]: Marking all children of 'model.my_dbt_project.sales_fact' to be skipped because of status 'error'.  Reason: Runtime Error in model sales_fact (models/facts/sales_fact.sql)
  Binder Error: Values list "product" does not have a column named "product_id"
  LINE 41: JOIN product ON sales.items @> ARRAY[product.product_id] -- Assuming `items` stores products as an array
  JOIN sales_team ON sales.sales_team @> ARRAY[sales_team.sales_team_id] -- Assuming `sales_team` stores sales team info
  JOIN date ON sales.transaction_date = date.date_id
      );
    
    ...
                                                ^.
[0m10:04:47.792209 [debug] [MainThread]: Using duckdb connection "master"
[0m10:04:47.793996 [debug] [MainThread]: On master: BEGIN
[0m10:04:47.797822 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:04:47.840302 [debug] [MainThread]: SQL status: OK in 0.042 seconds
[0m10:04:47.842177 [debug] [MainThread]: On master: COMMIT
[0m10:04:47.844079 [debug] [MainThread]: Using duckdb connection "master"
[0m10:04:47.846219 [debug] [MainThread]: On master: COMMIT
[0m10:04:47.849587 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m10:04:47.851464 [debug] [MainThread]: On master: Close
[0m10:04:47.859404 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:04:47.863705 [debug] [MainThread]: Connection 'create_sales_database_main' was properly closed.
[0m10:04:47.865462 [debug] [MainThread]: Connection 'list_sales_database_main' was properly closed.
[0m10:04:47.867280 [debug] [MainThread]: Connection 'model.my_dbt_project.sales_fact' was properly closed.
[0m10:04:47.869911 [info ] [MainThread]: 
[0m10:04:47.872154 [info ] [MainThread]: Finished running 2 table models, 4 view models in 0 hours 0 minutes and 3.94 seconds (3.94s).
[0m10:04:47.880183 [debug] [MainThread]: Command end result
[0m10:04:48.025444 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m10:04:48.040151 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m10:04:48.071145 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dags/dbt_models/target/run_results.json
[0m10:04:48.072635 [info ] [MainThread]: 
[0m10:04:48.074615 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m10:04:48.077041 [info ] [MainThread]: 
[0m10:04:48.082998 [error] [MainThread]:   Runtime Error in model sales_fact (models/facts/sales_fact.sql)
  Binder Error: Values list "product" does not have a column named "product_id"
  LINE 41: JOIN product ON sales.items @> ARRAY[product.product_id] -- Assuming `items` stores products as an array
  JOIN sales_team ON sales.sales_team @> ARRAY[sales_team.sales_team_id] -- Assuming `sales_team` stores sales team info
  JOIN date ON sales.transaction_date = date.date_id
      );
    
    ...
                                                ^
[0m10:04:48.085141 [info ] [MainThread]: 
[0m10:04:48.087211 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m10:04:48.092162 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 11.522849, "process_in_blocks": "596680", "process_kernel_time": 3.342079, "process_mem_max_rss": "143912", "process_out_blocks": "0", "process_user_time": 12.743535}
[0m10:04:48.099212 [debug] [MainThread]: Command `dbt run` failed at 10:04:48.098846 after 11.53 seconds
[0m10:04:48.101223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb86f04ffb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb86f72ef90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb86f72efc0>]}
[0m10:04:48.102999 [debug] [MainThread]: Flushing usage events
[0m10:04:49.989931 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:09:58.832916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70dfd2d610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70df67f800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70dfd2da90>]}


============================== 10:09:58.921777 | c7d112ae-bb47-4785-acdd-b2d7712ddc3e ==============================
[0m10:09:58.921777 [info ] [MainThread]: Running with dbt=1.9.1
[0m10:09:58.929057 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dags/dbt_models/logs', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt/profiles.yml', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt/profiles.yml --target dev', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:10:03.209512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c7d112ae-bb47-4785-acdd-b2d7712ddc3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70d9764080>]}
[0m10:10:03.810499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c7d112ae-bb47-4785-acdd-b2d7712ddc3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70df2fcd40>]}
[0m10:10:04.347959 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m10:10:25.736787 [debug] [MainThread]: checksum: cac3b9519010e47bfbeb71ca6efb4867dae2858687671594dc23fefc94ecf25d, vars: {}, profile: , target: dev, version: 1.9.1
[0m10:10:27.707315 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:10:27.721602 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/facts/sales_fact.sql
[0m10:10:30.246604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c7d112ae-bb47-4785-acdd-b2d7712ddc3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70d91ec6e0>]}
[0m10:10:30.777141 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m10:10:30.823269 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m10:10:31.220871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c7d112ae-bb47-4785-acdd-b2d7712ddc3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70d9298a40>]}
[0m10:10:31.237194 [info ] [MainThread]: Found 6 models, 1 source, 424 macros
[0m10:10:31.250336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c7d112ae-bb47-4785-acdd-b2d7712ddc3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70d8767a40>]}
[0m10:10:31.258452 [info ] [MainThread]: 
[0m10:10:31.284572 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:10:31.289228 [info ] [MainThread]: 
[0m10:10:31.310173 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m10:10:31.388501 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_sales_database'
[0m10:10:31.712349 [debug] [ThreadPool]: Using duckdb connection "list_sales_database"
[0m10:10:31.738617 [debug] [ThreadPool]: On list_sales_database: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "list_sales_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"sales_database"'
    
  
  
[0m10:10:31.740309 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:10:32.475952 [debug] [ThreadPool]: SQL status: OK in 0.736 seconds
[0m10:10:32.484212 [debug] [ThreadPool]: On list_sales_database: Close
[0m10:10:32.499742 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_database, now create_sales_database_main)
[0m10:10:32.505223 [debug] [ThreadPool]: Creating schema "database: "sales_database"
schema: "main"
"
[0m10:10:32.561290 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m10:10:32.566928 [debug] [ThreadPool]: On create_sales_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "create_sales_database_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='sales_database'
        and type='sqlite'
    
  
[0m10:10:32.569286 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:10:32.658378 [debug] [ThreadPool]: SQL status: OK in 0.089 seconds
[0m10:10:32.664360 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m10:10:32.667308 [debug] [ThreadPool]: On create_sales_database_main: BEGIN
[0m10:10:32.671564 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:10:32.675132 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m10:10:32.686473 [debug] [ThreadPool]: On create_sales_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "create_sales_database_main"} */

    
    
        create schema if not exists "sales_database"."main"
    
[0m10:10:32.699057 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m10:10:32.703351 [debug] [ThreadPool]: On create_sales_database_main: COMMIT
[0m10:10:32.710719 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m10:10:32.718831 [debug] [ThreadPool]: On create_sales_database_main: COMMIT
[0m10:10:32.727447 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m10:10:32.734643 [debug] [ThreadPool]: On create_sales_database_main: Close
[0m10:10:32.779623 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_sales_database_main'
[0m10:10:32.865159 [debug] [ThreadPool]: Using duckdb connection "list_sales_database_main"
[0m10:10:32.875766 [debug] [ThreadPool]: On list_sales_database_main: BEGIN
[0m10:10:32.886508 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:10:32.967491 [debug] [ThreadPool]: SQL status: OK in 0.081 seconds
[0m10:10:32.969503 [debug] [ThreadPool]: Using duckdb connection "list_sales_database_main"
[0m10:10:32.971806 [debug] [ThreadPool]: On list_sales_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "list_sales_database_main"} */
select
      'sales_database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'sales_database'
  
[0m10:10:33.138708 [debug] [ThreadPool]: SQL status: OK in 0.164 seconds
[0m10:10:33.156648 [debug] [ThreadPool]: On list_sales_database_main: ROLLBACK
[0m10:10:33.174280 [debug] [ThreadPool]: Failed to rollback 'list_sales_database_main'
[0m10:10:33.203934 [debug] [ThreadPool]: On list_sales_database_main: Close
[0m10:10:33.305924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c7d112ae-bb47-4785-acdd-b2d7712ddc3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70d85c1850>]}
[0m10:10:33.311490 [debug] [MainThread]: Using duckdb connection "master"
[0m10:10:33.315490 [debug] [MainThread]: On master: BEGIN
[0m10:10:33.318054 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:10:33.458269 [debug] [MainThread]: SQL status: OK in 0.140 seconds
[0m10:10:33.459961 [debug] [MainThread]: On master: COMMIT
[0m10:10:33.462582 [debug] [MainThread]: Using duckdb connection "master"
[0m10:10:33.467096 [debug] [MainThread]: On master: COMMIT
[0m10:10:33.471387 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m10:10:33.473263 [debug] [MainThread]: On master: Close
[0m10:10:33.485644 [debug] [Thread-1 (]: Began running node model.my_dbt_project.customer_dimension
[0m10:10:33.488063 [info ] [Thread-1 (]: 1 of 6 START sql view model main.customer_dimension ............................ [RUN]
[0m10:10:33.493076 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.my_dbt_project.customer_dimension'
[0m10:10:33.495169 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.customer_dimension
[0m10:10:33.544336 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.customer_dimension"
[0m10:10:33.585122 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.customer_dimension
[0m10:10:33.743088 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.customer_dimension"
[0m10:10:33.769616 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m10:10:33.771902 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: BEGIN
[0m10:10:33.774292 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:10:33.840707 [debug] [Thread-1 (]: SQL status: OK in 0.066 seconds
[0m10:10:33.843411 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m10:10:33.845654 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */

  
  create view "sales_database"."main"."customer_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
    DISTINCT
    customer AS customer_id,
    customer_name,
    customer_address,
    customer_group,
    territory,
    language AS customer_language
FROM sales
WHERE customer IS NOT NULL
  );

[0m10:10:33.851268 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:10:33.878173 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m10:10:33.882364 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */
alter view "sales_database"."main"."customer_dimension" rename to "customer_dimension__dbt_backup"
[0m10:10:33.885535 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:10:33.903177 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m10:10:33.906956 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */
alter view "sales_database"."main"."customer_dimension__dbt_tmp" rename to "customer_dimension"
[0m10:10:33.911756 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:10:33.980114 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: COMMIT
[0m10:10:33.984403 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m10:10:34.003515 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: COMMIT
[0m10:10:34.032294 [debug] [Thread-1 (]: SQL status: OK in 0.026 seconds
[0m10:10:34.062115 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m10:10:34.071815 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */
drop view if exists "sales_database"."main"."customer_dimension__dbt_backup" cascade
[0m10:10:34.078529 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m10:10:34.089208 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: Close
[0m10:10:34.214587 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7d112ae-bb47-4785-acdd-b2d7712ddc3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70e11161e0>]}
[0m10:10:34.219299 [info ] [Thread-1 (]: 1 of 6 OK created sql view model main.customer_dimension ....................... [[32mOK[0m in 0.70s]
[0m10:10:34.228240 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.customer_dimension
[0m10:10:34.233292 [debug] [Thread-1 (]: Began running node model.my_dbt_project.date_dimension
[0m10:10:34.238573 [info ] [Thread-1 (]: 2 of 6 START sql view model main.date_dimension ................................ [RUN]
[0m10:10:34.245375 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customer_dimension, now model.my_dbt_project.date_dimension)
[0m10:10:34.272212 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.date_dimension
[0m10:10:34.288074 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.date_dimension"
[0m10:10:34.392843 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.date_dimension
[0m10:10:34.526022 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.date_dimension"
[0m10:10:34.577119 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m10:10:34.581650 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: BEGIN
[0m10:10:34.584021 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:10:34.684636 [debug] [Thread-1 (]: SQL status: OK in 0.101 seconds
[0m10:10:34.690699 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m10:10:34.693538 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.date_dimension"} */

  
  create view "sales_database"."main"."date_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
    transaction_date,
    strftime(transaction_date, '%A') AS weekday_name,  -- Extract weekday name
    strftime(transaction_date, '%m') AS month,          -- Extract month (numeric)
    strftime(transaction_date, '%Y') AS year,           -- Extract year
    strftime(transaction_date, '%d') AS day,            -- Extract day
    EXTRACT(QUARTER FROM transaction_date) AS quarter   -- Extract quarter
FROM sales
WHERE transaction_date IS NOT NULL
  );

[0m10:10:34.703489 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m10:10:34.719757 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m10:10:34.722735 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.date_dimension"} */
alter view "sales_database"."main"."date_dimension" rename to "date_dimension__dbt_backup"
[0m10:10:34.728581 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:10:34.761714 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m10:10:34.765408 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.date_dimension"} */
alter view "sales_database"."main"."date_dimension__dbt_tmp" rename to "date_dimension"
[0m10:10:34.772791 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:10:34.780676 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: COMMIT
[0m10:10:34.783444 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m10:10:34.785512 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: COMMIT
[0m10:10:34.795605 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m10:10:34.806742 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m10:10:34.808834 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.date_dimension"} */
drop view if exists "sales_database"."main"."date_dimension__dbt_backup" cascade
[0m10:10:34.816845 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m10:10:34.821660 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: Close
[0m10:10:34.919953 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7d112ae-bb47-4785-acdd-b2d7712ddc3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70d83bb980>]}
[0m10:10:34.924258 [info ] [Thread-1 (]: 2 of 6 OK created sql view model main.date_dimension ........................... [[32mOK[0m in 0.67s]
[0m10:10:34.933165 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.date_dimension
[0m10:10:34.935702 [debug] [Thread-1 (]: Began running node model.my_dbt_project.product_dimension
[0m10:10:34.939566 [info ] [Thread-1 (]: 3 of 6 START sql view model main.product_dimension ............................. [RUN]
[0m10:10:34.952747 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.date_dimension, now model.my_dbt_project.product_dimension)
[0m10:10:34.954778 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.product_dimension
[0m10:10:34.993160 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.product_dimension"
[0m10:10:35.298265 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.product_dimension
[0m10:10:35.320462 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.product_dimension"
[0m10:10:35.370304 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m10:10:35.374109 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: BEGIN
[0m10:10:35.385027 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:10:35.877790 [debug] [Thread-1 (]: SQL status: OK in 0.493 seconds
[0m10:10:35.893819 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m10:10:35.915213 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.product_dimension"} */

  
  create view "sales_database"."main"."product_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * 
    FROM "sales_database"."main"."sales"
)

SELECT 
    sales.name,
    json_extract(items, '$[0].name') AS product_name,  -- Example to extract the first element's "name" field from JSON array
    json_extract(items, '$[0].item_code') AS product_item_code
FROM sales
WHERE json_extract(items, '$[0].name') IS NOT NULL  -- Filter to only keep rows with a non-null product name
  );

[0m10:10:35.924829 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:10:35.997828 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m10:10:36.002318 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.product_dimension"} */
alter view "sales_database"."main"."product_dimension" rename to "product_dimension__dbt_backup"
[0m10:10:36.036600 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m10:10:36.069447 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m10:10:36.073662 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.product_dimension"} */
alter view "sales_database"."main"."product_dimension__dbt_tmp" rename to "product_dimension"
[0m10:10:36.089055 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:10:36.119392 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: COMMIT
[0m10:10:36.131461 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m10:10:36.136386 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: COMMIT
[0m10:10:36.180135 [debug] [Thread-1 (]: SQL status: OK in 0.041 seconds
[0m10:10:36.200026 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m10:10:36.202296 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.product_dimension"} */
drop view if exists "sales_database"."main"."product_dimension__dbt_backup" cascade
[0m10:10:36.221775 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m10:10:36.248694 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: Close
[0m10:10:37.078248 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7d112ae-bb47-4785-acdd-b2d7712ddc3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70d83b8b60>]}
[0m10:10:37.094903 [info ] [Thread-1 (]: 3 of 6 OK created sql view model main.product_dimension ........................ [[32mOK[0m in 2.12s]
[0m10:10:37.112626 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.product_dimension
[0m10:10:37.124310 [debug] [Thread-1 (]: Began running node model.my_dbt_project.sales_team_dimension
[0m10:10:37.182678 [info ] [Thread-1 (]: 4 of 6 START sql view model main.sales_team_dimension .......................... [RUN]
[0m10:10:37.189453 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.product_dimension, now model.my_dbt_project.sales_team_dimension)
[0m10:10:37.202375 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.sales_team_dimension
[0m10:10:37.243558 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.sales_team_dimension"
[0m10:10:37.312091 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.sales_team_dimension
[0m10:10:37.359569 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.sales_team_dimension"
[0m10:10:37.468056 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m10:10:37.477523 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: BEGIN
[0m10:10:37.487105 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:10:39.052175 [debug] [Thread-1 (]: SQL status: OK in 1.558 seconds
[0m10:10:39.073181 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m10:10:39.079136 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */

  
  create view "sales_database"."main"."sales_team_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
    DISTINCT
    sales_team->>'name' AS sales_team_id,
    sales_team->>'region' AS sales_team_region
FROM sales
WHERE sales_team IS NOT NULL
  );

[0m10:10:39.327113 [debug] [Thread-1 (]: SQL status: OK in 0.244 seconds
[0m10:10:39.339699 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m10:10:39.342832 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */
alter view "sales_database"."main"."sales_team_dimension" rename to "sales_team_dimension__dbt_backup"
[0m10:10:39.388767 [debug] [Thread-1 (]: SQL status: OK in 0.044 seconds
[0m10:10:39.406116 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m10:10:39.407588 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */
alter view "sales_database"."main"."sales_team_dimension__dbt_tmp" rename to "sales_team_dimension"
[0m10:10:39.409829 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:10:39.417111 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: COMMIT
[0m10:10:39.419011 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m10:10:39.420604 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: COMMIT
[0m10:10:39.487907 [debug] [Thread-1 (]: SQL status: OK in 0.066 seconds
[0m10:10:39.493105 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m10:10:39.494332 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */
drop view if exists "sales_database"."main"."sales_team_dimension__dbt_backup" cascade
[0m10:10:39.511544 [debug] [Thread-1 (]: SQL status: OK in 0.016 seconds
[0m10:10:39.515392 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: Close
[0m10:10:39.795243 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7d112ae-bb47-4785-acdd-b2d7712ddc3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70bc729760>]}
[0m10:10:39.797438 [info ] [Thread-1 (]: 4 of 6 OK created sql view model main.sales_team_dimension ..................... [[32mOK[0m in 2.61s]
[0m10:10:39.800025 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.sales_team_dimension
[0m10:10:39.801724 [debug] [Thread-1 (]: Began running node model.my_dbt_project.transform_sales
[0m10:10:39.803356 [info ] [Thread-1 (]: 5 of 6 START sql table model main.transform_sales .............................. [RUN]
[0m10:10:39.804763 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.sales_team_dimension, now model.my_dbt_project.transform_sales)
[0m10:10:39.805853 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.transform_sales
[0m10:10:39.811175 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.transform_sales"
[0m10:10:39.835153 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.transform_sales
[0m10:10:39.939322 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.transform_sales"
[0m10:10:39.955626 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m10:10:39.957130 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: BEGIN
[0m10:10:39.958713 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:10:40.256412 [debug] [Thread-1 (]: SQL status: OK in 0.298 seconds
[0m10:10:40.257714 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m10:10:40.259476 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */

  
    
    

    create  table
      "sales_database"."main"."transform_sales__dbt_tmp"
  
    as (
      -- /opt/airflow/dags/dbt_models/transform_users.sql


WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
   *
FROM sales
WHERE name = 'ABC private LTD-0002'
    );
  
  
[0m10:10:40.520372 [debug] [Thread-1 (]: SQL status: OK in 0.259 seconds
[0m10:10:40.531786 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m10:10:40.533630 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */
alter table "sales_database"."main"."transform_sales" rename to "transform_sales__dbt_backup"
[0m10:10:40.537505 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:10:40.548457 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m10:10:40.550504 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */
alter table "sales_database"."main"."transform_sales__dbt_tmp" rename to "transform_sales"
[0m10:10:40.553442 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:10:40.583370 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: COMMIT
[0m10:10:40.585444 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m10:10:40.587526 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: COMMIT
[0m10:10:40.653122 [debug] [Thread-1 (]: SQL status: OK in 0.063 seconds
[0m10:10:40.670789 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m10:10:40.674620 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */
drop table if exists "sales_database"."main"."transform_sales__dbt_backup" cascade
[0m10:10:40.692800 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m10:10:40.703328 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: Close
[0m10:10:41.199383 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7d112ae-bb47-4785-acdd-b2d7712ddc3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70d84b63f0>]}
[0m10:10:41.211706 [info ] [Thread-1 (]: 5 of 6 OK created sql table model main.transform_sales ......................... [[32mOK[0m in 1.39s]
[0m10:10:41.229517 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.transform_sales
[0m10:10:41.240020 [debug] [Thread-1 (]: Began running node model.my_dbt_project.sales_fact
[0m10:10:41.245210 [info ] [Thread-1 (]: 6 of 6 START sql table model main.sales_fact ................................... [RUN]
[0m10:10:41.251634 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.transform_sales, now model.my_dbt_project.sales_fact)
[0m10:10:41.254638 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.sales_fact
[0m10:10:41.305984 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.sales_fact"
[0m10:10:41.409768 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.sales_fact
[0m10:10:41.460378 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.sales_fact"
[0m10:10:41.506956 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_fact"
[0m10:10:41.511643 [debug] [Thread-1 (]: On model.my_dbt_project.sales_fact: BEGIN
[0m10:10:41.522268 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:10:41.708748 [debug] [Thread-1 (]: SQL status: OK in 0.186 seconds
[0m10:10:41.808618 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_fact"
[0m10:10:41.824331 [debug] [Thread-1 (]: On model.my_dbt_project.sales_fact: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_fact"} */

  
    
    

    create  table
      "sales_database"."main"."sales_fact__dbt_tmp"
  
    as (
      WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
),
customer AS (
    SELECT * FROM "sales_database"."main"."customer_dimension"
),
product AS (
    SELECT * FROM "sales_database"."main"."product_dimension"
),
sales_team AS (
    SELECT * FROM "sales_database"."main"."sales_team_dimension"
),
date AS (
    SELECT * FROM "sales_database"."main"."date_dimension"
)

SELECT
    sales.name AS sales_id,
    customer.customer_id,
    product.product_id,
    sales_team.sales_team_id,
    date.date_id,
    sales.total_qty,
    sales.total_net_weight,
    sales.total,
    sales.net_total,
    sales.grand_total,
    sales.tax_category
FROM sales
JOIN customer ON sales.customer = customer.customer_id
JOIN LATERAL (
    SELECT json_extract_string(items, '$[0].product_id') AS product_id
    FROM unnest(json_extract(sales.items, '$')) AS product(items)
    WHERE json_extract_string(items, '$[0].product_id') IS NOT NULL
) AS product ON TRUE
JOIN sales_team ON sales.sales_team @> ARRAY[sales_team.sales_team_id]
JOIN date ON sales.transaction_date = date.date_id
    );
  
  
[0m10:10:42.004736 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_fact"} */

  
    
    

    create  table
      "sales_database"."main"."sales_fact__dbt_tmp"
  
    as (
      WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
),
customer AS (
    SELECT * FROM "sales_database"."main"."customer_dimension"
),
product AS (
    SELECT * FROM "sales_database"."main"."product_dimension"
),
sales_team AS (
    SELECT * FROM "sales_database"."main"."sales_team_dimension"
),
date AS (
    SELECT * FROM "sales_database"."main"."date_dimension"
)

SELECT
    sales.name AS sales_id,
    customer.customer_id,
    product.product_id,
    sales_team.sales_team_id,
    date.date_id,
    sales.total_qty,
    sales.total_net_weight,
    sales.total,
    sales.net_total,
    sales.grand_total,
    sales.tax_category
FROM sales
JOIN customer ON sales.customer = customer.customer_id
JOIN LATERAL (
    SELECT json_extract_string(items, '$[0].product_id') AS product_id
    FROM unnest(json_extract(sales.items, '$')) AS product(items)
    WHERE json_extract_string(items, '$[0].product_id') IS NOT NULL
) AS product ON TRUE
JOIN sales_team ON sales.sales_team @> ARRAY[sales_team.sales_team_id]
JOIN date ON sales.transaction_date = date.date_id
    );
  
  
[0m10:10:42.043285 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m10:10:42.087113 [debug] [Thread-1 (]: On model.my_dbt_project.sales_fact: ROLLBACK
[0m10:10:42.201956 [debug] [Thread-1 (]: Failed to rollback 'model.my_dbt_project.sales_fact'
[0m10:10:42.205211 [debug] [Thread-1 (]: On model.my_dbt_project.sales_fact: Close
[0m10:10:42.232257 [debug] [Thread-1 (]: Runtime Error in model sales_fact (models/facts/sales_fact.sql)
  Binder Error: UNNEST requires a single list as input
[0m10:10:42.235087 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7d112ae-bb47-4785-acdd-b2d7712ddc3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70d84cfbf0>]}
[0m10:10:42.237245 [error] [Thread-1 (]: 6 of 6 ERROR creating sql table model main.sales_fact .......................... [[31mERROR[0m in 0.98s]
[0m10:10:42.240673 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.sales_fact
[0m10:10:42.242660 [debug] [Thread-4 (]: Marking all children of 'model.my_dbt_project.sales_fact' to be skipped because of status 'error'.  Reason: Runtime Error in model sales_fact (models/facts/sales_fact.sql)
  Binder Error: UNNEST requires a single list as input.
[0m10:10:42.247659 [debug] [MainThread]: Using duckdb connection "master"
[0m10:10:42.251203 [debug] [MainThread]: On master: BEGIN
[0m10:10:42.252745 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:10:42.285544 [debug] [MainThread]: SQL status: OK in 0.033 seconds
[0m10:10:42.286696 [debug] [MainThread]: On master: COMMIT
[0m10:10:42.287778 [debug] [MainThread]: Using duckdb connection "master"
[0m10:10:42.288825 [debug] [MainThread]: On master: COMMIT
[0m10:10:42.290530 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m10:10:42.291842 [debug] [MainThread]: On master: Close
[0m10:10:42.303130 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:10:42.304423 [debug] [MainThread]: Connection 'create_sales_database_main' was properly closed.
[0m10:10:42.306267 [debug] [MainThread]: Connection 'list_sales_database_main' was properly closed.
[0m10:10:42.308415 [debug] [MainThread]: Connection 'model.my_dbt_project.sales_fact' was properly closed.
[0m10:10:42.310964 [info ] [MainThread]: 
[0m10:10:42.312639 [info ] [MainThread]: Finished running 2 table models, 4 view models in 0 hours 0 minutes and 11.00 seconds (11.00s).
[0m10:10:42.317763 [debug] [MainThread]: Command end result
[0m10:10:42.425037 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m10:10:42.497433 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m10:10:42.523335 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dags/dbt_models/target/run_results.json
[0m10:10:42.524663 [info ] [MainThread]: 
[0m10:10:42.525971 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m10:10:42.527460 [info ] [MainThread]: 
[0m10:10:42.529017 [error] [MainThread]:   Runtime Error in model sales_fact (models/facts/sales_fact.sql)
  Binder Error: UNNEST requires a single list as input
[0m10:10:42.530562 [info ] [MainThread]: 
[0m10:10:42.541048 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m10:10:42.566471 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 44.497818, "process_in_blocks": "3073664", "process_kernel_time": 13.851424, "process_mem_max_rss": "134644", "process_out_blocks": "0", "process_user_time": 16.315235}
[0m10:10:42.687367 [debug] [MainThread]: Command `dbt run` failed at 10:10:42.687015 after 44.62 seconds
[0m10:10:42.689473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70e2bf75f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70d873d370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70def54d40>]}
[0m10:10:42.691594 [debug] [MainThread]: Flushing usage events
[0m10:10:45.250054 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:14:57.596595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96d7941fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96d80a9d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96d7222210>]}


============================== 10:14:57.609229 | ad370189-ad4a-4a4d-b6d7-fd14e810e780 ==============================
[0m10:14:57.609229 [info ] [MainThread]: Running with dbt=1.9.1
[0m10:14:57.610676 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dags/dbt_models/logs', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt/profiles.yml', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt/profiles.yml --target dev', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:14:58.450161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ad370189-ad4a-4a4d-b6d7-fd14e810e780', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96d1361550>]}
[0m10:14:58.559595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ad370189-ad4a-4a4d-b6d7-fd14e810e780', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96d6a82180>]}
[0m10:14:58.571005 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m10:14:58.797870 [debug] [MainThread]: checksum: cac3b9519010e47bfbeb71ca6efb4867dae2858687671594dc23fefc94ecf25d, vars: {}, profile: , target: dev, version: 1.9.1
[0m10:14:59.222714 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:14:59.226283 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/facts/sales_fact.sql
[0m10:14:59.727061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ad370189-ad4a-4a4d-b6d7-fd14e810e780', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96d0c55b20>]}
[0m10:14:59.900907 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m10:14:59.912969 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m10:15:00.017059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ad370189-ad4a-4a4d-b6d7-fd14e810e780', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96d032d130>]}
[0m10:15:00.018932 [info ] [MainThread]: Found 6 models, 1 source, 424 macros
[0m10:15:00.020835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ad370189-ad4a-4a4d-b6d7-fd14e810e780', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96d035a7b0>]}
[0m10:15:00.024874 [info ] [MainThread]: 
[0m10:15:00.026184 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:15:00.027553 [info ] [MainThread]: 
[0m10:15:00.029203 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m10:15:00.038014 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_sales_database'
[0m10:15:00.138433 [debug] [ThreadPool]: Using duckdb connection "list_sales_database"
[0m10:15:00.140131 [debug] [ThreadPool]: On list_sales_database: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "list_sales_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"sales_database"'
    
  
  
[0m10:15:00.141815 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:15:00.220490 [debug] [ThreadPool]: SQL status: OK in 0.078 seconds
[0m10:15:00.225042 [debug] [ThreadPool]: On list_sales_database: Close
[0m10:15:00.233983 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_database, now create_sales_database_main)
[0m10:15:00.237115 [debug] [ThreadPool]: Creating schema "database: "sales_database"
schema: "main"
"
[0m10:15:00.253283 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m10:15:00.255041 [debug] [ThreadPool]: On create_sales_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "create_sales_database_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='sales_database'
        and type='sqlite'
    
  
[0m10:15:00.256256 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:15:00.289583 [debug] [ThreadPool]: SQL status: OK in 0.033 seconds
[0m10:15:00.293664 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m10:15:00.295273 [debug] [ThreadPool]: On create_sales_database_main: BEGIN
[0m10:15:00.297290 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:15:00.298931 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m10:15:00.300074 [debug] [ThreadPool]: On create_sales_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "create_sales_database_main"} */

    
    
        create schema if not exists "sales_database"."main"
    
[0m10:15:00.302609 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:15:00.304965 [debug] [ThreadPool]: On create_sales_database_main: COMMIT
[0m10:15:00.306167 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m10:15:00.307357 [debug] [ThreadPool]: On create_sales_database_main: COMMIT
[0m10:15:00.309176 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:15:00.310805 [debug] [ThreadPool]: On create_sales_database_main: Close
[0m10:15:00.318052 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_sales_database_main, now list_sales_database_main)
[0m10:15:00.331915 [debug] [ThreadPool]: Using duckdb connection "list_sales_database_main"
[0m10:15:00.333603 [debug] [ThreadPool]: On list_sales_database_main: BEGIN
[0m10:15:00.335206 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:15:00.366109 [debug] [ThreadPool]: SQL status: OK in 0.031 seconds
[0m10:15:00.367348 [debug] [ThreadPool]: Using duckdb connection "list_sales_database_main"
[0m10:15:00.368441 [debug] [ThreadPool]: On list_sales_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "list_sales_database_main"} */
select
      'sales_database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'sales_database'
  
[0m10:15:00.422124 [debug] [ThreadPool]: SQL status: OK in 0.052 seconds
[0m10:15:00.426307 [debug] [ThreadPool]: On list_sales_database_main: ROLLBACK
[0m10:15:00.430465 [debug] [ThreadPool]: Failed to rollback 'list_sales_database_main'
[0m10:15:00.432193 [debug] [ThreadPool]: On list_sales_database_main: Close
[0m10:15:00.441704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ad370189-ad4a-4a4d-b6d7-fd14e810e780', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96d6aff590>]}
[0m10:15:00.443439 [debug] [MainThread]: Using duckdb connection "master"
[0m10:15:00.444764 [debug] [MainThread]: On master: BEGIN
[0m10:15:00.446202 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:15:00.477068 [debug] [MainThread]: SQL status: OK in 0.030 seconds
[0m10:15:00.479811 [debug] [MainThread]: On master: COMMIT
[0m10:15:00.481463 [debug] [MainThread]: Using duckdb connection "master"
[0m10:15:00.483137 [debug] [MainThread]: On master: COMMIT
[0m10:15:00.485202 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m10:15:00.486489 [debug] [MainThread]: On master: Close
[0m10:15:00.494695 [debug] [Thread-1 (]: Began running node model.my_dbt_project.customer_dimension
[0m10:15:00.496243 [info ] [Thread-1 (]: 1 of 6 START sql view model main.customer_dimension ............................ [RUN]
[0m10:15:00.498786 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.my_dbt_project.customer_dimension'
[0m10:15:00.500505 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.customer_dimension
[0m10:15:00.520717 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.customer_dimension"
[0m10:15:00.539311 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.customer_dimension
[0m10:15:00.648097 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.customer_dimension"
[0m10:15:00.681587 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m10:15:00.685629 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: BEGIN
[0m10:15:00.687880 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:15:00.771352 [debug] [Thread-1 (]: SQL status: OK in 0.083 seconds
[0m10:15:00.773711 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m10:15:00.776710 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */

  
  create view "sales_database"."main"."customer_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
    DISTINCT
    customer AS customer_id,
    customer_name,
    customer_address,
    customer_group,
    territory,
    language AS customer_language
FROM sales
WHERE customer IS NOT NULL
  );

[0m10:15:00.782567 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m10:15:00.818032 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m10:15:00.820804 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */
alter view "sales_database"."main"."customer_dimension" rename to "customer_dimension__dbt_backup"
[0m10:15:00.824628 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:15:00.838306 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m10:15:00.841329 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */
alter view "sales_database"."main"."customer_dimension__dbt_tmp" rename to "customer_dimension"
[0m10:15:00.846024 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:15:00.911843 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: COMMIT
[0m10:15:00.916494 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m10:15:00.919162 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: COMMIT
[0m10:15:00.945713 [debug] [Thread-1 (]: SQL status: OK in 0.024 seconds
[0m10:15:00.975846 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m10:15:00.984701 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */
drop view if exists "sales_database"."main"."customer_dimension__dbt_backup" cascade
[0m10:15:01.000228 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m10:15:01.023067 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: Close
[0m10:15:01.121620 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad370189-ad4a-4a4d-b6d7-fd14e810e780', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96d8d2e270>]}
[0m10:15:01.126028 [info ] [Thread-1 (]: 1 of 6 OK created sql view model main.customer_dimension ....................... [[32mOK[0m in 0.61s]
[0m10:15:01.132400 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.customer_dimension
[0m10:15:01.135843 [debug] [Thread-1 (]: Began running node model.my_dbt_project.date_dimension
[0m10:15:01.138958 [info ] [Thread-1 (]: 2 of 6 START sql view model main.date_dimension ................................ [RUN]
[0m10:15:01.142041 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customer_dimension, now model.my_dbt_project.date_dimension)
[0m10:15:01.144950 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.date_dimension
[0m10:15:01.178944 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.date_dimension"
[0m10:15:01.249607 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.date_dimension
[0m10:15:01.285029 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.date_dimension"
[0m10:15:01.310497 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m10:15:01.312904 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: BEGIN
[0m10:15:01.316265 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:15:01.394231 [debug] [Thread-1 (]: SQL status: OK in 0.078 seconds
[0m10:15:01.396564 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m10:15:01.399720 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.date_dimension"} */

  
  create view "sales_database"."main"."date_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
    transaction_date,
    strftime(transaction_date, '%A') AS weekday_name,  -- Extract weekday name
    strftime(transaction_date, '%m') AS month,          -- Extract month (numeric)
    strftime(transaction_date, '%Y') AS year,           -- Extract year
    strftime(transaction_date, '%d') AS day,            -- Extract day
    EXTRACT(QUARTER FROM transaction_date) AS quarter   -- Extract quarter
FROM sales
WHERE transaction_date IS NOT NULL
  );

[0m10:15:01.415759 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m10:15:01.429431 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m10:15:01.431222 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.date_dimension"} */
alter view "sales_database"."main"."date_dimension" rename to "date_dimension__dbt_backup"
[0m10:15:01.435289 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:15:01.453764 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m10:15:01.457494 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.date_dimension"} */
alter view "sales_database"."main"."date_dimension__dbt_tmp" rename to "date_dimension"
[0m10:15:01.460487 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:15:01.475175 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: COMMIT
[0m10:15:01.478017 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m10:15:01.484984 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: COMMIT
[0m10:15:01.524386 [debug] [Thread-1 (]: SQL status: OK in 0.035 seconds
[0m10:15:01.543692 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m10:15:01.547618 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.date_dimension"} */
drop view if exists "sales_database"."main"."date_dimension__dbt_backup" cascade
[0m10:15:01.561450 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m10:15:01.571632 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: Close
[0m10:15:01.656512 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad370189-ad4a-4a4d-b6d7-fd14e810e780', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96d0c1b8f0>]}
[0m10:15:01.660796 [info ] [Thread-1 (]: 2 of 6 OK created sql view model main.date_dimension ........................... [[32mOK[0m in 0.51s]
[0m10:15:01.665090 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.date_dimension
[0m10:15:01.667962 [debug] [Thread-1 (]: Began running node model.my_dbt_project.product_dimension
[0m10:15:01.672066 [info ] [Thread-1 (]: 3 of 6 START sql view model main.product_dimension ............................. [RUN]
[0m10:15:01.675265 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.date_dimension, now model.my_dbt_project.product_dimension)
[0m10:15:01.678441 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.product_dimension
[0m10:15:01.686078 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.product_dimension"
[0m10:15:01.702545 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.product_dimension
[0m10:15:01.719724 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.product_dimension"
[0m10:15:01.738725 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m10:15:01.740532 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: BEGIN
[0m10:15:01.742487 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:15:01.799935 [debug] [Thread-1 (]: SQL status: OK in 0.057 seconds
[0m10:15:01.801848 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m10:15:01.803733 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.product_dimension"} */

  
  create view "sales_database"."main"."product_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * 
    FROM "sales_database"."main"."sales"
)

SELECT 
    sales.name,
    json_extract(items, '$[0].name') AS product_name,  -- Example to extract the first element's "name" field from JSON array
    json_extract(items, '$[0].item_code') AS product_item_code
FROM sales
WHERE json_extract(items, '$[0].name') IS NOT NULL  -- Filter to only keep rows with a non-null product name
  );

[0m10:15:01.810912 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m10:15:01.822653 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m10:15:01.824622 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.product_dimension"} */
alter view "sales_database"."main"."product_dimension" rename to "product_dimension__dbt_backup"
[0m10:15:01.827360 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:15:01.841681 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m10:15:01.844265 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.product_dimension"} */
alter view "sales_database"."main"."product_dimension__dbt_tmp" rename to "product_dimension"
[0m10:15:01.847572 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:15:01.855366 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: COMMIT
[0m10:15:01.857619 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m10:15:01.859581 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: COMMIT
[0m10:15:01.876053 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m10:15:01.888510 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m10:15:01.891412 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.product_dimension"} */
drop view if exists "sales_database"."main"."product_dimension__dbt_backup" cascade
[0m10:15:01.902193 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m10:15:01.907711 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: Close
[0m10:15:01.980300 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad370189-ad4a-4a4d-b6d7-fd14e810e780', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96b36c1850>]}
[0m10:15:01.983314 [info ] [Thread-1 (]: 3 of 6 OK created sql view model main.product_dimension ........................ [[32mOK[0m in 0.30s]
[0m10:15:01.987708 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.product_dimension
[0m10:15:01.990370 [debug] [Thread-1 (]: Began running node model.my_dbt_project.sales_team_dimension
[0m10:15:01.993658 [info ] [Thread-1 (]: 4 of 6 START sql view model main.sales_team_dimension .......................... [RUN]
[0m10:15:01.999989 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.product_dimension, now model.my_dbt_project.sales_team_dimension)
[0m10:15:02.002331 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.sales_team_dimension
[0m10:15:02.012550 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.sales_team_dimension"
[0m10:15:02.053794 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.sales_team_dimension
[0m10:15:02.070875 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.sales_team_dimension"
[0m10:15:02.094748 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m10:15:02.096633 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: BEGIN
[0m10:15:02.098671 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:15:02.162699 [debug] [Thread-1 (]: SQL status: OK in 0.064 seconds
[0m10:15:02.164791 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m10:15:02.172840 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */

  
  create view "sales_database"."main"."sales_team_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
    DISTINCT
    sales_team->>'name' AS sales_team_id,
    sales_team->>'region' AS sales_team_region
FROM sales
WHERE sales_team IS NOT NULL
  );

[0m10:15:02.188461 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m10:15:02.202498 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m10:15:02.204641 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */
alter view "sales_database"."main"."sales_team_dimension" rename to "sales_team_dimension__dbt_backup"
[0m10:15:02.207920 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:15:02.229323 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m10:15:02.231425 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */
alter view "sales_database"."main"."sales_team_dimension__dbt_tmp" rename to "sales_team_dimension"
[0m10:15:02.240787 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:15:02.247423 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: COMMIT
[0m10:15:02.249749 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m10:15:02.252001 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: COMMIT
[0m10:15:02.274620 [debug] [Thread-1 (]: SQL status: OK in 0.019 seconds
[0m10:15:02.285058 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m10:15:02.295950 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */
drop view if exists "sales_database"."main"."sales_team_dimension__dbt_backup" cascade
[0m10:15:02.331105 [debug] [Thread-1 (]: SQL status: OK in 0.016 seconds
[0m10:15:02.342514 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: Close
[0m10:15:02.460378 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad370189-ad4a-4a4d-b6d7-fd14e810e780', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96b1b2f200>]}
[0m10:15:02.465647 [info ] [Thread-1 (]: 4 of 6 OK created sql view model main.sales_team_dimension ..................... [[32mOK[0m in 0.46s]
[0m10:15:02.471400 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.sales_team_dimension
[0m10:15:02.481970 [debug] [Thread-1 (]: Began running node model.my_dbt_project.transform_sales
[0m10:15:02.495155 [info ] [Thread-1 (]: 5 of 6 START sql table model main.transform_sales .............................. [RUN]
[0m10:15:02.503610 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.sales_team_dimension, now model.my_dbt_project.transform_sales)
[0m10:15:02.521602 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.transform_sales
[0m10:15:02.573710 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.transform_sales"
[0m10:15:02.610224 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.transform_sales
[0m10:15:02.745823 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.transform_sales"
[0m10:15:02.839695 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m10:15:02.843989 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: BEGIN
[0m10:15:02.846532 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:15:04.383550 [debug] [Thread-1 (]: SQL status: OK in 1.530 seconds
[0m10:15:04.391192 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m10:15:04.393872 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */

  
    
    

    create  table
      "sales_database"."main"."transform_sales__dbt_tmp"
  
    as (
      -- /opt/airflow/dags/dbt_models/transform_users.sql


WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
   *
FROM sales
WHERE name = 'ABC private LTD-0002'
    );
  
  
[0m10:15:05.235638 [debug] [Thread-1 (]: SQL status: OK in 0.831 seconds
[0m10:15:05.261743 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m10:15:05.265262 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */
alter table "sales_database"."main"."transform_sales" rename to "transform_sales__dbt_backup"
[0m10:15:05.682434 [debug] [Thread-1 (]: SQL status: OK in 0.407 seconds
[0m10:15:05.718055 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m10:15:05.720164 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */
alter table "sales_database"."main"."transform_sales__dbt_tmp" rename to "transform_sales"
[0m10:15:06.727296 [debug] [Thread-1 (]: SQL status: OK in 0.999 seconds
[0m10:15:06.755312 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: COMMIT
[0m10:15:06.758708 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m10:15:06.760591 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: COMMIT
[0m10:15:06.867187 [debug] [Thread-1 (]: SQL status: OK in 0.105 seconds
[0m10:15:06.876610 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m10:15:06.879264 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */
drop table if exists "sales_database"."main"."transform_sales__dbt_backup" cascade
[0m10:15:06.901848 [debug] [Thread-1 (]: SQL status: OK in 0.018 seconds
[0m10:15:06.908143 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: Close
[0m10:15:07.232596 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad370189-ad4a-4a4d-b6d7-fd14e810e780', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96d0329790>]}
[0m10:15:07.236788 [info ] [Thread-1 (]: 5 of 6 OK created sql table model main.transform_sales ......................... [[32mOK[0m in 4.72s]
[0m10:15:07.239542 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.transform_sales
[0m10:15:07.242704 [debug] [Thread-1 (]: Began running node model.my_dbt_project.sales_fact
[0m10:15:07.244987 [info ] [Thread-1 (]: 6 of 6 START sql table model main.sales_fact ................................... [RUN]
[0m10:15:07.247382 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.transform_sales, now model.my_dbt_project.sales_fact)
[0m10:15:07.249966 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.sales_fact
[0m10:15:07.264672 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.sales_fact"
[0m10:15:07.282940 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.sales_fact
[0m10:15:07.304405 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.sales_fact"
[0m10:15:07.327818 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_fact"
[0m10:15:07.329581 [debug] [Thread-1 (]: On model.my_dbt_project.sales_fact: BEGIN
[0m10:15:07.331194 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:15:07.440175 [debug] [Thread-1 (]: SQL status: OK in 0.109 seconds
[0m10:15:07.448347 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_fact"
[0m10:15:07.450979 [debug] [Thread-1 (]: On model.my_dbt_project.sales_fact: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_fact"} */

  
    
    

    create  table
      "sales_database"."main"."sales_fact__dbt_tmp"
  
    as (
      WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
),
customer AS (
    SELECT * FROM "sales_database"."main"."customer_dimension"
),
product AS (
    SELECT * FROM "sales_database"."main"."product_dimension"
),
sales_team AS (
    SELECT * FROM "sales_database"."main"."sales_team_dimension"
),
date AS (
    SELECT * FROM "sales_database"."main"."date_dimension"
)

SELECT
    sales.name AS sales_id,
    customer.customer_id,
    product.product_id,
    sales_team.sales_team_id,
    date.date_id,
    sales.total_qty,
    sales.total_net_weight,
    sales.total,
    sales.net_total,
    sales.grand_total,
    sales.tax_category
FROM sales
JOIN customer ON sales.customer = customer.customer_id
-- Handling product as a lateral join for JSON
JOIN LATERAL (
    SELECT item->>'product_id' AS product_id
    FROM json_array_elements(sales.items::json) AS product(item)
    WHERE item->>'product_id' IS NOT NULL
) AS product ON TRUE
-- Handling sales_team as a lateral join for JSON
JOIN LATERAL (
    SELECT item->>'sales_team_id' AS sales_team_id
    FROM json_array_elements(sales.sales_team::json) AS team(item)
    WHERE item->>'sales_team_id' IS NOT NULL
) AS sales_team ON TRUE
JOIN date ON sales.transaction_date = date.date_id
    );
  
  
[0m10:15:07.531358 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_fact"} */

  
    
    

    create  table
      "sales_database"."main"."sales_fact__dbt_tmp"
  
    as (
      WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
),
customer AS (
    SELECT * FROM "sales_database"."main"."customer_dimension"
),
product AS (
    SELECT * FROM "sales_database"."main"."product_dimension"
),
sales_team AS (
    SELECT * FROM "sales_database"."main"."sales_team_dimension"
),
date AS (
    SELECT * FROM "sales_database"."main"."date_dimension"
)

SELECT
    sales.name AS sales_id,
    customer.customer_id,
    product.product_id,
    sales_team.sales_team_id,
    date.date_id,
    sales.total_qty,
    sales.total_net_weight,
    sales.total,
    sales.net_total,
    sales.grand_total,
    sales.tax_category
FROM sales
JOIN customer ON sales.customer = customer.customer_id
-- Handling product as a lateral join for JSON
JOIN LATERAL (
    SELECT item->>'product_id' AS product_id
    FROM json_array_elements(sales.items::json) AS product(item)
    WHERE item->>'product_id' IS NOT NULL
) AS product ON TRUE
-- Handling sales_team as a lateral join for JSON
JOIN LATERAL (
    SELECT item->>'sales_team_id' AS sales_team_id
    FROM json_array_elements(sales.sales_team::json) AS team(item)
    WHERE item->>'sales_team_id' IS NOT NULL
) AS sales_team ON TRUE
JOIN date ON sales.transaction_date = date.date_id
    );
  
  
[0m10:15:07.534105 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m10:15:07.541778 [debug] [Thread-1 (]: On model.my_dbt_project.sales_fact: ROLLBACK
[0m10:15:07.634870 [debug] [Thread-1 (]: Failed to rollback 'model.my_dbt_project.sales_fact'
[0m10:15:07.638735 [debug] [Thread-1 (]: On model.my_dbt_project.sales_fact: Close
[0m10:15:07.672931 [debug] [Thread-1 (]: Runtime Error in model sales_fact (models/facts/sales_fact.sql)
  Catalog Error: Table Function with name json_array_elements does not exist!
  Did you mean "json_execute_serialized_sql"?
  LINE 44:     FROM json_array_elements(sales.items::json) AS product(item)
      WHERE item->>'product_id' IS NOT NULL
  ) AS product ON TRUE
  -- Handling sales_team as a lateral join for JSON
  JOIN LATERAL (
      SELECT item->>'sales_team_id' AS sales_team_id
      FROM json_array_elements(sales.sales_team::json) AS team(item)
      WHERE item->>'sales_team_id' IS NOT NULL
  ) AS sales_team ON TRUE
  JOIN date ON sales.transaction_date = date.date_id
      );
    
    ...
                    ^
[0m10:15:07.695797 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad370189-ad4a-4a4d-b6d7-fd14e810e780', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96b36c5610>]}
[0m10:15:07.705904 [error] [Thread-1 (]: 6 of 6 ERROR creating sql table model main.sales_fact .......................... [[31mERROR[0m in 0.45s]
[0m10:15:07.724515 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.sales_fact
[0m10:15:07.729646 [debug] [Thread-4 (]: Marking all children of 'model.my_dbt_project.sales_fact' to be skipped because of status 'error'.  Reason: Runtime Error in model sales_fact (models/facts/sales_fact.sql)
  Catalog Error: Table Function with name json_array_elements does not exist!
  Did you mean "json_execute_serialized_sql"?
  LINE 44:     FROM json_array_elements(sales.items::json) AS product(item)
      WHERE item->>'product_id' IS NOT NULL
  ) AS product ON TRUE
  -- Handling sales_team as a lateral join for JSON
  JOIN LATERAL (
      SELECT item->>'sales_team_id' AS sales_team_id
      FROM json_array_elements(sales.sales_team::json) AS team(item)
      WHERE item->>'sales_team_id' IS NOT NULL
  ) AS sales_team ON TRUE
  JOIN date ON sales.transaction_date = date.date_id
      );
    
    ...
                    ^.
[0m10:15:07.752573 [debug] [MainThread]: Using duckdb connection "master"
[0m10:15:07.755510 [debug] [MainThread]: On master: BEGIN
[0m10:15:07.762020 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:15:07.837538 [debug] [MainThread]: SQL status: OK in 0.076 seconds
[0m10:15:07.840131 [debug] [MainThread]: On master: COMMIT
[0m10:15:07.844714 [debug] [MainThread]: Using duckdb connection "master"
[0m10:15:07.848479 [debug] [MainThread]: On master: COMMIT
[0m10:15:07.853712 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m10:15:07.856288 [debug] [MainThread]: On master: Close
[0m10:15:07.866602 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:15:07.868662 [debug] [MainThread]: Connection 'list_sales_database_main' was properly closed.
[0m10:15:07.870377 [debug] [MainThread]: Connection 'model.my_dbt_project.sales_fact' was properly closed.
[0m10:15:07.873566 [info ] [MainThread]: 
[0m10:15:07.877284 [info ] [MainThread]: Finished running 2 table models, 4 view models in 0 hours 0 minutes and 7.84 seconds (7.84s).
[0m10:15:07.885665 [debug] [MainThread]: Command end result
[0m10:15:08.136781 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m10:15:08.183260 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m10:15:08.231697 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dags/dbt_models/target/run_results.json
[0m10:15:08.233625 [info ] [MainThread]: 
[0m10:15:08.237174 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m10:15:08.239091 [info ] [MainThread]: 
[0m10:15:08.243656 [error] [MainThread]:   Runtime Error in model sales_fact (models/facts/sales_fact.sql)
  Catalog Error: Table Function with name json_array_elements does not exist!
  Did you mean "json_execute_serialized_sql"?
  LINE 44:     FROM json_array_elements(sales.items::json) AS product(item)
      WHERE item->>'product_id' IS NOT NULL
  ) AS product ON TRUE
  -- Handling sales_team as a lateral join for JSON
  JOIN LATERAL (
      SELECT item->>'sales_team_id' AS sales_team_id
      FROM json_array_elements(sales.sales_team::json) AS team(item)
      WHERE item->>'sales_team_id' IS NOT NULL
  ) AS sales_team ON TRUE
  JOIN date ON sales.transaction_date = date.date_id
      );
    
    ...
                    ^
[0m10:15:08.247117 [info ] [MainThread]: 
[0m10:15:08.252056 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m10:15:08.306627 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 10.885483, "process_in_blocks": "669576", "process_kernel_time": 1.823309, "process_mem_max_rss": "144956", "process_out_blocks": "0", "process_user_time": 8.601266}
[0m10:15:08.319293 [debug] [MainThread]: Command `dbt run` failed at 10:15:08.318828 after 10.92 seconds
[0m10:15:08.321786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96da80f5f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96d13d7080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96d6b8d040>]}
[0m10:15:08.323803 [debug] [MainThread]: Flushing usage events
[0m10:15:11.092937 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:18:18.552740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2909a3050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd290861730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2912da5d0>]}


============================== 10:18:18.574402 | 09da20df-be86-4f17-898b-c301483effc5 ==============================
[0m10:18:18.574402 [info ] [MainThread]: Running with dbt=1.9.1
[0m10:18:18.578028 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dags/dbt_models/logs', 'profiles_dir': '/opt/airflow/dbt/profiles.yml', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt/profiles.yml --target dev', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:18:19.571957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '09da20df-be86-4f17-898b-c301483effc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd28ca96210>]}
[0m10:18:19.669859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '09da20df-be86-4f17-898b-c301483effc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd290f4ce00>]}
[0m10:18:19.680180 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m10:18:19.881238 [debug] [MainThread]: checksum: cac3b9519010e47bfbeb71ca6efb4867dae2858687671594dc23fefc94ecf25d, vars: {}, profile: , target: dev, version: 1.9.1
[0m10:18:20.389895 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:18:20.391685 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/facts/sales_fact.sql
[0m10:18:20.913066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '09da20df-be86-4f17-898b-c301483effc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd289a77920>]}
[0m10:18:21.076143 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m10:18:21.088111 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m10:18:21.301401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '09da20df-be86-4f17-898b-c301483effc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd28a980860>]}
[0m10:18:21.303131 [info ] [MainThread]: Found 6 models, 1 source, 424 macros
[0m10:18:21.304504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '09da20df-be86-4f17-898b-c301483effc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd289a62660>]}
[0m10:18:21.308466 [info ] [MainThread]: 
[0m10:18:21.309756 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:18:21.310978 [info ] [MainThread]: 
[0m10:18:21.312705 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m10:18:21.322080 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_sales_database'
[0m10:18:21.413524 [debug] [ThreadPool]: Using duckdb connection "list_sales_database"
[0m10:18:21.414903 [debug] [ThreadPool]: On list_sales_database: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "list_sales_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"sales_database"'
    
  
  
[0m10:18:21.416200 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:18:21.473241 [debug] [ThreadPool]: SQL status: OK in 0.057 seconds
[0m10:18:21.476157 [debug] [ThreadPool]: On list_sales_database: Close
[0m10:18:21.482712 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_database, now create_sales_database_main)
[0m10:18:21.484444 [debug] [ThreadPool]: Creating schema "database: "sales_database"
schema: "main"
"
[0m10:18:21.504368 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m10:18:21.506111 [debug] [ThreadPool]: On create_sales_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "create_sales_database_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='sales_database'
        and type='sqlite'
    
  
[0m10:18:21.507658 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:18:21.542349 [debug] [ThreadPool]: SQL status: OK in 0.035 seconds
[0m10:18:21.546491 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m10:18:21.547671 [debug] [ThreadPool]: On create_sales_database_main: BEGIN
[0m10:18:21.549928 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:18:21.551420 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m10:18:21.552594 [debug] [ThreadPool]: On create_sales_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "create_sales_database_main"} */

    
    
        create schema if not exists "sales_database"."main"
    
[0m10:18:21.555224 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:18:21.558078 [debug] [ThreadPool]: On create_sales_database_main: COMMIT
[0m10:18:21.559462 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m10:18:21.560697 [debug] [ThreadPool]: On create_sales_database_main: COMMIT
[0m10:18:21.562736 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:18:21.564121 [debug] [ThreadPool]: On create_sales_database_main: Close
[0m10:18:21.571900 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_sales_database_main, now list_sales_database_main)
[0m10:18:21.591509 [debug] [ThreadPool]: Using duckdb connection "list_sales_database_main"
[0m10:18:21.592806 [debug] [ThreadPool]: On list_sales_database_main: BEGIN
[0m10:18:21.594021 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:18:21.637123 [debug] [ThreadPool]: SQL status: OK in 0.043 seconds
[0m10:18:21.638456 [debug] [ThreadPool]: Using duckdb connection "list_sales_database_main"
[0m10:18:21.639537 [debug] [ThreadPool]: On list_sales_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "list_sales_database_main"} */
select
      'sales_database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'sales_database'
  
[0m10:18:21.724553 [debug] [ThreadPool]: SQL status: OK in 0.084 seconds
[0m10:18:21.727939 [debug] [ThreadPool]: On list_sales_database_main: ROLLBACK
[0m10:18:21.731435 [debug] [ThreadPool]: Failed to rollback 'list_sales_database_main'
[0m10:18:21.732793 [debug] [ThreadPool]: On list_sales_database_main: Close
[0m10:18:21.742080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '09da20df-be86-4f17-898b-c301483effc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd28a3496a0>]}
[0m10:18:21.743583 [debug] [MainThread]: Using duckdb connection "master"
[0m10:18:21.744760 [debug] [MainThread]: On master: BEGIN
[0m10:18:21.745909 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:18:21.777062 [debug] [MainThread]: SQL status: OK in 0.031 seconds
[0m10:18:21.778492 [debug] [MainThread]: On master: COMMIT
[0m10:18:21.779601 [debug] [MainThread]: Using duckdb connection "master"
[0m10:18:21.780722 [debug] [MainThread]: On master: COMMIT
[0m10:18:21.782489 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m10:18:21.783784 [debug] [MainThread]: On master: Close
[0m10:18:21.791303 [debug] [Thread-1 (]: Began running node model.my_dbt_project.customer_dimension
[0m10:18:21.792816 [info ] [Thread-1 (]: 1 of 6 START sql view model main.customer_dimension ............................ [RUN]
[0m10:18:21.794911 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.my_dbt_project.customer_dimension'
[0m10:18:21.796544 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.customer_dimension
[0m10:18:21.815716 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.customer_dimension"
[0m10:18:21.830356 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.customer_dimension
[0m10:18:21.912907 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.customer_dimension"
[0m10:18:21.928835 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m10:18:21.930624 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: BEGIN
[0m10:18:21.932355 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:18:21.974157 [debug] [Thread-1 (]: SQL status: OK in 0.042 seconds
[0m10:18:21.976162 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m10:18:21.978051 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */

  
  create view "sales_database"."main"."customer_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
    DISTINCT
    customer AS customer_id,
    customer_name,
    customer_address,
    customer_group,
    territory,
    language AS customer_language
FROM sales
WHERE customer IS NOT NULL
  );

[0m10:18:21.981561 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:18:21.996384 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m10:18:21.998042 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */
alter view "sales_database"."main"."customer_dimension" rename to "customer_dimension__dbt_backup"
[0m10:18:22.000365 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:18:22.007071 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m10:18:22.008475 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */
alter view "sales_database"."main"."customer_dimension__dbt_tmp" rename to "customer_dimension"
[0m10:18:22.010472 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:18:22.033052 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: COMMIT
[0m10:18:22.034433 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m10:18:22.035604 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: COMMIT
[0m10:18:22.043737 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m10:18:22.053746 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m10:18:22.054985 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */
drop view if exists "sales_database"."main"."customer_dimension__dbt_backup" cascade
[0m10:18:22.059073 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m10:18:22.064041 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: Close
[0m10:18:22.111519 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09da20df-be86-4f17-898b-c301483effc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd28a96c2f0>]}
[0m10:18:22.113160 [info ] [Thread-1 (]: 1 of 6 OK created sql view model main.customer_dimension ....................... [[32mOK[0m in 0.31s]
[0m10:18:22.114939 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.customer_dimension
[0m10:18:22.116136 [debug] [Thread-1 (]: Began running node model.my_dbt_project.date_dimension
[0m10:18:22.117931 [info ] [Thread-1 (]: 2 of 6 START sql view model main.date_dimension ................................ [RUN]
[0m10:18:22.119494 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customer_dimension, now model.my_dbt_project.date_dimension)
[0m10:18:22.120669 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.date_dimension
[0m10:18:22.125975 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.date_dimension"
[0m10:18:22.137168 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.date_dimension
[0m10:18:22.147136 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.date_dimension"
[0m10:18:22.160652 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m10:18:22.161936 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: BEGIN
[0m10:18:22.163087 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:18:22.190337 [debug] [Thread-1 (]: SQL status: OK in 0.027 seconds
[0m10:18:22.191542 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m10:18:22.192728 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.date_dimension"} */

  
  create view "sales_database"."main"."date_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
    transaction_date,
    strftime(transaction_date, '%A') AS weekday_name,  -- Extract weekday name
    strftime(transaction_date, '%m') AS month,          -- Extract month (numeric)
    strftime(transaction_date, '%Y') AS year,           -- Extract year
    strftime(transaction_date, '%d') AS day,            -- Extract day
    EXTRACT(QUARTER FROM transaction_date) AS quarter   -- Extract quarter
FROM sales
WHERE transaction_date IS NOT NULL
  );

[0m10:18:22.195662 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:18:22.204228 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m10:18:22.207117 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.date_dimension"} */
alter view "sales_database"."main"."date_dimension" rename to "date_dimension__dbt_backup"
[0m10:18:22.209468 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:18:22.215539 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m10:18:22.217223 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.date_dimension"} */
alter view "sales_database"."main"."date_dimension__dbt_tmp" rename to "date_dimension"
[0m10:18:22.219603 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:18:22.223097 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: COMMIT
[0m10:18:22.224258 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m10:18:22.225375 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: COMMIT
[0m10:18:22.233057 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m10:18:22.238287 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m10:18:22.239592 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.date_dimension"} */
drop view if exists "sales_database"."main"."date_dimension__dbt_backup" cascade
[0m10:18:22.244219 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m10:18:22.247061 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: Close
[0m10:18:22.285960 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09da20df-be86-4f17-898b-c301483effc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd288edcef0>]}
[0m10:18:22.287807 [info ] [Thread-1 (]: 2 of 6 OK created sql view model main.date_dimension ........................... [[32mOK[0m in 0.17s]
[0m10:18:22.289663 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.date_dimension
[0m10:18:22.291051 [debug] [Thread-1 (]: Began running node model.my_dbt_project.product_dimension
[0m10:18:22.292415 [info ] [Thread-1 (]: 3 of 6 START sql view model main.product_dimension ............................. [RUN]
[0m10:18:22.293806 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.date_dimension, now model.my_dbt_project.product_dimension)
[0m10:18:22.295534 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.product_dimension
[0m10:18:22.302753 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.product_dimension"
[0m10:18:22.317652 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.product_dimension
[0m10:18:22.325893 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.product_dimension"
[0m10:18:22.341587 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m10:18:22.342982 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: BEGIN
[0m10:18:22.344523 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:18:22.373306 [debug] [Thread-1 (]: SQL status: OK in 0.029 seconds
[0m10:18:22.374844 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m10:18:22.376396 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.product_dimension"} */

  
  create view "sales_database"."main"."product_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * 
    FROM "sales_database"."main"."sales"
)

SELECT 
    sales.name,
    json_extract(items, '$[0].name') AS product_name,  -- Example to extract the first element's "name" field from JSON array
    json_extract(items, '$[0].item_code') AS product_item_code
FROM sales
WHERE json_extract(items, '$[0].name') IS NOT NULL  -- Filter to only keep rows with a non-null product name
  );

[0m10:18:22.379422 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:18:22.386126 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m10:18:22.387571 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.product_dimension"} */
alter view "sales_database"."main"."product_dimension" rename to "product_dimension__dbt_backup"
[0m10:18:22.389544 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:18:22.395719 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m10:18:22.397023 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.product_dimension"} */
alter view "sales_database"."main"."product_dimension__dbt_tmp" rename to "product_dimension"
[0m10:18:22.399078 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:18:22.403105 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: COMMIT
[0m10:18:22.404450 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m10:18:22.405688 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: COMMIT
[0m10:18:22.414651 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m10:18:22.420292 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m10:18:22.421592 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.product_dimension"} */
drop view if exists "sales_database"."main"."product_dimension__dbt_backup" cascade
[0m10:18:22.425938 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m10:18:22.429276 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: Close
[0m10:18:22.477412 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09da20df-be86-4f17-898b-c301483effc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd288e14590>]}
[0m10:18:22.479239 [info ] [Thread-1 (]: 3 of 6 OK created sql view model main.product_dimension ........................ [[32mOK[0m in 0.18s]
[0m10:18:22.481207 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.product_dimension
[0m10:18:22.482647 [debug] [Thread-1 (]: Began running node model.my_dbt_project.sales_team_dimension
[0m10:18:22.484501 [info ] [Thread-1 (]: 4 of 6 START sql view model main.sales_team_dimension .......................... [RUN]
[0m10:18:22.486777 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.product_dimension, now model.my_dbt_project.sales_team_dimension)
[0m10:18:22.489045 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.sales_team_dimension
[0m10:18:22.498321 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.sales_team_dimension"
[0m10:18:22.512716 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.sales_team_dimension
[0m10:18:22.520896 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.sales_team_dimension"
[0m10:18:22.533692 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m10:18:22.535470 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: BEGIN
[0m10:18:22.536943 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:18:22.562257 [debug] [Thread-1 (]: SQL status: OK in 0.025 seconds
[0m10:18:22.563608 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m10:18:22.565104 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */

  
  create view "sales_database"."main"."sales_team_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
    DISTINCT
    sales_team->>'name' AS sales_team_id,
    sales_team->>'region' AS sales_team_region
FROM sales
WHERE sales_team IS NOT NULL
  );

[0m10:18:22.568618 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:18:22.574580 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m10:18:22.575883 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */
alter view "sales_database"."main"."sales_team_dimension" rename to "sales_team_dimension__dbt_backup"
[0m10:18:22.577993 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:18:22.586571 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m10:18:22.587944 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */
alter view "sales_database"."main"."sales_team_dimension__dbt_tmp" rename to "sales_team_dimension"
[0m10:18:22.589886 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:18:22.593516 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: COMMIT
[0m10:18:22.594779 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m10:18:22.596054 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: COMMIT
[0m10:18:22.603812 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m10:18:22.608980 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m10:18:22.610255 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */
drop view if exists "sales_database"."main"."sales_team_dimension__dbt_backup" cascade
[0m10:18:22.615085 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m10:18:22.618321 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: Close
[0m10:18:22.673382 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09da20df-be86-4f17-898b-c301483effc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2880d2c60>]}
[0m10:18:22.675559 [info ] [Thread-1 (]: 4 of 6 OK created sql view model main.sales_team_dimension ..................... [[32mOK[0m in 0.19s]
[0m10:18:22.677745 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.sales_team_dimension
[0m10:18:22.679216 [debug] [Thread-1 (]: Began running node model.my_dbt_project.transform_sales
[0m10:18:22.685059 [info ] [Thread-1 (]: 5 of 6 START sql table model main.transform_sales .............................. [RUN]
[0m10:18:22.686957 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.sales_team_dimension, now model.my_dbt_project.transform_sales)
[0m10:18:22.688739 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.transform_sales
[0m10:18:22.698040 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.transform_sales"
[0m10:18:22.711409 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.transform_sales
[0m10:18:22.753033 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.transform_sales"
[0m10:18:22.764999 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m10:18:22.766256 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: BEGIN
[0m10:18:22.767703 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:18:22.793924 [debug] [Thread-1 (]: SQL status: OK in 0.026 seconds
[0m10:18:22.795262 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m10:18:22.796530 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */

  
    
    

    create  table
      "sales_database"."main"."transform_sales__dbt_tmp"
  
    as (
      -- /opt/airflow/dags/dbt_models/transform_users.sql


WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
   *
FROM sales
WHERE name = 'ABC private LTD-0002'
    );
  
  
[0m10:18:22.821315 [debug] [Thread-1 (]: SQL status: OK in 0.023 seconds
[0m10:18:22.826900 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m10:18:22.828412 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */
alter table "sales_database"."main"."transform_sales" rename to "transform_sales__dbt_backup"
[0m10:18:22.830674 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:18:22.837365 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m10:18:22.838921 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */
alter table "sales_database"."main"."transform_sales__dbt_tmp" rename to "transform_sales"
[0m10:18:22.841341 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:18:22.851650 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: COMMIT
[0m10:18:22.853032 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m10:18:22.854149 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: COMMIT
[0m10:18:22.862443 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m10:18:22.867817 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m10:18:22.869125 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */
drop table if exists "sales_database"."main"."transform_sales__dbt_backup" cascade
[0m10:18:22.874563 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m10:18:22.877414 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: Close
[0m10:18:22.947190 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09da20df-be86-4f17-898b-c301483effc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd288e1c140>]}
[0m10:18:22.949082 [info ] [Thread-1 (]: 5 of 6 OK created sql table model main.transform_sales ......................... [[32mOK[0m in 0.26s]
[0m10:18:22.951331 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.transform_sales
[0m10:18:22.952957 [debug] [Thread-1 (]: Began running node model.my_dbt_project.sales_fact
[0m10:18:22.954416 [info ] [Thread-1 (]: 6 of 6 START sql table model main.sales_fact ................................... [RUN]
[0m10:18:22.955949 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.transform_sales, now model.my_dbt_project.sales_fact)
[0m10:18:22.957439 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.sales_fact
[0m10:18:22.964180 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.sales_fact"
[0m10:18:22.978282 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.sales_fact
[0m10:18:22.986631 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.sales_fact"
[0m10:18:23.002170 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_fact"
[0m10:18:23.003417 [debug] [Thread-1 (]: On model.my_dbt_project.sales_fact: BEGIN
[0m10:18:23.004748 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:18:23.039181 [debug] [Thread-1 (]: SQL status: OK in 0.034 seconds
[0m10:18:23.040598 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_fact"
[0m10:18:23.042150 [debug] [Thread-1 (]: On model.my_dbt_project.sales_fact: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_fact"} */

  
    
    

    create  table
      "sales_database"."main"."sales_fact__dbt_tmp"
  
    as (
      WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
),
customer AS (
    SELECT * FROM "sales_database"."main"."customer_dimension"
),
product AS (
    SELECT * FROM "sales_database"."main"."product_dimension"
),
sales_team AS (
    SELECT * FROM "sales_database"."main"."sales_team_dimension"
),
date AS (
    SELECT * FROM "sales_database"."main"."date_dimension"
)

SELECT
    sales.name AS sales_id,
    customer.customer_id,
    product.product_id,
    sales_team.sales_team_id,
    date.date_id,
    sales.total_qty,
    sales.total_net_weight,
    sales.total,
    sales.net_total,
    sales.grand_total,
    sales.tax_category
FROM sales
JOIN customer ON sales.customer = customer.customer_id
-- Handling product as JSON in DuckDB
JOIN LATERAL (
    SELECT json_extract(items, '$[0].product_id') AS product_id
    FROM (VALUES (sales.items)) AS items(item)
    WHERE json_extract(item, '$[0].product_id') IS NOT NULL
) AS product ON TRUE
-- Handling sales_team as JSON in DuckDB
JOIN LATERAL (
    SELECT json_extract(sales_team, '$[0].sales_team_id') AS sales_team_id
    FROM (VALUES (sales.sales_team)) AS team(item)
    WHERE json_extract(item, '$[0].sales_team_id') IS NOT NULL
) AS sales_team ON TRUE
JOIN date ON sales.transaction_date = date.date_id
    );
  
  
[0m10:18:23.064474 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_fact"} */

  
    
    

    create  table
      "sales_database"."main"."sales_fact__dbt_tmp"
  
    as (
      WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
),
customer AS (
    SELECT * FROM "sales_database"."main"."customer_dimension"
),
product AS (
    SELECT * FROM "sales_database"."main"."product_dimension"
),
sales_team AS (
    SELECT * FROM "sales_database"."main"."sales_team_dimension"
),
date AS (
    SELECT * FROM "sales_database"."main"."date_dimension"
)

SELECT
    sales.name AS sales_id,
    customer.customer_id,
    product.product_id,
    sales_team.sales_team_id,
    date.date_id,
    sales.total_qty,
    sales.total_net_weight,
    sales.total,
    sales.net_total,
    sales.grand_total,
    sales.tax_category
FROM sales
JOIN customer ON sales.customer = customer.customer_id
-- Handling product as JSON in DuckDB
JOIN LATERAL (
    SELECT json_extract(items, '$[0].product_id') AS product_id
    FROM (VALUES (sales.items)) AS items(item)
    WHERE json_extract(item, '$[0].product_id') IS NOT NULL
) AS product ON TRUE
-- Handling sales_team as JSON in DuckDB
JOIN LATERAL (
    SELECT json_extract(sales_team, '$[0].sales_team_id') AS sales_team_id
    FROM (VALUES (sales.sales_team)) AS team(item)
    WHERE json_extract(item, '$[0].sales_team_id') IS NOT NULL
) AS sales_team ON TRUE
JOIN date ON sales.transaction_date = date.date_id
    );
  
  
[0m10:18:23.066801 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m10:18:23.070049 [debug] [Thread-1 (]: On model.my_dbt_project.sales_fact: ROLLBACK
[0m10:18:23.095470 [debug] [Thread-1 (]: Failed to rollback 'model.my_dbt_project.sales_fact'
[0m10:18:23.097532 [debug] [Thread-1 (]: On model.my_dbt_project.sales_fact: Close
[0m10:18:23.111524 [debug] [Thread-1 (]: Runtime Error in model sales_fact (models/facts/sales_fact.sql)
  Binder Error: Values list "date" does not have a column named "date_id"
  LINE 53: JOIN date ON sales.transaction_date = date.date_id
                                                 ^
[0m10:18:23.113115 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09da20df-be86-4f17-898b-c301483effc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd288ee4b30>]}
[0m10:18:23.115014 [error] [Thread-1 (]: 6 of 6 ERROR creating sql table model main.sales_fact .......................... [[31mERROR[0m in 0.16s]
[0m10:18:23.118045 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.sales_fact
[0m10:18:23.120168 [debug] [Thread-4 (]: Marking all children of 'model.my_dbt_project.sales_fact' to be skipped because of status 'error'.  Reason: Runtime Error in model sales_fact (models/facts/sales_fact.sql)
  Binder Error: Values list "date" does not have a column named "date_id"
  LINE 53: JOIN date ON sales.transaction_date = date.date_id
                                                 ^.
[0m10:18:23.127141 [debug] [MainThread]: Using duckdb connection "master"
[0m10:18:23.128593 [debug] [MainThread]: On master: BEGIN
[0m10:18:23.130142 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:18:23.175546 [debug] [MainThread]: SQL status: OK in 0.045 seconds
[0m10:18:23.179693 [debug] [MainThread]: On master: COMMIT
[0m10:18:23.181907 [debug] [MainThread]: Using duckdb connection "master"
[0m10:18:23.183818 [debug] [MainThread]: On master: COMMIT
[0m10:18:23.187600 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m10:18:23.189441 [debug] [MainThread]: On master: Close
[0m10:18:23.194636 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:18:23.196211 [debug] [MainThread]: Connection 'list_sales_database_main' was properly closed.
[0m10:18:23.197505 [debug] [MainThread]: Connection 'model.my_dbt_project.sales_fact' was properly closed.
[0m10:18:23.198953 [info ] [MainThread]: 
[0m10:18:23.200885 [info ] [MainThread]: Finished running 2 table models, 4 view models in 0 hours 0 minutes and 1.89 seconds (1.89s).
[0m10:18:23.205392 [debug] [MainThread]: Command end result
[0m10:18:23.279701 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m10:18:23.288998 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m10:18:23.308005 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dags/dbt_models/target/run_results.json
[0m10:18:23.309044 [info ] [MainThread]: 
[0m10:18:23.310222 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m10:18:23.311490 [info ] [MainThread]: 
[0m10:18:23.312905 [error] [MainThread]:   Runtime Error in model sales_fact (models/facts/sales_fact.sql)
  Binder Error: Values list "date" does not have a column named "date_id"
  LINE 53: JOIN date ON sales.transaction_date = date.date_id
                                                 ^
[0m10:18:23.314049 [info ] [MainThread]: 
[0m10:18:23.315440 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m10:18:23.318991 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 5.0560746, "process_in_blocks": "158456", "process_kernel_time": 1.146519, "process_mem_max_rss": "160252", "process_out_blocks": "0", "process_user_time": 9.331673}
[0m10:18:23.320337 [debug] [MainThread]: Command `dbt run` failed at 10:18:23.320145 after 5.06 seconds
[0m10:18:23.321454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd291cf79e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd290f1e150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd290f1f0e0>]}
[0m10:18:23.322547 [debug] [MainThread]: Flushing usage events
[0m10:18:24.912674 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:22:32.132515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ffff10290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ffe1e2c30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ffe4163c0>]}


============================== 10:22:32.217483 | 829e25f6-d57c-44f9-a7f5-78ab2888ed62 ==============================
[0m10:22:32.217483 [info ] [MainThread]: Running with dbt=1.9.1
[0m10:22:32.221556 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/profiles.yml', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/dags/dbt_models/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt/profiles.yml --target dev', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:22:36.129056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '829e25f6-d57c-44f9-a7f5-78ab2888ed62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ffdbf62a0>]}
[0m10:22:36.726058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '829e25f6-d57c-44f9-a7f5-78ab2888ed62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ffe1e3500>]}
[0m10:22:36.785284 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m10:22:37.987978 [debug] [MainThread]: checksum: cac3b9519010e47bfbeb71ca6efb4867dae2858687671594dc23fefc94ecf25d, vars: {}, profile: , target: dev, version: 1.9.1
[0m10:22:39.317140 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:22:39.320617 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/dimensions/date_dimension.sql
[0m10:22:40.585504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '829e25f6-d57c-44f9-a7f5-78ab2888ed62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7feb563e00>]}
[0m10:22:41.086361 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m10:22:41.107579 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m10:22:41.303801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '829e25f6-d57c-44f9-a7f5-78ab2888ed62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7feb52d100>]}
[0m10:22:41.313640 [info ] [MainThread]: Found 6 models, 1 source, 424 macros
[0m10:22:41.317343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '829e25f6-d57c-44f9-a7f5-78ab2888ed62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7feb55e900>]}
[0m10:22:41.327350 [info ] [MainThread]: 
[0m10:22:41.331192 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:22:41.333246 [info ] [MainThread]: 
[0m10:22:41.335784 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m10:22:41.364904 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_sales_database'
[0m10:22:41.597801 [debug] [ThreadPool]: Using duckdb connection "list_sales_database"
[0m10:22:41.599976 [debug] [ThreadPool]: On list_sales_database: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "list_sales_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"sales_database"'
    
  
  
[0m10:22:41.602009 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:22:42.092583 [debug] [ThreadPool]: SQL status: OK in 0.490 seconds
[0m10:22:42.099118 [debug] [ThreadPool]: On list_sales_database: Close
[0m10:22:42.111888 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_database, now create_sales_database_main)
[0m10:22:42.116729 [debug] [ThreadPool]: Creating schema "database: "sales_database"
schema: "main"
"
[0m10:22:42.147438 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m10:22:42.149264 [debug] [ThreadPool]: On create_sales_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "create_sales_database_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='sales_database'
        and type='sqlite'
    
  
[0m10:22:42.160148 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:22:42.225246 [debug] [ThreadPool]: SQL status: OK in 0.065 seconds
[0m10:22:42.230029 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m10:22:42.231857 [debug] [ThreadPool]: On create_sales_database_main: BEGIN
[0m10:22:42.234567 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:22:42.236767 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m10:22:42.241362 [debug] [ThreadPool]: On create_sales_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "create_sales_database_main"} */

    
    
        create schema if not exists "sales_database"."main"
    
[0m10:22:42.245382 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m10:22:42.248964 [debug] [ThreadPool]: On create_sales_database_main: COMMIT
[0m10:22:42.251053 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m10:22:42.253187 [debug] [ThreadPool]: On create_sales_database_main: COMMIT
[0m10:22:42.264175 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m10:22:42.267687 [debug] [ThreadPool]: On create_sales_database_main: Close
[0m10:22:42.306840 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_sales_database_main'
[0m10:22:42.342566 [debug] [ThreadPool]: Using duckdb connection "list_sales_database_main"
[0m10:22:42.344909 [debug] [ThreadPool]: On list_sales_database_main: BEGIN
[0m10:22:42.347185 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:22:42.404742 [debug] [ThreadPool]: SQL status: OK in 0.058 seconds
[0m10:22:42.407236 [debug] [ThreadPool]: Using duckdb connection "list_sales_database_main"
[0m10:22:42.409449 [debug] [ThreadPool]: On list_sales_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "list_sales_database_main"} */
select
      'sales_database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'sales_database'
  
[0m10:22:42.569038 [debug] [ThreadPool]: SQL status: OK in 0.157 seconds
[0m10:22:42.574967 [debug] [ThreadPool]: On list_sales_database_main: ROLLBACK
[0m10:22:42.586014 [debug] [ThreadPool]: Failed to rollback 'list_sales_database_main'
[0m10:22:42.587941 [debug] [ThreadPool]: On list_sales_database_main: Close
[0m10:22:42.613292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '829e25f6-d57c-44f9-a7f5-78ab2888ed62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fff1f79b0>]}
[0m10:22:42.615764 [debug] [MainThread]: Using duckdb connection "master"
[0m10:22:42.617580 [debug] [MainThread]: On master: BEGIN
[0m10:22:42.619757 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:22:42.707461 [debug] [MainThread]: SQL status: OK in 0.088 seconds
[0m10:22:42.709321 [debug] [MainThread]: On master: COMMIT
[0m10:22:42.711436 [debug] [MainThread]: Using duckdb connection "master"
[0m10:22:42.713297 [debug] [MainThread]: On master: COMMIT
[0m10:22:42.716341 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m10:22:42.718476 [debug] [MainThread]: On master: Close
[0m10:22:42.738710 [debug] [Thread-1 (]: Began running node model.my_dbt_project.customer_dimension
[0m10:22:42.742255 [info ] [Thread-1 (]: 1 of 6 START sql view model main.customer_dimension ............................ [RUN]
[0m10:22:42.747294 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.my_dbt_project.customer_dimension'
[0m10:22:42.751666 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.customer_dimension
[0m10:22:42.803978 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.customer_dimension"
[0m10:22:42.838347 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.customer_dimension
[0m10:22:42.994375 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.customer_dimension"
[0m10:22:43.059175 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m10:22:43.076127 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: BEGIN
[0m10:22:43.078417 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:22:43.177869 [debug] [Thread-1 (]: SQL status: OK in 0.099 seconds
[0m10:22:43.179888 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m10:22:43.182267 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */

  
  create view "sales_database"."main"."customer_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
    DISTINCT
    customer AS customer_id,
    customer_name,
    customer_address,
    customer_group,
    territory,
    language AS customer_language
FROM sales
WHERE customer IS NOT NULL
  );

[0m10:22:43.205714 [debug] [Thread-1 (]: SQL status: OK in 0.021 seconds
[0m10:22:43.232067 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m10:22:43.234243 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */
alter view "sales_database"."main"."customer_dimension" rename to "customer_dimension__dbt_backup"
[0m10:22:43.269380 [debug] [Thread-1 (]: SQL status: OK in 0.019 seconds
[0m10:22:43.283383 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m10:22:43.285922 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */
alter view "sales_database"."main"."customer_dimension__dbt_tmp" rename to "customer_dimension"
[0m10:22:43.291607 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:22:43.342710 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: COMMIT
[0m10:22:43.344648 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m10:22:43.347303 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: COMMIT
[0m10:22:43.363692 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m10:22:43.383374 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m10:22:43.385417 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */
drop view if exists "sales_database"."main"."customer_dimension__dbt_backup" cascade
[0m10:22:43.393894 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m10:22:43.417740 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: Close
[0m10:22:43.516383 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '829e25f6-d57c-44f9-a7f5-78ab2888ed62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ffff63d70>]}
[0m10:22:43.519065 [info ] [Thread-1 (]: 1 of 6 OK created sql view model main.customer_dimension ....................... [[32mOK[0m in 0.76s]
[0m10:22:43.528992 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.customer_dimension
[0m10:22:43.531268 [debug] [Thread-1 (]: Began running node model.my_dbt_project.date_dimension
[0m10:22:43.533443 [info ] [Thread-1 (]: 2 of 6 START sql view model main.date_dimension ................................ [RUN]
[0m10:22:43.545853 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customer_dimension, now model.my_dbt_project.date_dimension)
[0m10:22:43.547811 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.date_dimension
[0m10:22:43.559154 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.date_dimension"
[0m10:22:43.588703 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.date_dimension
[0m10:22:43.617337 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.date_dimension"
[0m10:22:43.646396 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m10:22:43.650281 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: BEGIN
[0m10:22:43.652843 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:22:43.716716 [debug] [Thread-1 (]: SQL status: OK in 0.063 seconds
[0m10:22:43.719654 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m10:22:43.722941 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.date_dimension"} */

  
  create view "sales_database"."main"."date_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)
SELECT
    transaction_date,
    strftime(transaction_date, '%Y%m%d') AS date_id,  -- Generate a date_id in the format YYYYMMDD
    strftime(transaction_date, '%A') AS weekday_name,
    strftime(transaction_date, '%m') AS month,
    strftime(transaction_date, '%Y') AS year,
    strftime(transaction_date, '%d') AS day,
    EXTRACT(QUARTER FROM transaction_date) AS quarter
FROM sales
WHERE transaction_date IS NOT NULL;
  );

[0m10:22:43.784464 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.date_dimension"} */

  
  create view "sales_database"."main"."date_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)
SELECT
    transaction_date,
    strftime(transaction_date, '%Y%m%d') AS date_id,  -- Generate a date_id in the format YYYYMMDD
    strftime(transaction_date, '%A') AS weekday_name,
    strftime(transaction_date, '%m') AS month,
    strftime(transaction_date, '%Y') AS year,
    strftime(transaction_date, '%d') AS day,
    EXTRACT(QUARTER FROM transaction_date) AS quarter
FROM sales
WHERE transaction_date IS NOT NULL;
  );

[0m10:22:43.787505 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m10:22:43.790317 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: ROLLBACK
[0m10:22:43.863603 [debug] [Thread-1 (]: Failed to rollback 'model.my_dbt_project.date_dimension'
[0m10:22:43.867077 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: Close
[0m10:22:43.881442 [debug] [Thread-1 (]: Runtime Error in model date_dimension (models/dimensions/date_dimension.sql)
  Parser Error: syntax error at or near ";"
[0m10:22:43.883799 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '829e25f6-d57c-44f9-a7f5-78ab2888ed62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fe8382210>]}
[0m10:22:43.886609 [error] [Thread-1 (]: 2 of 6 ERROR creating sql view model main.date_dimension ....................... [[31mERROR[0m in 0.34s]
[0m10:22:43.891095 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.date_dimension
[0m10:22:43.896242 [debug] [Thread-1 (]: Began running node model.my_dbt_project.product_dimension
[0m10:22:43.898390 [debug] [Thread-4 (]: Marking all children of 'model.my_dbt_project.date_dimension' to be skipped because of status 'error'.  Reason: Runtime Error in model date_dimension (models/dimensions/date_dimension.sql)
  Parser Error: syntax error at or near ";".
[0m10:22:43.901240 [info ] [Thread-1 (]: 3 of 6 START sql view model main.product_dimension ............................. [RUN]
[0m10:22:43.910941 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.date_dimension, now model.my_dbt_project.product_dimension)
[0m10:22:43.912777 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.product_dimension
[0m10:22:43.927888 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.product_dimension"
[0m10:22:43.956395 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.product_dimension
[0m10:22:43.973427 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.product_dimension"
[0m10:22:44.071940 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m10:22:44.085745 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: BEGIN
[0m10:22:44.105848 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:22:44.209346 [debug] [Thread-1 (]: SQL status: OK in 0.104 seconds
[0m10:22:44.220094 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m10:22:44.222654 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.product_dimension"} */

  
  create view "sales_database"."main"."product_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * 
    FROM "sales_database"."main"."sales"
)

SELECT 
    sales.name,
    json_extract(items, '$[0].name') AS product_name,  -- Example to extract the first element's "name" field from JSON array
    json_extract(items, '$[0].item_code') AS product_item_code
FROM sales
WHERE json_extract(items, '$[0].name') IS NOT NULL  -- Filter to only keep rows with a non-null product name
  );

[0m10:22:44.241755 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m10:22:44.271869 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m10:22:44.279854 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.product_dimension"} */
alter view "sales_database"."main"."product_dimension" rename to "product_dimension__dbt_backup"
[0m10:22:44.285593 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:22:44.331531 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m10:22:44.379311 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.product_dimension"} */
alter view "sales_database"."main"."product_dimension__dbt_tmp" rename to "product_dimension"
[0m10:22:44.398940 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:22:44.421250 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: COMMIT
[0m10:22:44.429441 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m10:22:44.435930 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: COMMIT
[0m10:22:44.518613 [debug] [Thread-1 (]: SQL status: OK in 0.079 seconds
[0m10:22:44.591536 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m10:22:44.623473 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.product_dimension"} */
drop view if exists "sales_database"."main"."product_dimension__dbt_backup" cascade
[0m10:22:44.678047 [debug] [Thread-1 (]: SQL status: OK in 0.039 seconds
[0m10:22:44.711342 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: Close
[0m10:22:44.875763 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '829e25f6-d57c-44f9-a7f5-78ab2888ed62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fe838e1b0>]}
[0m10:22:44.878635 [info ] [Thread-1 (]: 3 of 6 OK created sql view model main.product_dimension ........................ [[32mOK[0m in 0.96s]
[0m10:22:44.881546 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.product_dimension
[0m10:22:44.883381 [debug] [Thread-1 (]: Began running node model.my_dbt_project.sales_team_dimension
[0m10:22:44.888481 [info ] [Thread-1 (]: 4 of 6 START sql view model main.sales_team_dimension .......................... [RUN]
[0m10:22:44.896967 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.product_dimension, now model.my_dbt_project.sales_team_dimension)
[0m10:22:44.899592 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.sales_team_dimension
[0m10:22:44.928965 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.sales_team_dimension"
[0m10:22:45.046200 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.sales_team_dimension
[0m10:22:45.077654 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.sales_team_dimension"
[0m10:22:45.205379 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m10:22:45.211160 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: BEGIN
[0m10:22:45.235604 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:22:45.350672 [debug] [Thread-1 (]: SQL status: OK in 0.116 seconds
[0m10:22:45.355700 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m10:22:45.364458 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */

  
  create view "sales_database"."main"."sales_team_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
    DISTINCT
    sales_team->>'name' AS sales_team_id,
    sales_team->>'region' AS sales_team_region
FROM sales
WHERE sales_team IS NOT NULL
  );

[0m10:22:45.378329 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m10:22:45.390917 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m10:22:45.402963 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */
alter view "sales_database"."main"."sales_team_dimension" rename to "sales_team_dimension__dbt_backup"
[0m10:22:45.408175 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:22:45.422794 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m10:22:45.425716 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */
alter view "sales_database"."main"."sales_team_dimension__dbt_tmp" rename to "sales_team_dimension"
[0m10:22:45.431035 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:22:45.440204 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: COMMIT
[0m10:22:45.445274 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m10:22:45.449693 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: COMMIT
[0m10:22:45.466864 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m10:22:45.476507 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m10:22:45.488967 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */
drop view if exists "sales_database"."main"."sales_team_dimension__dbt_backup" cascade
[0m10:22:45.507740 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m10:22:45.523474 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: Close
[0m10:22:45.668947 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '829e25f6-d57c-44f9-a7f5-78ab2888ed62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fea919490>]}
[0m10:22:45.678945 [info ] [Thread-1 (]: 4 of 6 OK created sql view model main.sales_team_dimension ..................... [[32mOK[0m in 0.77s]
[0m10:22:45.686441 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.sales_team_dimension
[0m10:22:45.691693 [debug] [Thread-1 (]: Began running node model.my_dbt_project.transform_sales
[0m10:22:45.701324 [info ] [Thread-1 (]: 5 of 6 START sql table model main.transform_sales .............................. [RUN]
[0m10:22:45.707067 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.sales_team_dimension, now model.my_dbt_project.transform_sales)
[0m10:22:45.709380 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.transform_sales
[0m10:22:45.730819 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.transform_sales"
[0m10:22:45.763249 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.transform_sales
[0m10:22:45.899829 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.transform_sales"
[0m10:22:45.965051 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m10:22:45.967290 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: BEGIN
[0m10:22:45.969291 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:22:46.037773 [debug] [Thread-1 (]: SQL status: OK in 0.068 seconds
[0m10:22:46.040285 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m10:22:46.042576 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */

  
    
    

    create  table
      "sales_database"."main"."transform_sales__dbt_tmp"
  
    as (
      -- /opt/airflow/dags/dbt_models/transform_users.sql


WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
   *
FROM sales
WHERE name = 'ABC private LTD-0002'
    );
  
  
[0m10:22:46.166421 [debug] [Thread-1 (]: SQL status: OK in 0.119 seconds
[0m10:22:46.182703 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m10:22:46.185057 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */
alter table "sales_database"."main"."transform_sales" rename to "transform_sales__dbt_backup"
[0m10:22:46.205804 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m10:22:46.231660 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m10:22:46.234586 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */
alter table "sales_database"."main"."transform_sales__dbt_tmp" rename to "transform_sales"
[0m10:22:46.237974 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:22:46.274307 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: COMMIT
[0m10:22:46.279627 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m10:22:46.283251 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: COMMIT
[0m10:22:46.305939 [debug] [Thread-1 (]: SQL status: OK in 0.020 seconds
[0m10:22:46.327945 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m10:22:46.333415 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */
drop table if exists "sales_database"."main"."transform_sales__dbt_backup" cascade
[0m10:22:46.349476 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m10:22:46.357732 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: Close
[0m10:22:46.620921 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '829e25f6-d57c-44f9-a7f5-78ab2888ed62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fe840d280>]}
[0m10:22:46.636692 [info ] [Thread-1 (]: 5 of 6 OK created sql table model main.transform_sales ......................... [[32mOK[0m in 0.91s]
[0m10:22:46.648436 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.transform_sales
[0m10:22:46.656813 [debug] [Thread-1 (]: Began running node model.my_dbt_project.sales_fact
[0m10:22:46.671456 [info ] [Thread-1 (]: 6 of 6 SKIP relation main.sales_fact ........................................... [[33mSKIP[0m]
[0m10:22:46.681176 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.sales_fact
[0m10:22:46.691338 [debug] [MainThread]: Using duckdb connection "master"
[0m10:22:46.693302 [debug] [MainThread]: On master: BEGIN
[0m10:22:46.696285 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:22:46.827958 [debug] [MainThread]: SQL status: OK in 0.132 seconds
[0m10:22:46.837458 [debug] [MainThread]: On master: COMMIT
[0m10:22:46.839949 [debug] [MainThread]: Using duckdb connection "master"
[0m10:22:46.845516 [debug] [MainThread]: On master: COMMIT
[0m10:22:46.848022 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m10:22:46.849769 [debug] [MainThread]: On master: Close
[0m10:22:46.857581 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:22:46.859443 [debug] [MainThread]: Connection 'create_sales_database_main' was properly closed.
[0m10:22:46.863857 [debug] [MainThread]: Connection 'list_sales_database_main' was properly closed.
[0m10:22:46.867560 [debug] [MainThread]: Connection 'model.my_dbt_project.transform_sales' was properly closed.
[0m10:22:46.870564 [info ] [MainThread]: 
[0m10:22:46.873062 [info ] [MainThread]: Finished running 2 table models, 4 view models in 0 hours 0 minutes and 5.53 seconds (5.53s).
[0m10:22:46.882232 [debug] [MainThread]: Command end result
[0m10:22:47.639363 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m10:22:47.748461 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m10:22:47.835971 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dags/dbt_models/target/run_results.json
[0m10:22:47.839306 [info ] [MainThread]: 
[0m10:22:47.841564 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m10:22:47.848960 [info ] [MainThread]: 
[0m10:22:47.861965 [error] [MainThread]:   Runtime Error in model date_dimension (models/dimensions/date_dimension.sql)
  Parser Error: syntax error at or near ";"
[0m10:22:47.867184 [info ] [MainThread]: 
[0m10:22:47.880175 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=1 TOTAL=6
[0m10:22:47.895901 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 16.418581, "process_in_blocks": "1539848", "process_kernel_time": 7.930307, "process_mem_max_rss": "130452", "process_out_blocks": "0", "process_user_time": 14.194752}
[0m10:22:47.901465 [debug] [MainThread]: Command `dbt run` failed at 10:22:47.901112 after 16.43 seconds
[0m10:22:47.904078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ffff10290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80002708f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7feb55c9e0>]}
[0m10:22:47.906819 [debug] [MainThread]: Flushing usage events
[0m10:22:49.965812 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:24:27.449634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3cd5295e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3cd57b5b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3cd57b5550>]}


============================== 10:24:27.542947 | 6212fa99-9521-49e5-be87-c560300db297 ==============================
[0m10:24:27.542947 [info ] [MainThread]: Running with dbt=1.9.1
[0m10:24:27.552856 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/profiles.yml', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dags/dbt_models/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt/profiles.yml --target dev', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:24:30.358329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6212fa99-9521-49e5-be87-c560300db297', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3cd4b3dfd0>]}
[0m10:24:30.715943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6212fa99-9521-49e5-be87-c560300db297', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3cd50de000>]}
[0m10:24:30.736009 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m10:24:31.694690 [debug] [MainThread]: checksum: cac3b9519010e47bfbeb71ca6efb4867dae2858687671594dc23fefc94ecf25d, vars: {}, profile: , target: dev, version: 1.9.1
[0m10:24:32.921116 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:24:32.933032 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/dimensions/date_dimension.sql
[0m10:24:34.267344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6212fa99-9521-49e5-be87-c560300db297', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3cce367950>]}
[0m10:24:35.056313 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m10:24:35.092420 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m10:24:35.298632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6212fa99-9521-49e5-be87-c560300db297', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ccee58080>]}
[0m10:24:35.300678 [info ] [MainThread]: Found 6 models, 1 source, 424 macros
[0m10:24:35.307207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6212fa99-9521-49e5-be87-c560300db297', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3cd4a448c0>]}
[0m10:24:35.315607 [info ] [MainThread]: 
[0m10:24:35.319300 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:24:35.325279 [info ] [MainThread]: 
[0m10:24:35.327448 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m10:24:35.348048 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_sales_database'
[0m10:24:35.613337 [debug] [ThreadPool]: Using duckdb connection "list_sales_database"
[0m10:24:35.616355 [debug] [ThreadPool]: On list_sales_database: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "list_sales_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"sales_database"'
    
  
  
[0m10:24:35.618765 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:24:36.124089 [debug] [ThreadPool]: SQL status: OK in 0.499 seconds
[0m10:24:36.131128 [debug] [ThreadPool]: On list_sales_database: Close
[0m10:24:36.154559 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_database, now create_sales_database_main)
[0m10:24:36.158050 [debug] [ThreadPool]: Creating schema "database: "sales_database"
schema: "main"
"
[0m10:24:36.194928 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m10:24:36.196866 [debug] [ThreadPool]: On create_sales_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "create_sales_database_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='sales_database'
        and type='sqlite'
    
  
[0m10:24:36.199226 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:24:36.318879 [debug] [ThreadPool]: SQL status: OK in 0.120 seconds
[0m10:24:36.328235 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m10:24:36.330247 [debug] [ThreadPool]: On create_sales_database_main: BEGIN
[0m10:24:36.332674 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:24:36.334568 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m10:24:36.337019 [debug] [ThreadPool]: On create_sales_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "create_sales_database_main"} */

    
    
        create schema if not exists "sales_database"."main"
    
[0m10:24:36.342896 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m10:24:36.348327 [debug] [ThreadPool]: On create_sales_database_main: COMMIT
[0m10:24:36.350874 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m10:24:36.352646 [debug] [ThreadPool]: On create_sales_database_main: COMMIT
[0m10:24:36.358022 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:24:36.360348 [debug] [ThreadPool]: On create_sales_database_main: Close
[0m10:24:36.369965 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_sales_database_main'
[0m10:24:36.403885 [debug] [ThreadPool]: Using duckdb connection "list_sales_database_main"
[0m10:24:36.408227 [debug] [ThreadPool]: On list_sales_database_main: BEGIN
[0m10:24:36.411361 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:24:36.478843 [debug] [ThreadPool]: SQL status: OK in 0.068 seconds
[0m10:24:36.480558 [debug] [ThreadPool]: Using duckdb connection "list_sales_database_main"
[0m10:24:36.490415 [debug] [ThreadPool]: On list_sales_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "list_sales_database_main"} */
select
      'sales_database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'sales_database'
  
[0m10:24:36.766628 [debug] [ThreadPool]: SQL status: OK in 0.273 seconds
[0m10:24:36.773913 [debug] [ThreadPool]: On list_sales_database_main: ROLLBACK
[0m10:24:36.794587 [debug] [ThreadPool]: Failed to rollback 'list_sales_database_main'
[0m10:24:36.796353 [debug] [ThreadPool]: On list_sales_database_main: Close
[0m10:24:36.818910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6212fa99-9521-49e5-be87-c560300db297', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3cd60f4ec0>]}
[0m10:24:36.820765 [debug] [MainThread]: Using duckdb connection "master"
[0m10:24:36.824109 [debug] [MainThread]: On master: BEGIN
[0m10:24:36.825758 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:24:36.915264 [debug] [MainThread]: SQL status: OK in 0.090 seconds
[0m10:24:36.918656 [debug] [MainThread]: On master: COMMIT
[0m10:24:36.920770 [debug] [MainThread]: Using duckdb connection "master"
[0m10:24:36.925152 [debug] [MainThread]: On master: COMMIT
[0m10:24:36.927776 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m10:24:36.930517 [debug] [MainThread]: On master: Close
[0m10:24:36.997897 [debug] [Thread-1 (]: Began running node model.my_dbt_project.customer_dimension
[0m10:24:37.012633 [info ] [Thread-1 (]: 1 of 6 START sql view model main.customer_dimension ............................ [RUN]
[0m10:24:37.016492 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.my_dbt_project.customer_dimension'
[0m10:24:37.018993 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.customer_dimension
[0m10:24:37.082998 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.customer_dimension"
[0m10:24:37.128983 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.customer_dimension
[0m10:24:37.304044 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.customer_dimension"
[0m10:24:37.332581 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m10:24:37.334522 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: BEGIN
[0m10:24:37.336733 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:24:37.396613 [debug] [Thread-1 (]: SQL status: OK in 0.060 seconds
[0m10:24:37.402319 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m10:24:37.409357 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */

  
  create view "sales_database"."main"."customer_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
    DISTINCT
    customer AS customer_id,
    customer_name,
    customer_address,
    customer_group,
    territory,
    language AS customer_language
FROM sales
WHERE customer IS NOT NULL
  );

[0m10:24:37.425469 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m10:24:37.474554 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m10:24:37.478228 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */
alter view "sales_database"."main"."customer_dimension" rename to "customer_dimension__dbt_backup"
[0m10:24:37.487741 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m10:24:37.519340 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m10:24:37.524463 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */
alter view "sales_database"."main"."customer_dimension__dbt_tmp" rename to "customer_dimension"
[0m10:24:37.529527 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:24:37.592138 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: COMMIT
[0m10:24:37.594381 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m10:24:37.596215 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: COMMIT
[0m10:24:37.610191 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m10:24:37.630941 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m10:24:37.633134 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */
drop view if exists "sales_database"."main"."customer_dimension__dbt_backup" cascade
[0m10:24:37.641478 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m10:24:37.646777 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: Close
[0m10:24:37.728301 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6212fa99-9521-49e5-be87-c560300db297', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ccd7a3dd0>]}
[0m10:24:37.730828 [info ] [Thread-1 (]: 1 of 6 OK created sql view model main.customer_dimension ....................... [[32mOK[0m in 0.70s]
[0m10:24:37.734149 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.customer_dimension
[0m10:24:37.736465 [debug] [Thread-1 (]: Began running node model.my_dbt_project.date_dimension
[0m10:24:37.759155 [info ] [Thread-1 (]: 2 of 6 START sql view model main.date_dimension ................................ [RUN]
[0m10:24:37.766714 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customer_dimension, now model.my_dbt_project.date_dimension)
[0m10:24:37.769507 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.date_dimension
[0m10:24:37.792826 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.date_dimension"
[0m10:24:37.962943 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.date_dimension
[0m10:24:37.994598 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.date_dimension"
[0m10:24:38.025597 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m10:24:38.036390 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: BEGIN
[0m10:24:38.049615 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:24:38.213672 [debug] [Thread-1 (]: SQL status: OK in 0.165 seconds
[0m10:24:38.215709 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m10:24:38.218161 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.date_dimension"} */

  
  create view "sales_database"."main"."date_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)
SELECT
    transaction_date,
    strftime(transaction_date, '%Y%m%d') AS date_id,  -- Generate a date_id in the format YYYYMMDD
    strftime(transaction_date, '%A') AS weekday_name,
    strftime(transaction_date, '%m') AS month,
    strftime(transaction_date, '%Y') AS year,
    strftime(transaction_date, '%d') AS day,
    EXTRACT(QUARTER FROM transaction_date) AS quarter
FROM sales
WHERE transaction_date IS NOT NULL
  );

[0m10:24:38.227900 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m10:24:38.242420 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m10:24:38.244766 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.date_dimension"} */
alter view "sales_database"."main"."date_dimension" rename to "date_dimension__dbt_backup"
[0m10:24:38.247455 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:24:38.254446 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m10:24:38.257888 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.date_dimension"} */
alter view "sales_database"."main"."date_dimension__dbt_tmp" rename to "date_dimension"
[0m10:24:38.260760 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:24:38.264990 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: COMMIT
[0m10:24:38.266387 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m10:24:38.267645 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: COMMIT
[0m10:24:38.279626 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m10:24:38.285787 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m10:24:38.287168 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.date_dimension"} */
drop view if exists "sales_database"."main"."date_dimension__dbt_backup" cascade
[0m10:24:38.292628 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m10:24:38.295426 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: Close
[0m10:24:38.351034 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6212fa99-9521-49e5-be87-c560300db297', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ccc413f80>]}
[0m10:24:38.352852 [info ] [Thread-1 (]: 2 of 6 OK created sql view model main.date_dimension ........................... [[32mOK[0m in 0.58s]
[0m10:24:38.354553 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.date_dimension
[0m10:24:38.356681 [debug] [Thread-1 (]: Began running node model.my_dbt_project.product_dimension
[0m10:24:38.358178 [info ] [Thread-1 (]: 3 of 6 START sql view model main.product_dimension ............................. [RUN]
[0m10:24:38.359592 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.date_dimension, now model.my_dbt_project.product_dimension)
[0m10:24:38.360943 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.product_dimension
[0m10:24:38.366190 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.product_dimension"
[0m10:24:38.379264 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.product_dimension
[0m10:24:38.386455 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.product_dimension"
[0m10:24:38.399358 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m10:24:38.400741 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: BEGIN
[0m10:24:38.401779 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:24:38.424380 [debug] [Thread-1 (]: SQL status: OK in 0.023 seconds
[0m10:24:38.425522 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m10:24:38.426623 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.product_dimension"} */

  
  create view "sales_database"."main"."product_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * 
    FROM "sales_database"."main"."sales"
)

SELECT 
    sales.name,
    json_extract(items, '$[0].name') AS product_name,  -- Example to extract the first element's "name" field from JSON array
    json_extract(items, '$[0].item_code') AS product_item_code
FROM sales
WHERE json_extract(items, '$[0].name') IS NOT NULL  -- Filter to only keep rows with a non-null product name
  );

[0m10:24:38.429172 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:24:38.435322 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m10:24:38.436521 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.product_dimension"} */
alter view "sales_database"."main"."product_dimension" rename to "product_dimension__dbt_backup"
[0m10:24:38.438571 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:24:38.444892 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m10:24:38.446082 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.product_dimension"} */
alter view "sales_database"."main"."product_dimension__dbt_tmp" rename to "product_dimension"
[0m10:24:38.448223 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:24:38.451737 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: COMMIT
[0m10:24:38.453024 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m10:24:38.454256 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: COMMIT
[0m10:24:38.463003 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m10:24:38.468400 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m10:24:38.469640 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.product_dimension"} */
drop view if exists "sales_database"."main"."product_dimension__dbt_backup" cascade
[0m10:24:38.474777 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m10:24:38.477644 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: Close
[0m10:24:38.516890 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6212fa99-9521-49e5-be87-c560300db297', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ccd7c4110>]}
[0m10:24:38.519013 [info ] [Thread-1 (]: 3 of 6 OK created sql view model main.product_dimension ........................ [[32mOK[0m in 0.16s]
[0m10:24:38.522821 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.product_dimension
[0m10:24:38.524570 [debug] [Thread-1 (]: Began running node model.my_dbt_project.sales_team_dimension
[0m10:24:38.526518 [info ] [Thread-1 (]: 4 of 6 START sql view model main.sales_team_dimension .......................... [RUN]
[0m10:24:38.527933 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.product_dimension, now model.my_dbt_project.sales_team_dimension)
[0m10:24:38.529461 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.sales_team_dimension
[0m10:24:38.537037 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.sales_team_dimension"
[0m10:24:38.553138 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.sales_team_dimension
[0m10:24:38.563744 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.sales_team_dimension"
[0m10:24:38.581193 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m10:24:38.582834 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: BEGIN
[0m10:24:38.584289 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:24:38.610633 [debug] [Thread-1 (]: SQL status: OK in 0.026 seconds
[0m10:24:38.611897 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m10:24:38.613113 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */

  
  create view "sales_database"."main"."sales_team_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
    DISTINCT
    sales_team->>'name' AS sales_team_id,
    sales_team->>'region' AS sales_team_region
FROM sales
WHERE sales_team IS NOT NULL
  );

[0m10:24:38.615789 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:24:38.622206 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m10:24:38.623875 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */
alter view "sales_database"."main"."sales_team_dimension" rename to "sales_team_dimension__dbt_backup"
[0m10:24:38.625741 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:24:38.635582 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m10:24:38.637283 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */
alter view "sales_database"."main"."sales_team_dimension__dbt_tmp" rename to "sales_team_dimension"
[0m10:24:38.640660 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:24:38.645262 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: COMMIT
[0m10:24:38.646776 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m10:24:38.648201 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: COMMIT
[0m10:24:38.656223 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m10:24:38.661507 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m10:24:38.662685 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */
drop view if exists "sales_database"."main"."sales_team_dimension__dbt_backup" cascade
[0m10:24:38.666820 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m10:24:38.669672 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: Close
[0m10:24:38.708464 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6212fa99-9521-49e5-be87-c560300db297', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ccc43b0e0>]}
[0m10:24:38.710180 [info ] [Thread-1 (]: 4 of 6 OK created sql view model main.sales_team_dimension ..................... [[32mOK[0m in 0.18s]
[0m10:24:38.711938 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.sales_team_dimension
[0m10:24:38.713136 [debug] [Thread-1 (]: Began running node model.my_dbt_project.transform_sales
[0m10:24:38.714797 [info ] [Thread-1 (]: 5 of 6 START sql table model main.transform_sales .............................. [RUN]
[0m10:24:38.716334 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.sales_team_dimension, now model.my_dbt_project.transform_sales)
[0m10:24:38.717785 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.transform_sales
[0m10:24:38.725972 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.transform_sales"
[0m10:24:38.742677 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.transform_sales
[0m10:24:38.797956 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.transform_sales"
[0m10:24:38.813364 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m10:24:38.814961 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: BEGIN
[0m10:24:38.816500 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:24:38.843989 [debug] [Thread-1 (]: SQL status: OK in 0.027 seconds
[0m10:24:38.845315 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m10:24:38.846625 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */

  
    
    

    create  table
      "sales_database"."main"."transform_sales__dbt_tmp"
  
    as (
      -- /opt/airflow/dags/dbt_models/transform_users.sql


WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
   *
FROM sales
WHERE name = 'ABC private LTD-0002'
    );
  
  
[0m10:24:38.869955 [debug] [Thread-1 (]: SQL status: OK in 0.022 seconds
[0m10:24:38.877065 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m10:24:38.878435 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */
alter table "sales_database"."main"."transform_sales" rename to "transform_sales__dbt_backup"
[0m10:24:38.880618 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:24:38.887114 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m10:24:38.890070 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */
alter table "sales_database"."main"."transform_sales__dbt_tmp" rename to "transform_sales"
[0m10:24:38.892451 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:24:38.902773 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: COMMIT
[0m10:24:38.904407 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m10:24:38.906302 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: COMMIT
[0m10:24:38.921175 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m10:24:38.927245 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m10:24:38.928688 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */
drop table if exists "sales_database"."main"."transform_sales__dbt_backup" cascade
[0m10:24:38.935092 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m10:24:38.938147 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: Close
[0m10:24:39.023076 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6212fa99-9521-49e5-be87-c560300db297', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ccd86d340>]}
[0m10:24:39.024960 [info ] [Thread-1 (]: 5 of 6 OK created sql table model main.transform_sales ......................... [[32mOK[0m in 0.31s]
[0m10:24:39.026818 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.transform_sales
[0m10:24:39.028334 [debug] [Thread-1 (]: Began running node model.my_dbt_project.sales_fact
[0m10:24:39.029916 [info ] [Thread-1 (]: 6 of 6 START sql table model main.sales_fact ................................... [RUN]
[0m10:24:39.031613 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.transform_sales, now model.my_dbt_project.sales_fact)
[0m10:24:39.033011 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.sales_fact
[0m10:24:39.041464 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.sales_fact"
[0m10:24:39.060277 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.sales_fact
[0m10:24:39.067442 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.sales_fact"
[0m10:24:39.087471 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_fact"
[0m10:24:39.089984 [debug] [Thread-1 (]: On model.my_dbt_project.sales_fact: BEGIN
[0m10:24:39.091610 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:24:39.127060 [debug] [Thread-1 (]: SQL status: OK in 0.035 seconds
[0m10:24:39.128475 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_fact"
[0m10:24:39.129978 [debug] [Thread-1 (]: On model.my_dbt_project.sales_fact: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_fact"} */

  
    
    

    create  table
      "sales_database"."main"."sales_fact__dbt_tmp"
  
    as (
      WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
),
customer AS (
    SELECT * FROM "sales_database"."main"."customer_dimension"
),
product AS (
    SELECT * FROM "sales_database"."main"."product_dimension"
),
sales_team AS (
    SELECT * FROM "sales_database"."main"."sales_team_dimension"
),
date AS (
    SELECT * FROM "sales_database"."main"."date_dimension"
)

SELECT
    sales.name AS sales_id,
    customer.customer_id,
    product.product_id,
    sales_team.sales_team_id,
    date.date_id,
    sales.total_qty,
    sales.total_net_weight,
    sales.total,
    sales.net_total,
    sales.grand_total,
    sales.tax_category
FROM sales
JOIN customer ON sales.customer = customer.customer_id
-- Handling product as JSON in DuckDB
JOIN LATERAL (
    SELECT json_extract(items, '$[0].product_id') AS product_id
    FROM (VALUES (sales.items)) AS items(item)
    WHERE json_extract(item, '$[0].product_id') IS NOT NULL
) AS product ON TRUE
-- Handling sales_team as JSON in DuckDB
JOIN LATERAL (
    SELECT json_extract(sales_team, '$[0].sales_team_id') AS sales_team_id
    FROM (VALUES (sales.sales_team)) AS team(item)
    WHERE json_extract(item, '$[0].sales_team_id') IS NOT NULL
) AS sales_team ON TRUE
JOIN date ON sales.transaction_date = date.date_id
    );
  
  
[0m10:24:39.185984 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_fact"} */

  
    
    

    create  table
      "sales_database"."main"."sales_fact__dbt_tmp"
  
    as (
      WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
),
customer AS (
    SELECT * FROM "sales_database"."main"."customer_dimension"
),
product AS (
    SELECT * FROM "sales_database"."main"."product_dimension"
),
sales_team AS (
    SELECT * FROM "sales_database"."main"."sales_team_dimension"
),
date AS (
    SELECT * FROM "sales_database"."main"."date_dimension"
)

SELECT
    sales.name AS sales_id,
    customer.customer_id,
    product.product_id,
    sales_team.sales_team_id,
    date.date_id,
    sales.total_qty,
    sales.total_net_weight,
    sales.total,
    sales.net_total,
    sales.grand_total,
    sales.tax_category
FROM sales
JOIN customer ON sales.customer = customer.customer_id
-- Handling product as JSON in DuckDB
JOIN LATERAL (
    SELECT json_extract(items, '$[0].product_id') AS product_id
    FROM (VALUES (sales.items)) AS items(item)
    WHERE json_extract(item, '$[0].product_id') IS NOT NULL
) AS product ON TRUE
-- Handling sales_team as JSON in DuckDB
JOIN LATERAL (
    SELECT json_extract(sales_team, '$[0].sales_team_id') AS sales_team_id
    FROM (VALUES (sales.sales_team)) AS team(item)
    WHERE json_extract(item, '$[0].sales_team_id') IS NOT NULL
) AS sales_team ON TRUE
JOIN date ON sales.transaction_date = date.date_id
    );
  
  
[0m10:24:39.188343 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m10:24:39.191654 [debug] [Thread-1 (]: On model.my_dbt_project.sales_fact: ROLLBACK
[0m10:24:39.218230 [debug] [Thread-1 (]: Failed to rollback 'model.my_dbt_project.sales_fact'
[0m10:24:39.220460 [debug] [Thread-1 (]: On model.my_dbt_project.sales_fact: Close
[0m10:24:39.242484 [debug] [Thread-1 (]: Runtime Error in model sales_fact (models/facts/sales_fact.sql)
  Conversion Error: date field value out of range: "20241217", expected format is (YYYY-MM-DD)
  LINE 53: JOIN date ON sales.transaction_date = date.date_id
                                                 ^
[0m10:24:39.248201 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6212fa99-9521-49e5-be87-c560300db297', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ccd79a0c0>]}
[0m10:24:39.251147 [error] [Thread-1 (]: 6 of 6 ERROR creating sql table model main.sales_fact .......................... [[31mERROR[0m in 0.22s]
[0m10:24:39.254172 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.sales_fact
[0m10:24:39.258032 [debug] [Thread-4 (]: Marking all children of 'model.my_dbt_project.sales_fact' to be skipped because of status 'error'.  Reason: Runtime Error in model sales_fact (models/facts/sales_fact.sql)
  Conversion Error: date field value out of range: "20241217", expected format is (YYYY-MM-DD)
  LINE 53: JOIN date ON sales.transaction_date = date.date_id
                                                 ^.
[0m10:24:39.264459 [debug] [MainThread]: Using duckdb connection "master"
[0m10:24:39.266006 [debug] [MainThread]: On master: BEGIN
[0m10:24:39.268083 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:24:39.344091 [debug] [MainThread]: SQL status: OK in 0.076 seconds
[0m10:24:39.357044 [debug] [MainThread]: On master: COMMIT
[0m10:24:39.359182 [debug] [MainThread]: Using duckdb connection "master"
[0m10:24:39.361562 [debug] [MainThread]: On master: COMMIT
[0m10:24:39.364044 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m10:24:39.366731 [debug] [MainThread]: On master: Close
[0m10:24:39.376740 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:24:39.378437 [debug] [MainThread]: Connection 'create_sales_database_main' was properly closed.
[0m10:24:39.380768 [debug] [MainThread]: Connection 'list_sales_database_main' was properly closed.
[0m10:24:39.383423 [debug] [MainThread]: Connection 'model.my_dbt_project.sales_fact' was properly closed.
[0m10:24:39.385656 [info ] [MainThread]: 
[0m10:24:39.387590 [info ] [MainThread]: Finished running 2 table models, 4 view models in 0 hours 0 minutes and 4.06 seconds (4.06s).
[0m10:24:39.393506 [debug] [MainThread]: Command end result
[0m10:24:39.480126 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m10:24:39.491041 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m10:24:39.510768 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dags/dbt_models/target/run_results.json
[0m10:24:39.511825 [info ] [MainThread]: 
[0m10:24:39.513050 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m10:24:39.514230 [info ] [MainThread]: 
[0m10:24:39.515601 [error] [MainThread]:   Runtime Error in model sales_fact (models/facts/sales_fact.sql)
  Conversion Error: date field value out of range: "20241217", expected format is (YYYY-MM-DD)
  LINE 53: JOIN date ON sales.transaction_date = date.date_id
                                                 ^
[0m10:24:39.516837 [info ] [MainThread]: 
[0m10:24:39.518531 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m10:24:39.523790 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 13.196491, "process_in_blocks": "1483752", "process_kernel_time": 6.386782, "process_mem_max_rss": "137100", "process_out_blocks": "0", "process_user_time": 12.985174}
[0m10:24:39.528645 [debug] [MainThread]: Command `dbt run` failed at 10:24:39.528401 after 13.20 seconds
[0m10:24:39.529750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3cd884f620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3cd4b44650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3cce333530>]}
[0m10:24:39.530849 [debug] [MainThread]: Flushing usage events
[0m10:24:41.133990 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:28:50.806950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90335c4aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90336b61e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f903332d730>]}


============================== 10:28:50.828482 | 9e1c407c-12af-471d-b657-c097448f07fd ==============================
[0m10:28:50.828482 [info ] [MainThread]: Running with dbt=1.9.1
[0m10:28:50.832412 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt/profiles.yml', 'log_path': '/opt/airflow/dags/dbt_models/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt/profiles.yml --target dev', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:28:52.192660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9e1c407c-12af-471d-b657-c097448f07fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9032dd4dd0>]}
[0m10:28:52.342206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9e1c407c-12af-471d-b657-c097448f07fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9033647020>]}
[0m10:28:52.355839 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m10:28:52.663813 [debug] [MainThread]: checksum: cac3b9519010e47bfbeb71ca6efb4867dae2858687671594dc23fefc94ecf25d, vars: {}, profile: , target: dev, version: 1.9.1
[0m10:28:53.228420 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:28:53.230481 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/dimensions/date_dimension.sql
[0m10:28:53.852648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9e1c407c-12af-471d-b657-c097448f07fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f902c763920>]}
[0m10:28:54.123601 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m10:28:54.134588 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m10:28:54.222138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9e1c407c-12af-471d-b657-c097448f07fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f902d25dac0>]}
[0m10:28:54.223683 [info ] [MainThread]: Found 6 models, 1 source, 424 macros
[0m10:28:54.225014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9e1c407c-12af-471d-b657-c097448f07fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f902d751430>]}
[0m10:28:54.228692 [info ] [MainThread]: 
[0m10:28:54.230056 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:28:54.232815 [info ] [MainThread]: 
[0m10:28:54.234761 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m10:28:54.244831 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_sales_database'
[0m10:28:54.339010 [debug] [ThreadPool]: Using duckdb connection "list_sales_database"
[0m10:28:54.340250 [debug] [ThreadPool]: On list_sales_database: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "list_sales_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"sales_database"'
    
  
  
[0m10:28:54.341354 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:28:54.388966 [debug] [ThreadPool]: SQL status: OK in 0.048 seconds
[0m10:28:54.391747 [debug] [ThreadPool]: On list_sales_database: Close
[0m10:28:54.397833 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_database, now create_sales_database_main)
[0m10:28:54.400757 [debug] [ThreadPool]: Creating schema "database: "sales_database"
schema: "main"
"
[0m10:28:54.412919 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m10:28:54.414163 [debug] [ThreadPool]: On create_sales_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "create_sales_database_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='sales_database'
        and type='sqlite'
    
  
[0m10:28:54.416099 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:28:54.452562 [debug] [ThreadPool]: SQL status: OK in 0.036 seconds
[0m10:28:54.455560 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m10:28:54.457179 [debug] [ThreadPool]: On create_sales_database_main: BEGIN
[0m10:28:54.459155 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:28:54.460523 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m10:28:54.461918 [debug] [ThreadPool]: On create_sales_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "create_sales_database_main"} */

    
    
        create schema if not exists "sales_database"."main"
    
[0m10:28:54.465492 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m10:28:54.468163 [debug] [ThreadPool]: On create_sales_database_main: COMMIT
[0m10:28:54.469400 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m10:28:54.470663 [debug] [ThreadPool]: On create_sales_database_main: COMMIT
[0m10:28:54.472731 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:28:54.474047 [debug] [ThreadPool]: On create_sales_database_main: Close
[0m10:28:54.481675 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_sales_database_main, now list_sales_database_main)
[0m10:28:54.492590 [debug] [ThreadPool]: Using duckdb connection "list_sales_database_main"
[0m10:28:54.493921 [debug] [ThreadPool]: On list_sales_database_main: BEGIN
[0m10:28:54.495153 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:28:54.540174 [debug] [ThreadPool]: SQL status: OK in 0.045 seconds
[0m10:28:54.541670 [debug] [ThreadPool]: Using duckdb connection "list_sales_database_main"
[0m10:28:54.542982 [debug] [ThreadPool]: On list_sales_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "list_sales_database_main"} */
select
      'sales_database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'sales_database'
  
[0m10:28:54.593309 [debug] [ThreadPool]: SQL status: OK in 0.049 seconds
[0m10:28:54.596707 [debug] [ThreadPool]: On list_sales_database_main: ROLLBACK
[0m10:28:54.601160 [debug] [ThreadPool]: Failed to rollback 'list_sales_database_main'
[0m10:28:54.602635 [debug] [ThreadPool]: On list_sales_database_main: Close
[0m10:28:54.611605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9e1c407c-12af-471d-b657-c097448f07fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9034e7ac60>]}
[0m10:28:54.613111 [debug] [MainThread]: Using duckdb connection "master"
[0m10:28:54.614426 [debug] [MainThread]: On master: BEGIN
[0m10:28:54.616640 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:28:54.650986 [debug] [MainThread]: SQL status: OK in 0.034 seconds
[0m10:28:54.652231 [debug] [MainThread]: On master: COMMIT
[0m10:28:54.653393 [debug] [MainThread]: Using duckdb connection "master"
[0m10:28:54.654507 [debug] [MainThread]: On master: COMMIT
[0m10:28:54.656482 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m10:28:54.657708 [debug] [MainThread]: On master: Close
[0m10:28:54.665886 [debug] [Thread-1 (]: Began running node model.my_dbt_project.customer_dimension
[0m10:28:54.667610 [info ] [Thread-1 (]: 1 of 6 START sql view model main.customer_dimension ............................ [RUN]
[0m10:28:54.669243 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.my_dbt_project.customer_dimension'
[0m10:28:54.670515 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.customer_dimension
[0m10:28:54.685093 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.customer_dimension"
[0m10:28:54.703447 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.customer_dimension
[0m10:28:54.782972 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.customer_dimension"
[0m10:28:54.800713 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m10:28:54.802043 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: BEGIN
[0m10:28:54.803268 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:28:54.842871 [debug] [Thread-1 (]: SQL status: OK in 0.039 seconds
[0m10:28:54.845040 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m10:28:54.846937 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */

  
  create view "sales_database"."main"."customer_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
    DISTINCT
    customer AS customer_id,
    customer_name,
    customer_address,
    customer_group,
    territory,
    language AS customer_language
FROM sales
WHERE customer IS NOT NULL
  );

[0m10:28:54.856495 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:28:54.877178 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m10:28:54.879720 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */
alter view "sales_database"."main"."customer_dimension" rename to "customer_dimension__dbt_backup"
[0m10:28:54.885589 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:28:54.896245 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m10:28:54.899901 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */
alter view "sales_database"."main"."customer_dimension__dbt_tmp" rename to "customer_dimension"
[0m10:28:54.902671 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:28:54.960467 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: COMMIT
[0m10:28:54.962092 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m10:28:54.963997 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: COMMIT
[0m10:28:54.976765 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m10:28:54.992260 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m10:28:54.994105 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */
drop view if exists "sales_database"."main"."customer_dimension__dbt_backup" cascade
[0m10:28:55.001955 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m10:28:55.008839 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: Close
[0m10:28:55.069166 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e1c407c-12af-471d-b657-c097448f07fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f902c3bfb90>]}
[0m10:28:55.071021 [info ] [Thread-1 (]: 1 of 6 OK created sql view model main.customer_dimension ....................... [[32mOK[0m in 0.40s]
[0m10:28:55.073185 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.customer_dimension
[0m10:28:55.074905 [debug] [Thread-1 (]: Began running node model.my_dbt_project.date_dimension
[0m10:28:55.077820 [info ] [Thread-1 (]: 2 of 6 START sql view model main.date_dimension ................................ [RUN]
[0m10:28:55.080461 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customer_dimension, now model.my_dbt_project.date_dimension)
[0m10:28:55.084117 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.date_dimension
[0m10:28:55.094772 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.date_dimension"
[0m10:28:55.114177 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.date_dimension
[0m10:28:55.130101 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.date_dimension"
[0m10:28:55.147472 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m10:28:55.149435 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: BEGIN
[0m10:28:55.150781 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:28:55.176507 [debug] [Thread-1 (]: SQL status: OK in 0.026 seconds
[0m10:28:55.177781 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m10:28:55.179075 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.date_dimension"} */

  
  create view "sales_database"."main"."date_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)
SELECT
    transaction_date,
    strftime(transaction_date, '%Y-%m-%d') AS date_id,  -- Change the format to YYYY-MM-DD
    strftime(transaction_date, '%A') AS weekday_name,
    strftime(transaction_date, '%m') AS month,
    strftime(transaction_date, '%Y') AS year,
    strftime(transaction_date, '%d') AS day,
    EXTRACT(QUARTER FROM transaction_date) AS quarter
FROM sales
WHERE transaction_date IS NOT NULL
  );

[0m10:28:55.182934 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:28:55.190949 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m10:28:55.192534 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.date_dimension"} */
alter view "sales_database"."main"."date_dimension" rename to "date_dimension__dbt_backup"
[0m10:28:55.194791 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:28:55.202021 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m10:28:55.203322 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.date_dimension"} */
alter view "sales_database"."main"."date_dimension__dbt_tmp" rename to "date_dimension"
[0m10:28:55.205439 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:28:55.208962 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: COMMIT
[0m10:28:55.210088 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m10:28:55.211108 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: COMMIT
[0m10:28:55.220343 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m10:28:55.225760 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m10:28:55.227084 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.date_dimension"} */
drop view if exists "sales_database"."main"."date_dimension__dbt_backup" cascade
[0m10:28:55.230997 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m10:28:55.235902 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: Close
[0m10:28:55.281151 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e1c407c-12af-471d-b657-c097448f07fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f902c3bf9e0>]}
[0m10:28:55.284017 [info ] [Thread-1 (]: 2 of 6 OK created sql view model main.date_dimension ........................... [[32mOK[0m in 0.20s]
[0m10:28:55.286017 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.date_dimension
[0m10:28:55.287388 [debug] [Thread-1 (]: Began running node model.my_dbt_project.product_dimension
[0m10:28:55.288842 [info ] [Thread-1 (]: 3 of 6 START sql view model main.product_dimension ............................. [RUN]
[0m10:28:55.290381 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.date_dimension, now model.my_dbt_project.product_dimension)
[0m10:28:55.291693 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.product_dimension
[0m10:28:55.297464 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.product_dimension"
[0m10:28:55.311900 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.product_dimension
[0m10:28:55.324434 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.product_dimension"
[0m10:28:55.343904 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m10:28:55.345927 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: BEGIN
[0m10:28:55.347240 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:28:55.381052 [debug] [Thread-1 (]: SQL status: OK in 0.034 seconds
[0m10:28:55.383361 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m10:28:55.385089 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.product_dimension"} */

  
  create view "sales_database"."main"."product_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * 
    FROM "sales_database"."main"."sales"
)

SELECT 
    sales.name,
    json_extract(items, '$[0].name') AS product_name,  -- Example to extract the first element's "name" field from JSON array
    json_extract(items, '$[0].item_code') AS product_item_code
FROM sales
WHERE json_extract(items, '$[0].name') IS NOT NULL  -- Filter to only keep rows with a non-null product name
  );

[0m10:28:55.388944 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:28:55.395656 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m10:28:55.396931 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.product_dimension"} */
alter view "sales_database"."main"."product_dimension" rename to "product_dimension__dbt_backup"
[0m10:28:55.399656 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:28:55.413663 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m10:28:55.419380 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.product_dimension"} */
alter view "sales_database"."main"."product_dimension__dbt_tmp" rename to "product_dimension"
[0m10:28:55.426331 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:28:55.439183 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: COMMIT
[0m10:28:55.441111 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m10:28:55.445691 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: COMMIT
[0m10:28:55.457163 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m10:28:55.462764 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m10:28:55.464128 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.product_dimension"} */
drop view if exists "sales_database"."main"."product_dimension__dbt_backup" cascade
[0m10:28:55.469518 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m10:28:55.475981 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: Close
[0m10:28:55.527970 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e1c407c-12af-471d-b657-c097448f07fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f902c30eea0>]}
[0m10:28:55.529767 [info ] [Thread-1 (]: 3 of 6 OK created sql view model main.product_dimension ........................ [[32mOK[0m in 0.24s]
[0m10:28:55.533238 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.product_dimension
[0m10:28:55.535154 [debug] [Thread-1 (]: Began running node model.my_dbt_project.sales_team_dimension
[0m10:28:55.537905 [info ] [Thread-1 (]: 4 of 6 START sql view model main.sales_team_dimension .......................... [RUN]
[0m10:28:55.541635 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.product_dimension, now model.my_dbt_project.sales_team_dimension)
[0m10:28:55.544125 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.sales_team_dimension
[0m10:28:55.561860 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.sales_team_dimension"
[0m10:28:55.594023 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.sales_team_dimension
[0m10:28:55.604738 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.sales_team_dimension"
[0m10:28:55.619751 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m10:28:55.621076 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: BEGIN
[0m10:28:55.622309 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:28:55.651792 [debug] [Thread-1 (]: SQL status: OK in 0.029 seconds
[0m10:28:55.653452 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m10:28:55.655177 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */

  
  create view "sales_database"."main"."sales_team_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
    DISTINCT
    sales_team->>'name' AS sales_team_id,
    sales_team->>'region' AS sales_team_region
FROM sales
WHERE sales_team IS NOT NULL
  );

[0m10:28:55.660301 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m10:28:55.669194 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m10:28:55.670620 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */
alter view "sales_database"."main"."sales_team_dimension" rename to "sales_team_dimension__dbt_backup"
[0m10:28:55.673600 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:28:55.683393 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m10:28:55.684866 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */
alter view "sales_database"."main"."sales_team_dimension__dbt_tmp" rename to "sales_team_dimension"
[0m10:28:55.686837 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:28:55.690935 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: COMMIT
[0m10:28:55.692174 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m10:28:55.693339 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: COMMIT
[0m10:28:55.703356 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m10:28:55.708885 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m10:28:55.710191 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */
drop view if exists "sales_database"."main"."sales_team_dimension__dbt_backup" cascade
[0m10:28:55.715216 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m10:28:55.718902 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: Close
[0m10:28:55.774328 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e1c407c-12af-471d-b657-c097448f07fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90104afd70>]}
[0m10:28:55.776742 [info ] [Thread-1 (]: 4 of 6 OK created sql view model main.sales_team_dimension ..................... [[32mOK[0m in 0.23s]
[0m10:28:55.778812 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.sales_team_dimension
[0m10:28:55.780562 [debug] [Thread-1 (]: Began running node model.my_dbt_project.transform_sales
[0m10:28:55.783665 [info ] [Thread-1 (]: 5 of 6 START sql table model main.transform_sales .............................. [RUN]
[0m10:28:55.786131 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.sales_team_dimension, now model.my_dbt_project.transform_sales)
[0m10:28:55.787552 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.transform_sales
[0m10:28:55.793950 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.transform_sales"
[0m10:28:55.809174 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.transform_sales
[0m10:28:55.855442 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.transform_sales"
[0m10:28:55.866019 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m10:28:55.867306 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: BEGIN
[0m10:28:55.868269 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:28:55.890235 [debug] [Thread-1 (]: SQL status: OK in 0.022 seconds
[0m10:28:55.891505 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m10:28:55.892602 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */

  
    
    

    create  table
      "sales_database"."main"."transform_sales__dbt_tmp"
  
    as (
      -- /opt/airflow/dags/dbt_models/transform_users.sql


WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
   *
FROM sales
WHERE name = 'ABC private LTD-0002'
    );
  
  
[0m10:28:55.908723 [debug] [Thread-1 (]: SQL status: OK in 0.015 seconds
[0m10:28:55.914122 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m10:28:55.915852 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */
alter table "sales_database"."main"."transform_sales" rename to "transform_sales__dbt_backup"
[0m10:28:55.918579 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:28:55.924255 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m10:28:55.925471 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */
alter table "sales_database"."main"."transform_sales__dbt_tmp" rename to "transform_sales"
[0m10:28:55.927366 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:28:55.938046 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: COMMIT
[0m10:28:55.939305 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m10:28:55.940372 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: COMMIT
[0m10:28:55.948654 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m10:28:55.954202 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m10:28:55.955550 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */
drop table if exists "sales_database"."main"."transform_sales__dbt_backup" cascade
[0m10:28:55.960684 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m10:28:55.963365 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: Close
[0m10:28:56.044708 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e1c407c-12af-471d-b657-c097448f07fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f902c763f50>]}
[0m10:28:56.046655 [info ] [Thread-1 (]: 5 of 6 OK created sql table model main.transform_sales ......................... [[32mOK[0m in 0.26s]
[0m10:28:56.048771 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.transform_sales
[0m10:28:56.050655 [debug] [Thread-1 (]: Began running node model.my_dbt_project.sales_fact
[0m10:28:56.052050 [info ] [Thread-1 (]: 6 of 6 START sql table model main.sales_fact ................................... [RUN]
[0m10:28:56.053467 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.transform_sales, now model.my_dbt_project.sales_fact)
[0m10:28:56.054780 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.sales_fact
[0m10:28:56.061964 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.sales_fact"
[0m10:28:56.076535 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.sales_fact
[0m10:28:56.084216 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.sales_fact"
[0m10:28:56.103827 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_fact"
[0m10:28:56.106178 [debug] [Thread-1 (]: On model.my_dbt_project.sales_fact: BEGIN
[0m10:28:56.108253 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:28:56.146786 [debug] [Thread-1 (]: SQL status: OK in 0.039 seconds
[0m10:28:56.148490 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_fact"
[0m10:28:56.151178 [debug] [Thread-1 (]: On model.my_dbt_project.sales_fact: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_fact"} */

  
    
    

    create  table
      "sales_database"."main"."sales_fact__dbt_tmp"
  
    as (
      WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
),
customer AS (
    SELECT * FROM "sales_database"."main"."customer_dimension"
),
product AS (
    SELECT * FROM "sales_database"."main"."product_dimension"
),
sales_team AS (
    SELECT * FROM "sales_database"."main"."sales_team_dimension"
),
date AS (
    SELECT * FROM "sales_database"."main"."date_dimension"
)

SELECT
    sales.name AS sales_id,
    customer.customer_id,
    product.product_id,
    sales_team.sales_team_id,
    date.date_id,
    sales.total_qty,
    sales.total_net_weight,
    sales.total,
    sales.net_total,
    sales.grand_total,
    sales.tax_category
FROM sales
JOIN customer ON sales.customer = customer.customer_id
-- Handling product as JSON in DuckDB
JOIN LATERAL (
    SELECT json_extract(items, '$[0].product_id') AS product_id
    FROM (VALUES (sales.items)) AS items(item)
    WHERE json_extract(item, '$[0].product_id') IS NOT NULL
) AS product ON TRUE
-- Handling sales_team as JSON in DuckDB
JOIN LATERAL (
    SELECT json_extract(sales_team, '$[0].sales_team_id') AS sales_team_id
    FROM (VALUES (sales.sales_team)) AS team(item)
    WHERE json_extract(item, '$[0].sales_team_id') IS NOT NULL
) AS sales_team ON TRUE
JOIN date ON sales.transaction_date = date.date_id
    );
  
  
[0m10:28:56.193850 [debug] [Thread-1 (]: SQL status: OK in 0.041 seconds
[0m10:28:56.205239 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_fact"
[0m10:28:56.207745 [debug] [Thread-1 (]: On model.my_dbt_project.sales_fact: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_fact"} */
alter table "sales_database"."main"."sales_fact" rename to "sales_fact__dbt_backup"
[0m10:28:56.210285 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:28:56.220568 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_fact"
[0m10:28:56.222042 [debug] [Thread-1 (]: On model.my_dbt_project.sales_fact: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_fact"} */
alter table "sales_database"."main"."sales_fact__dbt_tmp" rename to "sales_fact"
[0m10:28:56.224801 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:28:56.229813 [debug] [Thread-1 (]: On model.my_dbt_project.sales_fact: COMMIT
[0m10:28:56.231197 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_fact"
[0m10:28:56.235855 [debug] [Thread-1 (]: On model.my_dbt_project.sales_fact: COMMIT
[0m10:28:56.263976 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m10:28:56.278406 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_fact"
[0m10:28:56.280337 [debug] [Thread-1 (]: On model.my_dbt_project.sales_fact: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_fact"} */
drop table if exists "sales_database"."main"."sales_fact__dbt_backup" cascade
[0m10:28:56.287599 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m10:28:56.290573 [debug] [Thread-1 (]: On model.my_dbt_project.sales_fact: Close
[0m10:28:56.326761 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e1c407c-12af-471d-b657-c097448f07fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90104a4350>]}
[0m10:28:56.328738 [info ] [Thread-1 (]: 6 of 6 OK created sql table model main.sales_fact .............................. [[32mOK[0m in 0.27s]
[0m10:28:56.331008 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.sales_fact
[0m10:28:56.336216 [debug] [MainThread]: Using duckdb connection "master"
[0m10:28:56.337502 [debug] [MainThread]: On master: BEGIN
[0m10:28:56.339006 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:28:56.365670 [debug] [MainThread]: SQL status: OK in 0.027 seconds
[0m10:28:56.367465 [debug] [MainThread]: On master: COMMIT
[0m10:28:56.368545 [debug] [MainThread]: Using duckdb connection "master"
[0m10:28:56.369520 [debug] [MainThread]: On master: COMMIT
[0m10:28:56.371148 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m10:28:56.372261 [debug] [MainThread]: On master: Close
[0m10:28:56.376302 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:28:56.377357 [debug] [MainThread]: Connection 'list_sales_database_main' was properly closed.
[0m10:28:56.379412 [debug] [MainThread]: Connection 'model.my_dbt_project.sales_fact' was properly closed.
[0m10:28:56.380584 [info ] [MainThread]: 
[0m10:28:56.383144 [info ] [MainThread]: Finished running 2 table models, 4 view models in 0 hours 0 minutes and 2.15 seconds (2.15s).
[0m10:28:56.386340 [debug] [MainThread]: Command end result
[0m10:28:56.477032 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m10:28:56.489177 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m10:28:56.517050 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dags/dbt_models/target/run_results.json
[0m10:28:56.518091 [info ] [MainThread]: 
[0m10:28:56.519312 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:28:56.520574 [info ] [MainThread]: 
[0m10:28:56.521938 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m10:28:56.525054 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.0976386, "process_in_blocks": "172888", "process_kernel_time": 1.8116, "process_mem_max_rss": "161404", "process_out_blocks": "0", "process_user_time": 11.354675}
[0m10:28:56.526386 [debug] [MainThread]: Command `dbt run` succeeded at 10:28:56.526186 after 6.10 seconds
[0m10:28:56.527501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9032efbcb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f902d1f2330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90333e96d0>]}
[0m10:28:56.528563 [debug] [MainThread]: Flushing usage events
[0m10:28:58.169050 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:30:39.861291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1bb935c590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1bb8c36d80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1bbb180590>]}


============================== 10:30:39.882408 | abcd913c-c84b-4eff-a7fa-186a4baf2bfe ==============================
[0m10:30:39.882408 [info ] [MainThread]: Running with dbt=1.9.1
[0m10:30:39.884317 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/profiles.yml', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dags/dbt_models/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt/profiles.yml --target dev', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:30:40.714479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'abcd913c-c84b-4eff-a7fa-186a4baf2bfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1bb8aeb800>]}
[0m10:30:40.845021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'abcd913c-c84b-4eff-a7fa-186a4baf2bfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1bb93a66f0>]}
[0m10:30:40.855342 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m10:30:41.135759 [debug] [MainThread]: checksum: cac3b9519010e47bfbeb71ca6efb4867dae2858687671594dc23fefc94ecf25d, vars: {}, profile: , target: dev, version: 1.9.1
[0m10:30:41.713304 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:30:41.714647 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:30:41.780928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'abcd913c-c84b-4eff-a7fa-186a4baf2bfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1bb54721b0>]}
[0m10:30:41.980494 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m10:30:41.994652 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m10:30:42.094978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'abcd913c-c84b-4eff-a7fa-186a4baf2bfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1bb2d03530>]}
[0m10:30:42.096441 [info ] [MainThread]: Found 6 models, 1 source, 424 macros
[0m10:30:42.097857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'abcd913c-c84b-4eff-a7fa-186a4baf2bfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1bb5557dd0>]}
[0m10:30:42.101708 [info ] [MainThread]: 
[0m10:30:42.103057 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:30:42.104373 [info ] [MainThread]: 
[0m10:30:42.106092 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m10:30:42.115275 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_sales_database'
[0m10:30:42.234587 [debug] [ThreadPool]: Using duckdb connection "list_sales_database"
[0m10:30:42.236033 [debug] [ThreadPool]: On list_sales_database: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "list_sales_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"sales_database"'
    
  
  
[0m10:30:42.237441 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:30:42.294398 [debug] [ThreadPool]: SQL status: OK in 0.057 seconds
[0m10:30:42.297229 [debug] [ThreadPool]: On list_sales_database: Close
[0m10:30:42.304982 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_database, now create_sales_database_main)
[0m10:30:42.308830 [debug] [ThreadPool]: Creating schema "database: "sales_database"
schema: "main"
"
[0m10:30:42.321536 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m10:30:42.322990 [debug] [ThreadPool]: On create_sales_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "create_sales_database_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='sales_database'
        and type='sqlite'
    
  
[0m10:30:42.325818 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:30:42.356639 [debug] [ThreadPool]: SQL status: OK in 0.031 seconds
[0m10:30:42.360028 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m10:30:42.361572 [debug] [ThreadPool]: On create_sales_database_main: BEGIN
[0m10:30:42.363571 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:30:42.364957 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m10:30:42.366202 [debug] [ThreadPool]: On create_sales_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "create_sales_database_main"} */

    
    
        create schema if not exists "sales_database"."main"
    
[0m10:30:42.369424 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m10:30:42.371681 [debug] [ThreadPool]: On create_sales_database_main: COMMIT
[0m10:30:42.373005 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m10:30:42.374933 [debug] [ThreadPool]: On create_sales_database_main: COMMIT
[0m10:30:42.376909 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:30:42.378281 [debug] [ThreadPool]: On create_sales_database_main: Close
[0m10:30:42.385871 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_sales_database_main, now list_sales_database_main)
[0m10:30:42.396712 [debug] [ThreadPool]: Using duckdb connection "list_sales_database_main"
[0m10:30:42.398063 [debug] [ThreadPool]: On list_sales_database_main: BEGIN
[0m10:30:42.399273 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:30:42.426614 [debug] [ThreadPool]: SQL status: OK in 0.027 seconds
[0m10:30:42.427901 [debug] [ThreadPool]: Using duckdb connection "list_sales_database_main"
[0m10:30:42.429121 [debug] [ThreadPool]: On list_sales_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "list_sales_database_main"} */
select
      'sales_database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'sales_database'
  
[0m10:30:42.476358 [debug] [ThreadPool]: SQL status: OK in 0.046 seconds
[0m10:30:42.479308 [debug] [ThreadPool]: On list_sales_database_main: ROLLBACK
[0m10:30:42.483316 [debug] [ThreadPool]: Failed to rollback 'list_sales_database_main'
[0m10:30:42.484677 [debug] [ThreadPool]: On list_sales_database_main: Close
[0m10:30:42.492835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'abcd913c-c84b-4eff-a7fa-186a4baf2bfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1bb8b1e270>]}
[0m10:30:42.494307 [debug] [MainThread]: Using duckdb connection "master"
[0m10:30:42.495541 [debug] [MainThread]: On master: BEGIN
[0m10:30:42.496880 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:30:42.524893 [debug] [MainThread]: SQL status: OK in 0.028 seconds
[0m10:30:42.526414 [debug] [MainThread]: On master: COMMIT
[0m10:30:42.527755 [debug] [MainThread]: Using duckdb connection "master"
[0m10:30:42.529253 [debug] [MainThread]: On master: COMMIT
[0m10:30:42.531438 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m10:30:42.532733 [debug] [MainThread]: On master: Close
[0m10:30:42.541489 [debug] [Thread-1 (]: Began running node model.my_dbt_project.customer_dimension
[0m10:30:42.543579 [info ] [Thread-1 (]: 1 of 6 START sql view model main.customer_dimension ............................ [RUN]
[0m10:30:42.545392 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.my_dbt_project.customer_dimension'
[0m10:30:42.546690 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.customer_dimension
[0m10:30:42.561600 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.customer_dimension"
[0m10:30:42.579083 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.customer_dimension
[0m10:30:42.653044 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.customer_dimension"
[0m10:30:42.670501 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m10:30:42.672182 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: BEGIN
[0m10:30:42.674973 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:30:42.706672 [debug] [Thread-1 (]: SQL status: OK in 0.032 seconds
[0m10:30:42.708546 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m10:30:42.709883 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */

  
  create view "sales_database"."main"."customer_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
    DISTINCT
    customer AS customer_id,
    customer_name,
    customer_address,
    customer_group,
    territory,
    language AS customer_language
FROM sales
WHERE customer IS NOT NULL
  );

[0m10:30:42.712854 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:30:42.732128 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m10:30:42.733524 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */
alter view "sales_database"."main"."customer_dimension__dbt_tmp" rename to "customer_dimension"
[0m10:30:42.735925 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:30:42.760707 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: COMMIT
[0m10:30:42.762713 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m10:30:42.764073 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: COMMIT
[0m10:30:42.772325 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m10:30:42.784662 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m10:30:42.786158 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */
drop view if exists "sales_database"."main"."customer_dimension__dbt_backup" cascade
[0m10:30:42.788437 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:30:42.794916 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: Close
[0m10:30:42.844028 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'abcd913c-c84b-4eff-a7fa-186a4baf2bfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1bbae6e0f0>]}
[0m10:30:42.845748 [info ] [Thread-1 (]: 1 of 6 OK created sql view model main.customer_dimension ....................... [[32mOK[0m in 0.30s]
[0m10:30:42.847610 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.customer_dimension
[0m10:30:42.848839 [debug] [Thread-1 (]: Began running node model.my_dbt_project.date_dimension
[0m10:30:42.850175 [info ] [Thread-1 (]: 2 of 6 START sql view model main.date_dimension ................................ [RUN]
[0m10:30:42.851700 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customer_dimension, now model.my_dbt_project.date_dimension)
[0m10:30:42.852856 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.date_dimension
[0m10:30:42.860283 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.date_dimension"
[0m10:30:42.875061 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.date_dimension
[0m10:30:42.882927 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.date_dimension"
[0m10:30:42.897420 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m10:30:42.898634 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: BEGIN
[0m10:30:42.899947 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:30:42.941531 [debug] [Thread-1 (]: SQL status: OK in 0.041 seconds
[0m10:30:42.943481 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m10:30:42.945026 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.date_dimension"} */

  
  create view "sales_database"."main"."date_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)
SELECT
    transaction_date,
    strftime(transaction_date, '%Y-%m-%d') AS date_id,  -- Change the format to YYYY-MM-DD
    strftime(transaction_date, '%A') AS weekday_name,
    strftime(transaction_date, '%m') AS month,
    strftime(transaction_date, '%Y') AS year,
    strftime(transaction_date, '%d') AS day,
    EXTRACT(QUARTER FROM transaction_date) AS quarter
FROM sales
WHERE transaction_date IS NOT NULL
  );

[0m10:30:42.948593 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:30:42.957918 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m10:30:42.960049 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.date_dimension"} */
alter view "sales_database"."main"."date_dimension__dbt_tmp" rename to "date_dimension"
[0m10:30:42.962564 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:30:42.967343 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: COMMIT
[0m10:30:42.969037 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m10:30:42.970204 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: COMMIT
[0m10:30:42.979954 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m10:30:42.985032 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m10:30:42.986276 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.date_dimension"} */
drop view if exists "sales_database"."main"."date_dimension__dbt_backup" cascade
[0m10:30:42.988120 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:30:42.992741 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: Close
[0m10:30:43.026904 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'abcd913c-c84b-4eff-a7fa-186a4baf2bfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1bb23785f0>]}
[0m10:30:43.028492 [info ] [Thread-1 (]: 2 of 6 OK created sql view model main.date_dimension ........................... [[32mOK[0m in 0.18s]
[0m10:30:43.030225 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.date_dimension
[0m10:30:43.031503 [debug] [Thread-1 (]: Began running node model.my_dbt_project.product_dimension
[0m10:30:43.032873 [info ] [Thread-1 (]: 3 of 6 START sql view model main.product_dimension ............................. [RUN]
[0m10:30:43.034303 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.date_dimension, now model.my_dbt_project.product_dimension)
[0m10:30:43.035363 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.product_dimension
[0m10:30:43.043153 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.product_dimension"
[0m10:30:43.055627 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.product_dimension
[0m10:30:43.065834 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.product_dimension"
[0m10:30:43.079064 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m10:30:43.080290 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: BEGIN
[0m10:30:43.081468 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:30:43.104197 [debug] [Thread-1 (]: SQL status: OK in 0.023 seconds
[0m10:30:43.105422 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m10:30:43.106946 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.product_dimension"} */

  
  create view "sales_database"."main"."product_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * 
    FROM "sales_database"."main"."sales"
)

SELECT 
    sales.name,
    json_extract(items, '$[0].name') AS product_name,  -- Example to extract the first element's "name" field from JSON array
    json_extract(items, '$[0].item_code') AS product_item_code
FROM sales
WHERE json_extract(items, '$[0].name') IS NOT NULL  -- Filter to only keep rows with a non-null product name
  );

[0m10:30:43.110295 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:30:43.118467 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m10:30:43.119985 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.product_dimension"} */
alter view "sales_database"."main"."product_dimension__dbt_tmp" rename to "product_dimension"
[0m10:30:43.122123 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:30:43.126906 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: COMMIT
[0m10:30:43.128374 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m10:30:43.129718 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: COMMIT
[0m10:30:43.138020 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m10:30:43.143757 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m10:30:43.144974 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.product_dimension"} */
drop view if exists "sales_database"."main"."product_dimension__dbt_backup" cascade
[0m10:30:43.146943 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:30:43.149963 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: Close
[0m10:30:43.183615 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'abcd913c-c84b-4eff-a7fa-186a4baf2bfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1bb216d760>]}
[0m10:30:43.185251 [info ] [Thread-1 (]: 3 of 6 OK created sql view model main.product_dimension ........................ [[32mOK[0m in 0.15s]
[0m10:30:43.186983 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.product_dimension
[0m10:30:43.188291 [debug] [Thread-1 (]: Began running node model.my_dbt_project.sales_team_dimension
[0m10:30:43.189661 [info ] [Thread-1 (]: 4 of 6 START sql view model main.sales_team_dimension .......................... [RUN]
[0m10:30:43.192251 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.product_dimension, now model.my_dbt_project.sales_team_dimension)
[0m10:30:43.193448 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.sales_team_dimension
[0m10:30:43.198376 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.sales_team_dimension"
[0m10:30:43.213000 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.sales_team_dimension
[0m10:30:43.221758 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.sales_team_dimension"
[0m10:30:43.235111 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m10:30:43.236230 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: BEGIN
[0m10:30:43.237303 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:30:43.262055 [debug] [Thread-1 (]: SQL status: OK in 0.025 seconds
[0m10:30:43.263556 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m10:30:43.264868 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */

  
  create view "sales_database"."main"."sales_team_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
    DISTINCT
    sales_team->>'name' AS sales_team_id,
    sales_team->>'region' AS sales_team_region
FROM sales
WHERE sales_team IS NOT NULL
  );

[0m10:30:43.267734 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:30:43.275229 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m10:30:43.276928 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */
alter view "sales_database"."main"."sales_team_dimension__dbt_tmp" rename to "sales_team_dimension"
[0m10:30:43.278921 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:30:43.282322 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: COMMIT
[0m10:30:43.283749 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m10:30:43.285087 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: COMMIT
[0m10:30:43.294680 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m10:30:43.299846 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m10:30:43.301194 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */
drop view if exists "sales_database"."main"."sales_team_dimension__dbt_backup" cascade
[0m10:30:43.303446 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:30:43.308339 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: Close
[0m10:30:43.353159 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'abcd913c-c84b-4eff-a7fa-186a4baf2bfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1bb21748f0>]}
[0m10:30:43.355112 [info ] [Thread-1 (]: 4 of 6 OK created sql view model main.sales_team_dimension ..................... [[32mOK[0m in 0.16s]
[0m10:30:43.359598 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.sales_team_dimension
[0m10:30:43.361502 [debug] [Thread-1 (]: Began running node model.my_dbt_project.transform_sales
[0m10:30:43.363778 [info ] [Thread-1 (]: 5 of 6 START sql table model main.transform_sales .............................. [RUN]
[0m10:30:43.370081 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.sales_team_dimension, now model.my_dbt_project.transform_sales)
[0m10:30:43.371655 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.transform_sales
[0m10:30:43.379759 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.transform_sales"
[0m10:30:43.395672 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.transform_sales
[0m10:30:43.438289 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.transform_sales"
[0m10:30:43.449394 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m10:30:43.451153 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: BEGIN
[0m10:30:43.452608 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:30:43.481150 [debug] [Thread-1 (]: SQL status: OK in 0.029 seconds
[0m10:30:43.482380 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m10:30:43.483977 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */

  
    
    

    create  table
      "sales_database"."main"."transform_sales__dbt_tmp"
  
    as (
      -- /opt/airflow/dags/dbt_models/transform_users.sql


WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
   *
FROM sales
WHERE name = 'ABC private LTD-0002'
    );
  
  
[0m10:30:43.502686 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m10:30:43.512707 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m10:30:43.515447 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */
alter table "sales_database"."main"."transform_sales__dbt_tmp" rename to "transform_sales"
[0m10:30:43.517911 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:30:43.531142 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: COMMIT
[0m10:30:43.533148 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m10:30:43.536075 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: COMMIT
[0m10:30:43.551946 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m10:30:43.559914 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m10:30:43.561865 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */
drop table if exists "sales_database"."main"."transform_sales__dbt_backup" cascade
[0m10:30:43.564206 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:30:43.567929 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: Close
[0m10:30:43.669404 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'abcd913c-c84b-4eff-a7fa-186a4baf2bfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1bb2eb20f0>]}
[0m10:30:43.671486 [info ] [Thread-1 (]: 5 of 6 OK created sql table model main.transform_sales ......................... [[32mOK[0m in 0.30s]
[0m10:30:43.674131 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.transform_sales
[0m10:30:43.676001 [debug] [Thread-1 (]: Began running node model.my_dbt_project.sales_fact
[0m10:30:43.677953 [info ] [Thread-1 (]: 6 of 6 START sql table model main.sales_fact ................................... [RUN]
[0m10:30:43.680012 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.transform_sales, now model.my_dbt_project.sales_fact)
[0m10:30:43.682363 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.sales_fact
[0m10:30:43.696158 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.sales_fact"
[0m10:30:43.741245 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.sales_fact
[0m10:30:43.754591 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.sales_fact"
[0m10:30:43.789018 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_fact"
[0m10:30:43.791850 [debug] [Thread-1 (]: On model.my_dbt_project.sales_fact: BEGIN
[0m10:30:43.794019 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:30:43.841869 [debug] [Thread-1 (]: SQL status: OK in 0.048 seconds
[0m10:30:43.843521 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_fact"
[0m10:30:43.845796 [debug] [Thread-1 (]: On model.my_dbt_project.sales_fact: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_fact"} */

  
    
    

    create  table
      "sales_database"."main"."sales_fact__dbt_tmp"
  
    as (
      WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
),
customer AS (
    SELECT * FROM "sales_database"."main"."customer_dimension"
),
product AS (
    SELECT * FROM "sales_database"."main"."product_dimension"
),
sales_team AS (
    SELECT * FROM "sales_database"."main"."sales_team_dimension"
),
date AS (
    SELECT * FROM "sales_database"."main"."date_dimension"
)

SELECT
    sales.name AS sales_id,
    customer.customer_id,
    product.product_id,
    sales_team.sales_team_id,
    date.date_id,
    sales.total_qty,
    sales.total_net_weight,
    sales.total,
    sales.net_total,
    sales.grand_total,
    sales.tax_category
FROM sales
JOIN customer ON sales.customer = customer.customer_id
-- Handling product as JSON in DuckDB
JOIN LATERAL (
    SELECT json_extract(items, '$[0].product_id') AS product_id
    FROM (VALUES (sales.items)) AS items(item)
    WHERE json_extract(item, '$[0].product_id') IS NOT NULL
) AS product ON TRUE
-- Handling sales_team as JSON in DuckDB
JOIN LATERAL (
    SELECT json_extract(sales_team, '$[0].sales_team_id') AS sales_team_id
    FROM (VALUES (sales.sales_team)) AS team(item)
    WHERE json_extract(item, '$[0].sales_team_id') IS NOT NULL
) AS sales_team ON TRUE
JOIN date ON sales.transaction_date = date.date_id
    );
  
  
[0m10:30:43.898007 [debug] [Thread-1 (]: SQL status: OK in 0.050 seconds
[0m10:30:43.929135 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_fact"
[0m10:30:43.931468 [debug] [Thread-1 (]: On model.my_dbt_project.sales_fact: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_fact"} */
alter table "sales_database"."main"."sales_fact__dbt_tmp" rename to "sales_fact"
[0m10:30:43.935008 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:30:43.945771 [debug] [Thread-1 (]: On model.my_dbt_project.sales_fact: COMMIT
[0m10:30:43.947780 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_fact"
[0m10:30:43.949834 [debug] [Thread-1 (]: On model.my_dbt_project.sales_fact: COMMIT
[0m10:30:43.977334 [debug] [Thread-1 (]: SQL status: OK in 0.024 seconds
[0m10:30:43.988819 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_fact"
[0m10:30:43.996775 [debug] [Thread-1 (]: On model.my_dbt_project.sales_fact: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_fact"} */
drop table if exists "sales_database"."main"."sales_fact__dbt_backup" cascade
[0m10:30:44.001650 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:30:44.006965 [debug] [Thread-1 (]: On model.my_dbt_project.sales_fact: Close
[0m10:30:44.098394 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'abcd913c-c84b-4eff-a7fa-186a4baf2bfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1bb2267e90>]}
[0m10:30:44.101883 [info ] [Thread-1 (]: 6 of 6 OK created sql table model main.sales_fact .............................. [[32mOK[0m in 0.42s]
[0m10:30:44.107698 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.sales_fact
[0m10:30:44.112883 [debug] [MainThread]: Using duckdb connection "master"
[0m10:30:44.115104 [debug] [MainThread]: On master: BEGIN
[0m10:30:44.118113 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:30:44.191307 [debug] [MainThread]: SQL status: OK in 0.074 seconds
[0m10:30:44.193233 [debug] [MainThread]: On master: COMMIT
[0m10:30:44.194802 [debug] [MainThread]: Using duckdb connection "master"
[0m10:30:44.196873 [debug] [MainThread]: On master: COMMIT
[0m10:30:44.199170 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m10:30:44.200722 [debug] [MainThread]: On master: Close
[0m10:30:44.206633 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:30:44.208737 [debug] [MainThread]: Connection 'list_sales_database_main' was properly closed.
[0m10:30:44.210103 [debug] [MainThread]: Connection 'model.my_dbt_project.sales_fact' was properly closed.
[0m10:30:44.211891 [info ] [MainThread]: 
[0m10:30:44.213840 [info ] [MainThread]: Finished running 2 table models, 4 view models in 0 hours 0 minutes and 2.11 seconds (2.11s).
[0m10:30:44.219643 [debug] [MainThread]: Command end result
[0m10:30:44.347044 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m10:30:44.356145 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m10:30:44.375651 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dags/dbt_models/target/run_results.json
[0m10:30:44.376762 [info ] [MainThread]: 
[0m10:30:44.377981 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:30:44.379208 [info ] [MainThread]: 
[0m10:30:44.380490 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m10:30:44.383478 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.802002, "process_in_blocks": "134408", "process_kernel_time": 0.80668, "process_mem_max_rss": "150820", "process_out_blocks": "0", "process_user_time": 7.965966}
[0m10:30:44.384844 [debug] [MainThread]: Command `dbt run` succeeded at 10:30:44.384632 after 4.80 seconds
[0m10:30:44.386199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1bb95d2270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1bb9443e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1bb23786e0>]}
[0m10:30:44.387388 [debug] [MainThread]: Flushing usage events
[0m10:30:45.843281 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:46:23.757990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4c641aff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4c5acd730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4c6418ef0>]}


============================== 10:46:23.779965 | 89b5dd34-1c6b-466f-a9e8-16d82c2d0e1f ==============================
[0m10:46:23.779965 [info ] [MainThread]: Running with dbt=1.9.1
[0m10:46:23.783481 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dags/dbt_models/logs', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt/profiles.yml', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt/profiles.yml --target dev', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:46:24.788558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '89b5dd34-1c6b-466f-a9e8-16d82c2d0e1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4c6483650>]}
[0m10:46:24.956691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '89b5dd34-1c6b-466f-a9e8-16d82c2d0e1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4bff06f90>]}
[0m10:46:24.969555 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m10:46:25.292378 [debug] [MainThread]: checksum: cac3b9519010e47bfbeb71ca6efb4867dae2858687671594dc23fefc94ecf25d, vars: {}, profile: , target: dev, version: 1.9.1
[0m10:46:26.418694 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:46:26.425790 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/facts/sales_fact.sql
[0m10:46:28.088770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '89b5dd34-1c6b-466f-a9e8-16d82c2d0e1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4bef6fa70>]}
[0m10:46:28.590173 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m10:46:28.621650 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m10:46:28.860425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '89b5dd34-1c6b-466f-a9e8-16d82c2d0e1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4c6d7d430>]}
[0m10:46:28.868654 [info ] [MainThread]: Found 6 models, 1 source, 424 macros
[0m10:46:28.870923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '89b5dd34-1c6b-466f-a9e8-16d82c2d0e1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4c5627560>]}
[0m10:46:28.881440 [info ] [MainThread]: 
[0m10:46:28.885633 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:46:28.887603 [info ] [MainThread]: 
[0m10:46:28.891738 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m10:46:28.942093 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_sales_database'
[0m10:46:29.426347 [debug] [ThreadPool]: Using duckdb connection "list_sales_database"
[0m10:46:29.439695 [debug] [ThreadPool]: On list_sales_database: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "list_sales_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"sales_database"'
    
  
  
[0m10:46:29.442527 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:46:31.969601 [debug] [ThreadPool]: SQL status: OK in 2.509 seconds
[0m10:46:32.090090 [debug] [ThreadPool]: On list_sales_database: Close
[0m10:46:32.471677 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_database, now create_sales_database_main)
[0m10:46:32.735628 [debug] [ThreadPool]: Creating schema "database: "sales_database"
schema: "main"
"
[0m10:46:32.776358 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m10:46:32.778493 [debug] [ThreadPool]: On create_sales_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "create_sales_database_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='sales_database'
        and type='sqlite'
    
  
[0m10:46:32.781177 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:47:20.822966 [debug] [ThreadPool]: SQL status: OK in 48.039 seconds
[0m10:47:20.835101 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m10:47:20.838838 [debug] [ThreadPool]: On create_sales_database_main: BEGIN
[0m10:47:20.861311 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m10:47:20.863728 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m10:47:20.867088 [debug] [ThreadPool]: On create_sales_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "create_sales_database_main"} */

    
    
        create schema if not exists "sales_database"."main"
    
[0m10:47:20.881820 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m10:47:20.898491 [debug] [ThreadPool]: On create_sales_database_main: COMMIT
[0m10:47:20.902194 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m10:47:20.906931 [debug] [ThreadPool]: On create_sales_database_main: COMMIT
[0m10:47:20.938634 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:47:20.977251 [debug] [ThreadPool]: On create_sales_database_main: Close
[0m10:47:21.010917 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_sales_database_main'
[0m10:47:21.067437 [debug] [ThreadPool]: Using duckdb connection "list_sales_database_main"
[0m10:47:21.089389 [debug] [ThreadPool]: On list_sales_database_main: BEGIN
[0m10:47:21.094094 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:47:21.796659 [debug] [ThreadPool]: SQL status: OK in 0.744 seconds
[0m10:47:21.809407 [debug] [ThreadPool]: Using duckdb connection "list_sales_database_main"
[0m10:47:21.818371 [debug] [ThreadPool]: On list_sales_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "list_sales_database_main"} */
select
      'sales_database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'sales_database'
  
[0m10:47:22.563245 [debug] [ThreadPool]: SQL status: OK in 0.738 seconds
[0m10:47:22.585839 [debug] [ThreadPool]: On list_sales_database_main: ROLLBACK
[0m10:47:22.623226 [debug] [ThreadPool]: Failed to rollback 'list_sales_database_main'
[0m10:47:22.625445 [debug] [ThreadPool]: On list_sales_database_main: Close
[0m10:47:22.676010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '89b5dd34-1c6b-466f-a9e8-16d82c2d0e1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4c6936db0>]}
[0m10:47:22.680954 [debug] [MainThread]: Using duckdb connection "master"
[0m10:47:22.684058 [debug] [MainThread]: On master: BEGIN
[0m10:47:22.686484 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:47:23.224924 [debug] [MainThread]: SQL status: OK in 0.538 seconds
[0m10:47:23.228257 [debug] [MainThread]: On master: COMMIT
[0m10:47:23.231711 [debug] [MainThread]: Using duckdb connection "master"
[0m10:47:23.242690 [debug] [MainThread]: On master: COMMIT
[0m10:47:23.293861 [debug] [MainThread]: SQL status: OK in 0.015 seconds
[0m10:47:23.308612 [debug] [MainThread]: On master: Close
[0m10:47:23.362682 [debug] [Thread-1 (]: Began running node model.my_dbt_project.customer_dimension
[0m10:47:23.376799 [info ] [Thread-1 (]: 1 of 6 START sql view model main.customer_dimension ............................ [RUN]
[0m10:47:23.401549 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.my_dbt_project.customer_dimension'
[0m10:47:23.405590 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.customer_dimension
[0m10:47:23.526977 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.customer_dimension"
[0m10:47:23.634224 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.customer_dimension
[0m10:47:24.090823 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.customer_dimension"
[0m10:47:24.261264 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m10:47:24.274313 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: BEGIN
[0m10:47:24.280180 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:47:24.461176 [debug] [Thread-1 (]: SQL status: OK in 0.181 seconds
[0m10:47:24.464048 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m10:47:24.480184 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */

  
  create view "sales_database"."main"."customer_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
    DISTINCT
    customer AS customer_id,
    customer_name,
    customer_address,
    customer_group,
    territory,
    language AS customer_language
FROM sales
WHERE customer IS NOT NULL
  );

[0m10:47:24.493042 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m10:47:24.560461 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m10:47:24.564952 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */
alter view "sales_database"."main"."customer_dimension" rename to "customer_dimension__dbt_backup"
[0m10:47:24.575811 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m10:47:24.609130 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m10:47:24.615101 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */
alter view "sales_database"."main"."customer_dimension__dbt_tmp" rename to "customer_dimension"
[0m10:47:24.629816 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:47:24.803390 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: COMMIT
[0m10:47:24.821113 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m10:47:24.823713 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: COMMIT
[0m10:47:24.922855 [debug] [Thread-1 (]: SQL status: OK in 0.087 seconds
[0m10:47:25.002769 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m10:47:25.042921 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */
drop view if exists "sales_database"."main"."customer_dimension__dbt_backup" cascade
[0m10:47:25.076999 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m10:47:25.114072 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: Close
[0m10:47:25.446020 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89b5dd34-1c6b-466f-a9e8-16d82c2d0e1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4c79f8e60>]}
[0m10:47:25.452098 [info ] [Thread-1 (]: 1 of 6 OK created sql view model main.customer_dimension ....................... [[32mOK[0m in 2.02s]
[0m10:47:25.495305 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.customer_dimension
[0m10:47:25.512168 [debug] [Thread-1 (]: Began running node model.my_dbt_project.date_dimension
[0m10:47:25.521704 [info ] [Thread-1 (]: 2 of 6 START sql view model main.date_dimension ................................ [RUN]
[0m10:47:25.537109 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customer_dimension, now model.my_dbt_project.date_dimension)
[0m10:47:25.549864 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.date_dimension
[0m10:47:25.622957 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.date_dimension"
[0m10:47:25.828407 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.date_dimension
[0m10:47:25.891820 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.date_dimension"
[0m10:47:26.057908 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m10:47:26.060361 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: BEGIN
[0m10:47:26.070564 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:47:26.404236 [debug] [Thread-1 (]: SQL status: OK in 0.340 seconds
[0m10:47:26.416601 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m10:47:26.419935 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.date_dimension"} */

  
  create view "sales_database"."main"."date_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)
SELECT
    transaction_date,
    strftime(transaction_date, '%Y-%m-%d') AS date_id,  -- Change the format to YYYY-MM-DD
    strftime(transaction_date, '%A') AS weekday_name,
    strftime(transaction_date, '%m') AS month,
    strftime(transaction_date, '%Y') AS year,
    strftime(transaction_date, '%d') AS day,
    EXTRACT(QUARTER FROM transaction_date) AS quarter
FROM sales
WHERE transaction_date IS NOT NULL
  );

[0m10:47:26.454236 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m10:47:26.496298 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m10:47:26.528554 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.date_dimension"} */
alter view "sales_database"."main"."date_dimension" rename to "date_dimension__dbt_backup"
[0m10:47:26.546551 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m10:47:26.657135 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m10:47:26.670788 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.date_dimension"} */
alter view "sales_database"."main"."date_dimension__dbt_tmp" rename to "date_dimension"
[0m10:47:26.674075 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:47:26.696548 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: COMMIT
[0m10:47:26.726870 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m10:47:26.773844 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: COMMIT
[0m10:47:26.915186 [debug] [Thread-1 (]: SQL status: OK in 0.125 seconds
[0m10:47:26.952313 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m10:47:26.955205 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.date_dimension"} */
drop view if exists "sales_database"."main"."date_dimension__dbt_backup" cascade
[0m10:47:26.977363 [debug] [Thread-1 (]: SQL status: OK in 0.020 seconds
[0m10:47:26.996670 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: Close
[0m10:47:27.318097 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89b5dd34-1c6b-466f-a9e8-16d82c2d0e1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4bc12bfb0>]}
[0m10:47:27.331836 [info ] [Thread-1 (]: 2 of 6 OK created sql view model main.date_dimension ........................... [[32mOK[0m in 1.78s]
[0m10:47:27.354795 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.date_dimension
[0m10:47:27.373024 [debug] [Thread-1 (]: Began running node model.my_dbt_project.product_dimension
[0m10:47:27.390154 [info ] [Thread-1 (]: 3 of 6 START sql view model main.product_dimension ............................. [RUN]
[0m10:47:27.425187 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.date_dimension, now model.my_dbt_project.product_dimension)
[0m10:47:27.429344 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.product_dimension
[0m10:47:27.464607 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.product_dimension"
[0m10:47:27.561339 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.product_dimension
[0m10:47:27.657340 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.product_dimension"
[0m10:47:27.723905 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m10:47:27.732358 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: BEGIN
[0m10:47:27.740010 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:47:28.128736 [debug] [Thread-1 (]: SQL status: OK in 0.389 seconds
[0m10:47:28.130617 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m10:47:28.134193 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.product_dimension"} */

  
  create view "sales_database"."main"."product_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * 
    FROM "sales_database"."main"."sales"
)

SELECT 
    sales.name,
    json_extract(items, '$[0].name') AS product_name,  -- Example to extract the first element's "name" field from JSON array
    json_extract(items, '$[0].item_code') AS product_item_code
FROM sales
WHERE json_extract(items, '$[0].name') IS NOT NULL  -- Filter to only keep rows with a non-null product name
  );

[0m10:47:28.149612 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m10:47:28.189188 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m10:47:28.192081 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.product_dimension"} */
alter view "sales_database"."main"."product_dimension" rename to "product_dimension__dbt_backup"
[0m10:47:28.212881 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:47:28.320146 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m10:47:28.336564 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.product_dimension"} */
alter view "sales_database"."main"."product_dimension__dbt_tmp" rename to "product_dimension"
[0m10:47:28.353579 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:47:28.409241 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: COMMIT
[0m10:47:28.414617 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m10:47:28.418026 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: COMMIT
[0m10:47:28.469016 [debug] [Thread-1 (]: SQL status: OK in 0.044 seconds
[0m10:47:28.492415 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m10:47:28.497161 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.product_dimension"} */
drop view if exists "sales_database"."main"."product_dimension__dbt_backup" cascade
[0m10:47:28.517069 [debug] [Thread-1 (]: SQL status: OK in 0.015 seconds
[0m10:47:28.553497 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: Close
[0m10:47:28.734111 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89b5dd34-1c6b-466f-a9e8-16d82c2d0e1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4be3dc140>]}
[0m10:47:28.738779 [info ] [Thread-1 (]: 3 of 6 OK created sql view model main.product_dimension ........................ [[32mOK[0m in 1.31s]
[0m10:47:28.744052 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.product_dimension
[0m10:47:28.760056 [debug] [Thread-1 (]: Began running node model.my_dbt_project.sales_team_dimension
[0m10:47:28.788996 [info ] [Thread-1 (]: 4 of 6 START sql view model main.sales_team_dimension .......................... [RUN]
[0m10:47:28.791359 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.product_dimension, now model.my_dbt_project.sales_team_dimension)
[0m10:47:28.797614 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.sales_team_dimension
[0m10:47:28.822663 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.sales_team_dimension"
[0m10:47:28.885134 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.sales_team_dimension
[0m10:47:28.919858 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.sales_team_dimension"
[0m10:47:29.081748 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m10:47:29.102307 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: BEGIN
[0m10:47:29.113039 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:47:29.356403 [debug] [Thread-1 (]: SQL status: OK in 0.243 seconds
[0m10:47:29.358828 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m10:47:29.389012 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */

  
  create view "sales_database"."main"."sales_team_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
    DISTINCT
    sales_team->>'name' AS sales_team_id,
    sales_team->>'region' AS sales_team_region
FROM sales
WHERE sales_team IS NOT NULL
  );

[0m10:47:29.409573 [debug] [Thread-1 (]: SQL status: OK in 0.018 seconds
[0m10:47:29.448550 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m10:47:29.451266 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */
alter view "sales_database"."main"."sales_team_dimension" rename to "sales_team_dimension__dbt_backup"
[0m10:47:29.454770 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:47:29.523820 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m10:47:29.527557 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */
alter view "sales_database"."main"."sales_team_dimension__dbt_tmp" rename to "sales_team_dimension"
[0m10:47:29.537011 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m10:47:29.551717 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: COMMIT
[0m10:47:29.570249 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m10:47:29.575743 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: COMMIT
[0m10:47:29.620296 [debug] [Thread-1 (]: SQL status: OK in 0.027 seconds
[0m10:47:29.641981 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m10:47:29.644742 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */
drop view if exists "sales_database"."main"."sales_team_dimension__dbt_backup" cascade
[0m10:47:29.661619 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m10:47:29.677602 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: Close
[0m10:47:29.923867 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89b5dd34-1c6b-466f-a9e8-16d82c2d0e1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4bc1446b0>]}
[0m10:47:29.929292 [info ] [Thread-1 (]: 4 of 6 OK created sql view model main.sales_team_dimension ..................... [[32mOK[0m in 1.13s]
[0m10:47:29.938068 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.sales_team_dimension
[0m10:47:29.942090 [debug] [Thread-1 (]: Began running node model.my_dbt_project.transform_sales
[0m10:47:29.954724 [info ] [Thread-1 (]: 5 of 6 START sql table model main.transform_sales .............................. [RUN]
[0m10:47:29.958506 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.sales_team_dimension, now model.my_dbt_project.transform_sales)
[0m10:47:29.961068 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.transform_sales
[0m10:47:29.995920 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.transform_sales"
[0m10:47:30.069522 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.transform_sales
[0m10:47:30.351875 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.transform_sales"
[0m10:47:30.388658 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m10:47:30.392169 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: BEGIN
[0m10:47:30.394114 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:47:30.590057 [debug] [Thread-1 (]: SQL status: OK in 0.196 seconds
[0m10:47:30.593386 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m10:47:30.614125 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */

  
    
    

    create  table
      "sales_database"."main"."transform_sales__dbt_tmp"
  
    as (
      -- /opt/airflow/dags/dbt_models/transform_users.sql


WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
   *
FROM sales
WHERE name = 'ABC private LTD-0002'
    );
  
  
[0m10:47:30.885192 [debug] [Thread-1 (]: SQL status: OK in 0.264 seconds
[0m10:47:30.919025 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m10:47:30.923224 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */
alter table "sales_database"."main"."transform_sales" rename to "transform_sales__dbt_backup"
[0m10:47:30.938125 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m10:47:31.009712 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m10:47:31.019384 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */
alter table "sales_database"."main"."transform_sales__dbt_tmp" rename to "transform_sales"
[0m10:47:31.034933 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:47:31.080618 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: COMMIT
[0m10:47:31.092381 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m10:47:31.096236 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: COMMIT
[0m10:47:31.195933 [debug] [Thread-1 (]: SQL status: OK in 0.094 seconds
[0m10:47:31.231906 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m10:47:31.244599 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */
drop table if exists "sales_database"."main"."transform_sales__dbt_backup" cascade
[0m10:47:31.284060 [debug] [Thread-1 (]: SQL status: OK in 0.033 seconds
[0m10:47:31.303490 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: Close
[0m10:47:31.959821 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89b5dd34-1c6b-466f-a9e8-16d82c2d0e1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4be4d7ad0>]}
[0m10:47:31.963684 [info ] [Thread-1 (]: 5 of 6 OK created sql table model main.transform_sales ......................... [[32mOK[0m in 2.00s]
[0m10:47:31.977392 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.transform_sales
[0m10:47:31.980038 [debug] [Thread-1 (]: Began running node model.my_dbt_project.sales_fact
[0m10:47:31.983524 [info ] [Thread-1 (]: 6 of 6 START sql table model main.sales_fact ................................... [RUN]
[0m10:47:31.995698 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.transform_sales, now model.my_dbt_project.sales_fact)
[0m10:47:31.998568 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.sales_fact
[0m10:47:32.033227 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.sales_fact"
[0m10:47:32.059927 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.sales_fact
[0m10:47:32.096965 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.sales_fact"
[0m10:47:32.137309 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_fact"
[0m10:47:32.139542 [debug] [Thread-1 (]: On model.my_dbt_project.sales_fact: BEGIN
[0m10:47:32.146840 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:47:32.263297 [debug] [Thread-1 (]: SQL status: OK in 0.116 seconds
[0m10:47:32.272115 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_fact"
[0m10:47:32.283436 [debug] [Thread-1 (]: On model.my_dbt_project.sales_fact: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_fact"} */

  
    
    

    create  table
      "sales_database"."main"."sales_fact__dbt_tmp"
  
    as (
      WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
),
customer AS (
    SELECT * FROM "sales_database"."main"."customer_dimension"
),
product AS (
    SELECT * FROM "sales_database"."main"."product_dimension"
),
sales_team AS (
    SELECT * FROM "sales_database"."main"."sales_team_dimension"
),
date AS (
    SELECT * FROM "sales_database"."main"."date_dimension"
)

SELECT
    s.name AS sales_id,
    c.customer_id,
    p.product_id,
    st.sales_team_id,
    d.date_id,
    s.total_qty,
    s.total_net_weight,
    s.total,
    s.net_total,
    s.grand_total,
    s.tax_category
FROM sales s
JOIN customer c 
    ON s.customer = c.customer_id
-- Handling product as JSON in DuckDB
JOIN LATERAL (
    SELECT json_extract(s.items, '$[0].product_id') AS product_id
    FROM (VALUES (s.items)) AS items(item)
    WHERE json_extract(item, '$[0].product_id') IS NOT NULL
) AS p ON TRUE
-- Handling sales_team as JSON in DuckDB
JOIN LATERAL (
    SELECT json_extract(s.sales_team, '$[0].sales_team_id') AS sales_team_id
    FROM (VALUES (s.sales_team)) AS team(item)
    WHERE json_extract(item, '$[0].sales_team_id') IS NOT NULL
) AS st ON TRUE
JOIN date d 
    ON s.transaction_date = d.date_id;
    );
  
  
[0m10:47:32.416921 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_fact"} */

  
    
    

    create  table
      "sales_database"."main"."sales_fact__dbt_tmp"
  
    as (
      WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
),
customer AS (
    SELECT * FROM "sales_database"."main"."customer_dimension"
),
product AS (
    SELECT * FROM "sales_database"."main"."product_dimension"
),
sales_team AS (
    SELECT * FROM "sales_database"."main"."sales_team_dimension"
),
date AS (
    SELECT * FROM "sales_database"."main"."date_dimension"
)

SELECT
    s.name AS sales_id,
    c.customer_id,
    p.product_id,
    st.sales_team_id,
    d.date_id,
    s.total_qty,
    s.total_net_weight,
    s.total,
    s.net_total,
    s.grand_total,
    s.tax_category
FROM sales s
JOIN customer c 
    ON s.customer = c.customer_id
-- Handling product as JSON in DuckDB
JOIN LATERAL (
    SELECT json_extract(s.items, '$[0].product_id') AS product_id
    FROM (VALUES (s.items)) AS items(item)
    WHERE json_extract(item, '$[0].product_id') IS NOT NULL
) AS p ON TRUE
-- Handling sales_team as JSON in DuckDB
JOIN LATERAL (
    SELECT json_extract(s.sales_team, '$[0].sales_team_id') AS sales_team_id
    FROM (VALUES (s.sales_team)) AS team(item)
    WHERE json_extract(item, '$[0].sales_team_id') IS NOT NULL
) AS st ON TRUE
JOIN date d 
    ON s.transaction_date = d.date_id;
    );
  
  
[0m10:47:32.420013 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m10:47:32.423845 [debug] [Thread-1 (]: On model.my_dbt_project.sales_fact: ROLLBACK
[0m10:47:32.562010 [debug] [Thread-1 (]: Failed to rollback 'model.my_dbt_project.sales_fact'
[0m10:47:32.573158 [debug] [Thread-1 (]: On model.my_dbt_project.sales_fact: Close
[0m10:47:32.595280 [debug] [Thread-1 (]: Runtime Error in model sales_fact (models/facts/sales_fact.sql)
  Parser Error: syntax error at or near ";"
[0m10:47:32.608093 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89b5dd34-1c6b-466f-a9e8-16d82c2d0e1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4be3e55e0>]}
[0m10:47:32.620414 [error] [Thread-1 (]: 6 of 6 ERROR creating sql table model main.sales_fact .......................... [[31mERROR[0m in 0.61s]
[0m10:47:32.623656 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.sales_fact
[0m10:47:32.626877 [debug] [Thread-4 (]: Marking all children of 'model.my_dbt_project.sales_fact' to be skipped because of status 'error'.  Reason: Runtime Error in model sales_fact (models/facts/sales_fact.sql)
  Parser Error: syntax error at or near ";".
[0m10:47:32.641926 [debug] [MainThread]: Using duckdb connection "master"
[0m10:47:32.644737 [debug] [MainThread]: On master: BEGIN
[0m10:47:32.649005 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:47:32.809371 [debug] [MainThread]: SQL status: OK in 0.161 seconds
[0m10:47:32.811351 [debug] [MainThread]: On master: COMMIT
[0m10:47:32.825255 [debug] [MainThread]: Using duckdb connection "master"
[0m10:47:32.827382 [debug] [MainThread]: On master: COMMIT
[0m10:47:32.833697 [debug] [MainThread]: SQL status: OK in 0.004 seconds
[0m10:47:32.841068 [debug] [MainThread]: On master: Close
[0m10:47:32.861652 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:47:32.872722 [debug] [MainThread]: Connection 'create_sales_database_main' was properly closed.
[0m10:47:32.876820 [debug] [MainThread]: Connection 'list_sales_database_main' was properly closed.
[0m10:47:32.888469 [debug] [MainThread]: Connection 'model.my_dbt_project.sales_fact' was properly closed.
[0m10:47:32.891907 [info ] [MainThread]: 
[0m10:47:32.895195 [info ] [MainThread]: Finished running 2 table models, 4 view models in 0 hours 1 minutes and 4.00 seconds (64.00s).
[0m10:47:32.913976 [debug] [MainThread]: Command end result
[0m10:47:33.208353 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m10:47:33.248338 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m10:47:33.327031 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dags/dbt_models/target/run_results.json
[0m10:47:33.328901 [info ] [MainThread]: 
[0m10:47:33.334017 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m10:47:33.340156 [info ] [MainThread]: 
[0m10:47:33.349830 [error] [MainThread]:   Runtime Error in model sales_fact (models/facts/sales_fact.sql)
  Parser Error: syntax error at or near ";"
[0m10:47:33.351942 [info ] [MainThread]: 
[0m10:47:33.369058 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m10:47:33.379324 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 69.94075, "process_in_blocks": "3118896", "process_kernel_time": 7.168144, "process_mem_max_rss": "134500", "process_out_blocks": "0", "process_user_time": 12.81517}
[0m10:47:33.385330 [debug] [MainThread]: Command `dbt run` failed at 10:47:33.384853 after 69.95 seconds
[0m10:47:33.389508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4c5742180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4c6418ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4c564f0e0>]}
[0m10:47:33.403257 [debug] [MainThread]: Flushing usage events
[0m10:47:35.661193 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:49:14.457649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b6f91e630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b6f93fef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b6f62e6f0>]}


============================== 10:49:14.503831 | 7b999f61-4959-4332-9be1-b338a693f15a ==============================
[0m10:49:14.503831 [info ] [MainThread]: Running with dbt=1.9.1
[0m10:49:14.507854 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt/profiles.yml', 'log_path': '/opt/airflow/dags/dbt_models/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt/profiles.yml --target dev', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:49:18.361209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7b999f61-4959-4332-9be1-b338a693f15a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b6f0a08c0>]}
[0m10:49:18.836650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7b999f61-4959-4332-9be1-b338a693f15a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b6f0cf3e0>]}
[0m10:49:19.178622 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m10:49:23.904732 [debug] [MainThread]: checksum: cac3b9519010e47bfbeb71ca6efb4867dae2858687671594dc23fefc94ecf25d, vars: {}, profile: , target: dev, version: 1.9.1
[0m10:49:25.023575 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:49:25.026001 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/facts/sales_fact.sql
[0m10:49:27.375484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7b999f61-4959-4332-9be1-b338a693f15a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b68a639e0>]}
[0m10:49:27.941757 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m10:49:27.962429 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m10:49:28.271373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7b999f61-4959-4332-9be1-b338a693f15a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b6955cc50>]}
[0m10:49:28.278268 [info ] [MainThread]: Found 6 models, 1 source, 424 macros
[0m10:49:28.281515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7b999f61-4959-4332-9be1-b338a693f15a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b6ba618b0>]}
[0m10:49:28.299131 [info ] [MainThread]: 
[0m10:49:28.321833 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:49:28.337717 [info ] [MainThread]: 
[0m10:49:28.362469 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m10:49:28.393620 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_sales_database'
[0m10:49:28.633126 [debug] [ThreadPool]: Using duckdb connection "list_sales_database"
[0m10:49:28.637276 [debug] [ThreadPool]: On list_sales_database: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "list_sales_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"sales_database"'
    
  
  
[0m10:49:28.639658 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:49:29.109509 [debug] [ThreadPool]: SQL status: OK in 0.470 seconds
[0m10:49:29.114159 [debug] [ThreadPool]: On list_sales_database: Close
[0m10:49:29.149329 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_database, now create_sales_database_main)
[0m10:49:29.162998 [debug] [ThreadPool]: Creating schema "database: "sales_database"
schema: "main"
"
[0m10:49:29.234923 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m10:49:29.238861 [debug] [ThreadPool]: On create_sales_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "create_sales_database_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='sales_database'
        and type='sqlite'
    
  
[0m10:49:29.241273 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:49:29.304239 [debug] [ThreadPool]: SQL status: OK in 0.063 seconds
[0m10:49:29.309920 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m10:49:29.315092 [debug] [ThreadPool]: On create_sales_database_main: BEGIN
[0m10:49:29.334134 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:49:29.335836 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m10:49:29.339732 [debug] [ThreadPool]: On create_sales_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "create_sales_database_main"} */

    
    
        create schema if not exists "sales_database"."main"
    
[0m10:49:29.349413 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m10:49:29.354884 [debug] [ThreadPool]: On create_sales_database_main: COMMIT
[0m10:49:29.360745 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m10:49:29.371855 [debug] [ThreadPool]: On create_sales_database_main: COMMIT
[0m10:49:29.375738 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:49:29.383714 [debug] [ThreadPool]: On create_sales_database_main: Close
[0m10:49:29.399871 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_sales_database_main'
[0m10:49:29.477276 [debug] [ThreadPool]: Using duckdb connection "list_sales_database_main"
[0m10:49:29.487393 [debug] [ThreadPool]: On list_sales_database_main: BEGIN
[0m10:49:29.489300 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:49:29.606683 [debug] [ThreadPool]: SQL status: OK in 0.117 seconds
[0m10:49:29.611775 [debug] [ThreadPool]: Using duckdb connection "list_sales_database_main"
[0m10:49:29.623887 [debug] [ThreadPool]: On list_sales_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "list_sales_database_main"} */
select
      'sales_database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'sales_database'
  
[0m10:49:29.809868 [debug] [ThreadPool]: SQL status: OK in 0.182 seconds
[0m10:49:29.832560 [debug] [ThreadPool]: On list_sales_database_main: ROLLBACK
[0m10:49:29.842799 [debug] [ThreadPool]: Failed to rollback 'list_sales_database_main'
[0m10:49:29.845726 [debug] [ThreadPool]: On list_sales_database_main: Close
[0m10:49:29.867818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7b999f61-4959-4332-9be1-b338a693f15a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b4bef6990>]}
[0m10:49:29.870049 [debug] [MainThread]: Using duckdb connection "master"
[0m10:49:29.872040 [debug] [MainThread]: On master: BEGIN
[0m10:49:29.874024 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:49:29.955759 [debug] [MainThread]: SQL status: OK in 0.082 seconds
[0m10:49:29.958290 [debug] [MainThread]: On master: COMMIT
[0m10:49:29.962228 [debug] [MainThread]: Using duckdb connection "master"
[0m10:49:29.967970 [debug] [MainThread]: On master: COMMIT
[0m10:49:29.970685 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m10:49:29.983637 [debug] [MainThread]: On master: Close
[0m10:49:30.003084 [debug] [Thread-1 (]: Began running node model.my_dbt_project.customer_dimension
[0m10:49:30.007200 [info ] [Thread-1 (]: 1 of 6 START sql view model main.customer_dimension ............................ [RUN]
[0m10:49:30.012244 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.my_dbt_project.customer_dimension'
[0m10:49:30.015227 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.customer_dimension
[0m10:49:30.063309 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.customer_dimension"
[0m10:49:30.091802 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.customer_dimension
[0m10:49:30.243545 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.customer_dimension"
[0m10:49:30.268659 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m10:49:30.270754 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: BEGIN
[0m10:49:30.272798 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:49:30.319943 [debug] [Thread-1 (]: SQL status: OK in 0.047 seconds
[0m10:49:30.322226 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m10:49:30.324521 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */

  
  create view "sales_database"."main"."customer_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
    DISTINCT
    customer AS customer_id,
    customer_name,
    customer_address,
    customer_group,
    territory,
    language AS customer_language
FROM sales
WHERE customer IS NOT NULL
  );

[0m10:49:30.328971 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:49:30.353941 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m10:49:30.355951 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */
alter view "sales_database"."main"."customer_dimension" rename to "customer_dimension__dbt_backup"
[0m10:49:30.358825 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:49:30.372641 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m10:49:30.374195 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */
alter view "sales_database"."main"."customer_dimension__dbt_tmp" rename to "customer_dimension"
[0m10:49:30.377018 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:49:30.422366 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: COMMIT
[0m10:49:30.424243 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m10:49:30.426064 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: COMMIT
[0m10:49:30.437310 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m10:49:30.451110 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m10:49:30.452600 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */
drop view if exists "sales_database"."main"."customer_dimension__dbt_backup" cascade
[0m10:49:30.457583 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m10:49:30.464749 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: Close
[0m10:49:30.535690 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7b999f61-4959-4332-9be1-b338a693f15a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b7141e450>]}
[0m10:49:30.538098 [info ] [Thread-1 (]: 1 of 6 OK created sql view model main.customer_dimension ....................... [[32mOK[0m in 0.52s]
[0m10:49:30.541943 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.customer_dimension
[0m10:49:30.544098 [debug] [Thread-1 (]: Began running node model.my_dbt_project.date_dimension
[0m10:49:30.547670 [info ] [Thread-1 (]: 2 of 6 START sql view model main.date_dimension ................................ [RUN]
[0m10:49:30.550887 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customer_dimension, now model.my_dbt_project.date_dimension)
[0m10:49:30.552502 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.date_dimension
[0m10:49:30.559395 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.date_dimension"
[0m10:49:30.583802 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.date_dimension
[0m10:49:30.607206 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.date_dimension"
[0m10:49:30.628357 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m10:49:30.631731 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: BEGIN
[0m10:49:30.633759 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:49:30.677856 [debug] [Thread-1 (]: SQL status: OK in 0.044 seconds
[0m10:49:30.682816 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m10:49:30.685009 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.date_dimension"} */

  
  create view "sales_database"."main"."date_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)
SELECT
    transaction_date,
    strftime(transaction_date, '%Y-%m-%d') AS date_id,  -- Change the format to YYYY-MM-DD
    strftime(transaction_date, '%A') AS weekday_name,
    strftime(transaction_date, '%m') AS month,
    strftime(transaction_date, '%Y') AS year,
    strftime(transaction_date, '%d') AS day,
    EXTRACT(QUARTER FROM transaction_date) AS quarter
FROM sales
WHERE transaction_date IS NOT NULL
  );

[0m10:49:30.689882 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m10:49:30.702562 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m10:49:30.704582 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.date_dimension"} */
alter view "sales_database"."main"."date_dimension" rename to "date_dimension__dbt_backup"
[0m10:49:30.707464 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:49:30.720850 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m10:49:30.723045 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.date_dimension"} */
alter view "sales_database"."main"."date_dimension__dbt_tmp" rename to "date_dimension"
[0m10:49:30.725765 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:49:30.734138 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: COMMIT
[0m10:49:30.736419 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m10:49:30.738409 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: COMMIT
[0m10:49:30.748769 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m10:49:30.758400 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m10:49:30.760402 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.date_dimension"} */
drop view if exists "sales_database"."main"."date_dimension__dbt_backup" cascade
[0m10:49:30.768722 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m10:49:30.774127 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: Close
[0m10:49:30.835831 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7b999f61-4959-4332-9be1-b338a693f15a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b4878f860>]}
[0m10:49:30.838557 [info ] [Thread-1 (]: 2 of 6 OK created sql view model main.date_dimension ........................... [[32mOK[0m in 0.28s]
[0m10:49:30.842177 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.date_dimension
[0m10:49:30.844162 [debug] [Thread-1 (]: Began running node model.my_dbt_project.product_dimension
[0m10:49:30.846520 [info ] [Thread-1 (]: 3 of 6 START sql view model main.product_dimension ............................. [RUN]
[0m10:49:30.850962 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.date_dimension, now model.my_dbt_project.product_dimension)
[0m10:49:30.852259 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.product_dimension
[0m10:49:30.860487 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.product_dimension"
[0m10:49:30.889129 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.product_dimension
[0m10:49:30.904600 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.product_dimension"
[0m10:49:30.922088 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m10:49:30.923502 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: BEGIN
[0m10:49:30.924790 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:49:30.986099 [debug] [Thread-1 (]: SQL status: OK in 0.061 seconds
[0m10:49:30.987998 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m10:49:30.990171 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.product_dimension"} */

  
  create view "sales_database"."main"."product_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * 
    FROM "sales_database"."main"."sales"
)

SELECT 
    sales.name,
    json_extract(items, '$[0].name') AS product_name,  -- Example to extract the first element's "name" field from JSON array
    json_extract(items, '$[0].item_code') AS product_item_code
FROM sales
WHERE json_extract(items, '$[0].name') IS NOT NULL  -- Filter to only keep rows with a non-null product name
  );

[0m10:49:30.995546 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m10:49:31.007288 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m10:49:31.009262 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.product_dimension"} */
alter view "sales_database"."main"."product_dimension" rename to "product_dimension__dbt_backup"
[0m10:49:31.016638 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m10:49:31.027506 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m10:49:31.029554 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.product_dimension"} */
alter view "sales_database"."main"."product_dimension__dbt_tmp" rename to "product_dimension"
[0m10:49:31.034457 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:49:31.040080 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: COMMIT
[0m10:49:31.041796 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m10:49:31.043788 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: COMMIT
[0m10:49:31.056751 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m10:49:31.066847 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m10:49:31.068742 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.product_dimension"} */
drop view if exists "sales_database"."main"."product_dimension__dbt_backup" cascade
[0m10:49:31.073735 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m10:49:31.079013 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: Close
[0m10:49:31.138164 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7b999f61-4959-4332-9be1-b338a693f15a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b4bd17350>]}
[0m10:49:31.141237 [info ] [Thread-1 (]: 3 of 6 OK created sql view model main.product_dimension ........................ [[32mOK[0m in 0.29s]
[0m10:49:31.144793 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.product_dimension
[0m10:49:31.150496 [debug] [Thread-1 (]: Began running node model.my_dbt_project.sales_team_dimension
[0m10:49:31.152907 [info ] [Thread-1 (]: 4 of 6 START sql view model main.sales_team_dimension .......................... [RUN]
[0m10:49:31.156867 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.product_dimension, now model.my_dbt_project.sales_team_dimension)
[0m10:49:31.158895 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.sales_team_dimension
[0m10:49:31.172860 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.sales_team_dimension"
[0m10:49:31.193754 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.sales_team_dimension
[0m10:49:31.216281 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.sales_team_dimension"
[0m10:49:31.246234 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m10:49:31.248708 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: BEGIN
[0m10:49:31.255220 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:49:31.312543 [debug] [Thread-1 (]: SQL status: OK in 0.057 seconds
[0m10:49:31.318854 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m10:49:31.320937 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */

  
  create view "sales_database"."main"."sales_team_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
    DISTINCT
    sales_team->>'name' AS sales_team_id,
    sales_team->>'region' AS sales_team_region
FROM sales
WHERE sales_team IS NOT NULL
  );

[0m10:49:31.325914 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m10:49:31.361490 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m10:49:31.367767 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */
alter view "sales_database"."main"."sales_team_dimension" rename to "sales_team_dimension__dbt_backup"
[0m10:49:31.377757 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:49:31.412875 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m10:49:31.418895 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */
alter view "sales_database"."main"."sales_team_dimension__dbt_tmp" rename to "sales_team_dimension"
[0m10:49:31.442040 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:49:31.472371 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: COMMIT
[0m10:49:31.477127 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m10:49:31.479304 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: COMMIT
[0m10:49:31.500500 [debug] [Thread-1 (]: SQL status: OK in 0.016 seconds
[0m10:49:31.518354 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m10:49:31.524481 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */
drop view if exists "sales_database"."main"."sales_team_dimension__dbt_backup" cascade
[0m10:49:31.534729 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m10:49:31.539679 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: Close
[0m10:49:31.597735 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7b999f61-4959-4332-9be1-b338a693f15a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b487bce90>]}
[0m10:49:31.601474 [info ] [Thread-1 (]: 4 of 6 OK created sql view model main.sales_team_dimension ..................... [[32mOK[0m in 0.44s]
[0m10:49:31.604635 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.sales_team_dimension
[0m10:49:31.606547 [debug] [Thread-1 (]: Began running node model.my_dbt_project.transform_sales
[0m10:49:31.608985 [info ] [Thread-1 (]: 5 of 6 START sql table model main.transform_sales .............................. [RUN]
[0m10:49:31.611516 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.sales_team_dimension, now model.my_dbt_project.transform_sales)
[0m10:49:31.615599 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.transform_sales
[0m10:49:31.630490 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.transform_sales"
[0m10:49:31.689809 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.transform_sales
[0m10:49:31.820905 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.transform_sales"
[0m10:49:31.915935 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m10:49:31.917816 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: BEGIN
[0m10:49:31.920898 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:49:31.988088 [debug] [Thread-1 (]: SQL status: OK in 0.068 seconds
[0m10:49:31.991271 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m10:49:31.993572 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */

  
    
    

    create  table
      "sales_database"."main"."transform_sales__dbt_tmp"
  
    as (
      -- /opt/airflow/dags/dbt_models/transform_users.sql


WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
   *
FROM sales
WHERE name = 'ABC private LTD-0002'
    );
  
  
[0m10:49:32.033221 [debug] [Thread-1 (]: SQL status: OK in 0.035 seconds
[0m10:49:32.043125 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m10:49:32.048754 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */
alter table "sales_database"."main"."transform_sales" rename to "transform_sales__dbt_backup"
[0m10:49:32.052209 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:49:32.065799 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m10:49:32.067792 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */
alter table "sales_database"."main"."transform_sales__dbt_tmp" rename to "transform_sales"
[0m10:49:32.071398 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:49:32.099147 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: COMMIT
[0m10:49:32.101253 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m10:49:32.103278 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: COMMIT
[0m10:49:32.125860 [debug] [Thread-1 (]: SQL status: OK in 0.021 seconds
[0m10:49:32.137835 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m10:49:32.140348 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */
drop table if exists "sales_database"."main"."transform_sales__dbt_backup" cascade
[0m10:49:32.149599 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m10:49:32.155894 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: Close
[0m10:49:32.245225 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7b999f61-4959-4332-9be1-b338a693f15a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b4bdd5b80>]}
[0m10:49:32.248795 [info ] [Thread-1 (]: 5 of 6 OK created sql table model main.transform_sales ......................... [[32mOK[0m in 0.63s]
[0m10:49:32.250815 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.transform_sales
[0m10:49:32.252261 [debug] [Thread-1 (]: Began running node model.my_dbt_project.sales_fact
[0m10:49:32.254012 [info ] [Thread-1 (]: 6 of 6 START sql table model main.sales_fact ................................... [RUN]
[0m10:49:32.255907 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.transform_sales, now model.my_dbt_project.sales_fact)
[0m10:49:32.257652 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.sales_fact
[0m10:49:32.269680 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.sales_fact"
[0m10:49:32.289326 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.sales_fact
[0m10:49:32.300709 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.sales_fact"
[0m10:49:32.317959 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_fact"
[0m10:49:32.320153 [debug] [Thread-1 (]: On model.my_dbt_project.sales_fact: BEGIN
[0m10:49:32.322344 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:49:32.357126 [debug] [Thread-1 (]: SQL status: OK in 0.035 seconds
[0m10:49:32.359067 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_fact"
[0m10:49:32.361295 [debug] [Thread-1 (]: On model.my_dbt_project.sales_fact: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_fact"} */

  
    
    

    create  table
      "sales_database"."main"."sales_fact__dbt_tmp"
  
    as (
      WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
),
customer AS (
    SELECT * FROM "sales_database"."main"."customer_dimension"
),
product AS (
    SELECT * FROM "sales_database"."main"."product_dimension"
),
sales_team AS (
    SELECT * FROM "sales_database"."main"."sales_team_dimension"
),
date AS (
    SELECT * FROM "sales_database"."main"."date_dimension"
)

SELECT
    s.name AS sales_id,
    c.customer_id,
    p.product_id,
    st.sales_team_id,
    d.date_id,
    s.total_qty,
    s.total_net_weight,
    s.total,
    s.net_total,
    s.grand_total,
    s.tax_category
FROM sales s
JOIN customer c 
    ON s.customer = c.customer_id
-- Handling product as JSON in DuckDB
JOIN LATERAL (
    SELECT json_extract(s.items, '$[0].product_id') AS product_id
    FROM (VALUES (s.items)) AS items(item)
    WHERE json_extract(item, '$[0].product_id') IS NOT NULL
) AS p ON TRUE
-- Handling sales_team as JSON in DuckDB
JOIN LATERAL (
    SELECT json_extract(s.sales_team, '$[0].sales_team_id') AS sales_team_id
    FROM (VALUES (s.sales_team)) AS team(item)
    WHERE json_extract(item, '$[0].sales_team_id') IS NOT NULL
) AS st ON TRUE
JOIN date d 
    ON s.transaction_date = d.date_id
    );
  
  
[0m10:49:32.404288 [debug] [Thread-1 (]: SQL status: OK in 0.039 seconds
[0m10:49:32.415886 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_fact"
[0m10:49:32.417751 [debug] [Thread-1 (]: On model.my_dbt_project.sales_fact: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_fact"} */
alter table "sales_database"."main"."sales_fact" rename to "sales_fact__dbt_backup"
[0m10:49:32.420587 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:49:32.428012 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_fact"
[0m10:49:32.431304 [debug] [Thread-1 (]: On model.my_dbt_project.sales_fact: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_fact"} */
alter table "sales_database"."main"."sales_fact__dbt_tmp" rename to "sales_fact"
[0m10:49:32.433570 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:49:32.440412 [debug] [Thread-1 (]: On model.my_dbt_project.sales_fact: COMMIT
[0m10:49:32.442146 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_fact"
[0m10:49:32.444066 [debug] [Thread-1 (]: On model.my_dbt_project.sales_fact: COMMIT
[0m10:49:32.457263 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m10:49:32.468320 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_fact"
[0m10:49:32.471287 [debug] [Thread-1 (]: On model.my_dbt_project.sales_fact: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_fact"} */
drop table if exists "sales_database"."main"."sales_fact__dbt_backup" cascade
[0m10:49:32.476771 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m10:49:32.480347 [debug] [Thread-1 (]: On model.my_dbt_project.sales_fact: Close
[0m10:49:32.526079 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7b999f61-4959-4332-9be1-b338a693f15a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b487ba7e0>]}
[0m10:49:32.528335 [info ] [Thread-1 (]: 6 of 6 OK created sql table model main.sales_fact .............................. [[32mOK[0m in 0.27s]
[0m10:49:32.532717 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.sales_fact
[0m10:49:32.536741 [debug] [MainThread]: Using duckdb connection "master"
[0m10:49:32.538700 [debug] [MainThread]: On master: BEGIN
[0m10:49:32.540068 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:49:32.573674 [debug] [MainThread]: SQL status: OK in 0.034 seconds
[0m10:49:32.574868 [debug] [MainThread]: On master: COMMIT
[0m10:49:32.576148 [debug] [MainThread]: Using duckdb connection "master"
[0m10:49:32.577231 [debug] [MainThread]: On master: COMMIT
[0m10:49:32.581566 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m10:49:32.583249 [debug] [MainThread]: On master: Close
[0m10:49:32.588891 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:49:32.589981 [debug] [MainThread]: Connection 'create_sales_database_main' was properly closed.
[0m10:49:32.591011 [debug] [MainThread]: Connection 'list_sales_database_main' was properly closed.
[0m10:49:32.592461 [debug] [MainThread]: Connection 'model.my_dbt_project.sales_fact' was properly closed.
[0m10:49:32.593797 [info ] [MainThread]: 
[0m10:49:32.595429 [info ] [MainThread]: Finished running 2 table models, 4 view models in 0 hours 0 minutes and 4.23 seconds (4.23s).
[0m10:49:32.600933 [debug] [MainThread]: Command end result
[0m10:49:32.805846 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m10:49:32.853519 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m10:49:32.990829 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dags/dbt_models/target/run_results.json
[0m10:49:32.992686 [info ] [MainThread]: 
[0m10:49:32.995189 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:49:33.010174 [info ] [MainThread]: 
[0m10:49:33.023300 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m10:49:33.037665 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 19.238499, "process_in_blocks": "825808", "process_kernel_time": 6.629796, "process_mem_max_rss": "141948", "process_out_blocks": "0", "process_user_time": 14.768168}
[0m10:49:33.041599 [debug] [MainThread]: Command `dbt run` succeeded at 10:49:33.041272 after 19.24 seconds
[0m10:49:33.052364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b72eff620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b6fe99fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b6fe9aed0>]}
[0m10:49:33.059088 [debug] [MainThread]: Flushing usage events
[0m10:49:35.001652 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:45:54.301217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8720729250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8721444380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87207c1f40>]}


============================== 11:45:54.416713 | 62f7bc3c-08b0-4bcf-896f-fe0ccee1ac0b ==============================
[0m11:45:54.416713 [info ] [MainThread]: Running with dbt=1.9.1
[0m11:45:54.425005 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt/profiles.yml', 'log_path': '/opt/airflow/dags/dbt_models/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt/profiles.yml --target dev', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:45:57.579488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '62f7bc3c-08b0-4bcf-896f-fe0ccee1ac0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f871ff5b6b0>]}
[0m11:45:57.888270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '62f7bc3c-08b0-4bcf-896f-fe0ccee1ac0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8720ca5d60>]}
[0m11:45:58.637611 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m11:46:01.581847 [debug] [MainThread]: checksum: cac3b9519010e47bfbeb71ca6efb4867dae2858687671594dc23fefc94ecf25d, vars: {}, profile: , target: dev, version: 1.9.1
[0m11:46:02.637658 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m11:46:02.680107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '62f7bc3c-08b0-4bcf-896f-fe0ccee1ac0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87207527b0>]}
[0m11:46:26.063328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '62f7bc3c-08b0-4bcf-896f-fe0ccee1ac0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f871fffbda0>]}
[0m11:46:27.148350 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m11:46:27.169554 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m11:46:27.782157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '62f7bc3c-08b0-4bcf-896f-fe0ccee1ac0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f871a1e8a70>]}
[0m11:46:27.784052 [info ] [MainThread]: Found 6 models, 1 source, 424 macros
[0m11:46:27.789784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '62f7bc3c-08b0-4bcf-896f-fe0ccee1ac0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87198a8da0>]}
[0m11:46:27.797922 [info ] [MainThread]: 
[0m11:46:27.806516 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:46:27.816110 [info ] [MainThread]: 
[0m11:46:27.820920 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:46:27.852260 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_sales_database'
[0m11:46:28.324376 [debug] [ThreadPool]: Using duckdb connection "list_sales_database"
[0m11:46:28.333582 [debug] [ThreadPool]: On list_sales_database: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "list_sales_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"sales_database"'
    
  
  
[0m11:46:28.346237 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:46:28.990474 [debug] [ThreadPool]: SQL status: OK in 0.644 seconds
[0m11:46:28.996386 [debug] [ThreadPool]: On list_sales_database: Close
[0m11:46:29.044919 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_database, now create_sales_database_main)
[0m11:46:29.096132 [debug] [ThreadPool]: Creating schema "database: "sales_database"
schema: "main"
"
[0m11:46:29.197991 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m11:46:29.227728 [debug] [ThreadPool]: On create_sales_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "create_sales_database_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='sales_database'
        and type='sqlite'
    
  
[0m11:46:29.235190 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:46:29.471791 [debug] [ThreadPool]: SQL status: OK in 0.237 seconds
[0m11:46:29.482151 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m11:46:29.484024 [debug] [ThreadPool]: On create_sales_database_main: BEGIN
[0m11:46:29.494983 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:46:29.498212 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m11:46:29.500558 [debug] [ThreadPool]: On create_sales_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "create_sales_database_main"} */

    
    
        create schema if not exists "sales_database"."main"
    
[0m11:46:29.508250 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m11:46:29.517834 [debug] [ThreadPool]: On create_sales_database_main: COMMIT
[0m11:46:29.521534 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m11:46:29.528723 [debug] [ThreadPool]: On create_sales_database_main: COMMIT
[0m11:46:29.534421 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:46:29.537903 [debug] [ThreadPool]: On create_sales_database_main: Close
[0m11:46:29.554117 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_sales_database_main'
[0m11:46:29.598098 [debug] [ThreadPool]: Using duckdb connection "list_sales_database_main"
[0m11:46:29.606950 [debug] [ThreadPool]: On list_sales_database_main: BEGIN
[0m11:46:29.608608 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:46:29.698918 [debug] [ThreadPool]: SQL status: OK in 0.090 seconds
[0m11:46:29.713167 [debug] [ThreadPool]: Using duckdb connection "list_sales_database_main"
[0m11:46:29.721361 [debug] [ThreadPool]: On list_sales_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "list_sales_database_main"} */
select
      'sales_database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'sales_database'
  
[0m11:46:29.856317 [debug] [ThreadPool]: SQL status: OK in 0.133 seconds
[0m11:46:29.863021 [debug] [ThreadPool]: On list_sales_database_main: ROLLBACK
[0m11:46:29.880144 [debug] [ThreadPool]: Failed to rollback 'list_sales_database_main'
[0m11:46:29.895592 [debug] [ThreadPool]: On list_sales_database_main: Close
[0m11:46:29.917274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '62f7bc3c-08b0-4bcf-896f-fe0ccee1ac0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f871a1c3860>]}
[0m11:46:29.919851 [debug] [MainThread]: Using duckdb connection "master"
[0m11:46:29.921815 [debug] [MainThread]: On master: BEGIN
[0m11:46:29.923415 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:46:29.977200 [debug] [MainThread]: SQL status: OK in 0.054 seconds
[0m11:46:29.981310 [debug] [MainThread]: On master: COMMIT
[0m11:46:29.997414 [debug] [MainThread]: Using duckdb connection "master"
[0m11:46:29.999302 [debug] [MainThread]: On master: COMMIT
[0m11:46:30.001566 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:46:30.026786 [debug] [MainThread]: On master: Close
[0m11:46:30.096386 [debug] [Thread-1 (]: Began running node model.my_dbt_project.customer_dimension
[0m11:46:30.116694 [info ] [Thread-1 (]: 1 of 6 START sql view model main.customer_dimension ............................ [RUN]
[0m11:46:30.126758 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.my_dbt_project.customer_dimension'
[0m11:46:30.129501 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.customer_dimension
[0m11:46:30.160303 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.customer_dimension"
[0m11:46:30.180627 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.customer_dimension
[0m11:46:30.297115 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.customer_dimension"
[0m11:46:30.316588 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m11:46:30.319507 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: BEGIN
[0m11:46:30.321949 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:46:30.403303 [debug] [Thread-1 (]: SQL status: OK in 0.081 seconds
[0m11:46:30.414589 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m11:46:30.424938 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */

  
  create view "sales_database"."main"."customer_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
    DISTINCT
    customer AS customer_id,
    customer_name,
    customer_address,
    customer_group,
    territory,
    language AS customer_language
FROM sales
WHERE customer IS NOT NULL
  );

[0m11:46:30.440016 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m11:46:30.482601 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m11:46:30.484378 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */
alter view "sales_database"."main"."customer_dimension" rename to "customer_dimension__dbt_backup"
[0m11:46:30.494978 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m11:46:30.507023 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m11:46:30.509173 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */
alter view "sales_database"."main"."customer_dimension__dbt_tmp" rename to "customer_dimension"
[0m11:46:30.515678 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:46:30.570451 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: COMMIT
[0m11:46:30.572624 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m11:46:30.574573 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: COMMIT
[0m11:46:30.591576 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m11:46:30.613148 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m11:46:30.615371 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */
drop view if exists "sales_database"."main"."customer_dimension__dbt_backup" cascade
[0m11:46:30.621552 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m11:46:30.636301 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: Close
[0m11:46:30.814972 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '62f7bc3c-08b0-4bcf-896f-fe0ccee1ac0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f871a1cd970>]}
[0m11:46:30.832120 [info ] [Thread-1 (]: 1 of 6 OK created sql view model main.customer_dimension ....................... [[32mOK[0m in 0.67s]
[0m11:46:30.841124 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.customer_dimension
[0m11:46:30.843535 [debug] [Thread-1 (]: Began running node model.my_dbt_project.date_dimension
[0m11:46:30.847817 [info ] [Thread-1 (]: 2 of 6 START sql view model main.date_dimension ................................ [RUN]
[0m11:46:30.856433 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customer_dimension, now model.my_dbt_project.date_dimension)
[0m11:46:30.860030 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.date_dimension
[0m11:46:30.871270 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.date_dimension"
[0m11:46:30.893640 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.date_dimension
[0m11:46:30.913866 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.date_dimension"
[0m11:46:30.945365 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m11:46:30.947512 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: BEGIN
[0m11:46:30.955776 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:46:31.016259 [debug] [Thread-1 (]: SQL status: OK in 0.060 seconds
[0m11:46:31.018883 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m11:46:31.022363 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.date_dimension"} */

  
  create view "sales_database"."main"."date_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)
SELECT
    transaction_date,
    strftime(transaction_date, '%Y-%m-%d') AS date_id,  -- Change the format to YYYY-MM-DD
    strftime(transaction_date, '%A') AS weekday_name,
    strftime(transaction_date, '%m') AS month,
    strftime(transaction_date, '%Y') AS year,
    strftime(transaction_date, '%d') AS day,
    EXTRACT(QUARTER FROM transaction_date) AS quarter
FROM sales
WHERE transaction_date IS NOT NULL
  );

[0m11:46:31.029467 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m11:46:31.050736 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m11:46:31.053121 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.date_dimension"} */
alter view "sales_database"."main"."date_dimension" rename to "date_dimension__dbt_backup"
[0m11:46:31.058063 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:46:31.077562 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m11:46:31.079575 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.date_dimension"} */
alter view "sales_database"."main"."date_dimension__dbt_tmp" rename to "date_dimension"
[0m11:46:31.088477 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:46:31.104594 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: COMMIT
[0m11:46:31.107617 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m11:46:31.113172 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: COMMIT
[0m11:46:31.138438 [debug] [Thread-1 (]: SQL status: OK in 0.019 seconds
[0m11:46:31.170444 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m11:46:31.176765 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.date_dimension"} */
drop view if exists "sales_database"."main"."date_dimension__dbt_backup" cascade
[0m11:46:31.184279 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m11:46:31.190178 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: Close
[0m11:46:31.296223 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '62f7bc3c-08b0-4bcf-896f-fe0ccee1ac0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8718d35df0>]}
[0m11:46:31.300353 [info ] [Thread-1 (]: 2 of 6 OK created sql view model main.date_dimension ........................... [[32mOK[0m in 0.44s]
[0m11:46:31.307353 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.date_dimension
[0m11:46:31.312458 [debug] [Thread-1 (]: Began running node model.my_dbt_project.product_dimension
[0m11:46:31.314702 [info ] [Thread-1 (]: 3 of 6 START sql view model main.product_dimension ............................. [RUN]
[0m11:46:31.316829 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.date_dimension, now model.my_dbt_project.product_dimension)
[0m11:46:31.320350 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.product_dimension
[0m11:46:31.374710 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.product_dimension"
[0m11:46:31.451938 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.product_dimension
[0m11:46:31.520517 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.product_dimension"
[0m11:46:31.549356 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m11:46:31.552021 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: BEGIN
[0m11:46:31.558869 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:46:31.660264 [debug] [Thread-1 (]: SQL status: OK in 0.098 seconds
[0m11:46:31.662314 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m11:46:31.664493 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.product_dimension"} */

  
  create view "sales_database"."main"."product_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * 
    FROM "sales_database"."main"."sales"
)

SELECT 
    sales.name,
    item->>'name' AS product_name,  -- Extract 'name' from each element in the JSON array
    item->>'item_code' AS product_item_code  -- Extract 'item_code' from each element in the JSON array
FROM sales,
LATERAL json_each(sales.items) AS item  -- Unnest the JSON array `items` for each sale
WHERE item->>'name' IS NOT NULL  -- Filter for items that have a 'name' field
  );

[0m11:46:31.704706 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.product_dimension"} */

  
  create view "sales_database"."main"."product_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * 
    FROM "sales_database"."main"."sales"
)

SELECT 
    sales.name,
    item->>'name' AS product_name,  -- Extract 'name' from each element in the JSON array
    item->>'item_code' AS product_item_code  -- Extract 'item_code' from each element in the JSON array
FROM sales,
LATERAL json_each(sales.items) AS item  -- Unnest the JSON array `items` for each sale
WHERE item->>'name' IS NOT NULL  -- Filter for items that have a 'name' field
  );

[0m11:46:31.711343 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m11:46:31.714553 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: ROLLBACK
[0m11:46:31.771123 [debug] [Thread-1 (]: Failed to rollback 'model.my_dbt_project.product_dimension'
[0m11:46:31.773505 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: Close
[0m11:46:31.813850 [debug] [Thread-1 (]: Runtime Error in model product_dimension (models/dimensions/product_dimension.sql)
  Catalog Error: Table Function with name json_each does not exist!
  Did you mean "json_execute_serialized_sql"?
  LINE 15: LATERAL json_each(sales.items) AS item  -- Unnest the JSON array `items` for each sale
  WHERE item->>'name' IS NOT NULL  -- Filter for items that have a 'name' field
    );
  ...
                   ^
[0m11:46:31.817579 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '62f7bc3c-08b0-4bcf-896f-fe0ccee1ac0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86f97284a0>]}
[0m11:46:31.820581 [error] [Thread-1 (]: 3 of 6 ERROR creating sql view model main.product_dimension .................... [[31mERROR[0m in 0.50s]
[0m11:46:31.826124 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.product_dimension
[0m11:46:31.829250 [debug] [Thread-1 (]: Began running node model.my_dbt_project.sales_team_dimension
[0m11:46:31.832382 [debug] [Thread-4 (]: Marking all children of 'model.my_dbt_project.product_dimension' to be skipped because of status 'error'.  Reason: Runtime Error in model product_dimension (models/dimensions/product_dimension.sql)
  Catalog Error: Table Function with name json_each does not exist!
  Did you mean "json_execute_serialized_sql"?
  LINE 15: LATERAL json_each(sales.items) AS item  -- Unnest the JSON array `items` for each sale
  WHERE item->>'name' IS NOT NULL  -- Filter for items that have a 'name' field
    );
  ...
                   ^.
[0m11:46:31.834734 [info ] [Thread-1 (]: 4 of 6 START sql view model main.sales_team_dimension .......................... [RUN]
[0m11:46:31.840302 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.product_dimension, now model.my_dbt_project.sales_team_dimension)
[0m11:46:31.842357 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.sales_team_dimension
[0m11:46:31.857455 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.sales_team_dimension"
[0m11:46:31.907933 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.sales_team_dimension
[0m11:46:31.938423 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.sales_team_dimension"
[0m11:46:31.988948 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m11:46:31.991672 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: BEGIN
[0m11:46:31.994404 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:46:32.083999 [debug] [Thread-1 (]: SQL status: OK in 0.075 seconds
[0m11:46:32.088713 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m11:46:32.091382 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */

  
  create view "sales_database"."main"."sales_team_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
    DISTINCT
    sales_team->>'name' AS sales_team_id,
    sales_team->>'region' AS sales_team_region
FROM sales
WHERE sales_team IS NOT NULL
  );

[0m11:46:32.095459 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:46:32.127183 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m11:46:32.131110 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */
alter view "sales_database"."main"."sales_team_dimension" rename to "sales_team_dimension__dbt_backup"
[0m11:46:32.141611 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:46:32.171658 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m11:46:32.175089 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */
alter view "sales_database"."main"."sales_team_dimension__dbt_tmp" rename to "sales_team_dimension"
[0m11:46:32.181933 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:46:32.192449 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: COMMIT
[0m11:46:32.200303 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m11:46:32.203492 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: COMMIT
[0m11:46:32.222486 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m11:46:32.239984 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m11:46:32.244622 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */
drop view if exists "sales_database"."main"."sales_team_dimension__dbt_backup" cascade
[0m11:46:32.257103 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m11:46:32.263240 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: Close
[0m11:46:32.365558 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '62f7bc3c-08b0-4bcf-896f-fe0ccee1ac0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8718d360f0>]}
[0m11:46:32.370508 [info ] [Thread-1 (]: 4 of 6 OK created sql view model main.sales_team_dimension ..................... [[32mOK[0m in 0.52s]
[0m11:46:32.376319 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.sales_team_dimension
[0m11:46:32.379435 [debug] [Thread-1 (]: Began running node model.my_dbt_project.transform_sales
[0m11:46:32.382381 [info ] [Thread-1 (]: 5 of 6 START sql table model main.transform_sales .............................. [RUN]
[0m11:46:32.385999 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.sales_team_dimension, now model.my_dbt_project.transform_sales)
[0m11:46:32.395942 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.transform_sales
[0m11:46:32.413676 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.transform_sales"
[0m11:46:32.431688 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.transform_sales
[0m11:46:32.537841 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.transform_sales"
[0m11:46:32.563174 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m11:46:32.565035 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: BEGIN
[0m11:46:32.568622 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:46:32.619099 [debug] [Thread-1 (]: SQL status: OK in 0.050 seconds
[0m11:46:32.621262 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m11:46:32.628144 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */

  
    
    

    create  table
      "sales_database"."main"."transform_sales__dbt_tmp"
  
    as (
      -- /opt/airflow/dags/dbt_models/transform_users.sql


WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
   *
FROM sales
WHERE name = 'ABC private LTD-0002'
    );
  
  
[0m11:46:32.668007 [debug] [Thread-1 (]: SQL status: OK in 0.037 seconds
[0m11:46:32.686890 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m11:46:32.689077 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */
alter table "sales_database"."main"."transform_sales" rename to "transform_sales__dbt_backup"
[0m11:46:32.695487 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:46:32.712527 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m11:46:32.714664 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */
alter table "sales_database"."main"."transform_sales__dbt_tmp" rename to "transform_sales"
[0m11:46:32.719297 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:46:32.751821 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: COMMIT
[0m11:46:32.754307 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m11:46:32.757099 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: COMMIT
[0m11:46:32.772039 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m11:46:32.793745 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m11:46:32.800026 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */
drop table if exists "sales_database"."main"."transform_sales__dbt_backup" cascade
[0m11:46:32.811032 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m11:46:32.819202 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: Close
[0m11:46:32.968538 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '62f7bc3c-08b0-4bcf-896f-fe0ccee1ac0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86f9794ef0>]}
[0m11:46:32.971630 [info ] [Thread-1 (]: 5 of 6 OK created sql table model main.transform_sales ......................... [[32mOK[0m in 0.58s]
[0m11:46:32.978338 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.transform_sales
[0m11:46:32.985240 [debug] [Thread-1 (]: Began running node model.my_dbt_project.sales_fact
[0m11:46:32.993051 [info ] [Thread-1 (]: 6 of 6 SKIP relation main.sales_fact ........................................... [[33mSKIP[0m]
[0m11:46:33.005578 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.sales_fact
[0m11:46:33.012367 [debug] [MainThread]: Using duckdb connection "master"
[0m11:46:33.016307 [debug] [MainThread]: On master: BEGIN
[0m11:46:33.019915 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:46:33.083975 [debug] [MainThread]: SQL status: OK in 0.064 seconds
[0m11:46:33.086092 [debug] [MainThread]: On master: COMMIT
[0m11:46:33.087929 [debug] [MainThread]: Using duckdb connection "master"
[0m11:46:33.089686 [debug] [MainThread]: On master: COMMIT
[0m11:46:33.101400 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:46:33.105369 [debug] [MainThread]: On master: Close
[0m11:46:33.131799 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:46:33.140354 [debug] [MainThread]: Connection 'create_sales_database_main' was properly closed.
[0m11:46:33.142168 [debug] [MainThread]: Connection 'list_sales_database_main' was properly closed.
[0m11:46:33.147309 [debug] [MainThread]: Connection 'model.my_dbt_project.transform_sales' was properly closed.
[0m11:46:33.157692 [info ] [MainThread]: 
[0m11:46:33.161643 [info ] [MainThread]: Finished running 2 table models, 4 view models in 0 hours 0 minutes and 5.34 seconds (5.34s).
[0m11:46:33.179179 [debug] [MainThread]: Command end result
[0m11:46:33.500952 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m11:46:33.522414 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m11:46:33.582146 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dags/dbt_models/target/run_results.json
[0m11:46:33.586415 [info ] [MainThread]: 
[0m11:46:33.593960 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m11:46:33.601488 [info ] [MainThread]: 
[0m11:46:33.612786 [error] [MainThread]:   Runtime Error in model product_dimension (models/dimensions/product_dimension.sql)
  Catalog Error: Table Function with name json_each does not exist!
  Did you mean "json_execute_serialized_sql"?
  LINE 15: LATERAL json_each(sales.items) AS item  -- Unnest the JSON array `items` for each sale
  WHERE item->>'name' IS NOT NULL  -- Filter for items that have a 'name' field
    );
  ...
                   ^
[0m11:46:33.632006 [info ] [MainThread]: 
[0m11:46:33.639076 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=1 TOTAL=6
[0m11:46:33.643265 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 40.155136, "process_in_blocks": "668360", "process_kernel_time": 5.073913, "process_mem_max_rss": "149384", "process_out_blocks": "0", "process_user_time": 18.900078}
[0m11:46:33.650024 [debug] [MainThread]: Command `dbt run` failed at 11:46:33.649646 after 40.16 seconds
[0m11:46:33.654900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8720498c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8720e4ade0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f872045d790>]}
[0m11:46:33.657162 [debug] [MainThread]: Flushing usage events
[0m11:46:35.657722 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:51:03.557923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17b385d280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17b390d730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17b3bfe7b0>]}


============================== 11:51:03.667158 | 4d9389b1-eefa-403b-8f34-2043a1aab7ff ==============================
[0m11:51:03.667158 [info ] [MainThread]: Running with dbt=1.9.1
[0m11:51:03.716765 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt/profiles.yml', 'log_path': '/opt/airflow/dags/dbt_models/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt/profiles.yml --target dev', 'send_anonymous_usage_stats': 'True'}
[0m11:51:07.143890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4d9389b1-eefa-403b-8f34-2043a1aab7ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17b3549eb0>]}
[0m11:51:07.460124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4d9389b1-eefa-403b-8f34-2043a1aab7ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17b3c95c40>]}
[0m11:51:07.506755 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m11:51:08.891073 [debug] [MainThread]: checksum: cac3b9519010e47bfbeb71ca6efb4867dae2858687671594dc23fefc94ecf25d, vars: {}, profile: , target: dev, version: 1.9.1
[0m11:51:10.126075 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:51:10.128550 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/dimensions/product_dimension.sql
[0m11:51:11.190610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4d9389b1-eefa-403b-8f34-2043a1aab7ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17afd13e90>]}
[0m11:51:11.471312 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m11:51:11.488024 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m11:51:11.638260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4d9389b1-eefa-403b-8f34-2043a1aab7ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17b49d8ef0>]}
[0m11:51:11.640501 [info ] [MainThread]: Found 6 models, 1 source, 424 macros
[0m11:51:11.642848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4d9389b1-eefa-403b-8f34-2043a1aab7ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17adb55bb0>]}
[0m11:51:11.650631 [info ] [MainThread]: 
[0m11:51:11.661206 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:51:11.665348 [info ] [MainThread]: 
[0m11:51:11.668669 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:51:11.685732 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_sales_database'
[0m11:51:11.863584 [debug] [ThreadPool]: Using duckdb connection "list_sales_database"
[0m11:51:11.865369 [debug] [ThreadPool]: On list_sales_database: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "list_sales_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"sales_database"'
    
  
  
[0m11:51:11.867291 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:51:13.555870 [debug] [ThreadPool]: SQL status: OK in 1.680 seconds
[0m11:51:13.608598 [debug] [ThreadPool]: On list_sales_database: Close
[0m11:51:13.683626 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_database, now create_sales_database_main)
[0m11:51:13.692207 [debug] [ThreadPool]: Creating schema "database: "sales_database"
schema: "main"
"
[0m11:51:13.730642 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m11:51:13.732719 [debug] [ThreadPool]: On create_sales_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "create_sales_database_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='sales_database'
        and type='sqlite'
    
  
[0m11:51:13.734566 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:51:15.750755 [debug] [ThreadPool]: SQL status: OK in 2.005 seconds
[0m11:51:15.871671 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m11:51:15.878264 [debug] [ThreadPool]: On create_sales_database_main: BEGIN
[0m11:51:16.144210 [debug] [ThreadPool]: SQL status: OK in 0.249 seconds
[0m11:51:16.162798 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m11:51:16.165424 [debug] [ThreadPool]: On create_sales_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "create_sales_database_main"} */

    
    
        create schema if not exists "sales_database"."main"
    
[0m11:51:16.482973 [debug] [ThreadPool]: SQL status: OK in 0.298 seconds
[0m11:51:16.496533 [debug] [ThreadPool]: On create_sales_database_main: COMMIT
[0m11:51:16.499380 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m11:51:16.501457 [debug] [ThreadPool]: On create_sales_database_main: COMMIT
[0m11:51:16.643280 [debug] [ThreadPool]: SQL status: OK in 0.125 seconds
[0m11:51:16.661640 [debug] [ThreadPool]: On create_sales_database_main: Close
[0m11:51:16.880123 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_sales_database_main'
[0m11:51:16.977449 [debug] [ThreadPool]: Using duckdb connection "list_sales_database_main"
[0m11:51:16.988264 [debug] [ThreadPool]: On list_sales_database_main: BEGIN
[0m11:51:16.991629 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:51:19.752257 [debug] [ThreadPool]: SQL status: OK in 2.734 seconds
[0m11:51:19.773742 [debug] [ThreadPool]: Using duckdb connection "list_sales_database_main"
[0m11:51:19.776801 [debug] [ThreadPool]: On list_sales_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "list_sales_database_main"} */
select
      'sales_database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'sales_database'
  
[0m11:51:38.970773 [debug] [ThreadPool]: SQL status: OK in 19.188 seconds
[0m11:51:38.958485 [debug] [ThreadPool]: On list_sales_database_main: ROLLBACK
[0m11:51:38.976351 [debug] [ThreadPool]: Failed to rollback 'list_sales_database_main'
[0m11:51:38.978256 [debug] [ThreadPool]: On list_sales_database_main: Close
[0m11:51:39.002266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4d9389b1-eefa-403b-8f34-2043a1aab7ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17ad530fe0>]}
[0m11:51:39.004623 [debug] [MainThread]: Using duckdb connection "master"
[0m11:51:39.006537 [debug] [MainThread]: On master: BEGIN
[0m11:51:39.008585 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:51:39.147925 [debug] [MainThread]: SQL status: OK in 0.139 seconds
[0m11:51:39.149679 [debug] [MainThread]: On master: COMMIT
[0m11:51:39.151621 [debug] [MainThread]: Using duckdb connection "master"
[0m11:51:39.153334 [debug] [MainThread]: On master: COMMIT
[0m11:51:39.155674 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:51:39.157532 [debug] [MainThread]: On master: Close
[0m11:51:39.170479 [debug] [Thread-1 (]: Began running node model.my_dbt_project.customer_dimension
[0m11:51:39.172585 [info ] [Thread-1 (]: 1 of 6 START sql view model main.customer_dimension ............................ [RUN]
[0m11:51:39.175170 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.my_dbt_project.customer_dimension'
[0m11:51:39.180829 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.customer_dimension
[0m11:51:39.219047 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.customer_dimension"
[0m11:51:39.237244 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.customer_dimension
[0m11:51:39.678983 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.customer_dimension"
[0m11:51:39.797009 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m11:51:39.816757 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: BEGIN
[0m11:51:39.819390 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:51:40.137226 [debug] [Thread-1 (]: SQL status: OK in 0.318 seconds
[0m11:51:40.146460 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m11:51:40.150067 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */

  
  create view "sales_database"."main"."customer_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
    DISTINCT
    customer AS customer_id,
    customer_name,
    customer_address,
    customer_group,
    territory,
    language AS customer_language
FROM sales
WHERE customer IS NOT NULL
  );

[0m11:51:40.299806 [debug] [Thread-1 (]: SQL status: OK in 0.094 seconds
[0m11:51:40.429024 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m11:51:40.465968 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */
alter view "sales_database"."main"."customer_dimension" rename to "customer_dimension__dbt_backup"
[0m11:51:40.481973 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m11:51:40.503349 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m11:51:40.520062 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */
alter view "sales_database"."main"."customer_dimension__dbt_tmp" rename to "customer_dimension"
[0m11:51:40.551084 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:51:40.797797 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: COMMIT
[0m11:51:40.803491 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m11:51:40.829591 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: COMMIT
[0m11:51:40.997303 [debug] [Thread-1 (]: SQL status: OK in 0.162 seconds
[0m11:51:41.076396 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m11:51:41.090400 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */
drop view if exists "sales_database"."main"."customer_dimension__dbt_backup" cascade
[0m11:51:41.128856 [debug] [Thread-1 (]: SQL status: OK in 0.036 seconds
[0m11:51:41.150533 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: Close
[0m11:51:41.555548 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d9389b1-eefa-403b-8f34-2043a1aab7ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17ac163fe0>]}
[0m11:51:41.563041 [info ] [Thread-1 (]: 1 of 6 OK created sql view model main.customer_dimension ....................... [[32mOK[0m in 2.31s]
[0m11:51:41.592884 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.customer_dimension
[0m11:51:41.609554 [debug] [Thread-1 (]: Began running node model.my_dbt_project.date_dimension
[0m11:51:41.625368 [info ] [Thread-1 (]: 2 of 6 START sql view model main.date_dimension ................................ [RUN]
[0m11:51:41.630654 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customer_dimension, now model.my_dbt_project.date_dimension)
[0m11:51:41.642772 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.date_dimension
[0m11:51:41.666112 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.date_dimension"
[0m11:51:41.725006 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.date_dimension
[0m11:51:41.768968 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.date_dimension"
[0m11:51:41.824949 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m11:51:41.827528 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: BEGIN
[0m11:51:41.829541 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:51:41.893204 [debug] [Thread-1 (]: SQL status: OK in 0.063 seconds
[0m11:51:41.895356 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m11:51:41.897468 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.date_dimension"} */

  
  create view "sales_database"."main"."date_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)
SELECT
    transaction_date,
    strftime(transaction_date, '%Y-%m-%d') AS date_id,  -- Change the format to YYYY-MM-DD
    strftime(transaction_date, '%A') AS weekday_name,
    strftime(transaction_date, '%m') AS month,
    strftime(transaction_date, '%Y') AS year,
    strftime(transaction_date, '%d') AS day,
    EXTRACT(QUARTER FROM transaction_date) AS quarter
FROM sales
WHERE transaction_date IS NOT NULL
  );

[0m11:51:42.114776 [debug] [Thread-1 (]: SQL status: OK in 0.215 seconds
[0m11:51:42.152569 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m11:51:42.160992 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.date_dimension"} */
alter view "sales_database"."main"."date_dimension" rename to "date_dimension__dbt_backup"
[0m11:51:42.164954 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:51:42.197547 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m11:51:42.199952 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.date_dimension"} */
alter view "sales_database"."main"."date_dimension__dbt_tmp" rename to "date_dimension"
[0m11:51:42.204799 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:51:42.250266 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: COMMIT
[0m11:51:42.253892 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m11:51:42.257532 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: COMMIT
[0m11:51:42.324514 [debug] [Thread-1 (]: SQL status: OK in 0.053 seconds
[0m11:51:42.364713 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m11:51:42.375991 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.date_dimension"} */
drop view if exists "sales_database"."main"."date_dimension__dbt_backup" cascade
[0m11:51:42.424452 [debug] [Thread-1 (]: SQL status: OK in 0.045 seconds
[0m11:51:42.431093 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: Close
[0m11:51:42.645615 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d9389b1-eefa-403b-8f34-2043a1aab7ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f178ffff410>]}
[0m11:51:42.663969 [info ] [Thread-1 (]: 2 of 6 OK created sql view model main.date_dimension ........................... [[32mOK[0m in 1.01s]
[0m11:51:42.679449 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.date_dimension
[0m11:51:42.682601 [debug] [Thread-1 (]: Began running node model.my_dbt_project.product_dimension
[0m11:51:42.698540 [info ] [Thread-1 (]: 3 of 6 START sql view model main.product_dimension ............................. [RUN]
[0m11:51:42.715093 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.date_dimension, now model.my_dbt_project.product_dimension)
[0m11:51:42.717381 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.product_dimension
[0m11:51:42.743500 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.product_dimension"
[0m11:51:42.792674 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.product_dimension
[0m11:51:42.822765 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.product_dimension"
[0m11:51:43.060972 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m11:51:43.063393 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: BEGIN
[0m11:51:43.095977 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:51:43.258929 [debug] [Thread-1 (]: SQL status: OK in 0.175 seconds
[0m11:51:43.277560 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m11:51:43.285096 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.product_dimension"} */

  
  create view "sales_database"."main"."product_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * 
    FROM "sales_database"."main"."sales"
)

SELECT 
    sales.name,
    json_extract(items, '$[' || i || '].name') AS product_name,  -- Extract the name field from each element in the array
    json_extract(items, '$[' || i || '].item_code') AS product_item_code  -- Extract the item_code field from each element
FROM sales,
LATERAL (SELECT generate_series(0, json_array_length(sales.items) - 1) AS i) AS series  -- Generate indices for the JSON array
WHERE json_extract(items, '$[' || i || '].name') IS NOT NULL  -- Filter for non-null 'name'
  );

[0m11:51:43.424503 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.product_dimension"} */

  
  create view "sales_database"."main"."product_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * 
    FROM "sales_database"."main"."sales"
)

SELECT 
    sales.name,
    json_extract(items, '$[' || i || '].name') AS product_name,  -- Extract the name field from each element in the array
    json_extract(items, '$[' || i || '].item_code') AS product_item_code  -- Extract the item_code field from each element
FROM sales,
LATERAL (SELECT generate_series(0, json_array_length(sales.items) - 1) AS i) AS series  -- Generate indices for the JSON array
WHERE json_extract(items, '$[' || i || '].name') IS NOT NULL  -- Filter for non-null 'name'
  );

[0m11:51:43.437494 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m11:51:43.451423 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: ROLLBACK
[0m11:51:43.608638 [debug] [Thread-1 (]: Failed to rollback 'model.my_dbt_project.product_dimension'
[0m11:51:43.671858 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: Close
[0m11:51:43.751212 [debug] [Thread-1 (]: Runtime Error in model product_dimension (models/dimensions/product_dimension.sql)
  Binder Error: No function matches the given name and argument types 'generate_series(INTEGER_LITERAL, UBIGINT)'. You might need to add explicit type casts.
  	Candidate functions:
  	generate_series(BIGINT) -> BIGINT[]
  	generate_series(BIGINT, BIGINT) -> BIGINT[]
  	generate_series(BIGINT, BIGINT, BIGINT) -> BIGINT[]
  	generate_series(TIMESTAMP, TIMESTAMP, INTERVAL) -> TIMESTAMP[]
  	generate_series(TIMESTAMP WITH TIME ZONE, TIMESTAMP WITH TIME ZONE, INTERVAL) -> TIMESTAMP WITH TIME ZONE[]
  
  LINE 15: LATERAL (SELECT generate_series(0, json_array_length(sales.items) - 1) AS i) AS series  -- Generate indices for the JSON array
  WHERE json_extract(items, '$[' || i || '].name') IS NOT NULL  -- Filter for non-null 'name'
    );
  ...
                           ^
[0m11:51:43.786757 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d9389b1-eefa-403b-8f34-2043a1aab7ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f178ff270b0>]}
[0m11:51:43.790629 [error] [Thread-1 (]: 3 of 6 ERROR creating sql view model main.product_dimension .................... [[31mERROR[0m in 1.08s]
[0m11:51:43.841605 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.product_dimension
[0m11:51:43.862657 [debug] [Thread-1 (]: Began running node model.my_dbt_project.sales_team_dimension
[0m11:51:43.895502 [info ] [Thread-1 (]: 4 of 6 START sql view model main.sales_team_dimension .......................... [RUN]
[0m11:51:43.900264 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.product_dimension, now model.my_dbt_project.sales_team_dimension)
[0m11:51:43.868476 [debug] [Thread-4 (]: Marking all children of 'model.my_dbt_project.product_dimension' to be skipped because of status 'error'.  Reason: Runtime Error in model product_dimension (models/dimensions/product_dimension.sql)
  Binder Error: No function matches the given name and argument types 'generate_series(INTEGER_LITERAL, UBIGINT)'. You might need to add explicit type casts.
  	Candidate functions:
  	generate_series(BIGINT) -> BIGINT[]
  	generate_series(BIGINT, BIGINT) -> BIGINT[]
  	generate_series(BIGINT, BIGINT, BIGINT) -> BIGINT[]
  	generate_series(TIMESTAMP, TIMESTAMP, INTERVAL) -> TIMESTAMP[]
  	generate_series(TIMESTAMP WITH TIME ZONE, TIMESTAMP WITH TIME ZONE, INTERVAL) -> TIMESTAMP WITH TIME ZONE[]
  
  LINE 15: LATERAL (SELECT generate_series(0, json_array_length(sales.items) - 1) AS i) AS series  -- Generate indices for the JSON array
  WHERE json_extract(items, '$[' || i || '].name') IS NOT NULL  -- Filter for non-null 'name'
    );
  ...
                           ^.
[0m11:51:43.903005 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.sales_team_dimension
[0m11:51:43.951936 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.sales_team_dimension"
[0m11:51:44.275746 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.sales_team_dimension
[0m11:51:44.307312 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.sales_team_dimension"
[0m11:51:44.341196 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m11:51:44.343592 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: BEGIN
[0m11:51:44.346295 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:51:44.603256 [debug] [Thread-1 (]: SQL status: OK in 0.257 seconds
[0m11:51:44.617850 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m11:51:44.622076 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */

  
  create view "sales_database"."main"."sales_team_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
    DISTINCT
    sales_team->>'name' AS sales_team_id,
    sales_team->>'region' AS sales_team_region
FROM sales
WHERE sales_team IS NOT NULL
  );

[0m11:51:44.658279 [debug] [Thread-1 (]: SQL status: OK in 0.029 seconds
[0m11:51:44.688186 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m11:51:44.690597 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */
alter view "sales_database"."main"."sales_team_dimension" rename to "sales_team_dimension__dbt_backup"
[0m11:51:44.693370 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:51:44.722175 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m11:51:44.724544 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */
alter view "sales_database"."main"."sales_team_dimension__dbt_tmp" rename to "sales_team_dimension"
[0m11:51:44.728188 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:51:44.742776 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: COMMIT
[0m11:51:44.746509 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m11:51:44.752069 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: COMMIT
[0m11:51:44.791685 [debug] [Thread-1 (]: SQL status: OK in 0.033 seconds
[0m11:51:44.805704 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m11:51:44.807874 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */
drop view if exists "sales_database"."main"."sales_team_dimension__dbt_backup" cascade
[0m11:51:44.834885 [debug] [Thread-1 (]: SQL status: OK in 0.025 seconds
[0m11:51:44.840547 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: Close
[0m11:51:45.005370 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d9389b1-eefa-403b-8f34-2043a1aab7ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f178ff1ce00>]}
[0m11:51:45.008756 [info ] [Thread-1 (]: 4 of 6 OK created sql view model main.sales_team_dimension ..................... [[32mOK[0m in 1.11s]
[0m11:51:45.011238 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.sales_team_dimension
[0m11:51:45.012955 [debug] [Thread-1 (]: Began running node model.my_dbt_project.transform_sales
[0m11:51:45.015230 [info ] [Thread-1 (]: 5 of 6 START sql table model main.transform_sales .............................. [RUN]
[0m11:51:45.017122 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.sales_team_dimension, now model.my_dbt_project.transform_sales)
[0m11:51:45.018410 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.transform_sales
[0m11:51:45.026214 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.transform_sales"
[0m11:51:45.051586 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.transform_sales
[0m11:51:45.292268 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.transform_sales"
[0m11:51:45.352913 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m11:51:45.366217 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: BEGIN
[0m11:51:45.368218 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:51:45.520316 [debug] [Thread-1 (]: SQL status: OK in 0.152 seconds
[0m11:51:45.537989 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m11:51:45.540110 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */

  
    
    

    create  table
      "sales_database"."main"."transform_sales__dbt_tmp"
  
    as (
      -- /opt/airflow/dags/dbt_models/transform_users.sql


WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
   *
FROM sales
WHERE name = 'ABC private LTD-0002'
    );
  
  
[0m11:51:45.668224 [debug] [Thread-1 (]: SQL status: OK in 0.125 seconds
[0m11:51:45.700849 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m11:51:45.708418 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */
alter table "sales_database"."main"."transform_sales" rename to "transform_sales__dbt_backup"
[0m11:51:45.714471 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m11:51:45.729309 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m11:51:45.731448 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */
alter table "sales_database"."main"."transform_sales__dbt_tmp" rename to "transform_sales"
[0m11:51:45.734445 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:51:45.762786 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: COMMIT
[0m11:51:45.765823 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m11:51:45.767824 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: COMMIT
[0m11:51:45.806731 [debug] [Thread-1 (]: SQL status: OK in 0.035 seconds
[0m11:51:45.815113 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m11:51:45.817216 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */
drop table if exists "sales_database"."main"."transform_sales__dbt_backup" cascade
[0m11:51:45.868411 [debug] [Thread-1 (]: SQL status: OK in 0.049 seconds
[0m11:51:45.873369 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: Close
[0m11:51:46.153598 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d9389b1-eefa-403b-8f34-2043a1aab7ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f178ca165d0>]}
[0m11:51:46.160286 [info ] [Thread-1 (]: 5 of 6 OK created sql table model main.transform_sales ......................... [[32mOK[0m in 1.14s]
[0m11:51:46.164072 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.transform_sales
[0m11:51:46.166340 [debug] [Thread-1 (]: Began running node model.my_dbt_project.sales_fact
[0m11:51:46.169261 [info ] [Thread-1 (]: 6 of 6 SKIP relation main.sales_fact ........................................... [[33mSKIP[0m]
[0m11:51:46.173430 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.sales_fact
[0m11:51:46.180630 [debug] [MainThread]: Using duckdb connection "master"
[0m11:51:46.182387 [debug] [MainThread]: On master: BEGIN
[0m11:51:46.184209 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:51:46.229474 [debug] [MainThread]: SQL status: OK in 0.045 seconds
[0m11:51:46.231475 [debug] [MainThread]: On master: COMMIT
[0m11:51:46.233559 [debug] [MainThread]: Using duckdb connection "master"
[0m11:51:46.235497 [debug] [MainThread]: On master: COMMIT
[0m11:51:46.238175 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:51:46.239857 [debug] [MainThread]: On master: Close
[0m11:51:46.251097 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:51:46.253320 [debug] [MainThread]: Connection 'create_sales_database_main' was properly closed.
[0m11:51:46.258126 [debug] [MainThread]: Connection 'list_sales_database_main' was properly closed.
[0m11:51:46.259972 [debug] [MainThread]: Connection 'model.my_dbt_project.transform_sales' was properly closed.
[0m11:51:46.261970 [info ] [MainThread]: 
[0m11:51:46.265327 [info ] [MainThread]: Finished running 2 table models, 4 view models in 0 hours 0 minutes and 34.59 seconds (34.59s).
[0m11:51:46.271265 [debug] [MainThread]: Command end result
[0m11:51:46.521050 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m11:51:46.600654 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m11:51:46.705979 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dags/dbt_models/target/run_results.json
[0m11:51:46.710171 [info ] [MainThread]: 
[0m11:51:46.712977 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m11:51:46.715891 [info ] [MainThread]: 
[0m11:51:46.720850 [error] [MainThread]:   Runtime Error in model product_dimension (models/dimensions/product_dimension.sql)
  Binder Error: No function matches the given name and argument types 'generate_series(INTEGER_LITERAL, UBIGINT)'. You might need to add explicit type casts.
  	Candidate functions:
  	generate_series(BIGINT) -> BIGINT[]
  	generate_series(BIGINT, BIGINT) -> BIGINT[]
  	generate_series(BIGINT, BIGINT, BIGINT) -> BIGINT[]
  	generate_series(TIMESTAMP, TIMESTAMP, INTERVAL) -> TIMESTAMP[]
  	generate_series(TIMESTAMP WITH TIME ZONE, TIMESTAMP WITH TIME ZONE, INTERVAL) -> TIMESTAMP WITH TIME ZONE[]
  
  LINE 15: LATERAL (SELECT generate_series(0, json_array_length(sales.items) - 1) AS i) AS series  -- Generate indices for the JSON array
  WHERE json_extract(items, '$[' || i || '].name') IS NOT NULL  -- Filter for non-null 'name'
    );
  ...
                           ^
[0m11:51:46.733518 [info ] [MainThread]: 
[0m11:51:46.743021 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=1 TOTAL=6
[0m11:51:46.751889 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 43.813644, "process_in_blocks": "2808768", "process_kernel_time": 8.965736, "process_mem_max_rss": "138740", "process_out_blocks": "0", "process_user_time": 26.534958}
[0m11:51:46.779194 [debug] [MainThread]: Command `dbt run` failed at 11:51:46.778784 after 43.84 seconds
[0m11:51:46.781202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17b3c2edb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17b4179fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17b417af00>]}
[0m11:51:46.784475 [debug] [MainThread]: Flushing usage events
[0m11:51:49.003367 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:56:46.077329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1869b3b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1866fd400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb188867e60>]}


============================== 11:56:46.108342 | 565d4041-8e8d-4725-b104-7eca52858cc8 ==============================
[0m11:56:46.108342 [info ] [MainThread]: Running with dbt=1.9.1
[0m11:56:46.112161 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/profiles.yml', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dags/dbt_models/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt/profiles.yml --target dev', 'send_anonymous_usage_stats': 'True'}
[0m11:56:46.956199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '565d4041-8e8d-4725-b104-7eca52858cc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb18848f5f0>]}
[0m11:56:47.052603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '565d4041-8e8d-4725-b104-7eca52858cc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1869fdc40>]}
[0m11:56:47.064174 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m11:56:47.350584 [debug] [MainThread]: checksum: cac3b9519010e47bfbeb71ca6efb4867dae2858687671594dc23fefc94ecf25d, vars: {}, profile: , target: dev, version: 1.9.1
[0m11:56:48.114275 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:56:48.128275 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/dimensions/product_dimension.sql
[0m11:56:49.365375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '565d4041-8e8d-4725-b104-7eca52858cc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb182b7fda0>]}
[0m11:56:49.705849 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m11:56:49.722808 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m11:56:49.871308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '565d4041-8e8d-4725-b104-7eca52858cc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb18059dbe0>]}
[0m11:56:49.880592 [info ] [MainThread]: Found 6 models, 1 source, 424 macros
[0m11:56:49.883123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '565d4041-8e8d-4725-b104-7eca52858cc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb18610c680>]}
[0m11:56:49.895248 [info ] [MainThread]: 
[0m11:56:49.898536 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:56:49.902659 [info ] [MainThread]: 
[0m11:56:49.907601 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:56:49.940055 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_sales_database'
[0m11:56:50.271420 [debug] [ThreadPool]: Using duckdb connection "list_sales_database"
[0m11:56:50.279082 [debug] [ThreadPool]: On list_sales_database: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "list_sales_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"sales_database"'
    
  
  
[0m11:56:50.281585 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:56:51.392782 [debug] [ThreadPool]: SQL status: OK in 1.091 seconds
[0m11:56:51.470580 [debug] [ThreadPool]: On list_sales_database: Close
[0m11:56:51.708560 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_database, now create_sales_database_main)
[0m11:56:51.719956 [debug] [ThreadPool]: Creating schema "database: "sales_database"
schema: "main"
"
[0m11:56:51.752953 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m11:56:51.758688 [debug] [ThreadPool]: On create_sales_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "create_sales_database_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='sales_database'
        and type='sqlite'
    
  
[0m11:56:51.762059 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:56:53.726800 [debug] [ThreadPool]: SQL status: OK in 1.960 seconds
[0m11:56:53.744851 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m11:56:53.748391 [debug] [ThreadPool]: On create_sales_database_main: BEGIN
[0m11:56:53.833669 [debug] [ThreadPool]: SQL status: OK in 0.078 seconds
[0m11:56:53.840256 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m11:56:53.842213 [debug] [ThreadPool]: On create_sales_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "create_sales_database_main"} */

    
    
        create schema if not exists "sales_database"."main"
    
[0m11:56:53.954985 [debug] [ThreadPool]: SQL status: OK in 0.105 seconds
[0m11:56:53.964669 [debug] [ThreadPool]: On create_sales_database_main: COMMIT
[0m11:56:53.967039 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m11:56:53.969527 [debug] [ThreadPool]: On create_sales_database_main: COMMIT
[0m11:56:54.060210 [debug] [ThreadPool]: SQL status: OK in 0.078 seconds
[0m11:56:54.077110 [debug] [ThreadPool]: On create_sales_database_main: Close
[0m11:56:54.941887 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_sales_database_main, now list_sales_database_main)
[0m11:56:54.970262 [debug] [ThreadPool]: Using duckdb connection "list_sales_database_main"
[0m11:56:54.971474 [debug] [ThreadPool]: On list_sales_database_main: BEGIN
[0m11:56:54.972590 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:56:56.496976 [debug] [ThreadPool]: SQL status: OK in 1.518 seconds
[0m11:56:56.504795 [debug] [ThreadPool]: Using duckdb connection "list_sales_database_main"
[0m11:56:56.506862 [debug] [ThreadPool]: On list_sales_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "list_sales_database_main"} */
select
      'sales_database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'sales_database'
  
[0m11:57:21.407854 [debug] [ThreadPool]: SQL status: OK in 24.884 seconds
[0m11:57:21.449783 [debug] [ThreadPool]: On list_sales_database_main: ROLLBACK
[0m11:57:21.465646 [debug] [ThreadPool]: Failed to rollback 'list_sales_database_main'
[0m11:57:21.467344 [debug] [ThreadPool]: On list_sales_database_main: Close
[0m11:57:21.529777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '565d4041-8e8d-4725-b104-7eca52858cc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb18819b1d0>]}
[0m11:57:21.538599 [debug] [MainThread]: Using duckdb connection "master"
[0m11:57:21.540059 [debug] [MainThread]: On master: BEGIN
[0m11:57:21.541656 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:57:21.908764 [debug] [MainThread]: SQL status: OK in 0.361 seconds
[0m11:57:21.920424 [debug] [MainThread]: On master: COMMIT
[0m11:57:21.922645 [debug] [MainThread]: Using duckdb connection "master"
[0m11:57:21.925128 [debug] [MainThread]: On master: COMMIT
[0m11:57:21.992417 [debug] [MainThread]: SQL status: OK in 0.051 seconds
[0m11:57:22.004466 [debug] [MainThread]: On master: Close
[0m11:57:22.060010 [debug] [Thread-1 (]: Began running node model.my_dbt_project.customer_dimension
[0m11:57:22.063684 [info ] [Thread-1 (]: 1 of 6 START sql view model main.customer_dimension ............................ [RUN]
[0m11:57:22.067506 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.my_dbt_project.customer_dimension'
[0m11:57:22.069918 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.customer_dimension
[0m11:57:22.107149 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.customer_dimension"
[0m11:57:22.140411 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.customer_dimension
[0m11:57:22.229718 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.customer_dimension"
[0m11:57:22.245472 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m11:57:22.247324 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: BEGIN
[0m11:57:22.249062 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:57:23.088497 [debug] [Thread-1 (]: SQL status: OK in 0.871 seconds
[0m11:57:23.091317 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m11:57:23.099292 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */

  
  create view "sales_database"."main"."customer_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
    DISTINCT
    customer AS customer_id,
    customer_name,
    customer_address,
    customer_group,
    territory,
    language AS customer_language
FROM sales
WHERE customer IS NOT NULL
  );

[0m11:57:23.120376 [debug] [Thread-1 (]: SQL status: OK in 0.018 seconds
[0m11:57:23.148912 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m11:57:23.151117 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */
alter view "sales_database"."main"."customer_dimension" rename to "customer_dimension__dbt_backup"
[0m11:57:23.163051 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m11:57:23.177197 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m11:57:23.181843 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */
alter view "sales_database"."main"."customer_dimension__dbt_tmp" rename to "customer_dimension"
[0m11:57:23.184923 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:57:23.276976 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: COMMIT
[0m11:57:23.279464 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m11:57:23.281353 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: COMMIT
[0m11:57:23.303193 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m11:57:23.330830 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m11:57:23.340425 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */
drop view if exists "sales_database"."main"."customer_dimension__dbt_backup" cascade
[0m11:57:23.348089 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m11:57:23.366732 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: Close
[0m11:57:23.524450 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '565d4041-8e8d-4725-b104-7eca52858cc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb18848a390>]}
[0m11:57:23.528498 [info ] [Thread-1 (]: 1 of 6 OK created sql view model main.customer_dimension ....................... [[32mOK[0m in 1.42s]
[0m11:57:23.542803 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.customer_dimension
[0m11:57:23.545586 [debug] [Thread-1 (]: Began running node model.my_dbt_project.date_dimension
[0m11:57:23.559575 [info ] [Thread-1 (]: 2 of 6 START sql view model main.date_dimension ................................ [RUN]
[0m11:57:23.566876 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customer_dimension, now model.my_dbt_project.date_dimension)
[0m11:57:23.569624 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.date_dimension
[0m11:57:23.591008 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.date_dimension"
[0m11:57:23.656505 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.date_dimension
[0m11:57:23.723751 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.date_dimension"
[0m11:57:23.780969 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m11:57:23.787626 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: BEGIN
[0m11:57:23.794415 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:57:24.503961 [debug] [Thread-1 (]: SQL status: OK in 0.705 seconds
[0m11:57:24.513603 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m11:57:24.516969 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.date_dimension"} */

  
  create view "sales_database"."main"."date_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)
SELECT
    transaction_date,
    strftime(transaction_date, '%Y-%m-%d') AS date_id,  -- Change the format to YYYY-MM-DD
    strftime(transaction_date, '%A') AS weekday_name,
    strftime(transaction_date, '%m') AS month,
    strftime(transaction_date, '%Y') AS year,
    strftime(transaction_date, '%d') AS day,
    EXTRACT(QUARTER FROM transaction_date) AS quarter
FROM sales
WHERE transaction_date IS NOT NULL
  );

[0m11:57:24.584753 [debug] [Thread-1 (]: SQL status: OK in 0.064 seconds
[0m11:57:24.619627 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m11:57:24.625253 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.date_dimension"} */
alter view "sales_database"."main"."date_dimension" rename to "date_dimension__dbt_backup"
[0m11:57:24.629375 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:57:24.662219 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m11:57:24.680905 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.date_dimension"} */
alter view "sales_database"."main"."date_dimension__dbt_tmp" rename to "date_dimension"
[0m11:57:24.684117 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:57:24.691979 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: COMMIT
[0m11:57:24.703512 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m11:57:24.706143 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: COMMIT
[0m11:57:24.757636 [debug] [Thread-1 (]: SQL status: OK in 0.043 seconds
[0m11:57:24.778315 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m11:57:24.781877 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.date_dimension"} */
drop view if exists "sales_database"."main"."date_dimension__dbt_backup" cascade
[0m11:57:24.790209 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m11:57:24.816198 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: Close
[0m11:57:24.967234 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '565d4041-8e8d-4725-b104-7eca52858cc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb172dbd340>]}
[0m11:57:24.983529 [info ] [Thread-1 (]: 2 of 6 OK created sql view model main.date_dimension ........................... [[32mOK[0m in 1.40s]
[0m11:57:25.000260 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.date_dimension
[0m11:57:25.004286 [debug] [Thread-1 (]: Began running node model.my_dbt_project.product_dimension
[0m11:57:25.021380 [info ] [Thread-1 (]: 3 of 6 START sql view model main.product_dimension ............................. [RUN]
[0m11:57:25.026524 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.date_dimension, now model.my_dbt_project.product_dimension)
[0m11:57:25.039313 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.product_dimension
[0m11:57:25.066043 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.product_dimension"
[0m11:57:25.112222 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.product_dimension
[0m11:57:25.146942 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.product_dimension"
[0m11:57:25.315382 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m11:57:25.318088 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: BEGIN
[0m11:57:25.320426 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:57:25.719891 [debug] [Thread-1 (]: SQL status: OK in 0.400 seconds
[0m11:57:25.733448 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m11:57:25.736653 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.product_dimension"} */

  
  create view "sales_database"."main"."product_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * 
    FROM "sales_database"."main"."sales"
)

SELECT 
    sales.name,
    json_extract(items, '$[' || i || '].name') AS product_name,  -- Extract the name field from each element in the array
    json_extract(items, '$[' || i || '].item_code') AS product_item_code  -- Extract the item_code field from each element
FROM sales,
LATERAL (SELECT generate_series(CAST(0 AS BIGINT), CAST(json_array_length(sales.items) - 1 AS BIGINT)) AS i) AS series  -- Cast both to BIGINT
WHERE json_extract(items, '$[' || i || '].name') IS NOT NULL  -- Filter for non-null 'name'
;
  );

[0m11:57:25.807146 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.product_dimension"} */

  
  create view "sales_database"."main"."product_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * 
    FROM "sales_database"."main"."sales"
)

SELECT 
    sales.name,
    json_extract(items, '$[' || i || '].name') AS product_name,  -- Extract the name field from each element in the array
    json_extract(items, '$[' || i || '].item_code') AS product_item_code  -- Extract the item_code field from each element
FROM sales,
LATERAL (SELECT generate_series(CAST(0 AS BIGINT), CAST(json_array_length(sales.items) - 1 AS BIGINT)) AS i) AS series  -- Cast both to BIGINT
WHERE json_extract(items, '$[' || i || '].name') IS NOT NULL  -- Filter for non-null 'name'
;
  );

[0m11:57:25.809860 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m11:57:25.823435 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: ROLLBACK
[0m11:57:25.932872 [debug] [Thread-1 (]: Failed to rollback 'model.my_dbt_project.product_dimension'
[0m11:57:25.937791 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: Close
[0m11:57:26.007453 [debug] [Thread-1 (]: Runtime Error in model product_dimension (models/dimensions/product_dimension.sql)
  Parser Error: syntax error at or near ";"
[0m11:57:26.058922 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '565d4041-8e8d-4725-b104-7eca52858cc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb172d0f320>]}
[0m11:57:26.076051 [error] [Thread-1 (]: 3 of 6 ERROR creating sql view model main.product_dimension .................... [[31mERROR[0m in 0.99s]
[0m11:57:26.083560 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.product_dimension
[0m11:57:26.115046 [debug] [Thread-1 (]: Began running node model.my_dbt_project.sales_team_dimension
[0m11:57:26.117728 [debug] [Thread-4 (]: Marking all children of 'model.my_dbt_project.product_dimension' to be skipped because of status 'error'.  Reason: Runtime Error in model product_dimension (models/dimensions/product_dimension.sql)
  Parser Error: syntax error at or near ";".
[0m11:57:26.130288 [info ] [Thread-1 (]: 4 of 6 START sql view model main.sales_team_dimension .......................... [RUN]
[0m11:57:26.150055 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.product_dimension, now model.my_dbt_project.sales_team_dimension)
[0m11:57:26.152428 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.sales_team_dimension
[0m11:57:26.175106 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.sales_team_dimension"
[0m11:57:26.228552 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.sales_team_dimension
[0m11:57:26.263941 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.sales_team_dimension"
[0m11:57:26.378272 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m11:57:26.392337 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: BEGIN
[0m11:57:26.396514 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:57:27.057352 [debug] [Thread-1 (]: SQL status: OK in 0.656 seconds
[0m11:57:27.060500 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m11:57:27.063394 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */

  
  create view "sales_database"."main"."sales_team_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
    DISTINCT
    sales_team->>'name' AS sales_team_id,
    sales_team->>'region' AS sales_team_region
FROM sales
WHERE sales_team IS NOT NULL
  );

[0m11:57:27.093471 [debug] [Thread-1 (]: SQL status: OK in 0.027 seconds
[0m11:57:27.134074 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m11:57:27.143766 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */
alter view "sales_database"."main"."sales_team_dimension" rename to "sales_team_dimension__dbt_backup"
[0m11:57:27.151547 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m11:57:27.175055 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m11:57:27.182117 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */
alter view "sales_database"."main"."sales_team_dimension__dbt_tmp" rename to "sales_team_dimension"
[0m11:57:27.185609 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:57:27.201445 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: COMMIT
[0m11:57:27.207894 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m11:57:27.210832 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: COMMIT
[0m11:57:27.234369 [debug] [Thread-1 (]: SQL status: OK in 0.015 seconds
[0m11:57:27.260520 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m11:57:27.263007 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */
drop view if exists "sales_database"."main"."sales_team_dimension__dbt_backup" cascade
[0m11:57:27.275670 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m11:57:27.283381 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: Close
[0m11:57:27.475938 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '565d4041-8e8d-4725-b104-7eca52858cc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1700d0500>]}
[0m11:57:27.486745 [info ] [Thread-1 (]: 4 of 6 OK created sql view model main.sales_team_dimension ..................... [[32mOK[0m in 1.31s]
[0m11:57:27.491539 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.sales_team_dimension
[0m11:57:27.505019 [debug] [Thread-1 (]: Began running node model.my_dbt_project.transform_sales
[0m11:57:27.508867 [info ] [Thread-1 (]: 5 of 6 START sql table model main.transform_sales .............................. [RUN]
[0m11:57:27.519102 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.sales_team_dimension, now model.my_dbt_project.transform_sales)
[0m11:57:27.527813 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.transform_sales
[0m11:57:27.576254 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.transform_sales"
[0m11:57:27.633066 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.transform_sales
[0m11:57:27.811607 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.transform_sales"
[0m11:57:27.914228 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m11:57:27.935518 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: BEGIN
[0m11:57:27.947618 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:57:28.556696 [debug] [Thread-1 (]: SQL status: OK in 0.591 seconds
[0m11:57:28.578828 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m11:57:28.582272 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */

  
    
    

    create  table
      "sales_database"."main"."transform_sales__dbt_tmp"
  
    as (
      -- /opt/airflow/dags/dbt_models/transform_users.sql


WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
   *
FROM sales
WHERE name = 'ABC private LTD-0002'
    );
  
  
[0m11:57:28.782648 [debug] [Thread-1 (]: SQL status: OK in 0.197 seconds
[0m11:57:28.823738 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m11:57:28.834625 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */
alter table "sales_database"."main"."transform_sales" rename to "transform_sales__dbt_backup"
[0m11:57:28.849930 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m11:57:28.870361 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m11:57:28.872897 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */
alter table "sales_database"."main"."transform_sales__dbt_tmp" rename to "transform_sales"
[0m11:57:28.888986 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:57:28.940093 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: COMMIT
[0m11:57:28.941989 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m11:57:28.944220 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: COMMIT
[0m11:57:28.981700 [debug] [Thread-1 (]: SQL status: OK in 0.033 seconds
[0m11:57:29.000098 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m11:57:29.003293 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */
drop table if exists "sales_database"."main"."transform_sales__dbt_backup" cascade
[0m11:57:29.018308 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m11:57:29.025145 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: Close
[0m11:57:29.304132 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '565d4041-8e8d-4725-b104-7eca52858cc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1700d0830>]}
[0m11:57:29.308579 [info ] [Thread-1 (]: 5 of 6 OK created sql table model main.transform_sales ......................... [[32mOK[0m in 1.76s]
[0m11:57:29.312001 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.transform_sales
[0m11:57:29.316198 [debug] [Thread-1 (]: Began running node model.my_dbt_project.sales_fact
[0m11:57:29.326404 [info ] [Thread-1 (]: 6 of 6 SKIP relation main.sales_fact ........................................... [[33mSKIP[0m]
[0m11:57:29.330402 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.sales_fact
[0m11:57:29.346272 [debug] [MainThread]: Using duckdb connection "master"
[0m11:57:29.354828 [debug] [MainThread]: On master: BEGIN
[0m11:57:29.360676 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:57:29.639339 [debug] [MainThread]: SQL status: OK in 0.278 seconds
[0m11:57:29.641644 [debug] [MainThread]: On master: COMMIT
[0m11:57:29.643810 [debug] [MainThread]: Using duckdb connection "master"
[0m11:57:29.646220 [debug] [MainThread]: On master: COMMIT
[0m11:57:29.659081 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:57:29.661426 [debug] [MainThread]: On master: Close
[0m11:57:29.677448 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:57:29.679688 [debug] [MainThread]: Connection 'list_sales_database_main' was properly closed.
[0m11:57:29.682148 [debug] [MainThread]: Connection 'model.my_dbt_project.transform_sales' was properly closed.
[0m11:57:29.685573 [info ] [MainThread]: 
[0m11:57:29.688751 [info ] [MainThread]: Finished running 2 table models, 4 view models in 0 hours 0 minutes and 39.78 seconds (39.78s).
[0m11:57:29.702868 [debug] [MainThread]: Command end result
[0m11:57:29.966874 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m11:57:30.077709 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m11:57:30.170133 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dags/dbt_models/target/run_results.json
[0m11:57:30.183385 [info ] [MainThread]: 
[0m11:57:30.191112 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m11:57:30.200290 [info ] [MainThread]: 
[0m11:57:30.202767 [error] [MainThread]:   Runtime Error in model product_dimension (models/dimensions/product_dimension.sql)
  Parser Error: syntax error at or near ";"
[0m11:57:30.206424 [info ] [MainThread]: 
[0m11:57:30.209900 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=1 TOTAL=6
[0m11:57:30.259004 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 44.454346, "process_in_blocks": "4502440", "process_kernel_time": 6.293529, "process_mem_max_rss": "130304", "process_out_blocks": "0", "process_user_time": 32.64953}
[0m11:57:30.280197 [debug] [MainThread]: Command `dbt run` failed at 11:57:30.279743 after 44.48 seconds
[0m11:57:30.289430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb189f6b620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1865009b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb170119160>]}
[0m11:57:30.291628 [debug] [MainThread]: Flushing usage events
[0m11:57:32.137454 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:59:18.288641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c85ba1310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c853069f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c85ba3710>]}


============================== 11:59:18.316467 | c7c51480-e0e5-4a1f-8f76-500b5f6eb1ba ==============================
[0m11:59:18.316467 [info ] [MainThread]: Running with dbt=1.9.1
[0m11:59:18.320597 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/profiles.yml', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/dags/dbt_models/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt/profiles.yml --target dev', 'send_anonymous_usage_stats': 'True'}
[0m11:59:20.194558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c7c51480-e0e5-4a1f-8f76-500b5f6eb1ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c84d7f920>]}
[0m11:59:20.440814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c7c51480-e0e5-4a1f-8f76-500b5f6eb1ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c85307860>]}
[0m11:59:20.458643 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m11:59:21.038450 [debug] [MainThread]: checksum: cac3b9519010e47bfbeb71ca6efb4867dae2858687671594dc23fefc94ecf25d, vars: {}, profile: , target: dev, version: 1.9.1
[0m11:59:22.364086 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:59:22.366252 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/dimensions/product_dimension.sql
[0m11:59:23.637062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c7c51480-e0e5-4a1f-8f76-500b5f6eb1ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c7ef77350>]}
[0m11:59:24.121756 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m11:59:24.143162 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m11:59:24.481173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c7c51480-e0e5-4a1f-8f76-500b5f6eb1ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c7f1b4da0>]}
[0m11:59:24.483185 [info ] [MainThread]: Found 6 models, 1 source, 424 macros
[0m11:59:24.485201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c7c51480-e0e5-4a1f-8f76-500b5f6eb1ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c7f023230>]}
[0m11:59:24.491821 [info ] [MainThread]: 
[0m11:59:24.498638 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:59:24.505822 [info ] [MainThread]: 
[0m11:59:24.512759 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:59:24.532464 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_sales_database'
[0m11:59:24.871827 [debug] [ThreadPool]: Using duckdb connection "list_sales_database"
[0m11:59:24.875326 [debug] [ThreadPool]: On list_sales_database: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "list_sales_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"sales_database"'
    
  
  
[0m11:59:24.884352 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:59:25.272146 [debug] [ThreadPool]: SQL status: OK in 0.391 seconds
[0m11:59:25.282260 [debug] [ThreadPool]: On list_sales_database: Close
[0m11:59:25.299748 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_database, now create_sales_database_main)
[0m11:59:25.305813 [debug] [ThreadPool]: Creating schema "database: "sales_database"
schema: "main"
"
[0m11:59:25.334547 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m11:59:25.336892 [debug] [ThreadPool]: On create_sales_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "create_sales_database_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='sales_database'
        and type='sqlite'
    
  
[0m11:59:25.338905 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:59:25.411834 [debug] [ThreadPool]: SQL status: OK in 0.073 seconds
[0m11:59:25.416926 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m11:59:25.418812 [debug] [ThreadPool]: On create_sales_database_main: BEGIN
[0m11:59:25.428957 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m11:59:25.433809 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m11:59:25.437953 [debug] [ThreadPool]: On create_sales_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "create_sales_database_main"} */

    
    
        create schema if not exists "sales_database"."main"
    
[0m11:59:25.442242 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:59:25.451271 [debug] [ThreadPool]: On create_sales_database_main: COMMIT
[0m11:59:25.460252 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m11:59:25.462788 [debug] [ThreadPool]: On create_sales_database_main: COMMIT
[0m11:59:25.474879 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:59:25.478866 [debug] [ThreadPool]: On create_sales_database_main: Close
[0m11:59:25.510045 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_sales_database_main, now list_sales_database_main)
[0m11:59:25.549173 [debug] [ThreadPool]: Using duckdb connection "list_sales_database_main"
[0m11:59:25.550953 [debug] [ThreadPool]: On list_sales_database_main: BEGIN
[0m11:59:25.552804 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:59:25.670242 [debug] [ThreadPool]: SQL status: OK in 0.117 seconds
[0m11:59:25.680348 [debug] [ThreadPool]: Using duckdb connection "list_sales_database_main"
[0m11:59:25.685958 [debug] [ThreadPool]: On list_sales_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "list_sales_database_main"} */
select
      'sales_database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'sales_database'
  
[0m11:59:25.894869 [debug] [ThreadPool]: SQL status: OK in 0.202 seconds
[0m11:59:25.904719 [debug] [ThreadPool]: On list_sales_database_main: ROLLBACK
[0m11:59:25.913238 [debug] [ThreadPool]: Failed to rollback 'list_sales_database_main'
[0m11:59:25.915944 [debug] [ThreadPool]: On list_sales_database_main: Close
[0m11:59:25.930834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c7c51480-e0e5-4a1f-8f76-500b5f6eb1ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c7ef30a40>]}
[0m11:59:25.939134 [debug] [MainThread]: Using duckdb connection "master"
[0m11:59:25.941874 [debug] [MainThread]: On master: BEGIN
[0m11:59:25.949047 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:59:26.056740 [debug] [MainThread]: SQL status: OK in 0.108 seconds
[0m11:59:26.063062 [debug] [MainThread]: On master: COMMIT
[0m11:59:26.067436 [debug] [MainThread]: Using duckdb connection "master"
[0m11:59:26.070504 [debug] [MainThread]: On master: COMMIT
[0m11:59:26.073600 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:59:26.075758 [debug] [MainThread]: On master: Close
[0m11:59:26.123981 [debug] [Thread-1 (]: Began running node model.my_dbt_project.customer_dimension
[0m11:59:26.128671 [info ] [Thread-1 (]: 1 of 6 START sql view model main.customer_dimension ............................ [RUN]
[0m11:59:26.132589 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.my_dbt_project.customer_dimension'
[0m11:59:26.135341 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.customer_dimension
[0m11:59:26.155766 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.customer_dimension"
[0m11:59:26.186248 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.customer_dimension
[0m11:59:26.299638 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.customer_dimension"
[0m11:59:26.316572 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m11:59:26.318031 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: BEGIN
[0m11:59:26.319646 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:59:26.364116 [debug] [Thread-1 (]: SQL status: OK in 0.044 seconds
[0m11:59:26.365715 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m11:59:26.367323 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */

  
  create view "sales_database"."main"."customer_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
    DISTINCT
    customer AS customer_id,
    customer_name,
    customer_address,
    customer_group,
    territory,
    language AS customer_language
FROM sales
WHERE customer IS NOT NULL
  );

[0m11:59:26.437921 [debug] [Thread-1 (]: SQL status: OK in 0.069 seconds
[0m11:59:26.449986 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m11:59:26.451648 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */
alter view "sales_database"."main"."customer_dimension" rename to "customer_dimension__dbt_backup"
[0m11:59:26.490896 [debug] [Thread-1 (]: SQL status: OK in 0.037 seconds
[0m11:59:26.510533 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m11:59:26.512662 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */
alter view "sales_database"."main"."customer_dimension__dbt_tmp" rename to "customer_dimension"
[0m11:59:26.520212 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:59:26.581370 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: COMMIT
[0m11:59:26.583188 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m11:59:26.584456 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: COMMIT
[0m11:59:26.626687 [debug] [Thread-1 (]: SQL status: OK in 0.041 seconds
[0m11:59:26.638429 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m11:59:26.639682 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */
drop view if exists "sales_database"."main"."customer_dimension__dbt_backup" cascade
[0m11:59:26.653615 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m11:59:26.658314 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: Close
[0m11:59:26.960201 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7c51480-e0e5-4a1f-8f76-500b5f6eb1ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c870e3e90>]}
[0m11:59:26.965344 [info ] [Thread-1 (]: 1 of 6 OK created sql view model main.customer_dimension ....................... [[32mOK[0m in 0.82s]
[0m11:59:26.969040 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.customer_dimension
[0m11:59:26.972530 [debug] [Thread-1 (]: Began running node model.my_dbt_project.date_dimension
[0m11:59:26.981688 [info ] [Thread-1 (]: 2 of 6 START sql view model main.date_dimension ................................ [RUN]
[0m11:59:26.988605 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customer_dimension, now model.my_dbt_project.date_dimension)
[0m11:59:27.014167 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.date_dimension
[0m11:59:27.032460 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.date_dimension"
[0m11:59:27.106022 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.date_dimension
[0m11:59:27.130028 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.date_dimension"
[0m11:59:27.156658 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m11:59:27.158867 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: BEGIN
[0m11:59:27.161056 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:59:27.251762 [debug] [Thread-1 (]: SQL status: OK in 0.090 seconds
[0m11:59:27.273157 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m11:59:27.281952 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.date_dimension"} */

  
  create view "sales_database"."main"."date_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)
SELECT
    transaction_date,
    strftime(transaction_date, '%Y-%m-%d') AS date_id,  -- Change the format to YYYY-MM-DD
    strftime(transaction_date, '%A') AS weekday_name,
    strftime(transaction_date, '%m') AS month,
    strftime(transaction_date, '%Y') AS year,
    strftime(transaction_date, '%d') AS day,
    EXTRACT(QUARTER FROM transaction_date) AS quarter
FROM sales
WHERE transaction_date IS NOT NULL
  );

[0m11:59:27.384695 [debug] [Thread-1 (]: SQL status: OK in 0.086 seconds
[0m11:59:27.427125 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m11:59:27.431000 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.date_dimension"} */
alter view "sales_database"."main"."date_dimension" rename to "date_dimension__dbt_backup"
[0m11:59:27.443141 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m11:59:27.457412 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m11:59:27.460441 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.date_dimension"} */
alter view "sales_database"."main"."date_dimension__dbt_tmp" rename to "date_dimension"
[0m11:59:27.464240 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:59:27.474961 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: COMMIT
[0m11:59:27.477631 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m11:59:27.485500 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: COMMIT
[0m11:59:27.527398 [debug] [Thread-1 (]: SQL status: OK in 0.039 seconds
[0m11:59:27.549428 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m11:59:27.555377 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.date_dimension"} */
drop view if exists "sales_database"."main"."date_dimension__dbt_backup" cascade
[0m11:59:27.567713 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m11:59:27.574191 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: Close
[0m11:59:27.692664 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7c51480-e0e5-4a1f-8f76-500b5f6eb1ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c7c12bd70>]}
[0m11:59:27.696546 [info ] [Thread-1 (]: 2 of 6 OK created sql view model main.date_dimension ........................... [[32mOK[0m in 0.70s]
[0m11:59:27.700172 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.date_dimension
[0m11:59:27.706031 [debug] [Thread-1 (]: Began running node model.my_dbt_project.product_dimension
[0m11:59:27.709147 [info ] [Thread-1 (]: 3 of 6 START sql view model main.product_dimension ............................. [RUN]
[0m11:59:27.712249 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.date_dimension, now model.my_dbt_project.product_dimension)
[0m11:59:27.714600 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.product_dimension
[0m11:59:27.731283 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.product_dimension"
[0m11:59:27.771663 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.product_dimension
[0m11:59:27.791184 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.product_dimension"
[0m11:59:27.821321 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m11:59:27.823641 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: BEGIN
[0m11:59:27.825447 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:59:27.972395 [debug] [Thread-1 (]: SQL status: OK in 0.147 seconds
[0m11:59:27.975169 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m11:59:27.979473 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.product_dimension"} */

  
  create view "sales_database"."main"."product_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * 
    FROM "sales_database"."main"."sales"
)

SELECT 
    sales.name,
    json_extract(items, '$[' || i || '].name') AS product_name,  -- Extract the name field from each element in the array
    json_extract(items, '$[' || i || '].item_code') AS product_item_code  -- Extract the item_code field from each element
FROM sales,
LATERAL (SELECT generate_series(CAST(0 AS BIGINT), CAST(json_array_length(sales.items) - 1 AS BIGINT)) AS i) AS series  -- Cast both to BIGINT
WHERE json_extract(items, '$[' || i || '].name') IS NOT NULL  -- Filter for non-null 'name'
  );

[0m11:59:28.039358 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.product_dimension"} */

  
  create view "sales_database"."main"."product_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * 
    FROM "sales_database"."main"."sales"
)

SELECT 
    sales.name,
    json_extract(items, '$[' || i || '].name') AS product_name,  -- Extract the name field from each element in the array
    json_extract(items, '$[' || i || '].item_code') AS product_item_code  -- Extract the item_code field from each element
FROM sales,
LATERAL (SELECT generate_series(CAST(0 AS BIGINT), CAST(json_array_length(sales.items) - 1 AS BIGINT)) AS i) AS series  -- Cast both to BIGINT
WHERE json_extract(items, '$[' || i || '].name') IS NOT NULL  -- Filter for non-null 'name'
  );

[0m11:59:28.044257 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m11:59:28.049265 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: ROLLBACK
[0m11:59:28.086911 [debug] [Thread-1 (]: Failed to rollback 'model.my_dbt_project.product_dimension'
[0m11:59:28.090354 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: Close
[0m11:59:28.124044 [debug] [Thread-1 (]: Runtime Error in model product_dimension (models/dimensions/product_dimension.sql)
  Binder Error: Cannot concatenate types VARCHAR and BIGINT[] - an explicit cast is required
  LINE 16: WHERE json_extract(items, '$[' || i || '].name') IS NOT NULL  -- Filter for non-null 'name'
    );
  ...
                                     ^
[0m11:59:28.135706 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7c51480-e0e5-4a1f-8f76-500b5f6eb1ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c7da37200>]}
[0m11:59:28.144953 [error] [Thread-1 (]: 3 of 6 ERROR creating sql view model main.product_dimension .................... [[31mERROR[0m in 0.42s]
[0m11:59:28.151126 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.product_dimension
[0m11:59:28.155065 [debug] [Thread-1 (]: Began running node model.my_dbt_project.sales_team_dimension
[0m11:59:28.157501 [debug] [Thread-4 (]: Marking all children of 'model.my_dbt_project.product_dimension' to be skipped because of status 'error'.  Reason: Runtime Error in model product_dimension (models/dimensions/product_dimension.sql)
  Binder Error: Cannot concatenate types VARCHAR and BIGINT[] - an explicit cast is required
  LINE 16: WHERE json_extract(items, '$[' || i || '].name') IS NOT NULL  -- Filter for non-null 'name'
    );
  ...
                                     ^.
[0m11:59:28.159628 [info ] [Thread-1 (]: 4 of 6 START sql view model main.sales_team_dimension .......................... [RUN]
[0m11:59:28.168550 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.product_dimension, now model.my_dbt_project.sales_team_dimension)
[0m11:59:28.172065 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.sales_team_dimension
[0m11:59:28.187501 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.sales_team_dimension"
[0m11:59:28.208424 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.sales_team_dimension
[0m11:59:28.222455 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.sales_team_dimension"
[0m11:59:28.241421 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m11:59:28.243213 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: BEGIN
[0m11:59:28.245178 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:59:28.541068 [debug] [Thread-1 (]: SQL status: OK in 0.294 seconds
[0m11:59:28.565025 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m11:59:28.573598 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */

  
  create view "sales_database"."main"."sales_team_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
    DISTINCT
    sales_team->>'name' AS sales_team_id,
    sales_team->>'region' AS sales_team_region
FROM sales
WHERE sales_team IS NOT NULL
  );

[0m11:59:28.607730 [debug] [Thread-1 (]: SQL status: OK in 0.025 seconds
[0m11:59:28.629775 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m11:59:28.632967 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */
alter view "sales_database"."main"."sales_team_dimension" rename to "sales_team_dimension__dbt_backup"
[0m11:59:28.651911 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:59:28.668016 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m11:59:28.672283 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */
alter view "sales_database"."main"."sales_team_dimension__dbt_tmp" rename to "sales_team_dimension"
[0m11:59:28.682618 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m11:59:28.707607 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: COMMIT
[0m11:59:28.710570 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m11:59:28.714594 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: COMMIT
[0m11:59:28.735048 [debug] [Thread-1 (]: SQL status: OK in 0.016 seconds
[0m11:59:28.747600 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m11:59:28.750097 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */
drop view if exists "sales_database"."main"."sales_team_dimension__dbt_backup" cascade
[0m11:59:28.758005 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m11:59:28.762977 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: Close
[0m11:59:28.851112 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7c51480-e0e5-4a1f-8f76-500b5f6eb1ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c7c17b080>]}
[0m11:59:28.855153 [info ] [Thread-1 (]: 4 of 6 OK created sql view model main.sales_team_dimension ..................... [[32mOK[0m in 0.67s]
[0m11:59:28.857856 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.sales_team_dimension
[0m11:59:28.860629 [debug] [Thread-1 (]: Began running node model.my_dbt_project.transform_sales
[0m11:59:28.863830 [info ] [Thread-1 (]: 5 of 6 START sql table model main.transform_sales .............................. [RUN]
[0m11:59:28.866412 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.sales_team_dimension, now model.my_dbt_project.transform_sales)
[0m11:59:28.868947 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.transform_sales
[0m11:59:28.879539 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.transform_sales"
[0m11:59:28.904622 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.transform_sales
[0m11:59:29.026448 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.transform_sales"
[0m11:59:29.173413 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m11:59:29.220875 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: BEGIN
[0m11:59:29.225895 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:59:48.199663 [debug] [Thread-1 (]: SQL status: OK in 18.971 seconds
[0m11:59:48.203055 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m11:59:48.206338 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */

  
    
    

    create  table
      "sales_database"."main"."transform_sales__dbt_tmp"
  
    as (
      -- /opt/airflow/dags/dbt_models/transform_users.sql


WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
   *
FROM sales
WHERE name = 'ABC private LTD-0002'
    );
  
  
[0m11:59:48.273025 [debug] [Thread-1 (]: SQL status: OK in 0.061 seconds
[0m11:59:48.293357 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m11:59:48.296116 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */
alter table "sales_database"."main"."transform_sales" rename to "transform_sales__dbt_backup"
[0m11:59:48.303432 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m11:59:48.320772 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m11:59:48.325205 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */
alter table "sales_database"."main"."transform_sales__dbt_tmp" rename to "transform_sales"
[0m11:59:48.329755 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:59:48.366514 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: COMMIT
[0m11:59:48.369573 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m11:59:48.372430 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: COMMIT
[0m11:59:48.403759 [debug] [Thread-1 (]: SQL status: OK in 0.029 seconds
[0m11:59:48.414318 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m11:59:48.416924 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */
drop table if exists "sales_database"."main"."transform_sales__dbt_backup" cascade
[0m11:59:48.425854 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m11:59:48.431901 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: Close
[0m11:59:48.611571 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7c51480-e0e5-4a1f-8f76-500b5f6eb1ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c7e614920>]}
[0m11:59:48.615762 [info ] [Thread-1 (]: 5 of 6 OK created sql table model main.transform_sales ......................... [[32mOK[0m in 19.74s]
[0m11:59:48.620289 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.transform_sales
[0m11:59:48.622514 [debug] [Thread-1 (]: Began running node model.my_dbt_project.sales_fact
[0m11:59:48.624668 [info ] [Thread-1 (]: 6 of 6 SKIP relation main.sales_fact ........................................... [[33mSKIP[0m]
[0m11:59:48.627679 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.sales_fact
[0m11:59:48.638821 [debug] [MainThread]: Using duckdb connection "master"
[0m11:59:48.640936 [debug] [MainThread]: On master: BEGIN
[0m11:59:48.643229 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:59:48.765217 [debug] [MainThread]: SQL status: OK in 0.122 seconds
[0m11:59:48.776241 [debug] [MainThread]: On master: COMMIT
[0m11:59:48.778578 [debug] [MainThread]: Using duckdb connection "master"
[0m11:59:48.781411 [debug] [MainThread]: On master: COMMIT
[0m11:59:48.784676 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:59:48.794098 [debug] [MainThread]: On master: Close
[0m11:59:48.801317 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:59:48.808823 [debug] [MainThread]: Connection 'list_sales_database_main' was properly closed.
[0m11:59:48.813159 [debug] [MainThread]: Connection 'model.my_dbt_project.transform_sales' was properly closed.
[0m11:59:48.816465 [info ] [MainThread]: 
[0m11:59:48.818701 [info ] [MainThread]: Finished running 2 table models, 4 view models in 0 hours 0 minutes and 24.30 seconds (24.30s).
[0m11:59:48.834504 [debug] [MainThread]: Command end result
[0m11:59:49.495942 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m11:59:49.685551 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m11:59:49.963882 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dags/dbt_models/target/run_results.json
[0m11:59:49.966718 [info ] [MainThread]: 
[0m11:59:50.022267 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m11:59:50.050121 [info ] [MainThread]: 
[0m11:59:50.066757 [error] [MainThread]:   Runtime Error in model product_dimension (models/dimensions/product_dimension.sql)
  Binder Error: Cannot concatenate types VARCHAR and BIGINT[] - an explicit cast is required
  LINE 16: WHERE json_extract(items, '$[' || i || '].name') IS NOT NULL  -- Filter for non-null 'name'
    );
  ...
                                     ^
[0m11:59:50.102925 [info ] [MainThread]: 
[0m11:59:50.171936 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=1 TOTAL=6
[0m11:59:50.211314 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 32.36412, "process_in_blocks": "1934248", "process_kernel_time": 6.943223, "process_mem_max_rss": "140248", "process_out_blocks": "0", "process_user_time": 13.357827}
[0m11:59:50.277870 [debug] [MainThread]: Command `dbt run` failed at 11:59:50.277304 after 32.43 seconds
[0m11:59:50.308606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c7c1809e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c88bc75f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c7d9fe5a0>]}
[0m11:59:50.340167 [debug] [MainThread]: Flushing usage events
[0m11:59:52.777696 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:04:28.556527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f970567adb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9702d6e6f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97032598e0>]}


============================== 12:04:40.647134 | e36b407a-16e3-49f8-8eb9-02587628c8e8 ==============================
[0m12:04:40.647134 [info ] [MainThread]: Running with dbt=1.9.1
[0m12:04:47.760838 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/profiles.yml', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/dags/dbt_models/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt/profiles.yml --target dev', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:04:51.737109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e36b407a-16e3-49f8-8eb9-02587628c8e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96ff12ffe0>]}
[0m12:04:52.550563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e36b407a-16e3-49f8-8eb9-02587628c8e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9703da8da0>]}
[0m12:04:53.119374 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m12:04:56.948976 [debug] [MainThread]: checksum: cac3b9519010e47bfbeb71ca6efb4867dae2858687671594dc23fefc94ecf25d, vars: {}, profile: , target: dev, version: 1.9.1
[0m12:04:58.275151 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:04:58.285020 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/dimensions/product_dimension.sql
[0m12:05:00.013305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e36b407a-16e3-49f8-8eb9-02587628c8e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97027f4aa0>]}
[0m12:05:00.451340 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m12:05:00.481583 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m12:05:00.797696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e36b407a-16e3-49f8-8eb9-02587628c8e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9703da16d0>]}
[0m12:05:00.799900 [info ] [MainThread]: Found 6 models, 1 source, 424 macros
[0m12:05:00.806270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e36b407a-16e3-49f8-8eb9-02587628c8e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96fcb5ff50>]}
[0m12:05:00.819493 [info ] [MainThread]: 
[0m12:05:00.840585 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:05:00.844741 [info ] [MainThread]: 
[0m12:05:00.856234 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:05:00.915498 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_sales_database'
[0m12:05:01.309933 [debug] [ThreadPool]: Using duckdb connection "list_sales_database"
[0m12:05:01.312118 [debug] [ThreadPool]: On list_sales_database: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "list_sales_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"sales_database"'
    
  
  
[0m12:05:01.326190 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:05:01.753715 [debug] [ThreadPool]: SQL status: OK in 0.427 seconds
[0m12:05:01.758820 [debug] [ThreadPool]: On list_sales_database: Close
[0m12:05:01.770680 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_database, now create_sales_database_main)
[0m12:05:01.774748 [debug] [ThreadPool]: Creating schema "database: "sales_database"
schema: "main"
"
[0m12:05:01.799343 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m12:05:01.803293 [debug] [ThreadPool]: On create_sales_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "create_sales_database_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='sales_database'
        and type='sqlite'
    
  
[0m12:05:01.806332 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:05:01.952367 [debug] [ThreadPool]: SQL status: OK in 0.140 seconds
[0m12:05:01.960391 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m12:05:01.964475 [debug] [ThreadPool]: On create_sales_database_main: BEGIN
[0m12:05:01.968541 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:05:01.970533 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m12:05:01.974323 [debug] [ThreadPool]: On create_sales_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "create_sales_database_main"} */

    
    
        create schema if not exists "sales_database"."main"
    
[0m12:05:01.981965 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m12:05:01.987167 [debug] [ThreadPool]: On create_sales_database_main: COMMIT
[0m12:05:01.989316 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m12:05:01.993916 [debug] [ThreadPool]: On create_sales_database_main: COMMIT
[0m12:05:01.996577 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:05:01.998431 [debug] [ThreadPool]: On create_sales_database_main: Close
[0m12:05:02.011594 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_sales_database_main'
[0m12:05:02.041414 [debug] [ThreadPool]: Using duckdb connection "list_sales_database_main"
[0m12:05:02.055132 [debug] [ThreadPool]: On list_sales_database_main: BEGIN
[0m12:05:02.057615 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:05:02.171889 [debug] [ThreadPool]: SQL status: OK in 0.114 seconds
[0m12:05:02.178062 [debug] [ThreadPool]: Using duckdb connection "list_sales_database_main"
[0m12:05:02.183427 [debug] [ThreadPool]: On list_sales_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "list_sales_database_main"} */
select
      'sales_database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'sales_database'
  
[0m12:05:02.402783 [debug] [ThreadPool]: SQL status: OK in 0.217 seconds
[0m12:05:02.409690 [debug] [ThreadPool]: On list_sales_database_main: ROLLBACK
[0m12:05:02.426288 [debug] [ThreadPool]: Failed to rollback 'list_sales_database_main'
[0m12:05:02.431113 [debug] [ThreadPool]: On list_sales_database_main: Close
[0m12:05:02.456707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e36b407a-16e3-49f8-8eb9-02587628c8e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96ff169b50>]}
[0m12:05:02.487130 [debug] [MainThread]: Using duckdb connection "master"
[0m12:05:02.488694 [debug] [MainThread]: On master: BEGIN
[0m12:05:02.490174 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:05:02.570114 [debug] [MainThread]: SQL status: OK in 0.080 seconds
[0m12:05:02.572202 [debug] [MainThread]: On master: COMMIT
[0m12:05:02.574278 [debug] [MainThread]: Using duckdb connection "master"
[0m12:05:02.576227 [debug] [MainThread]: On master: COMMIT
[0m12:05:02.581577 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m12:05:02.583527 [debug] [MainThread]: On master: Close
[0m12:05:02.601292 [debug] [Thread-1 (]: Began running node model.my_dbt_project.customer_dimension
[0m12:05:02.612130 [info ] [Thread-1 (]: 1 of 6 START sql view model main.customer_dimension ............................ [RUN]
[0m12:05:02.618052 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.my_dbt_project.customer_dimension'
[0m12:05:02.625559 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.customer_dimension
[0m12:05:02.670385 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.customer_dimension"
[0m12:05:02.707372 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.customer_dimension
[0m12:05:03.046790 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.customer_dimension"
[0m12:05:03.086446 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m12:05:03.088465 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: BEGIN
[0m12:05:03.090492 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:05:03.158409 [debug] [Thread-1 (]: SQL status: OK in 0.068 seconds
[0m12:05:03.161814 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m12:05:03.165371 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */

  
  create view "sales_database"."main"."customer_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
    DISTINCT
    customer AS customer_id,
    customer_name,
    customer_address,
    customer_group,
    territory,
    language AS customer_language
FROM sales
WHERE customer IS NOT NULL
  );

[0m12:05:03.172236 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m12:05:03.212178 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m12:05:03.217137 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */
alter view "sales_database"."main"."customer_dimension" rename to "customer_dimension__dbt_backup"
[0m12:05:03.220486 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:05:03.237435 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m12:05:03.241176 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */
alter view "sales_database"."main"."customer_dimension__dbt_tmp" rename to "customer_dimension"
[0m12:05:03.251023 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:05:03.316606 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: COMMIT
[0m12:05:03.319258 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m12:05:03.321309 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: COMMIT
[0m12:05:03.335932 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m12:05:03.354056 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m12:05:03.356421 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */
drop view if exists "sales_database"."main"."customer_dimension__dbt_backup" cascade
[0m12:05:03.363414 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m12:05:03.372874 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: Close
[0m12:05:03.476382 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e36b407a-16e3-49f8-8eb9-02587628c8e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9704b121e0>]}
[0m12:05:03.481934 [info ] [Thread-1 (]: 1 of 6 OK created sql view model main.customer_dimension ....................... [[32mOK[0m in 0.85s]
[0m12:05:03.497342 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.customer_dimension
[0m12:05:03.501515 [debug] [Thread-1 (]: Began running node model.my_dbt_project.date_dimension
[0m12:05:03.505718 [info ] [Thread-1 (]: 2 of 6 START sql view model main.date_dimension ................................ [RUN]
[0m12:05:03.511281 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customer_dimension, now model.my_dbt_project.date_dimension)
[0m12:05:03.518048 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.date_dimension
[0m12:05:03.555419 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.date_dimension"
[0m12:05:03.590129 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.date_dimension
[0m12:05:03.611197 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.date_dimension"
[0m12:05:03.657442 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m12:05:03.669648 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: BEGIN
[0m12:05:03.671706 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:05:03.752534 [debug] [Thread-1 (]: SQL status: OK in 0.081 seconds
[0m12:05:03.754682 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m12:05:03.758812 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.date_dimension"} */

  
  create view "sales_database"."main"."date_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)
SELECT
    transaction_date,
    strftime(transaction_date, '%Y-%m-%d') AS date_id,  -- Change the format to YYYY-MM-DD
    strftime(transaction_date, '%A') AS weekday_name,
    strftime(transaction_date, '%m') AS month,
    strftime(transaction_date, '%Y') AS year,
    strftime(transaction_date, '%d') AS day,
    EXTRACT(QUARTER FROM transaction_date) AS quarter
FROM sales
WHERE transaction_date IS NOT NULL
  );

[0m12:05:03.764754 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:05:03.777135 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m12:05:03.779274 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.date_dimension"} */
alter view "sales_database"."main"."date_dimension" rename to "date_dimension__dbt_backup"
[0m12:05:03.782928 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:05:03.820845 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m12:05:03.823001 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.date_dimension"} */
alter view "sales_database"."main"."date_dimension__dbt_tmp" rename to "date_dimension"
[0m12:05:03.826060 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:05:03.832449 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: COMMIT
[0m12:05:03.834881 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m12:05:03.836911 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: COMMIT
[0m12:05:03.845679 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m12:05:03.854953 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m12:05:03.859627 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.date_dimension"} */
drop view if exists "sales_database"."main"."date_dimension__dbt_backup" cascade
[0m12:05:03.866165 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m12:05:03.871105 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: Close
[0m12:05:03.945774 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e36b407a-16e3-49f8-8eb9-02587628c8e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96dc57ef90>]}
[0m12:05:03.948738 [info ] [Thread-1 (]: 2 of 6 OK created sql view model main.date_dimension ........................... [[32mOK[0m in 0.43s]
[0m12:05:03.957538 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.date_dimension
[0m12:05:03.959863 [debug] [Thread-1 (]: Began running node model.my_dbt_project.product_dimension
[0m12:05:03.962784 [info ] [Thread-1 (]: 3 of 6 START sql view model main.product_dimension ............................. [RUN]
[0m12:05:03.967613 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.date_dimension, now model.my_dbt_project.product_dimension)
[0m12:05:03.970521 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.product_dimension
[0m12:05:03.980134 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.product_dimension"
[0m12:05:04.022059 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.product_dimension
[0m12:05:04.040023 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.product_dimension"
[0m12:05:04.080880 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m12:05:04.083209 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: BEGIN
[0m12:05:04.086297 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:05:04.149893 [debug] [Thread-1 (]: SQL status: OK in 0.064 seconds
[0m12:05:04.152646 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m12:05:04.154858 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.product_dimension"} */

  
  create view "sales_database"."main"."product_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * 
    FROM "sales_database"."main"."sales"
)

SELECT 
    sales.name,
    json_extract(item, '$.name') AS product_name,  -- Extract the 'name' field for each item
    json_extract(item, '$.item_code') AS product_item_code  -- Extract the 'item_code' field for each item
FROM sales,
LATERAL json_array_elements(sales.items::json) AS item  -- Unnest the JSON array into individual elements
WHERE json_extract(item, '$.name') IS NOT NULL -- Filter for items that have a non-null 'name'
  );

[0m12:05:04.241477 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.product_dimension"} */

  
  create view "sales_database"."main"."product_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * 
    FROM "sales_database"."main"."sales"
)

SELECT 
    sales.name,
    json_extract(item, '$.name') AS product_name,  -- Extract the 'name' field for each item
    json_extract(item, '$.item_code') AS product_item_code  -- Extract the 'item_code' field for each item
FROM sales,
LATERAL json_array_elements(sales.items::json) AS item  -- Unnest the JSON array into individual elements
WHERE json_extract(item, '$.name') IS NOT NULL -- Filter for items that have a non-null 'name'
  );

[0m12:05:04.244006 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m12:05:04.247609 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: ROLLBACK
[0m12:05:04.315694 [debug] [Thread-1 (]: Failed to rollback 'model.my_dbt_project.product_dimension'
[0m12:05:04.326501 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: Close
[0m12:05:04.384021 [debug] [Thread-1 (]: Runtime Error in model product_dimension (models/dimensions/product_dimension.sql)
  Catalog Error: Table Function with name json_array_elements does not exist!
  Did you mean "json_execute_serialized_sql"?
  LINE 15: LATERAL json_array_elements(sales.items::json) AS item  -- Unnest the JSON array into individual elements
  WHERE json_extract(item, '$.name') IS NOT NULL -- Filter for items that have a non-null 'name'
    );
  ...
                   ^
[0m12:05:04.388344 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e36b407a-16e3-49f8-8eb9-02587628c8e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97029103b0>]}
[0m12:05:04.391216 [error] [Thread-1 (]: 3 of 6 ERROR creating sql view model main.product_dimension .................... [[31mERROR[0m in 0.42s]
[0m12:05:04.398797 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.product_dimension
[0m12:05:04.403682 [debug] [Thread-1 (]: Began running node model.my_dbt_project.sales_team_dimension
[0m12:05:04.405579 [debug] [Thread-4 (]: Marking all children of 'model.my_dbt_project.product_dimension' to be skipped because of status 'error'.  Reason: Runtime Error in model product_dimension (models/dimensions/product_dimension.sql)
  Catalog Error: Table Function with name json_array_elements does not exist!
  Did you mean "json_execute_serialized_sql"?
  LINE 15: LATERAL json_array_elements(sales.items::json) AS item  -- Unnest the JSON array into individual elements
  WHERE json_extract(item, '$.name') IS NOT NULL -- Filter for items that have a non-null 'name'
    );
  ...
                   ^.
[0m12:05:04.408982 [info ] [Thread-1 (]: 4 of 6 START sql view model main.sales_team_dimension .......................... [RUN]
[0m12:05:04.416250 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.product_dimension, now model.my_dbt_project.sales_team_dimension)
[0m12:05:04.421591 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.sales_team_dimension
[0m12:05:04.438961 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.sales_team_dimension"
[0m12:05:04.482837 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.sales_team_dimension
[0m12:05:04.507188 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.sales_team_dimension"
[0m12:05:04.528338 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m12:05:04.530279 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: BEGIN
[0m12:05:04.532571 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:05:05.034198 [debug] [Thread-1 (]: SQL status: OK in 0.502 seconds
[0m12:05:05.037031 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m12:05:05.058874 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */

  
  create view "sales_database"."main"."sales_team_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
    DISTINCT
    sales_team->>'name' AS sales_team_id,
    sales_team->>'region' AS sales_team_region
FROM sales
WHERE sales_team IS NOT NULL
  );

[0m12:05:05.065511 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:05:05.080030 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m12:05:05.082944 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */
alter view "sales_database"."main"."sales_team_dimension" rename to "sales_team_dimension__dbt_backup"
[0m12:05:05.086506 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:05:05.109833 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m12:05:05.116744 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */
alter view "sales_database"."main"."sales_team_dimension__dbt_tmp" rename to "sales_team_dimension"
[0m12:05:05.120064 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:05:05.140123 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: COMMIT
[0m12:05:05.142935 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m12:05:05.145175 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: COMMIT
[0m12:05:05.156640 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m12:05:05.165614 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m12:05:05.167728 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */
drop view if exists "sales_database"."main"."sales_team_dimension__dbt_backup" cascade
[0m12:05:05.175961 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m12:05:05.180798 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: Close
[0m12:05:05.263638 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e36b407a-16e3-49f8-8eb9-02587628c8e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96dc5e71d0>]}
[0m12:05:05.266338 [info ] [Thread-1 (]: 4 of 6 OK created sql view model main.sales_team_dimension ..................... [[32mOK[0m in 0.85s]
[0m12:05:05.269376 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.sales_team_dimension
[0m12:05:05.272535 [debug] [Thread-1 (]: Began running node model.my_dbt_project.transform_sales
[0m12:05:05.276740 [info ] [Thread-1 (]: 5 of 6 START sql table model main.transform_sales .............................. [RUN]
[0m12:05:05.280056 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.sales_team_dimension, now model.my_dbt_project.transform_sales)
[0m12:05:05.282059 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.transform_sales
[0m12:05:05.294525 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.transform_sales"
[0m12:05:05.324494 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.transform_sales
[0m12:05:05.430174 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.transform_sales"
[0m12:05:05.467311 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m12:05:05.469063 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: BEGIN
[0m12:05:05.471074 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:05:05.525584 [debug] [Thread-1 (]: SQL status: OK in 0.054 seconds
[0m12:05:05.528513 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m12:05:05.531355 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */

  
    
    

    create  table
      "sales_database"."main"."transform_sales__dbt_tmp"
  
    as (
      -- /opt/airflow/dags/dbt_models/transform_users.sql


WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
   *
FROM sales
WHERE name = 'ABC private LTD-0002'
    );
  
  
[0m12:05:05.597228 [debug] [Thread-1 (]: SQL status: OK in 0.062 seconds
[0m12:05:05.613033 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m12:05:05.617934 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */
alter table "sales_database"."main"."transform_sales" rename to "transform_sales__dbt_backup"
[0m12:05:05.623194 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:05:05.639595 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m12:05:05.645289 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */
alter table "sales_database"."main"."transform_sales__dbt_tmp" rename to "transform_sales"
[0m12:05:05.648680 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:05:05.678131 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: COMMIT
[0m12:05:05.680134 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m12:05:05.682164 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: COMMIT
[0m12:05:05.716844 [debug] [Thread-1 (]: SQL status: OK in 0.032 seconds
[0m12:05:05.730841 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m12:05:05.732942 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */
drop table if exists "sales_database"."main"."transform_sales__dbt_backup" cascade
[0m12:05:05.742877 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m12:05:05.750293 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: Close
[0m12:05:06.130385 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e36b407a-16e3-49f8-8eb9-02587628c8e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97035400e0>]}
[0m12:05:06.147839 [info ] [Thread-1 (]: 5 of 6 OK created sql table model main.transform_sales ......................... [[32mOK[0m in 0.85s]
[0m12:05:06.151425 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.transform_sales
[0m12:05:06.179982 [debug] [Thread-1 (]: Began running node model.my_dbt_project.sales_fact
[0m12:05:06.188469 [info ] [Thread-1 (]: 6 of 6 SKIP relation main.sales_fact ........................................... [[33mSKIP[0m]
[0m12:05:06.204298 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.sales_fact
[0m12:05:06.232262 [debug] [MainThread]: Using duckdb connection "master"
[0m12:05:06.234210 [debug] [MainThread]: On master: BEGIN
[0m12:05:06.236253 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:05:06.315634 [debug] [MainThread]: SQL status: OK in 0.079 seconds
[0m12:05:06.320217 [debug] [MainThread]: On master: COMMIT
[0m12:05:06.324293 [debug] [MainThread]: Using duckdb connection "master"
[0m12:05:06.330982 [debug] [MainThread]: On master: COMMIT
[0m12:05:06.334570 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:05:06.340683 [debug] [MainThread]: On master: Close
[0m12:05:06.353500 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:05:06.360670 [debug] [MainThread]: Connection 'create_sales_database_main' was properly closed.
[0m12:05:06.365524 [debug] [MainThread]: Connection 'list_sales_database_main' was properly closed.
[0m12:05:06.367996 [debug] [MainThread]: Connection 'model.my_dbt_project.transform_sales' was properly closed.
[0m12:05:06.370683 [info ] [MainThread]: 
[0m12:05:06.379633 [info ] [MainThread]: Finished running 2 table models, 4 view models in 0 hours 0 minutes and 5.52 seconds (5.52s).
[0m12:05:06.401673 [debug] [MainThread]: Command end result
[0m12:05:06.664193 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m12:05:06.701339 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m12:05:06.749671 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dags/dbt_models/target/run_results.json
[0m12:05:06.751278 [info ] [MainThread]: 
[0m12:05:06.753647 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:05:06.767169 [info ] [MainThread]: 
[0m12:05:06.776755 [error] [MainThread]:   Runtime Error in model product_dimension (models/dimensions/product_dimension.sql)
  Catalog Error: Table Function with name json_array_elements does not exist!
  Did you mean "json_execute_serialized_sql"?
  LINE 15: LATERAL json_array_elements(sales.items::json) AS item  -- Unnest the JSON array into individual elements
  WHERE json_extract(item, '$.name') IS NOT NULL -- Filter for items that have a non-null 'name'
    );
  ...
                   ^
[0m12:05:06.781741 [info ] [MainThread]: 
[0m12:05:06.784372 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=1 TOTAL=6
[0m12:05:06.807139 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 39.25992, "process_in_blocks": "1274504", "process_kernel_time": 5.170329, "process_mem_max_rss": "148932", "process_out_blocks": "0", "process_user_time": 13.39944}
[0m12:05:06.814905 [debug] [MainThread]: Command `dbt run` failed at 12:05:06.814579 after 39.27 seconds
[0m12:05:06.820982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9702dd0da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96dff6f470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96fcb5cfb0>]}
[0m12:05:06.823014 [debug] [MainThread]: Flushing usage events
[0m12:05:09.033817 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:11:38.431571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb731c9880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb7282d160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb7495c530>]}


============================== 12:11:38.529574 | f0399feb-c13c-4b3c-ab7c-b360ac245ff9 ==============================
[0m12:11:38.529574 [info ] [MainThread]: Running with dbt=1.9.1
[0m12:11:38.561683 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dags/dbt_models/logs', 'profiles_dir': '/opt/airflow/dbt/profiles.yml', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt/profiles.yml --target dev', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:11:41.488256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f0399feb-c13c-4b3c-ab7c-b360ac245ff9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb6eca3e60>]}
[0m12:11:41.736674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f0399feb-c13c-4b3c-ab7c-b360ac245ff9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb7279b5f0>]}
[0m12:11:41.765777 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m12:11:42.336233 [debug] [MainThread]: checksum: cac3b9519010e47bfbeb71ca6efb4867dae2858687671594dc23fefc94ecf25d, vars: {}, profile: , target: dev, version: 1.9.1
[0m12:11:43.459864 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:11:43.470887 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/dimensions/product_dimension.sql
[0m12:11:44.644756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f0399feb-c13c-4b3c-ab7c-b360ac245ff9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb5fb5fcb0>]}
[0m12:11:45.557729 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m12:11:45.584849 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m12:11:45.843139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f0399feb-c13c-4b3c-ab7c-b360ac245ff9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb5fb39430>]}
[0m12:11:45.845350 [info ] [MainThread]: Found 6 models, 1 source, 424 macros
[0m12:11:45.849415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f0399feb-c13c-4b3c-ab7c-b360ac245ff9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb6ed37980>]}
[0m12:11:45.858633 [info ] [MainThread]: 
[0m12:11:45.862500 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:11:45.867594 [info ] [MainThread]: 
[0m12:11:45.875406 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:11:45.925953 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_sales_database'
[0m12:11:46.366424 [debug] [ThreadPool]: Using duckdb connection "list_sales_database"
[0m12:11:46.368383 [debug] [ThreadPool]: On list_sales_database: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "list_sales_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"sales_database"'
    
  
  
[0m12:11:46.370237 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:11:46.493677 [debug] [ThreadPool]: SQL status: OK in 0.123 seconds
[0m12:11:46.502079 [debug] [ThreadPool]: On list_sales_database: Close
[0m12:11:46.523724 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_database, now create_sales_database_main)
[0m12:11:46.527809 [debug] [ThreadPool]: Creating schema "database: "sales_database"
schema: "main"
"
[0m12:11:46.559200 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m12:11:46.561072 [debug] [ThreadPool]: On create_sales_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "create_sales_database_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='sales_database'
        and type='sqlite'
    
  
[0m12:11:46.566045 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:11:46.666894 [debug] [ThreadPool]: SQL status: OK in 0.101 seconds
[0m12:11:46.680546 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m12:11:46.684470 [debug] [ThreadPool]: On create_sales_database_main: BEGIN
[0m12:11:46.688456 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:11:46.690239 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m12:11:46.699651 [debug] [ThreadPool]: On create_sales_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "create_sales_database_main"} */

    
    
        create schema if not exists "sales_database"."main"
    
[0m12:11:46.706083 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m12:11:46.713368 [debug] [ThreadPool]: On create_sales_database_main: COMMIT
[0m12:11:46.717708 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m12:11:46.719561 [debug] [ThreadPool]: On create_sales_database_main: COMMIT
[0m12:11:46.721770 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:11:46.723576 [debug] [ThreadPool]: On create_sales_database_main: Close
[0m12:11:46.749470 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_sales_database_main, now list_sales_database_main)
[0m12:11:46.800739 [debug] [ThreadPool]: Using duckdb connection "list_sales_database_main"
[0m12:11:46.802482 [debug] [ThreadPool]: On list_sales_database_main: BEGIN
[0m12:11:46.804210 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:11:46.868160 [debug] [ThreadPool]: SQL status: OK in 0.064 seconds
[0m12:11:46.869989 [debug] [ThreadPool]: Using duckdb connection "list_sales_database_main"
[0m12:11:46.871779 [debug] [ThreadPool]: On list_sales_database_main: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "list_sales_database_main"} */
select
      'sales_database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'sales_database'
  
[0m12:11:47.042727 [debug] [ThreadPool]: SQL status: OK in 0.169 seconds
[0m12:11:47.050426 [debug] [ThreadPool]: On list_sales_database_main: ROLLBACK
[0m12:11:47.055362 [debug] [ThreadPool]: Failed to rollback 'list_sales_database_main'
[0m12:11:47.057115 [debug] [ThreadPool]: On list_sales_database_main: Close
[0m12:11:47.070737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f0399feb-c13c-4b3c-ab7c-b360ac245ff9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb5fb3fe60>]}
[0m12:11:47.073014 [debug] [MainThread]: Using duckdb connection "master"
[0m12:11:47.074857 [debug] [MainThread]: On master: BEGIN
[0m12:11:47.076749 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:11:47.124402 [debug] [MainThread]: SQL status: OK in 0.048 seconds
[0m12:11:47.126313 [debug] [MainThread]: On master: COMMIT
[0m12:11:47.128337 [debug] [MainThread]: Using duckdb connection "master"
[0m12:11:47.130138 [debug] [MainThread]: On master: COMMIT
[0m12:11:47.133667 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m12:11:47.135360 [debug] [MainThread]: On master: Close
[0m12:11:47.144903 [debug] [Thread-1 (]: Began running node model.my_dbt_project.customer_dimension
[0m12:11:47.147316 [info ] [Thread-1 (]: 1 of 6 START sql view model main.customer_dimension ............................ [RUN]
[0m12:11:47.150579 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.my_dbt_project.customer_dimension'
[0m12:11:47.152576 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.customer_dimension
[0m12:11:47.179914 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.customer_dimension"
[0m12:11:47.201644 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.customer_dimension
[0m12:11:47.329767 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.customer_dimension"
[0m12:11:47.352879 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m12:11:47.354726 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: BEGIN
[0m12:11:47.356651 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:11:47.407912 [debug] [Thread-1 (]: SQL status: OK in 0.051 seconds
[0m12:11:47.409865 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m12:11:47.412035 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */

  
  create view "sales_database"."main"."customer_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
    DISTINCT
    customer AS customer_id,
    customer_name,
    customer_address,
    customer_group,
    territory,
    language AS customer_language
FROM sales
WHERE customer IS NOT NULL
  );

[0m12:11:47.416826 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m12:11:47.439427 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m12:11:47.441547 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */
alter view "sales_database"."main"."customer_dimension" rename to "customer_dimension__dbt_backup"
[0m12:11:47.444821 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:11:47.458920 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m12:11:47.460868 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */
alter view "sales_database"."main"."customer_dimension__dbt_tmp" rename to "customer_dimension"
[0m12:11:47.466560 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:11:47.512386 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: COMMIT
[0m12:11:47.516022 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m12:11:47.517896 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: COMMIT
[0m12:11:47.539471 [debug] [Thread-1 (]: SQL status: OK in 0.020 seconds
[0m12:11:47.556662 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m12:11:47.558930 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */
drop view if exists "sales_database"."main"."customer_dimension__dbt_backup" cascade
[0m12:11:47.572938 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m12:11:47.584310 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: Close
[0m12:11:47.684187 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0399feb-c13c-4b3c-ab7c-b360ac245ff9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb5efab9b0>]}
[0m12:11:47.686850 [info ] [Thread-1 (]: 1 of 6 OK created sql view model main.customer_dimension ....................... [[32mOK[0m in 0.53s]
[0m12:11:47.691309 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.customer_dimension
[0m12:11:47.693558 [debug] [Thread-1 (]: Began running node model.my_dbt_project.date_dimension
[0m12:11:47.696023 [info ] [Thread-1 (]: 2 of 6 START sql view model main.date_dimension ................................ [RUN]
[0m12:11:47.700442 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customer_dimension, now model.my_dbt_project.date_dimension)
[0m12:11:47.702338 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.date_dimension
[0m12:11:47.712066 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.date_dimension"
[0m12:11:47.736878 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.date_dimension
[0m12:11:47.757348 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.date_dimension"
[0m12:11:47.780827 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m12:11:47.784531 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: BEGIN
[0m12:11:47.786676 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:11:47.830446 [debug] [Thread-1 (]: SQL status: OK in 0.044 seconds
[0m12:11:47.833876 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m12:11:47.836135 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.date_dimension"} */

  
  create view "sales_database"."main"."date_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)
SELECT
    transaction_date,
    strftime(transaction_date, '%Y-%m-%d') AS date_id,  -- Change the format to YYYY-MM-DD
    strftime(transaction_date, '%A') AS weekday_name,
    strftime(transaction_date, '%m') AS month,
    strftime(transaction_date, '%Y') AS year,
    strftime(transaction_date, '%d') AS day,
    EXTRACT(QUARTER FROM transaction_date) AS quarter
FROM sales
WHERE transaction_date IS NOT NULL
  );

[0m12:11:47.842816 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m12:11:47.856371 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m12:11:47.858865 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.date_dimension"} */
alter view "sales_database"."main"."date_dimension" rename to "date_dimension__dbt_backup"
[0m12:11:47.861839 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:11:47.874877 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m12:11:47.877165 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.date_dimension"} */
alter view "sales_database"."main"."date_dimension__dbt_tmp" rename to "date_dimension"
[0m12:11:47.880259 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:11:47.888830 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: COMMIT
[0m12:11:47.890861 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m12:11:47.892775 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: COMMIT
[0m12:11:47.914294 [debug] [Thread-1 (]: SQL status: OK in 0.020 seconds
[0m12:11:47.928209 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m12:11:47.930828 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.date_dimension"} */
drop view if exists "sales_database"."main"."date_dimension__dbt_backup" cascade
[0m12:11:47.947365 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m12:11:47.967571 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: Close
[0m12:11:48.065863 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0399feb-c13c-4b3c-ab7c-b360ac245ff9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb6ed10470>]}
[0m12:11:48.068811 [info ] [Thread-1 (]: 2 of 6 OK created sql view model main.date_dimension ........................... [[32mOK[0m in 0.36s]
[0m12:11:48.076594 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.date_dimension
[0m12:11:48.079361 [debug] [Thread-1 (]: Began running node model.my_dbt_project.product_dimension
[0m12:11:48.084738 [info ] [Thread-1 (]: 3 of 6 START sql view model main.product_dimension ............................. [RUN]
[0m12:11:48.093669 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.date_dimension, now model.my_dbt_project.product_dimension)
[0m12:11:48.097220 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.product_dimension
[0m12:11:48.108231 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.product_dimension"
[0m12:11:48.136520 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.product_dimension
[0m12:11:48.157628 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.product_dimension"
[0m12:11:48.197094 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m12:11:48.200996 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: BEGIN
[0m12:11:48.206305 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:11:48.293560 [debug] [Thread-1 (]: SQL status: OK in 0.087 seconds
[0m12:11:48.295352 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m12:11:48.297304 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.product_dimension"} */

  
  create view "sales_database"."main"."product_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * 
    FROM "sales_database"."main"."sales"
)

SELECT 
    sales.name,
    json_extract(items, '$[0].name') AS product_name,  -- Example to extract the first element's "name" field from JSON array
    json_extract(items, '$[0].item_code') AS product_item_code
FROM sales
WHERE json_extract(items, '$[0].name') IS NOT NULL  -- Filter to only keep rows with a non-null product name
  );

[0m12:11:48.303480 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:11:48.312945 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m12:11:48.318850 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.product_dimension"} */
alter view "sales_database"."main"."product_dimension" rename to "product_dimension__dbt_backup"
[0m12:11:48.327888 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:11:48.349679 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m12:11:48.368305 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.product_dimension"} */
alter view "sales_database"."main"."product_dimension__dbt_tmp" rename to "product_dimension"
[0m12:11:48.371405 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:11:48.384765 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: COMMIT
[0m12:11:48.388223 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m12:11:48.391097 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: COMMIT
[0m12:11:48.415281 [debug] [Thread-1 (]: SQL status: OK in 0.022 seconds
[0m12:11:48.426265 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m12:11:48.429752 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.product_dimension"} */
drop view if exists "sales_database"."main"."product_dimension__dbt_backup" cascade
[0m12:11:48.446904 [debug] [Thread-1 (]: SQL status: OK in 0.015 seconds
[0m12:11:48.453153 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: Close
[0m12:11:48.547867 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0399feb-c13c-4b3c-ab7c-b360ac245ff9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb5efcddc0>]}
[0m12:11:48.552548 [info ] [Thread-1 (]: 3 of 6 OK created sql view model main.product_dimension ........................ [[32mOK[0m in 0.46s]
[0m12:11:48.555613 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.product_dimension
[0m12:11:48.558619 [debug] [Thread-1 (]: Began running node model.my_dbt_project.sales_team_dimension
[0m12:11:48.562377 [info ] [Thread-1 (]: 4 of 6 START sql view model main.sales_team_dimension .......................... [RUN]
[0m12:11:48.569091 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.product_dimension, now model.my_dbt_project.sales_team_dimension)
[0m12:11:48.571138 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.sales_team_dimension
[0m12:11:48.584108 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.sales_team_dimension"
[0m12:11:48.609453 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.sales_team_dimension
[0m12:11:48.626261 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.sales_team_dimension"
[0m12:11:48.654466 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m12:11:48.656711 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: BEGIN
[0m12:11:48.659232 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:11:48.722138 [debug] [Thread-1 (]: SQL status: OK in 0.063 seconds
[0m12:11:48.725310 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m12:11:48.727440 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */

  
  create view "sales_database"."main"."sales_team_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
    DISTINCT
    sales_team->>'name' AS sales_team_id,
    sales_team->>'region' AS sales_team_region
FROM sales
WHERE sales_team IS NOT NULL
  );

[0m12:11:48.732359 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m12:11:48.747359 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m12:11:48.751194 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */
alter view "sales_database"."main"."sales_team_dimension" rename to "sales_team_dimension__dbt_backup"
[0m12:11:48.756301 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:11:48.773790 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m12:11:48.776100 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */
alter view "sales_database"."main"."sales_team_dimension__dbt_tmp" rename to "sales_team_dimension"
[0m12:11:48.779208 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:11:48.789557 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: COMMIT
[0m12:11:48.792361 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m12:11:48.794673 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: COMMIT
[0m12:11:48.814270 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m12:11:48.827263 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m12:11:48.829365 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */
drop view if exists "sales_database"."main"."sales_team_dimension__dbt_backup" cascade
[0m12:11:48.846326 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m12:11:48.858731 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: Close
[0m12:11:48.943684 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0399feb-c13c-4b3c-ab7c-b360ac245ff9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb5c1abe90>]}
[0m12:11:48.946105 [info ] [Thread-1 (]: 4 of 6 OK created sql view model main.sales_team_dimension ..................... [[32mOK[0m in 0.37s]
[0m12:11:48.952184 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.sales_team_dimension
[0m12:11:48.955058 [debug] [Thread-1 (]: Began running node model.my_dbt_project.transform_sales
[0m12:11:48.958454 [info ] [Thread-1 (]: 5 of 6 START sql table model main.transform_sales .............................. [RUN]
[0m12:11:48.961278 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.sales_team_dimension, now model.my_dbt_project.transform_sales)
[0m12:11:48.963706 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.transform_sales
[0m12:11:48.975546 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.transform_sales"
[0m12:11:48.995777 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.transform_sales
[0m12:11:49.085088 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.transform_sales"
[0m12:11:49.102623 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m12:11:49.104998 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: BEGIN
[0m12:11:49.107046 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:11:49.162092 [debug] [Thread-1 (]: SQL status: OK in 0.055 seconds
[0m12:11:49.164204 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m12:11:49.174092 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */

  
    
    

    create  table
      "sales_database"."main"."transform_sales__dbt_tmp"
  
    as (
      -- /opt/airflow/dags/dbt_models/transform_users.sql


WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
   *
FROM sales
WHERE name = 'ABC private LTD-0002'
    );
  
  
[0m12:11:49.244838 [debug] [Thread-1 (]: SQL status: OK in 0.069 seconds
[0m12:11:49.263178 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m12:11:49.268134 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */
alter table "sales_database"."main"."transform_sales" rename to "transform_sales__dbt_backup"
[0m12:11:49.272975 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m12:11:49.285651 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m12:11:49.287880 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */
alter table "sales_database"."main"."transform_sales__dbt_tmp" rename to "transform_sales"
[0m12:11:49.291350 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:11:49.311540 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: COMMIT
[0m12:11:49.313826 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m12:11:49.317752 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: COMMIT
[0m12:11:49.340051 [debug] [Thread-1 (]: SQL status: OK in 0.020 seconds
[0m12:11:49.348639 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m12:11:49.353034 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */
drop table if exists "sales_database"."main"."transform_sales__dbt_backup" cascade
[0m12:11:49.368376 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m12:11:49.372976 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: Close
[0m12:11:49.555404 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0399feb-c13c-4b3c-ab7c-b360ac245ff9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb5f0784d0>]}
[0m12:11:49.557860 [info ] [Thread-1 (]: 5 of 6 OK created sql table model main.transform_sales ......................... [[32mOK[0m in 0.59s]
[0m12:11:49.560469 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.transform_sales
[0m12:11:49.562549 [debug] [Thread-1 (]: Began running node model.my_dbt_project.sales_fact
[0m12:11:49.565289 [info ] [Thread-1 (]: 6 of 6 START sql table model main.sales_fact ................................... [RUN]
[0m12:11:49.569699 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.transform_sales, now model.my_dbt_project.sales_fact)
[0m12:11:49.571503 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.sales_fact
[0m12:11:49.600074 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.sales_fact"
[0m12:11:49.645601 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.sales_fact
[0m12:11:49.669085 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.sales_fact"
[0m12:11:49.693441 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_fact"
[0m12:11:49.695535 [debug] [Thread-1 (]: On model.my_dbt_project.sales_fact: BEGIN
[0m12:11:49.697538 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:11:49.759424 [debug] [Thread-1 (]: SQL status: OK in 0.062 seconds
[0m12:11:49.791853 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_fact"
[0m12:11:49.827058 [debug] [Thread-1 (]: On model.my_dbt_project.sales_fact: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_fact"} */

  
    
    

    create  table
      "sales_database"."main"."sales_fact__dbt_tmp"
  
    as (
      WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
),
customer AS (
    SELECT * FROM "sales_database"."main"."customer_dimension"
),
product AS (
    SELECT * FROM "sales_database"."main"."product_dimension"
),
sales_team AS (
    SELECT * FROM "sales_database"."main"."sales_team_dimension"
),
date AS (
    SELECT * FROM "sales_database"."main"."date_dimension"
)

SELECT
    s.name AS sales_id,
    c.customer_id,
    p.product_id,
    st.sales_team_id,
    d.date_id,
    s.total_qty,
    s.total_net_weight,
    s.total,
    s.net_total,
    s.grand_total,
    s.tax_category
FROM sales s
JOIN customer c 
    ON s.customer = c.customer_id
-- Handling product as JSON in DuckDB
JOIN LATERAL (
    SELECT json_extract(s.items, '$[0].product_id') AS product_id
    FROM (VALUES (s.items)) AS items(item)
    WHERE json_extract(item, '$[0].product_id') IS NOT NULL
) AS p ON TRUE
-- Handling sales_team as JSON in DuckDB
JOIN LATERAL (
    SELECT json_extract(s.sales_team, '$[0].sales_team_id') AS sales_team_id
    FROM (VALUES (s.sales_team)) AS team(item)
    WHERE json_extract(item, '$[0].sales_team_id') IS NOT NULL
) AS st ON TRUE
JOIN date d 
    ON s.transaction_date = d.date_id
    );
  
  
[0m12:11:50.076046 [debug] [Thread-1 (]: SQL status: OK in 0.210 seconds
[0m12:11:50.097543 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_fact"
[0m12:11:50.100220 [debug] [Thread-1 (]: On model.my_dbt_project.sales_fact: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_fact"} */
alter table "sales_database"."main"."sales_fact" rename to "sales_fact__dbt_backup"
[0m12:11:50.104090 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:11:50.116654 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_fact"
[0m12:11:50.119189 [debug] [Thread-1 (]: On model.my_dbt_project.sales_fact: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_fact"} */
alter table "sales_database"."main"."sales_fact__dbt_tmp" rename to "sales_fact"
[0m12:11:50.122438 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:11:50.144008 [debug] [Thread-1 (]: On model.my_dbt_project.sales_fact: COMMIT
[0m12:11:50.146458 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_fact"
[0m12:11:50.148675 [debug] [Thread-1 (]: On model.my_dbt_project.sales_fact: COMMIT
[0m12:11:50.170385 [debug] [Thread-1 (]: SQL status: OK in 0.018 seconds
[0m12:11:50.185656 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_fact"
[0m12:11:50.188009 [debug] [Thread-1 (]: On model.my_dbt_project.sales_fact: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_fact"} */
drop table if exists "sales_database"."main"."sales_fact__dbt_backup" cascade
[0m12:11:50.222238 [debug] [Thread-1 (]: SQL status: OK in 0.032 seconds
[0m12:11:50.241314 [debug] [Thread-1 (]: On model.my_dbt_project.sales_fact: Close
[0m12:11:50.388475 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0399feb-c13c-4b3c-ab7c-b360ac245ff9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb5c188b60>]}
[0m12:11:50.403846 [info ] [Thread-1 (]: 6 of 6 OK created sql table model main.sales_fact .............................. [[32mOK[0m in 0.81s]
[0m12:11:50.411378 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.sales_fact
[0m12:11:50.428085 [debug] [MainThread]: Using duckdb connection "master"
[0m12:11:50.444822 [debug] [MainThread]: On master: BEGIN
[0m12:11:50.460321 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:11:50.655322 [debug] [MainThread]: SQL status: OK in 0.195 seconds
[0m12:11:50.660287 [debug] [MainThread]: On master: COMMIT
[0m12:11:50.664603 [debug] [MainThread]: Using duckdb connection "master"
[0m12:11:50.676186 [debug] [MainThread]: On master: COMMIT
[0m12:11:50.691346 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m12:11:50.693834 [debug] [MainThread]: On master: Close
[0m12:11:50.710906 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:11:50.712563 [debug] [MainThread]: Connection 'list_sales_database_main' was properly closed.
[0m12:11:50.714206 [debug] [MainThread]: Connection 'model.my_dbt_project.sales_fact' was properly closed.
[0m12:11:50.719765 [info ] [MainThread]: 
[0m12:11:50.723330 [info ] [MainThread]: Finished running 2 table models, 4 view models in 0 hours 0 minutes and 4.84 seconds (4.84s).
[0m12:11:50.731045 [debug] [MainThread]: Command end result
[0m12:11:50.882927 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m12:11:50.897528 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m12:11:50.938239 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dags/dbt_models/target/run_results.json
[0m12:11:50.939932 [info ] [MainThread]: 
[0m12:11:50.941660 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:11:50.943242 [info ] [MainThread]: 
[0m12:11:50.946666 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m12:11:50.954343 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 13.6690035, "process_in_blocks": "2383624", "process_kernel_time": 10.463717, "process_mem_max_rss": "153300", "process_out_blocks": "0", "process_user_time": 15.439751}
[0m12:11:50.956518 [debug] [MainThread]: Command `dbt run` succeeded at 12:11:50.956180 after 13.67 seconds
[0m12:11:50.958380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb7282d160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb728aeea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb6ed37ef0>]}
[0m12:11:50.960424 [debug] [MainThread]: Flushing usage events
[0m12:11:52.796863 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:33:57.630187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d9a23cf50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d98431730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d98665a30>]}


============================== 07:33:57.760335 | 89dce7c4-221f-4ad7-b8ce-2471dd12d129 ==============================
[0m07:33:57.760335 [info ] [MainThread]: Running with dbt=1.9.2
[0m07:33:57.776917 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/profiles.yml', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dags/dbt_models/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt/profiles.yml --target dev', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:34:04.700359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '89dce7c4-221f-4ad7-b8ce-2471dd12d129', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d9270d8b0>]}
[0m07:34:05.400418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '89dce7c4-221f-4ad7-b8ce-2471dd12d129', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d98665a30>]}
[0m07:34:05.468709 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m07:34:07.664492 [debug] [MainThread]: checksum: eea1a9e9f56a74d304aa4a9e5e9c8fc1dea4ccd2b0ec98e366756009c99c5c94, vars: {}, profile: , target: dev, version: 1.9.2
[0m07:34:09.182578 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m07:34:09.198242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '89dce7c4-221f-4ad7-b8ce-2471dd12d129', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d9214d970>]}
[0m07:34:18.100329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '89dce7c4-221f-4ad7-b8ce-2471dd12d129', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d920d4e00>]}
[0m07:34:18.393455 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m07:34:18.446333 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m07:34:19.211575 [error] [MainThread]: Encountered an error:
Found a cycle: model.my_dbt_project.sales_fact --> model.my_dbt_project.product_dimension
[0m07:34:19.246661 [error] [MainThread]: Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/requires.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/requires.py", line 235, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/requires.py", line 264, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/requires.py", line 311, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/requires.py", line 328, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/main.py", line 578, in run
    results = task.run()
              ^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/task/runnable.py", line 572, in run
    self._runtime_initialize()
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/task/compile.py", line 133, in _runtime_initialize
    super()._runtime_initialize()
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/task/runnable.py", line 170, in _runtime_initialize
    self.compile_manifest()
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/task/base.py", line 134, in compile_manifest
    self.graph = self.compiler.compile(self.manifest)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/compilation.py", line 475, in compile
    linker.link_graph(manifest)
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/compilation.py", line 195, in link_graph
    raise RuntimeError("Found a cycle: {}".format(cycle))
RuntimeError: Found a cycle: model.my_dbt_project.sales_fact --> model.my_dbt_project.product_dimension

[0m07:34:19.262206 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 22.976904, "process_in_blocks": "185208", "process_kernel_time": 7.228552, "process_mem_max_rss": "125268", "process_out_blocks": "1968", "process_user_time": 18.1603}
[0m07:34:19.265001 [debug] [MainThread]: Command `dbt run` failed at 07:34:19.264534 after 22.98 seconds
[0m07:34:19.267110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d980ff3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d9171f6b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d91754b60>]}
[0m07:34:19.269837 [debug] [MainThread]: Flushing usage events
[0m07:34:21.474931 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:39:19.910087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53bc61e210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53bbf36ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53bc4a6ea0>]}


============================== 07:39:20.030204 | 2615d981-2c41-4be2-a2ce-3788beec6e35 ==============================
[0m07:39:20.030204 [info ] [MainThread]: Running with dbt=1.9.2
[0m07:39:20.034836 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/profiles.yml', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dags/dbt_models/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt/profiles.yml --target dev', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:39:25.050344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2615d981-2c41-4be2-a2ce-3788beec6e35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53bc5134a0>]}
[0m07:39:25.544706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2615d981-2c41-4be2-a2ce-3788beec6e35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53bc61ee70>]}
[0m07:39:25.641548 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m07:39:28.071565 [debug] [MainThread]: checksum: eea1a9e9f56a74d304aa4a9e5e9c8fc1dea4ccd2b0ec98e366756009c99c5c94, vars: {}, profile: , target: dev, version: 1.9.2
[0m07:39:30.771117 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m07:39:30.773509 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/dimensions/product_dimension.sql
[0m07:39:32.113754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2615d981-2c41-4be2-a2ce-3788beec6e35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53b5f118e0>]}
[0m07:39:32.761548 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m07:39:32.827738 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m07:39:33.172379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2615d981-2c41-4be2-a2ce-3788beec6e35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53b4f5e5a0>]}
[0m07:39:33.173735 [info ] [MainThread]: Found 8 models, 1 source, 424 macros
[0m07:39:33.175479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2615d981-2c41-4be2-a2ce-3788beec6e35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53b58569c0>]}
[0m07:39:33.182026 [info ] [MainThread]: 
[0m07:39:33.184040 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:39:33.187688 [info ] [MainThread]: 
[0m07:39:33.190573 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m07:39:33.203321 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_sales_database'
[0m07:39:33.529576 [debug] [ThreadPool]: Using duckdb connection "list_sales_database"
[0m07:39:33.531431 [debug] [ThreadPool]: On list_sales_database: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "list_sales_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"sales_database"'
    
  
  
[0m07:39:33.533371 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:39:33.947440 [debug] [ThreadPool]: SQL status: OK in 0.414 seconds
[0m07:39:33.958591 [debug] [ThreadPool]: On list_sales_database: Close
[0m07:39:33.972898 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_database, now create_sales_database_main)
[0m07:39:33.976453 [debug] [ThreadPool]: Creating schema "database: "sales_database"
schema: "main"
"
[0m07:39:34.015590 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m07:39:34.020947 [debug] [ThreadPool]: On create_sales_database_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "create_sales_database_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='sales_database'
        and type='sqlite'
    
  
[0m07:39:34.038558 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:39:34.152569 [debug] [ThreadPool]: SQL status: OK in 0.114 seconds
[0m07:39:34.158122 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m07:39:34.159369 [debug] [ThreadPool]: On create_sales_database_main: BEGIN
[0m07:39:34.161422 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m07:39:34.163061 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m07:39:34.164592 [debug] [ThreadPool]: On create_sales_database_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "create_sales_database_main"} */

    
    
        create schema if not exists "sales_database"."main"
    
[0m07:39:34.186233 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m07:39:34.189649 [debug] [ThreadPool]: On create_sales_database_main: COMMIT
[0m07:39:34.191262 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m07:39:34.192614 [debug] [ThreadPool]: On create_sales_database_main: COMMIT
[0m07:39:34.194690 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m07:39:34.196362 [debug] [ThreadPool]: On create_sales_database_main: Close
[0m07:39:34.207099 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_sales_database_main, now list_sales_database_main)
[0m07:39:34.224495 [debug] [ThreadPool]: Using duckdb connection "list_sales_database_main"
[0m07:39:34.226345 [debug] [ThreadPool]: On list_sales_database_main: BEGIN
[0m07:39:34.227559 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:39:34.298677 [debug] [ThreadPool]: SQL status: OK in 0.071 seconds
[0m07:39:34.300176 [debug] [ThreadPool]: Using duckdb connection "list_sales_database_main"
[0m07:39:34.302488 [debug] [ThreadPool]: On list_sales_database_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "list_sales_database_main"} */
select
      'sales_database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'sales_database'
  
[0m07:39:34.506555 [debug] [ThreadPool]: SQL status: OK in 0.202 seconds
[0m07:39:34.512153 [debug] [ThreadPool]: On list_sales_database_main: ROLLBACK
[0m07:39:34.537688 [debug] [ThreadPool]: Failed to rollback 'list_sales_database_main'
[0m07:39:34.542936 [debug] [ThreadPool]: On list_sales_database_main: Close
[0m07:39:34.556780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2615d981-2c41-4be2-a2ce-3788beec6e35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53bd70f050>]}
[0m07:39:34.560995 [debug] [MainThread]: Using duckdb connection "master"
[0m07:39:34.562877 [debug] [MainThread]: On master: BEGIN
[0m07:39:34.565276 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:39:34.646869 [debug] [MainThread]: SQL status: OK in 0.082 seconds
[0m07:39:34.649015 [debug] [MainThread]: On master: COMMIT
[0m07:39:34.653026 [debug] [MainThread]: Using duckdb connection "master"
[0m07:39:34.656964 [debug] [MainThread]: On master: COMMIT
[0m07:39:34.659824 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m07:39:34.661575 [debug] [MainThread]: On master: Close
[0m07:39:34.687428 [debug] [Thread-1 (]: Began running node model.my_dbt_project.customer_dimension
[0m07:39:34.692804 [info ] [Thread-1 (]: 1 of 8 START sql view model main.customer_dimension ............................ [RUN]
[0m07:39:34.696943 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.my_dbt_project.customer_dimension'
[0m07:39:34.699347 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.customer_dimension
[0m07:39:34.740369 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.customer_dimension"
[0m07:39:34.833611 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.customer_dimension
[0m07:39:34.998823 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.customer_dimension"
[0m07:39:35.027167 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m07:39:35.029301 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: BEGIN
[0m07:39:35.032314 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m07:39:35.095801 [debug] [Thread-1 (]: SQL status: OK in 0.063 seconds
[0m07:39:35.097776 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m07:39:35.100788 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */

  
  create view "sales_database"."main"."customer_dimension__dbt_tmp" as (
    -- WITH sales AS (
--     SELECT * FROM "sales_database"."main"."sales"
-- )

-- SELECT
--     DISTINCT
--     customer AS customer_id,
--     customer_name,
--     customer_address,
--     customer_group,
--     territory,
--     language AS customer_language
-- FROM sales
-- WHERE customer IS NOT NULL




WITH customers AS (
    SELECT DISTINCT
        customer AS customer_id,
        customer_name,
        customer_group,
        territory
    FROM "sales_database"."main"."sales"
)

SELECT * FROM customers
  );

[0m07:39:35.104666 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:39:35.131065 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m07:39:35.137121 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */
alter view "sales_database"."main"."customer_dimension__dbt_tmp" rename to "customer_dimension"
[0m07:39:35.141476 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:39:35.175440 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: COMMIT
[0m07:39:35.177130 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m07:39:35.179522 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: COMMIT
[0m07:39:35.333766 [debug] [Thread-1 (]: SQL status: OK in 0.150 seconds
[0m07:39:35.389994 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.customer_dimension"
[0m07:39:35.394198 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.customer_dimension"} */
drop view if exists "sales_database"."main"."customer_dimension__dbt_backup" cascade
[0m07:39:35.397844 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:39:35.410002 [debug] [Thread-1 (]: On model.my_dbt_project.customer_dimension: Close
[0m07:39:35.843178 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2615d981-2c41-4be2-a2ce-3788beec6e35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53bd9fff20>]}
[0m07:39:35.846954 [info ] [Thread-1 (]: 1 of 8 OK created sql view model main.customer_dimension ....................... [[32mOK[0m in 1.14s]
[0m07:39:35.853722 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.customer_dimension
[0m07:39:35.855808 [debug] [Thread-1 (]: Began running node model.my_dbt_project.date_dimension
[0m07:39:35.858498 [info ] [Thread-1 (]: 2 of 8 START sql view model main.date_dimension ................................ [RUN]
[0m07:39:35.860792 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.customer_dimension, now model.my_dbt_project.date_dimension)
[0m07:39:35.862577 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.date_dimension
[0m07:39:35.877778 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.date_dimension"
[0m07:39:35.930065 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.date_dimension
[0m07:39:35.939976 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.date_dimension"
[0m07:39:36.144177 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m07:39:36.166355 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: BEGIN
[0m07:39:36.201436 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:39:36.390071 [debug] [Thread-1 (]: SQL status: OK in 0.189 seconds
[0m07:39:36.396060 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m07:39:36.406829 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.date_dimension"} */

  
  create view "sales_database"."main"."date_dimension__dbt_tmp" as (
    -- WITH sales AS (
--     SELECT * FROM "sales_database"."main"."sales"
-- )
-- SELECT
--     transaction_date,
--     strftime(transaction_date, '%Y-%m-%d') AS date_id,  -- Change the format to YYYY-MM-DD
--     strftime(transaction_date, '%A') AS weekday_name,
--     strftime(transaction_date, '%m') AS month,
--     strftime(transaction_date, '%Y') AS year,
--     strftime(transaction_date, '%d') AS day,
--     EXTRACT(QUARTER FROM transaction_date) AS quarter
-- FROM sales
-- WHERE transaction_date IS NOT NULL


WITH date_data AS (
    SELECT DISTINCT
        transaction_date AS date_id,
        EXTRACT(YEAR FROM transaction_date) AS year,
        EXTRACT(MONTH FROM transaction_date) AS month,
        EXTRACT(DAY FROM transaction_date) AS day,
        EXTRACT(WEEK FROM transaction_date) AS week_of_year,
        EXTRACT(QUARTER FROM transaction_date) AS quarter
    FROM "sales_database"."main"."sales"
)

SELECT * FROM date_data
  );

[0m07:39:36.421024 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m07:39:36.443431 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m07:39:36.447854 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.date_dimension"} */
alter view "sales_database"."main"."date_dimension__dbt_tmp" rename to "date_dimension"
[0m07:39:36.451076 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:39:36.458034 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: COMMIT
[0m07:39:36.473686 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m07:39:36.475852 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: COMMIT
[0m07:39:36.617464 [debug] [Thread-1 (]: SQL status: OK in 0.138 seconds
[0m07:39:36.635156 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.date_dimension"
[0m07:39:36.637413 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.date_dimension"} */
drop view if exists "sales_database"."main"."date_dimension__dbt_backup" cascade
[0m07:39:36.646882 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:39:36.652071 [debug] [Thread-1 (]: On model.my_dbt_project.date_dimension: Close
[0m07:39:37.067878 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2615d981-2c41-4be2-a2ce-3788beec6e35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53b43e2180>]}
[0m07:39:37.070759 [info ] [Thread-1 (]: 2 of 8 OK created sql view model main.date_dimension ........................... [[32mOK[0m in 1.21s]
[0m07:39:37.073232 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.date_dimension
[0m07:39:37.076331 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_company
[0m07:39:37.079261 [info ] [Thread-1 (]: 3 of 8 START sql view model main.dim_company ................................... [RUN]
[0m07:39:37.089930 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.date_dimension, now model.my_dbt_project.dim_company)
[0m07:39:37.093100 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_company
[0m07:39:37.113062 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_company"
[0m07:39:37.199573 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_company
[0m07:39:37.261686 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_company"
[0m07:39:37.369818 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_company"
[0m07:39:37.379096 [debug] [Thread-1 (]: On model.my_dbt_project.dim_company: BEGIN
[0m07:39:37.389058 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:39:37.573862 [debug] [Thread-1 (]: SQL status: OK in 0.184 seconds
[0m07:39:37.588100 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_company"
[0m07:39:37.591010 [debug] [Thread-1 (]: On model.my_dbt_project.dim_company: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.dim_company"} */

  
  create view "sales_database"."main"."dim_company__dbt_tmp" as (
    WITH companies AS (
    SELECT DISTINCT
        company AS company_id,
        company
    FROM "sales_database"."main"."sales"
)

SELECT * FROM companies
  );

[0m07:39:37.595903 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:39:37.614379 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_company"
[0m07:39:37.622059 [debug] [Thread-1 (]: On model.my_dbt_project.dim_company: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.dim_company"} */
alter view "sales_database"."main"."dim_company__dbt_tmp" rename to "dim_company"
[0m07:39:37.625293 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:39:37.636632 [debug] [Thread-1 (]: On model.my_dbt_project.dim_company: COMMIT
[0m07:39:37.638917 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_company"
[0m07:39:37.641076 [debug] [Thread-1 (]: On model.my_dbt_project.dim_company: COMMIT
[0m07:39:37.793782 [debug] [Thread-1 (]: SQL status: OK in 0.150 seconds
[0m07:39:37.803450 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_company"
[0m07:39:37.816079 [debug] [Thread-1 (]: On model.my_dbt_project.dim_company: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.dim_company"} */
drop view if exists "sales_database"."main"."dim_company__dbt_backup" cascade
[0m07:39:37.823956 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:39:37.830155 [debug] [Thread-1 (]: On model.my_dbt_project.dim_company: Close
[0m07:39:38.500984 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2615d981-2c41-4be2-a2ce-3788beec6e35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53b43356d0>]}
[0m07:39:38.513186 [info ] [Thread-1 (]: 3 of 8 OK created sql view model main.dim_company .............................. [[32mOK[0m in 1.41s]
[0m07:39:38.534014 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_company
[0m07:39:38.546449 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_currency
[0m07:39:38.561921 [info ] [Thread-1 (]: 4 of 8 START sql view model main.dim_currency .................................. [RUN]
[0m07:39:38.593429 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_company, now model.my_dbt_project.dim_currency)
[0m07:39:38.608810 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_currency
[0m07:39:38.677516 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_currency"
[0m07:39:38.742059 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_currency
[0m07:39:38.784667 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_currency"
[0m07:39:39.021857 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_currency"
[0m07:39:39.026157 [debug] [Thread-1 (]: On model.my_dbt_project.dim_currency: BEGIN
[0m07:39:39.038128 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:39:39.432520 [debug] [Thread-1 (]: SQL status: OK in 0.395 seconds
[0m07:39:39.481988 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_currency"
[0m07:39:39.493103 [debug] [Thread-1 (]: On model.my_dbt_project.dim_currency: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.dim_currency"} */

  
  create view "sales_database"."main"."dim_currency__dbt_tmp" as (
    WITH currency_data AS (
    SELECT DISTINCT
        currency AS currency_id,
        currency,
        conversion_rate
    FROM "sales_database"."main"."sales"
)

SELECT * FROM currency_data
  );

[0m07:39:39.539246 [debug] [Thread-1 (]: SQL status: OK in 0.033 seconds
[0m07:39:39.569854 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_currency"
[0m07:39:39.579429 [debug] [Thread-1 (]: On model.my_dbt_project.dim_currency: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.dim_currency"} */
alter view "sales_database"."main"."dim_currency__dbt_tmp" rename to "dim_currency"
[0m07:39:39.594205 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:39:39.614119 [debug] [Thread-1 (]: On model.my_dbt_project.dim_currency: COMMIT
[0m07:39:39.641556 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_currency"
[0m07:39:39.660270 [debug] [Thread-1 (]: On model.my_dbt_project.dim_currency: COMMIT
[0m07:39:39.971641 [debug] [Thread-1 (]: SQL status: OK in 0.266 seconds
[0m07:39:40.018401 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_currency"
[0m07:39:40.023901 [debug] [Thread-1 (]: On model.my_dbt_project.dim_currency: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.dim_currency"} */
drop view if exists "sales_database"."main"."dim_currency__dbt_backup" cascade
[0m07:39:40.029952 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m07:39:40.093316 [debug] [Thread-1 (]: On model.my_dbt_project.dim_currency: Close
[0m07:39:40.872931 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2615d981-2c41-4be2-a2ce-3788beec6e35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5394cbf260>]}
[0m07:39:40.876840 [info ] [Thread-1 (]: 4 of 8 OK created sql view model main.dim_currency ............................. [[32mOK[0m in 2.29s]
[0m07:39:40.881070 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_currency
[0m07:39:40.883584 [debug] [Thread-1 (]: Began running node model.my_dbt_project.product_dimension
[0m07:39:40.891097 [info ] [Thread-1 (]: 5 of 8 START sql view model main.product_dimension ............................. [RUN]
[0m07:39:40.897107 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_currency, now model.my_dbt_project.product_dimension)
[0m07:39:40.904379 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.product_dimension
[0m07:39:40.924839 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.product_dimension"
[0m07:39:40.991136 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.product_dimension
[0m07:39:41.040167 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.product_dimension"
[0m07:39:41.081793 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m07:39:41.084048 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: BEGIN
[0m07:39:41.087834 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:39:41.476977 [debug] [Thread-1 (]: SQL status: OK in 0.390 seconds
[0m07:39:41.500290 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m07:39:41.504905 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.product_dimension"} */

  
  create view "sales_database"."main"."product_dimension__dbt_tmp" as (
    -- WITH sales AS (
--     SELECT * 
--     FROM "sales_database"."main"."sales"
-- )

-- SELECT 
--     sales.name,
--     json_extract(items, '$[0].name') AS product_name,  -- Example to extract the first element's "name" field from JSON array
--     json_extract(items, '$[0].item_code') AS product_item_code
-- FROM sales
-- WHERE json_extract(items, '$[0].name') IS NOT NULL  -- Filter to only keep rows with a non-null product name



WITH exploded_items AS (
    SELECT
        name AS sales_order_id,
        JSON_EXTRACT(items, '$[*].item_code') AS product_code,
        JSON_EXTRACT(items, '$[*].item_name') AS product_name,
        JSON_EXTRACT(items, '$[*].qty') AS quantity_sold,
        JSON_EXTRACT(items, '$[*].rate') AS unit_price
    FROM "sales_database"."main"."sales"
)

SELECT 
    sales_order_id,
    UNNEST(product_code) AS product_id,
    UNNEST(product_name) AS product_name,
    UNNEST(quantity_sold) AS quantity_sold,
    UNNEST(unit_price) AS unit_price
FROM exploded_items
  );

[0m07:39:41.529172 [debug] [Thread-1 (]: SQL status: OK in 0.019 seconds
[0m07:39:41.548380 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m07:39:41.550934 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.product_dimension"} */
alter view "sales_database"."main"."product_dimension__dbt_tmp" rename to "product_dimension"
[0m07:39:41.557259 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:39:41.572141 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: COMMIT
[0m07:39:41.575091 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m07:39:41.581468 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: COMMIT
[0m07:39:41.815807 [debug] [Thread-1 (]: SQL status: OK in 0.228 seconds
[0m07:39:41.844486 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.product_dimension"
[0m07:39:41.858703 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.product_dimension"} */
drop view if exists "sales_database"."main"."product_dimension__dbt_backup" cascade
[0m07:39:41.866223 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m07:39:41.880019 [debug] [Thread-1 (]: On model.my_dbt_project.product_dimension: Close
[0m07:39:42.535068 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2615d981-2c41-4be2-a2ce-3788beec6e35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5394c88f20>]}
[0m07:39:42.543716 [info ] [Thread-1 (]: 5 of 8 OK created sql view model main.product_dimension ........................ [[32mOK[0m in 1.64s]
[0m07:39:42.546825 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.product_dimension
[0m07:39:42.548946 [debug] [Thread-1 (]: Began running node model.my_dbt_project.sales_team_dimension
[0m07:39:42.551138 [info ] [Thread-1 (]: 6 of 8 START sql view model main.sales_team_dimension .......................... [RUN]
[0m07:39:42.561976 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.product_dimension, now model.my_dbt_project.sales_team_dimension)
[0m07:39:42.564239 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.sales_team_dimension
[0m07:39:42.592458 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.sales_team_dimension"
[0m07:39:42.614546 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.sales_team_dimension
[0m07:39:42.640849 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.sales_team_dimension"
[0m07:39:42.707444 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m07:39:42.711041 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: BEGIN
[0m07:39:42.713688 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:39:42.888439 [debug] [Thread-1 (]: SQL status: OK in 0.175 seconds
[0m07:39:42.897991 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m07:39:42.917487 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */

  
  create view "sales_database"."main"."sales_team_dimension__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
    DISTINCT
    sales_team->>'name' AS sales_team_id,
    sales_team->>'region' AS sales_team_region
FROM sales
WHERE sales_team IS NOT NULL
  );

[0m07:39:43.008928 [debug] [Thread-1 (]: SQL status: OK in 0.078 seconds
[0m07:39:43.055130 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m07:39:43.088357 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */
alter view "sales_database"."main"."sales_team_dimension__dbt_tmp" rename to "sales_team_dimension"
[0m07:39:43.105822 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:39:43.124611 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: COMMIT
[0m07:39:43.155395 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m07:39:43.164176 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: COMMIT
[0m07:39:43.575284 [debug] [Thread-1 (]: SQL status: OK in 0.399 seconds
[0m07:39:43.602353 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_team_dimension"
[0m07:39:43.624329 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_team_dimension"} */
drop view if exists "sales_database"."main"."sales_team_dimension__dbt_backup" cascade
[0m07:39:43.648732 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m07:39:43.657726 [debug] [Thread-1 (]: On model.my_dbt_project.sales_team_dimension: Close
[0m07:39:44.239553 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2615d981-2c41-4be2-a2ce-3788beec6e35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53b43123c0>]}
[0m07:39:44.271311 [info ] [Thread-1 (]: 6 of 8 OK created sql view model main.sales_team_dimension ..................... [[32mOK[0m in 1.68s]
[0m07:39:44.305198 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.sales_team_dimension
[0m07:39:44.323398 [debug] [Thread-1 (]: Began running node model.my_dbt_project.transform_sales
[0m07:39:44.335907 [info ] [Thread-1 (]: 7 of 8 START sql table model main.transform_sales .............................. [RUN]
[0m07:39:44.351068 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.sales_team_dimension, now model.my_dbt_project.transform_sales)
[0m07:39:44.386919 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.transform_sales
[0m07:39:44.497754 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.transform_sales"
[0m07:39:44.522842 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.transform_sales
[0m07:39:44.591611 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.transform_sales"
[0m07:39:44.609893 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m07:39:44.612016 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: BEGIN
[0m07:39:44.616289 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:39:45.290292 [debug] [Thread-1 (]: SQL status: OK in 0.674 seconds
[0m07:39:45.293106 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m07:39:45.305012 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */

  
    
    

    create  table
      "sales_database"."main"."transform_sales__dbt_tmp"
  
    as (
      -- /opt/airflow/dags/dbt_models/transform_users.sql


WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
   *
FROM sales
WHERE name = 'ABC private LTD-0002'
    );
  
  
[0m07:39:45.622676 [debug] [Thread-1 (]: SQL status: OK in 0.315 seconds
[0m07:39:45.728628 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m07:39:45.741058 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */
alter table "sales_database"."main"."transform_sales__dbt_tmp" rename to "transform_sales"
[0m07:39:45.756989 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m07:39:45.822961 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: COMMIT
[0m07:39:45.836511 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m07:39:45.842122 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: COMMIT
[0m07:39:46.219305 [debug] [Thread-1 (]: SQL status: OK in 0.373 seconds
[0m07:39:46.254381 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m07:39:46.269689 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */
drop table if exists "sales_database"."main"."transform_sales__dbt_backup" cascade
[0m07:39:46.274867 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m07:39:46.288164 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: Close
[0m07:39:47.603666 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2615d981-2c41-4be2-a2ce-3788beec6e35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5394ce75c0>]}
[0m07:39:47.620353 [info ] [Thread-1 (]: 7 of 8 OK created sql table model main.transform_sales ......................... [[32mOK[0m in 3.24s]
[0m07:39:47.627186 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.transform_sales
[0m07:39:47.638426 [debug] [Thread-1 (]: Began running node model.my_dbt_project.sales_fact
[0m07:39:47.656354 [info ] [Thread-1 (]: 8 of 8 START sql table model main.sales_fact ................................... [RUN]
[0m07:39:47.660818 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.transform_sales, now model.my_dbt_project.sales_fact)
[0m07:39:47.686303 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.sales_fact
[0m07:39:48.125579 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.sales_fact"
[0m07:39:48.494453 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.sales_fact
[0m07:39:48.537319 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.sales_fact"
[0m07:39:48.811950 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_fact"
[0m07:39:48.851987 [debug] [Thread-1 (]: On model.my_dbt_project.sales_fact: BEGIN
[0m07:39:48.856730 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:39:50.845670 [debug] [Thread-1 (]: SQL status: OK in 1.967 seconds
[0m07:39:50.879371 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_fact"
[0m07:39:50.885937 [debug] [Thread-1 (]: On model.my_dbt_project.sales_fact: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_fact"} */

  
    
    

    create  table
      "sales_database"."main"."sales_fact__dbt_tmp"
  
    as (
      -- WITH sales AS (
--     SELECT * FROM "sales_database"."main"."sales"
-- ),
-- customer AS (
--     SELECT * FROM "sales_database"."main"."customer_dimension"
-- ),
-- product AS (
--     SELECT * FROM "sales_database"."main"."product_dimension"
-- ),
-- sales_team AS (
--     SELECT * FROM "sales_database"."main"."sales_team_dimension"
-- ),
-- date AS (
--     SELECT * FROM "sales_database"."main"."date_dimension"
-- )

-- SELECT
--     s.name AS sales_id,
--     c.customer_id,
--     p.product_id,
--     st.sales_team_id,
--     d.date_id,
--     s.total_qty,
--     s.total_net_weight,
--     s.total,
--     s.net_total,
--     s.grand_total,
--     s.tax_category
-- FROM sales s
-- JOIN customer c 
--     ON s.customer = c.customer_id
-- -- Handling product as JSON in DuckDB
-- JOIN LATERAL (
--     SELECT json_extract(s.items, '$[0].product_id') AS product_id
--     FROM (VALUES (s.items)) AS items(item)
--     WHERE json_extract(item, '$[0].product_id') IS NOT NULL
-- ) AS p ON TRUE
-- -- Handling sales_team as JSON in DuckDB
-- JOIN LATERAL (
--     SELECT json_extract(s.sales_team, '$[0].sales_team_id') AS sales_team_id
--     FROM (VALUES (s.sales_team)) AS team(item)
--     WHERE json_extract(item, '$[0].sales_team_id') IS NOT NULL
-- ) AS st ON TRUE
-- JOIN date d 
--     ON s.transaction_date = d.date_id




WITH sales_data AS (
    SELECT
        name AS sales_order_id,
        transaction_date,
        customer,
        company,
        total AS sales_amount,
        net_total,
        discount_amount,
        base_total_taxes_and_charges AS tax_amount,
        grand_total,
        currency,
        conversion_rate,
        items, -- JSON field with product details
        taxes -- JSON field with tax details
    FROM "sales_database"."main"."sales"
)

SELECT * FROM sales_data
    );
  
  
[0m07:39:51.369054 [debug] [Thread-1 (]: SQL status: OK in 0.480 seconds
[0m07:39:51.431635 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_fact"
[0m07:39:51.446968 [debug] [Thread-1 (]: On model.my_dbt_project.sales_fact: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_fact"} */
alter table "sales_database"."main"."sales_fact__dbt_tmp" rename to "sales_fact"
[0m07:39:51.471636 [debug] [Thread-1 (]: SQL status: OK in 0.016 seconds
[0m07:39:51.506996 [debug] [Thread-1 (]: On model.my_dbt_project.sales_fact: COMMIT
[0m07:39:51.515664 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_fact"
[0m07:39:51.518288 [debug] [Thread-1 (]: On model.my_dbt_project.sales_fact: COMMIT
[0m07:39:51.725971 [debug] [Thread-1 (]: SQL status: OK in 0.200 seconds
[0m07:39:51.759782 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.sales_fact"
[0m07:39:51.766001 [debug] [Thread-1 (]: On model.my_dbt_project.sales_fact: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.sales_fact"} */
drop table if exists "sales_database"."main"."sales_fact__dbt_backup" cascade
[0m07:39:51.774522 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m07:39:51.807536 [debug] [Thread-1 (]: On model.my_dbt_project.sales_fact: Close
[0m07:39:53.357191 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2615d981-2c41-4be2-a2ce-3788beec6e35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53b5b55220>]}
[0m07:39:53.372484 [info ] [Thread-1 (]: 8 of 8 OK created sql table model main.sales_fact .............................. [[32mOK[0m in 5.55s]
[0m07:39:53.394616 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.sales_fact
[0m07:39:53.479660 [debug] [MainThread]: Using duckdb connection "master"
[0m07:39:53.487993 [debug] [MainThread]: On master: BEGIN
[0m07:39:53.493475 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:39:54.977095 [debug] [MainThread]: SQL status: OK in 1.478 seconds
[0m07:39:55.029378 [debug] [MainThread]: On master: COMMIT
[0m07:39:55.035578 [debug] [MainThread]: Using duckdb connection "master"
[0m07:39:55.042697 [debug] [MainThread]: On master: COMMIT
[0m07:39:55.071872 [debug] [MainThread]: SQL status: OK in 0.017 seconds
[0m07:39:55.101593 [debug] [MainThread]: On master: Close
[0m07:39:55.403016 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:39:55.406633 [debug] [MainThread]: Connection 'list_sales_database_main' was properly closed.
[0m07:39:55.418119 [debug] [MainThread]: Connection 'model.my_dbt_project.sales_fact' was properly closed.
[0m07:39:55.437630 [info ] [MainThread]: 
[0m07:39:55.449316 [info ] [MainThread]: Finished running 2 table models, 6 view models in 0 hours 0 minutes and 22.24 seconds (22.24s).
[0m07:39:55.471007 [debug] [MainThread]: Command end result
[0m07:39:56.086011 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m07:39:56.320495 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m07:39:56.425733 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dags/dbt_models/target/run_results.json
[0m07:39:56.428355 [info ] [MainThread]: 
[0m07:39:56.434854 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:39:56.442897 [info ] [MainThread]: 
[0m07:39:56.447900 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m07:39:56.457854 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 37.88164, "process_in_blocks": "1588872", "process_kernel_time": 10.919947, "process_mem_max_rss": "134400", "process_out_blocks": "0", "process_user_time": 17.38598}
[0m07:39:56.479332 [debug] [MainThread]: Command `dbt run` succeeded at 07:39:56.478937 after 37.91 seconds
[0m07:39:56.486665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53bb7d1310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53bc47a0c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53bc47aff0>]}
[0m07:39:56.489588 [debug] [MainThread]: Flushing usage events
[0m07:40:06.787429 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:50:39.825930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f698d681790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f698dc7c950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f698cc582c0>]}


============================== 07:50:39.847666 | c19acdb4-8582-46f2-81bc-fe32822406e8 ==============================
[0m07:50:39.847666 [info ] [MainThread]: Running with dbt=1.9.2
[0m07:50:39.850019 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dags/dbt_models/logs', 'profiles_dir': '/opt/airflow/dbt/profiles.yml', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt/profiles.yml --target dev', 'send_anonymous_usage_stats': 'True'}
[0m07:50:42.642202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c19acdb4-8582-46f2-81bc-fe32822406e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69890770b0>]}
[0m07:50:44.333309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c19acdb4-8582-46f2-81bc-fe32822406e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f698d2a14c0>]}
[0m07:50:45.664823 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m07:51:07.115327 [debug] [MainThread]: checksum: eea1a9e9f56a74d304aa4a9e5e9c8fc1dea4ccd2b0ec98e366756009c99c5c94, vars: {}, profile: , target: dev, version: 1.9.2
[0m07:51:08.528338 [debug] [MainThread]: Partial parsing enabled: 5 files deleted, 5 files added, 0 files changed.
[0m07:51:08.536577 [debug] [MainThread]: Partial parsing: added file: my_dbt_project://models/facts/fact_sales.sql
[0m07:51:08.548793 [debug] [MainThread]: Partial parsing: added file: my_dbt_project://models/dimensions/dim_sales_team.sql
[0m07:51:08.551286 [debug] [MainThread]: Partial parsing: added file: my_dbt_project://models/dimensions/dim_customer.sql
[0m07:51:08.556394 [debug] [MainThread]: Partial parsing: added file: my_dbt_project://models/dimensions/dim_date.sql
[0m07:51:08.558734 [debug] [MainThread]: Partial parsing: added file: my_dbt_project://models/dimensions/dim_produt.sql
[0m07:51:08.562546 [debug] [MainThread]: Partial parsing: deleted file: my_dbt_project://models/dimensions/sales_team_dimension.sql
[0m07:51:08.564595 [debug] [MainThread]: Partial parsing: deleted file: my_dbt_project://models/dimensions/product_dimension.sql
[0m07:51:08.579809 [debug] [MainThread]: Partial parsing: deleted file: my_dbt_project://models/dimensions/customer_dimension.sql
[0m07:51:08.581568 [debug] [MainThread]: Partial parsing: deleted file: my_dbt_project://models/dimensions/date_dimension.sql
[0m07:51:08.585622 [debug] [MainThread]: Partial parsing: deleted file: my_dbt_project://models/facts/sales_fact.sql
[0m07:51:10.469363 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.my_dbt_project.fact_sales' (models/facts/fact_sales.sql) depends on a node named 'customer_dimension' which was not found
[0m07:51:10.524787 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 30.992538, "process_in_blocks": "705480", "process_kernel_time": 4.785812, "process_mem_max_rss": "121104", "process_out_blocks": "0", "process_user_time": 10.069739}
[0m07:51:10.531120 [debug] [MainThread]: Command `dbt run` failed at 07:51:10.530188 after 31.01 seconds
[0m07:51:10.534707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f698cd0b1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f698915fa10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6986acab40>]}
[0m07:51:10.544405 [debug] [MainThread]: Flushing usage events
[0m07:51:12.100313 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:54:41.729981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a99bb9f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a997ad670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a99bbba10>]}


============================== 07:54:41.758084 | d625305d-83ba-48de-ad08-ff99c10e8d41 ==============================
[0m07:54:41.758084 [info ] [MainThread]: Running with dbt=1.9.2
[0m07:54:41.762205 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/profiles.yml', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dags/dbt_models/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt/profiles.yml --target dev', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:54:43.696108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd625305d-83ba-48de-ad08-ff99c10e8d41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a95af8cb0>]}
[0m07:54:44.612964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd625305d-83ba-48de-ad08-ff99c10e8d41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a9b242ba0>]}
[0m07:54:44.834159 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m07:54:45.656731 [debug] [MainThread]: checksum: eea1a9e9f56a74d304aa4a9e5e9c8fc1dea4ccd2b0ec98e366756009c99c5c94, vars: {}, profile: , target: dev, version: 1.9.2
[0m07:54:46.547236 [debug] [MainThread]: Partial parsing enabled: 5 files deleted, 5 files added, 0 files changed.
[0m07:54:46.549236 [debug] [MainThread]: Partial parsing: added file: my_dbt_project://models/facts/fact_sales.sql
[0m07:54:46.550994 [debug] [MainThread]: Partial parsing: added file: my_dbt_project://models/dimensions/dim_produt.sql
[0m07:54:46.552509 [debug] [MainThread]: Partial parsing: added file: my_dbt_project://models/dimensions/dim_customer.sql
[0m07:54:46.556158 [debug] [MainThread]: Partial parsing: added file: my_dbt_project://models/dimensions/dim_sales_team.sql
[0m07:54:46.557670 [debug] [MainThread]: Partial parsing: added file: my_dbt_project://models/dimensions/dim_date.sql
[0m07:54:46.559254 [debug] [MainThread]: Partial parsing: deleted file: my_dbt_project://models/dimensions/customer_dimension.sql
[0m07:54:46.560705 [debug] [MainThread]: Partial parsing: deleted file: my_dbt_project://models/dimensions/product_dimension.sql
[0m07:54:46.562210 [debug] [MainThread]: Partial parsing: deleted file: my_dbt_project://models/dimensions/sales_team_dimension.sql
[0m07:54:46.563679 [debug] [MainThread]: Partial parsing: deleted file: my_dbt_project://models/facts/sales_fact.sql
[0m07:54:46.565319 [debug] [MainThread]: Partial parsing: deleted file: my_dbt_project://models/dimensions/date_dimension.sql
[0m07:54:47.167587 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.my_dbt_project.fact_sales' (models/facts/fact_sales.sql) depends on a node named 'customer_dimension' which was not found
[0m07:54:47.173417 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 5.8281136, "process_in_blocks": "296168", "process_kernel_time": 1.70366, "process_mem_max_rss": "120108", "process_out_blocks": "0", "process_user_time": 8.75435}
[0m07:54:47.180633 [debug] [MainThread]: Command `dbt run` failed at 07:54:47.180336 after 5.84 seconds
[0m07:54:47.181944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a998d1910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a9359f7a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a933879b0>]}
[0m07:54:47.183279 [debug] [MainThread]: Flushing usage events
[0m07:54:49.023933 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:01:39.047516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ab4d5a750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ab638ed50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ab661c980>]}


============================== 08:01:39.064833 | 81b382a3-4a9d-4800-be87-074fdb3a28e3 ==============================
[0m08:01:39.064833 [info ] [MainThread]: Running with dbt=1.9.2
[0m08:01:39.067236 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/profiles.yml', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dags/dbt_models/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt/profiles.yml --target dev', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m08:01:39.944578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '81b382a3-4a9d-4800-be87-074fdb3a28e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ab4389d60>]}
[0m08:01:40.086168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '81b382a3-4a9d-4800-be87-074fdb3a28e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ab3f9bb30>]}
[0m08:01:40.098872 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m08:01:40.398399 [debug] [MainThread]: checksum: eea1a9e9f56a74d304aa4a9e5e9c8fc1dea4ccd2b0ec98e366756009c99c5c94, vars: {}, profile: , target: dev, version: 1.9.2
[0m08:01:40.940260 [debug] [MainThread]: Partial parsing enabled: 5 files deleted, 5 files added, 0 files changed.
[0m08:01:40.941652 [debug] [MainThread]: Partial parsing: added file: my_dbt_project://models/dimensions/dim_produt.sql
[0m08:01:40.942936 [debug] [MainThread]: Partial parsing: added file: my_dbt_project://models/dimensions/dim_customer.sql
[0m08:01:40.944198 [debug] [MainThread]: Partial parsing: added file: my_dbt_project://models/facts/fact_sales.sql
[0m08:01:40.945378 [debug] [MainThread]: Partial parsing: added file: my_dbt_project://models/dimensions/dim_sales_team.sql
[0m08:01:40.946600 [debug] [MainThread]: Partial parsing: added file: my_dbt_project://models/dimensions/dim_date.sql
[0m08:01:40.947794 [debug] [MainThread]: Partial parsing: deleted file: my_dbt_project://models/dimensions/customer_dimension.sql
[0m08:01:40.949414 [debug] [MainThread]: Partial parsing: deleted file: my_dbt_project://models/facts/sales_fact.sql
[0m08:01:40.950755 [debug] [MainThread]: Partial parsing: deleted file: my_dbt_project://models/dimensions/sales_team_dimension.sql
[0m08:01:40.953316 [debug] [MainThread]: Partial parsing: deleted file: my_dbt_project://models/dimensions/product_dimension.sql
[0m08:01:40.954479 [debug] [MainThread]: Partial parsing: deleted file: my_dbt_project://models/dimensions/date_dimension.sql
[0m08:01:41.438388 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.my_dbt_project.fact_sales' (models/facts/fact_sales.sql) depends on a node named 'customer_dimension' which was not found
[0m08:01:41.441828 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.5877864, "process_in_blocks": "72720", "process_kernel_time": 0.709517, "process_mem_max_rss": "132772", "process_out_blocks": "0", "process_user_time": 6.935287}
[0m08:01:41.443633 [debug] [MainThread]: Command `dbt run` failed at 08:01:41.443283 after 2.59 seconds
[0m08:01:41.445264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ab4d5a750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ab097aba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ab3f7c950>]}
[0m08:01:41.446853 [debug] [MainThread]: Flushing usage events
[0m08:01:42.763385 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:05:07.791877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd985bbffe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd98406a030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd983ce8c20>]}


============================== 08:05:07.883966 | cff6d427-4603-4fae-b749-616e0da04e0f ==============================
[0m08:05:07.883966 [info ] [MainThread]: Running with dbt=1.9.2
[0m08:05:07.890692 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dags/dbt_models/logs', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt/profiles.yml', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt/profiles.yml --target dev', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m08:05:10.743250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cff6d427-4603-4fae-b749-616e0da04e0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9837636e0>]}
[0m08:05:11.449927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cff6d427-4603-4fae-b749-616e0da04e0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9857c2d80>]}
[0m08:05:11.728301 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m08:05:14.678281 [debug] [MainThread]: checksum: eea1a9e9f56a74d304aa4a9e5e9c8fc1dea4ccd2b0ec98e366756009c99c5c94, vars: {}, profile: , target: dev, version: 1.9.2
[0m08:05:50.220423 [debug] [MainThread]: Partial parsing enabled: 5 files deleted, 5 files added, 0 files changed.
[0m08:05:50.265799 [debug] [MainThread]: Partial parsing: added file: my_dbt_project://models/dimensions/dim_produt.sql
[0m08:05:50.287755 [debug] [MainThread]: Partial parsing: added file: my_dbt_project://models/facts/fact_sales.sql
[0m08:05:50.319469 [debug] [MainThread]: Partial parsing: added file: my_dbt_project://models/dimensions/dim_date.sql
[0m08:05:50.327114 [debug] [MainThread]: Partial parsing: added file: my_dbt_project://models/dimensions/dim_sales_team.sql
[0m08:05:50.344426 [debug] [MainThread]: Partial parsing: added file: my_dbt_project://models/dimensions/dim_customer.sql
[0m08:05:50.359912 [debug] [MainThread]: Partial parsing: deleted file: my_dbt_project://models/facts/sales_fact.sql
[0m08:05:50.370305 [debug] [MainThread]: Partial parsing: deleted file: my_dbt_project://models/dimensions/product_dimension.sql
[0m08:05:50.380017 [debug] [MainThread]: Partial parsing: deleted file: my_dbt_project://models/dimensions/date_dimension.sql
[0m08:05:50.381808 [debug] [MainThread]: Partial parsing: deleted file: my_dbt_project://models/dimensions/sales_team_dimension.sql
[0m08:05:50.403790 [debug] [MainThread]: Partial parsing: deleted file: my_dbt_project://models/dimensions/customer_dimension.sql
[0m08:05:52.556866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cff6d427-4603-4fae-b749-616e0da04e0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd983763260>]}
[0m08:05:53.185825 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m08:05:53.213171 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m08:05:53.460166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cff6d427-4603-4fae-b749-616e0da04e0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd97df54680>]}
[0m08:05:53.462195 [info ] [MainThread]: Found 8 models, 1 source, 424 macros
[0m08:05:53.465156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cff6d427-4603-4fae-b749-616e0da04e0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd97d97c470>]}
[0m08:05:53.472653 [info ] [MainThread]: 
[0m08:05:53.485958 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:05:53.487775 [info ] [MainThread]: 
[0m08:05:53.490924 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m08:05:53.511647 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_sales_database'
[0m08:05:53.869121 [debug] [ThreadPool]: Using duckdb connection "list_sales_database"
[0m08:05:53.882417 [debug] [ThreadPool]: On list_sales_database: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "list_sales_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"sales_database"'
    
  
  
[0m08:05:53.884164 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:05:54.274539 [debug] [ThreadPool]: SQL status: OK in 0.390 seconds
[0m08:05:54.279966 [debug] [ThreadPool]: On list_sales_database: Close
[0m08:05:54.304229 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_database, now create_sales_database_main)
[0m08:05:54.311081 [debug] [ThreadPool]: Creating schema "database: "sales_database"
schema: "main"
"
[0m08:05:54.346527 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m08:05:54.348546 [debug] [ThreadPool]: On create_sales_database_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "create_sales_database_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='sales_database'
        and type='sqlite'
    
  
[0m08:05:54.350442 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:05:54.405335 [debug] [ThreadPool]: SQL status: OK in 0.055 seconds
[0m08:05:54.413603 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m08:05:54.416995 [debug] [ThreadPool]: On create_sales_database_main: BEGIN
[0m08:05:54.421472 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m08:05:54.426930 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m08:05:54.429916 [debug] [ThreadPool]: On create_sales_database_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "create_sales_database_main"} */

    
    
        create schema if not exists "sales_database"."main"
    
[0m08:05:54.435222 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m08:05:54.439296 [debug] [ThreadPool]: On create_sales_database_main: COMMIT
[0m08:05:54.443298 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m08:05:54.445735 [debug] [ThreadPool]: On create_sales_database_main: COMMIT
[0m08:05:54.448407 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m08:05:54.449943 [debug] [ThreadPool]: On create_sales_database_main: Close
[0m08:05:54.465023 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_sales_database_main'
[0m08:05:54.488497 [debug] [ThreadPool]: Using duckdb connection "list_sales_database_main"
[0m08:05:54.496439 [debug] [ThreadPool]: On list_sales_database_main: BEGIN
[0m08:05:54.498829 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:05:54.534436 [debug] [ThreadPool]: SQL status: OK in 0.036 seconds
[0m08:05:54.536052 [debug] [ThreadPool]: Using duckdb connection "list_sales_database_main"
[0m08:05:54.537990 [debug] [ThreadPool]: On list_sales_database_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "list_sales_database_main"} */
select
      'sales_database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'sales_database'
  
[0m08:05:54.754491 [debug] [ThreadPool]: SQL status: OK in 0.212 seconds
[0m08:05:54.769646 [debug] [ThreadPool]: On list_sales_database_main: ROLLBACK
[0m08:05:54.779664 [debug] [ThreadPool]: Failed to rollback 'list_sales_database_main'
[0m08:05:54.781411 [debug] [ThreadPool]: On list_sales_database_main: Close
[0m08:05:54.818865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cff6d427-4603-4fae-b749-616e0da04e0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd97da0cf80>]}
[0m08:05:54.827994 [debug] [MainThread]: Using duckdb connection "master"
[0m08:05:54.829484 [debug] [MainThread]: On master: BEGIN
[0m08:05:54.830888 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:05:54.923530 [debug] [MainThread]: SQL status: OK in 0.093 seconds
[0m08:05:54.942845 [debug] [MainThread]: On master: COMMIT
[0m08:05:54.959466 [debug] [MainThread]: Using duckdb connection "master"
[0m08:05:54.961566 [debug] [MainThread]: On master: COMMIT
[0m08:05:54.966551 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m08:05:54.968041 [debug] [MainThread]: On master: Close
[0m08:05:54.998198 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_company
[0m08:05:55.000903 [info ] [Thread-1 (]: 1 of 8 START sql view model main.dim_company ................................... [RUN]
[0m08:05:55.010841 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.my_dbt_project.dim_company'
[0m08:05:55.013129 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_company
[0m08:05:55.039826 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_company"
[0m08:05:55.062548 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_company
[0m08:05:55.229435 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_company"
[0m08:05:55.250748 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_company"
[0m08:05:55.253079 [debug] [Thread-1 (]: On model.my_dbt_project.dim_company: BEGIN
[0m08:05:55.256440 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m08:05:55.335569 [debug] [Thread-1 (]: SQL status: OK in 0.079 seconds
[0m08:05:55.366927 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_company"
[0m08:05:55.369483 [debug] [Thread-1 (]: On model.my_dbt_project.dim_company: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.dim_company"} */

  
  create view "sales_database"."main"."dim_company__dbt_tmp" as (
    WITH companies AS (
    SELECT DISTINCT
        company AS company_id,
        company
    FROM "sales_database"."main"."sales"
)

SELECT * FROM companies
  );

[0m08:05:55.373113 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:05:55.407062 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_company"
[0m08:05:55.410469 [debug] [Thread-1 (]: On model.my_dbt_project.dim_company: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.dim_company"} */
alter view "sales_database"."main"."dim_company__dbt_tmp" rename to "dim_company"
[0m08:05:55.413511 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:05:55.449076 [debug] [Thread-1 (]: On model.my_dbt_project.dim_company: COMMIT
[0m08:05:55.451256 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_company"
[0m08:05:55.453287 [debug] [Thread-1 (]: On model.my_dbt_project.dim_company: COMMIT
[0m08:05:55.467584 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m08:05:55.486138 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_company"
[0m08:05:55.488424 [debug] [Thread-1 (]: On model.my_dbt_project.dim_company: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.dim_company"} */
drop view if exists "sales_database"."main"."dim_company__dbt_backup" cascade
[0m08:05:55.494190 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:05:55.501388 [debug] [Thread-1 (]: On model.my_dbt_project.dim_company: Close
[0m08:05:55.551333 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cff6d427-4603-4fae-b749-616e0da04e0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd985aa3f20>]}
[0m08:05:55.553855 [info ] [Thread-1 (]: 1 of 8 OK created sql view model main.dim_company .............................. [[32mOK[0m in 0.54s]
[0m08:05:55.561919 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_company
[0m08:05:55.564213 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_currency
[0m08:05:55.566836 [info ] [Thread-1 (]: 2 of 8 START sql view model main.dim_currency .................................. [RUN]
[0m08:05:55.568743 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_company, now model.my_dbt_project.dim_currency)
[0m08:05:55.570810 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_currency
[0m08:05:55.589104 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_currency"
[0m08:05:55.614747 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_currency
[0m08:05:55.629736 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_currency"
[0m08:05:55.649993 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_currency"
[0m08:05:55.654244 [debug] [Thread-1 (]: On model.my_dbt_project.dim_currency: BEGIN
[0m08:05:55.656124 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:05:55.705668 [debug] [Thread-1 (]: SQL status: OK in 0.050 seconds
[0m08:05:55.716444 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_currency"
[0m08:05:55.725356 [debug] [Thread-1 (]: On model.my_dbt_project.dim_currency: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.dim_currency"} */

  
  create view "sales_database"."main"."dim_currency__dbt_tmp" as (
    WITH currency_data AS (
    SELECT DISTINCT
        currency AS currency_id,
        currency,
        conversion_rate
    FROM "sales_database"."main"."sales"
)

SELECT * FROM currency_data
  );

[0m08:05:55.729290 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:05:55.743562 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_currency"
[0m08:05:55.746960 [debug] [Thread-1 (]: On model.my_dbt_project.dim_currency: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.dim_currency"} */
alter view "sales_database"."main"."dim_currency__dbt_tmp" rename to "dim_currency"
[0m08:05:55.750413 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:05:55.758887 [debug] [Thread-1 (]: On model.my_dbt_project.dim_currency: COMMIT
[0m08:05:55.760765 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_currency"
[0m08:05:55.763129 [debug] [Thread-1 (]: On model.my_dbt_project.dim_currency: COMMIT
[0m08:05:55.775755 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m08:05:55.784431 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_currency"
[0m08:05:55.786455 [debug] [Thread-1 (]: On model.my_dbt_project.dim_currency: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.dim_currency"} */
drop view if exists "sales_database"."main"."dim_currency__dbt_backup" cascade
[0m08:05:55.792398 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:05:55.798603 [debug] [Thread-1 (]: On model.my_dbt_project.dim_currency: Close
[0m08:05:55.869421 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cff6d427-4603-4fae-b749-616e0da04e0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd983735190>]}
[0m08:05:55.872022 [info ] [Thread-1 (]: 2 of 8 OK created sql view model main.dim_currency ............................. [[32mOK[0m in 0.30s]
[0m08:05:55.876734 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_currency
[0m08:05:55.878904 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_customer
[0m08:05:55.881961 [info ] [Thread-1 (]: 3 of 8 START sql view model main.dim_customer .................................. [RUN]
[0m08:05:55.884629 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_currency, now model.my_dbt_project.dim_customer)
[0m08:05:55.886570 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_customer
[0m08:05:55.900475 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_customer"
[0m08:05:55.920007 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_customer
[0m08:05:55.938871 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_customer"
[0m08:05:55.969050 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_customer"
[0m08:05:55.972357 [debug] [Thread-1 (]: On model.my_dbt_project.dim_customer: BEGIN
[0m08:05:55.976820 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:05:56.025182 [debug] [Thread-1 (]: SQL status: OK in 0.048 seconds
[0m08:05:56.027089 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_customer"
[0m08:05:56.029313 [debug] [Thread-1 (]: On model.my_dbt_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.dim_customer"} */

  
  create view "sales_database"."main"."dim_customer__dbt_tmp" as (
    -- WITH sales AS (
--     SELECT * FROM "sales_database"."main"."sales"
-- )

-- SELECT
--     DISTINCT
--     customer AS customer_id,
--     customer_name,
--     customer_address,
--     customer_group,
--     territory,
--     language AS customer_language
-- FROM sales
-- WHERE customer IS NOT NULL




WITH customers AS (
    SELECT DISTINCT
        customer AS customer_id,
        customer_name,
        customer_group,
        territory
    FROM "sales_database"."main"."sales"
)

SELECT * FROM customers
  );

[0m08:05:56.033073 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:05:56.052664 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_customer"
[0m08:05:56.054555 [debug] [Thread-1 (]: On model.my_dbt_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.dim_customer"} */
alter view "sales_database"."main"."dim_customer__dbt_tmp" rename to "dim_customer"
[0m08:05:56.058635 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:05:56.064431 [debug] [Thread-1 (]: On model.my_dbt_project.dim_customer: COMMIT
[0m08:05:56.068853 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_customer"
[0m08:05:56.070836 [debug] [Thread-1 (]: On model.my_dbt_project.dim_customer: COMMIT
[0m08:05:56.093941 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m08:05:56.103020 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_customer"
[0m08:05:56.105675 [debug] [Thread-1 (]: On model.my_dbt_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.dim_customer"} */
drop view if exists "sales_database"."main"."dim_customer__dbt_backup" cascade
[0m08:05:56.117332 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:05:56.125984 [debug] [Thread-1 (]: On model.my_dbt_project.dim_customer: Close
[0m08:05:56.187950 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cff6d427-4603-4fae-b749-616e0da04e0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd97c5e4110>]}
[0m08:05:56.195417 [info ] [Thread-1 (]: 3 of 8 OK created sql view model main.dim_customer ............................. [[32mOK[0m in 0.30s]
[0m08:05:56.199822 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_customer
[0m08:05:56.202866 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_date
[0m08:05:56.208875 [info ] [Thread-1 (]: 4 of 8 START sql view model main.dim_date ...................................... [RUN]
[0m08:05:56.213220 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_customer, now model.my_dbt_project.dim_date)
[0m08:05:56.215262 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_date
[0m08:05:56.227073 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_date"
[0m08:05:56.255478 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_date
[0m08:05:56.275564 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_date"
[0m08:05:56.305633 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_date"
[0m08:05:56.309113 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: BEGIN
[0m08:05:56.311835 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:05:56.359390 [debug] [Thread-1 (]: SQL status: OK in 0.048 seconds
[0m08:05:56.361986 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_date"
[0m08:05:56.365125 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.dim_date"} */

  
  create view "sales_database"."main"."dim_date__dbt_tmp" as (
    -- WITH sales AS (
--     SELECT * FROM "sales_database"."main"."sales"
-- )
-- SELECT
--     transaction_date,
--     strftime(transaction_date, '%Y-%m-%d') AS date_id,  -- Change the format to YYYY-MM-DD
--     strftime(transaction_date, '%A') AS weekday_name,
--     strftime(transaction_date, '%m') AS month,
--     strftime(transaction_date, '%Y') AS year,
--     strftime(transaction_date, '%d') AS day,
--     EXTRACT(QUARTER FROM transaction_date) AS quarter
-- FROM sales
-- WHERE transaction_date IS NOT NULL


WITH date_data AS (
    SELECT DISTINCT
        transaction_date AS date_id,
        EXTRACT(YEAR FROM transaction_date) AS year,
        EXTRACT(MONTH FROM transaction_date) AS month,
        EXTRACT(DAY FROM transaction_date) AS day,
        EXTRACT(WEEK FROM transaction_date) AS week_of_year,
        EXTRACT(QUARTER FROM transaction_date) AS quarter
    FROM "sales_database"."main"."sales"
)

SELECT * FROM date_data
  );

[0m08:05:56.372078 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m08:05:56.386469 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_date"
[0m08:05:56.388750 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.dim_date"} */
alter view "sales_database"."main"."dim_date__dbt_tmp" rename to "dim_date"
[0m08:05:56.393426 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:05:56.403580 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: COMMIT
[0m08:05:56.409471 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_date"
[0m08:05:56.412807 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: COMMIT
[0m08:05:56.426084 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m08:05:56.439125 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_date"
[0m08:05:56.442708 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.dim_date"} */
drop view if exists "sales_database"."main"."dim_date__dbt_backup" cascade
[0m08:05:56.446132 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:05:56.450981 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: Close
[0m08:05:56.558121 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cff6d427-4603-4fae-b749-616e0da04e0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd97c1095b0>]}
[0m08:05:56.562109 [info ] [Thread-1 (]: 4 of 8 OK created sql view model main.dim_date ................................. [[32mOK[0m in 0.34s]
[0m08:05:56.568517 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_date
[0m08:05:56.595199 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_produt
[0m08:05:56.598004 [info ] [Thread-1 (]: 5 of 8 START sql view model main.dim_produt .................................... [RUN]
[0m08:05:56.610420 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_date, now model.my_dbt_project.dim_produt)
[0m08:05:56.613102 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_produt
[0m08:05:56.644172 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_produt"
[0m08:05:56.720338 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_produt
[0m08:05:56.742486 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_produt"
[0m08:05:56.794013 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_produt"
[0m08:05:56.797032 [debug] [Thread-1 (]: On model.my_dbt_project.dim_produt: BEGIN
[0m08:05:56.800765 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:05:56.877382 [debug] [Thread-1 (]: SQL status: OK in 0.072 seconds
[0m08:05:56.879319 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_produt"
[0m08:05:56.882258 [debug] [Thread-1 (]: On model.my_dbt_project.dim_produt: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.dim_produt"} */

  
  create view "sales_database"."main"."dim_produt__dbt_tmp" as (
    -- WITH sales AS (
--     SELECT * 
--     FROM "sales_database"."main"."sales"
-- )

-- SELECT 
--     sales.name,
--     json_extract(items, '$[0].name') AS product_name,  -- Example to extract the first element's "name" field from JSON array
--     json_extract(items, '$[0].item_code') AS product_item_code
-- FROM sales
-- WHERE json_extract(items, '$[0].name') IS NOT NULL  -- Filter to only keep rows with a non-null product name



WITH exploded_items AS (
    SELECT
        name AS sales_order_id,
        JSON_EXTRACT(items, '$[*].item_code') AS product_code,
        JSON_EXTRACT(items, '$[*].item_name') AS product_name,
        JSON_EXTRACT(items, '$[*].qty') AS quantity_sold,
        JSON_EXTRACT(items, '$[*].rate') AS unit_price
    FROM "sales_database"."main"."sales"
)

SELECT 
    sales_order_id,
    UNNEST(product_code) AS product_id,
    UNNEST(product_name) AS product_name,
    UNNEST(quantity_sold) AS quantity_sold,
    UNNEST(unit_price) AS unit_price
FROM exploded_items
  );

[0m08:05:56.885969 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m08:05:56.901697 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_produt"
[0m08:05:56.914665 [debug] [Thread-1 (]: On model.my_dbt_project.dim_produt: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.dim_produt"} */
alter view "sales_database"."main"."dim_produt__dbt_tmp" rename to "dim_produt"
[0m08:05:56.920728 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:05:56.929643 [debug] [Thread-1 (]: On model.my_dbt_project.dim_produt: COMMIT
[0m08:05:56.933114 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_produt"
[0m08:05:56.935318 [debug] [Thread-1 (]: On model.my_dbt_project.dim_produt: COMMIT
[0m08:05:56.950028 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m08:05:56.963477 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_produt"
[0m08:05:56.968355 [debug] [Thread-1 (]: On model.my_dbt_project.dim_produt: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.dim_produt"} */
drop view if exists "sales_database"."main"."dim_produt__dbt_backup" cascade
[0m08:05:56.971928 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:05:56.980097 [debug] [Thread-1 (]: On model.my_dbt_project.dim_produt: Close
[0m08:05:57.074263 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cff6d427-4603-4fae-b749-616e0da04e0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd97c103b60>]}
[0m08:05:57.081446 [info ] [Thread-1 (]: 5 of 8 OK created sql view model main.dim_produt ............................... [[32mOK[0m in 0.47s]
[0m08:05:57.087453 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_produt
[0m08:05:57.092292 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_sales_team
[0m08:05:57.102239 [info ] [Thread-1 (]: 6 of 8 START sql view model main.dim_sales_team ................................ [RUN]
[0m08:05:57.104544 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_produt, now model.my_dbt_project.dim_sales_team)
[0m08:05:57.108240 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_sales_team
[0m08:05:57.126064 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_sales_team"
[0m08:05:57.188156 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_sales_team
[0m08:05:57.214983 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_sales_team"
[0m08:05:57.259149 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_sales_team"
[0m08:05:57.262743 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_team: BEGIN
[0m08:05:57.264752 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:05:57.312637 [debug] [Thread-1 (]: SQL status: OK in 0.048 seconds
[0m08:05:57.315866 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_sales_team"
[0m08:05:57.318901 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_team: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sales_team"} */

  
  create view "sales_database"."main"."dim_sales_team__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
    DISTINCT
    sales_team->>'name' AS sales_team_id,
    sales_team->>'region' AS sales_team_region
FROM sales
WHERE sales_team IS NOT NULL
  );

[0m08:05:57.347261 [debug] [Thread-1 (]: SQL status: OK in 0.021 seconds
[0m08:05:57.367853 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_sales_team"
[0m08:05:57.371911 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_team: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sales_team"} */
alter view "sales_database"."main"."dim_sales_team__dbt_tmp" rename to "dim_sales_team"
[0m08:05:57.382051 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:05:57.394966 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_team: COMMIT
[0m08:05:57.404692 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_sales_team"
[0m08:05:57.406733 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_team: COMMIT
[0m08:05:57.437941 [debug] [Thread-1 (]: SQL status: OK in 0.029 seconds
[0m08:05:57.459356 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_sales_team"
[0m08:05:57.472108 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_team: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sales_team"} */
drop view if exists "sales_database"."main"."dim_sales_team__dbt_backup" cascade
[0m08:05:57.474984 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:05:57.480986 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_team: Close
[0m08:05:57.562338 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cff6d427-4603-4fae-b749-616e0da04e0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd97c4db860>]}
[0m08:05:57.569682 [info ] [Thread-1 (]: 6 of 8 OK created sql view model main.dim_sales_team ........................... [[32mOK[0m in 0.46s]
[0m08:05:57.572331 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_sales_team
[0m08:05:57.574734 [debug] [Thread-1 (]: Began running node model.my_dbt_project.fact_sales
[0m08:05:57.577081 [info ] [Thread-1 (]: 7 of 8 START sql table model main.fact_sales ................................... [RUN]
[0m08:05:57.579573 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_sales_team, now model.my_dbt_project.fact_sales)
[0m08:05:57.591105 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.fact_sales
[0m08:05:57.600344 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.fact_sales"
[0m08:05:57.641526 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.fact_sales
[0m08:05:57.811990 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.fact_sales"
[0m08:05:58.048790 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.fact_sales"
[0m08:05:58.051202 [debug] [Thread-1 (]: On model.my_dbt_project.fact_sales: BEGIN
[0m08:05:58.074394 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:05:58.249257 [debug] [Thread-1 (]: SQL status: OK in 0.179 seconds
[0m08:05:58.266972 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.fact_sales"
[0m08:05:58.269339 [debug] [Thread-1 (]: On model.my_dbt_project.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.fact_sales"} */

  
    
    

    create  table
      "sales_database"."main"."fact_sales__dbt_tmp"
  
    as (
      WITH sales_data AS (
    SELECT
        name AS sales_order_id,
        transaction_date,
        customer,
        company,
        total AS sales_amount,
        net_total,
        discount_amount,
        base_total_taxes_and_charges AS tax_amount,
        grand_total,
        currency,
        conversion_rate,
        items, -- JSON field with product details
        taxes -- JSON field with tax details
    FROM "sales_database"."main"."sales"
)

SELECT * FROM sales_data
    );
  
  
[0m08:05:58.402300 [debug] [Thread-1 (]: SQL status: OK in 0.125 seconds
[0m08:05:58.442608 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.fact_sales"
[0m08:05:58.475589 [debug] [Thread-1 (]: On model.my_dbt_project.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.fact_sales"} */
alter table "sales_database"."main"."fact_sales__dbt_tmp" rename to "fact_sales"
[0m08:05:58.505099 [debug] [Thread-1 (]: SQL status: OK in 0.015 seconds
[0m08:05:58.608852 [debug] [Thread-1 (]: On model.my_dbt_project.fact_sales: COMMIT
[0m08:05:58.620348 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.fact_sales"
[0m08:05:58.649166 [debug] [Thread-1 (]: On model.my_dbt_project.fact_sales: COMMIT
[0m08:05:58.691579 [debug] [Thread-1 (]: SQL status: OK in 0.040 seconds
[0m08:05:58.716702 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.fact_sales"
[0m08:05:58.718539 [debug] [Thread-1 (]: On model.my_dbt_project.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.fact_sales"} */
drop table if exists "sales_database"."main"."fact_sales__dbt_backup" cascade
[0m08:05:58.741149 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:05:58.748492 [debug] [Thread-1 (]: On model.my_dbt_project.fact_sales: Close
[0m08:05:58.913244 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cff6d427-4603-4fae-b749-616e0da04e0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd97c16b650>]}
[0m08:05:58.926077 [info ] [Thread-1 (]: 7 of 8 OK created sql table model main.fact_sales .............................. [[32mOK[0m in 1.33s]
[0m08:05:58.931216 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.fact_sales
[0m08:05:58.935633 [debug] [Thread-1 (]: Began running node model.my_dbt_project.transform_sales
[0m08:05:58.937974 [info ] [Thread-1 (]: 8 of 8 START sql table model main.transform_sales .............................. [RUN]
[0m08:05:58.941185 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.fact_sales, now model.my_dbt_project.transform_sales)
[0m08:05:58.945654 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.transform_sales
[0m08:05:58.969106 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.transform_sales"
[0m08:05:58.996684 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.transform_sales
[0m08:05:59.012609 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.transform_sales"
[0m08:05:59.071783 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m08:05:59.074799 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: BEGIN
[0m08:05:59.086313 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:05:59.147995 [debug] [Thread-1 (]: SQL status: OK in 0.062 seconds
[0m08:05:59.150927 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m08:05:59.154303 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */

  
    
    

    create  table
      "sales_database"."main"."transform_sales__dbt_tmp"
  
    as (
      -- /opt/airflow/dags/dbt_models/transform_users.sql


WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
   *
FROM sales
WHERE name = 'ABC private LTD-0002'
    );
  
  
[0m08:05:59.217297 [debug] [Thread-1 (]: SQL status: OK in 0.056 seconds
[0m08:05:59.230087 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m08:05:59.237596 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */
alter table "sales_database"."main"."transform_sales__dbt_tmp" rename to "transform_sales"
[0m08:05:59.241739 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m08:05:59.250856 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: COMMIT
[0m08:05:59.254770 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m08:05:59.256840 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: COMMIT
[0m08:05:59.288070 [debug] [Thread-1 (]: SQL status: OK in 0.023 seconds
[0m08:05:59.305178 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.transform_sales"
[0m08:05:59.318755 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.transform_sales"} */
drop table if exists "sales_database"."main"."transform_sales__dbt_backup" cascade
[0m08:05:59.331321 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:05:59.341021 [debug] [Thread-1 (]: On model.my_dbt_project.transform_sales: Close
[0m08:05:59.542791 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cff6d427-4603-4fae-b749-616e0da04e0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd97c4d9a00>]}
[0m08:05:59.545454 [info ] [Thread-1 (]: 8 of 8 OK created sql table model main.transform_sales ......................... [[32mOK[0m in 0.60s]
[0m08:05:59.549126 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.transform_sales
[0m08:05:59.558658 [debug] [MainThread]: Using duckdb connection "master"
[0m08:05:59.561134 [debug] [MainThread]: On master: BEGIN
[0m08:05:59.563085 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:05:59.665289 [debug] [MainThread]: SQL status: OK in 0.102 seconds
[0m08:05:59.693779 [debug] [MainThread]: On master: COMMIT
[0m08:05:59.706630 [debug] [MainThread]: Using duckdb connection "master"
[0m08:05:59.709980 [debug] [MainThread]: On master: COMMIT
[0m08:05:59.727628 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m08:05:59.729534 [debug] [MainThread]: On master: Close
[0m08:05:59.752850 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:05:59.764735 [debug] [MainThread]: Connection 'create_sales_database_main' was properly closed.
[0m08:05:59.766527 [debug] [MainThread]: Connection 'list_sales_database_main' was properly closed.
[0m08:05:59.770730 [debug] [MainThread]: Connection 'model.my_dbt_project.transform_sales' was properly closed.
[0m08:05:59.777552 [info ] [MainThread]: 
[0m08:05:59.785861 [info ] [MainThread]: Finished running 2 table models, 6 view models in 0 hours 0 minutes and 6.29 seconds (6.29s).
[0m08:05:59.795905 [debug] [MainThread]: Command end result
[0m08:05:59.974625 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m08:06:00.029962 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m08:06:00.108533 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dags/dbt_models/target/run_results.json
[0m08:06:00.110148 [info ] [MainThread]: 
[0m08:06:00.116107 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:06:00.119203 [info ] [MainThread]: 
[0m08:06:00.122314 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m08:06:00.132372 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 53.24009, "process_in_blocks": "1133456", "process_kernel_time": 5.810283, "process_mem_max_rss": "145360", "process_out_blocks": "0", "process_user_time": 13.773617}
[0m08:06:00.134773 [debug] [MainThread]: Command `dbt run` succeeded at 08:06:00.134385 after 53.25 seconds
[0m08:06:00.137081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9838f8590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd97d91f4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd97d91f110>]}
[0m08:06:00.139586 [debug] [MainThread]: Flushing usage events
[0m08:06:01.797390 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:00:19.467683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe405a1adb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe407714680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe40592b2c0>]}


============================== 10:00:19.479770 | f91ed154-3652-4098-a542-aa677465436b ==============================
[0m10:00:19.479770 [info ] [MainThread]: Running with dbt=1.9.2
[0m10:00:19.482017 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/profiles.yml', 'version_check': 'True', 'debug': 'False', 'log_path': 'logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt/profiles.yml --target dev', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:00:19.484063 [error] [MainThread]: Encountered an error:
Runtime Error
  No dbt_project.yml found at expected path /opt/airflow/dags/dbt_models/dbt_project.yml
  Verify that each entry within packages.yml (and their transitive dependencies) contains a file named dbt_project.yml
  
[0m10:00:19.488121 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.14415118, "process_in_blocks": "57328", "process_kernel_time": 0.493925, "process_mem_max_rss": "100236", "process_out_blocks": "1512", "process_user_time": 4.513121}
[0m10:00:19.491067 [debug] [MainThread]: Command `dbt run` failed at 10:00:19.490691 after 0.15 seconds
[0m10:00:19.492793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe405a1adb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe405d08a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe405864ef0>]}
[0m10:00:19.494151 [debug] [MainThread]: Flushing usage events
[0m10:00:21.008884 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:03:45.206116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f085dc3d730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f085e049400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f085dc3cb60>]}


============================== 10:03:46.161460 | 84fd1154-cc46-4a13-8e17-39fe487977f8 ==============================
[0m10:03:46.161460 [info ] [MainThread]: Running with dbt=1.9.2
[0m10:03:47.238521 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dags/dbt_models/logs', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt/profiles.yml', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt/profiles.yml --target dev', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:03:57.742164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '84fd1154-cc46-4a13-8e17-39fe487977f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0858167d70>]}
[0m10:03:58.329738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '84fd1154-cc46-4a13-8e17-39fe487977f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f085e1dbef0>]}
[0m10:03:58.557425 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m10:03:59.839468 [debug] [MainThread]: checksum: eea1a9e9f56a74d304aa4a9e5e9c8fc1dea4ccd2b0ec98e366756009c99c5c94, vars: {}, profile: , target: dev, version: 1.9.2
[0m10:04:00.413143 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m10:04:00.417564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '84fd1154-cc46-4a13-8e17-39fe487977f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f085df123f0>]}
[0m10:04:08.144304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '84fd1154-cc46-4a13-8e17-39fe487977f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0853a32540>]}
[0m10:04:09.856857 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m10:04:09.903305 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m10:04:10.382272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '84fd1154-cc46-4a13-8e17-39fe487977f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f085310be90>]}
[0m10:04:10.384848 [info ] [MainThread]: Found 7 models, 1 source, 424 macros
[0m10:04:10.386548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '84fd1154-cc46-4a13-8e17-39fe487977f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0853177470>]}
[0m10:04:10.395110 [info ] [MainThread]: 
[0m10:04:10.397722 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:04:10.399797 [info ] [MainThread]: 
[0m10:04:10.403414 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m10:04:10.423513 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_sales_database'
[0m10:04:10.753851 [debug] [ThreadPool]: Using duckdb connection "list_sales_database"
[0m10:04:10.769760 [debug] [ThreadPool]: On list_sales_database: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "list_sales_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"sales_database"'
    
  
  
[0m10:04:10.772755 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:04:12.819928 [debug] [ThreadPool]: SQL status: OK in 2.032 seconds
[0m10:04:12.833239 [debug] [ThreadPool]: On list_sales_database: Close
[0m10:04:12.882280 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_database, now create_sales_database_main)
[0m10:04:12.897597 [debug] [ThreadPool]: Creating schema "database: "sales_database"
schema: "main"
"
[0m10:04:12.953456 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m10:04:12.955635 [debug] [ThreadPool]: On create_sales_database_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "create_sales_database_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='sales_database'
        and type='sqlite'
    
  
[0m10:04:12.958642 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:04:13.327488 [debug] [ThreadPool]: SQL status: OK in 0.368 seconds
[0m10:04:13.338920 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m10:04:13.348528 [debug] [ThreadPool]: On create_sales_database_main: BEGIN
[0m10:04:13.352234 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m10:04:13.359007 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m10:04:13.372863 [debug] [ThreadPool]: On create_sales_database_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "create_sales_database_main"} */

    
    
        create schema if not exists "sales_database"."main"
    
[0m10:04:13.378376 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m10:04:13.383426 [debug] [ThreadPool]: On create_sales_database_main: COMMIT
[0m10:04:13.385838 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m10:04:13.391569 [debug] [ThreadPool]: On create_sales_database_main: COMMIT
[0m10:04:13.399557 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m10:04:13.401772 [debug] [ThreadPool]: On create_sales_database_main: Close
[0m10:04:13.421950 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_sales_database_main'
[0m10:04:13.450828 [debug] [ThreadPool]: Using duckdb connection "list_sales_database_main"
[0m10:04:13.454158 [debug] [ThreadPool]: On list_sales_database_main: BEGIN
[0m10:04:13.459508 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:04:13.551355 [debug] [ThreadPool]: SQL status: OK in 0.092 seconds
[0m10:04:13.553303 [debug] [ThreadPool]: Using duckdb connection "list_sales_database_main"
[0m10:04:13.555857 [debug] [ThreadPool]: On list_sales_database_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "list_sales_database_main"} */
select
      'sales_database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'sales_database'
  
[0m10:04:13.892715 [debug] [ThreadPool]: SQL status: OK in 0.334 seconds
[0m10:04:13.905516 [debug] [ThreadPool]: On list_sales_database_main: ROLLBACK
[0m10:04:13.941815 [debug] [ThreadPool]: Failed to rollback 'list_sales_database_main'
[0m10:04:13.946280 [debug] [ThreadPool]: On list_sales_database_main: Close
[0m10:04:13.967297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '84fd1154-cc46-4a13-8e17-39fe487977f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f085d8706b0>]}
[0m10:04:13.969967 [debug] [MainThread]: Using duckdb connection "master"
[0m10:04:13.972520 [debug] [MainThread]: On master: BEGIN
[0m10:04:13.975355 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:04:14.056751 [debug] [MainThread]: SQL status: OK in 0.081 seconds
[0m10:04:14.076711 [debug] [MainThread]: On master: COMMIT
[0m10:04:14.081507 [debug] [MainThread]: Using duckdb connection "master"
[0m10:04:14.091493 [debug] [MainThread]: On master: COMMIT
[0m10:04:14.095751 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m10:04:14.098501 [debug] [MainThread]: On master: Close
[0m10:04:14.163538 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_company
[0m10:04:14.182512 [info ] [Thread-1 (]: 1 of 7 START sql view model main.dim_company ................................... [RUN]
[0m10:04:14.190637 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.my_dbt_project.dim_company'
[0m10:04:14.201329 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_company
[0m10:04:14.291737 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_company"
[0m10:04:14.326622 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_company
[0m10:04:14.533360 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_company"
[0m10:04:14.580688 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_company"
[0m10:04:14.582524 [debug] [Thread-1 (]: On model.my_dbt_project.dim_company: BEGIN
[0m10:04:14.584462 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:04:17.551619 [debug] [Thread-1 (]: SQL status: OK in 2.952 seconds
[0m10:04:17.574855 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_company"
[0m10:04:17.580061 [debug] [Thread-1 (]: On model.my_dbt_project.dim_company: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.dim_company"} */

  
  create view "sales_database"."main"."dim_company__dbt_tmp" as (
    WITH companies AS (
    SELECT DISTINCT
        company AS company_id,
        company
    FROM "sales_database"."main"."sales"
)

SELECT * FROM companies
  );

[0m10:04:38.379411 [debug] [Thread-1 (]: SQL status: OK in 20.789 seconds
[0m10:04:38.418349 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_company"
[0m10:04:38.421967 [debug] [Thread-1 (]: On model.my_dbt_project.dim_company: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.dim_company"} */
alter view "sales_database"."main"."dim_company__dbt_tmp" rename to "dim_company"
[0m10:04:38.497331 [debug] [Thread-1 (]: SQL status: OK in 0.069 seconds
[0m10:04:38.593252 [debug] [Thread-1 (]: On model.my_dbt_project.dim_company: COMMIT
[0m10:04:38.596475 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_company"
[0m10:04:38.606686 [debug] [Thread-1 (]: On model.my_dbt_project.dim_company: COMMIT
[0m10:04:38.654333 [debug] [Thread-1 (]: SQL status: OK in 0.043 seconds
[0m10:04:38.689731 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_company"
[0m10:04:38.693322 [debug] [Thread-1 (]: On model.my_dbt_project.dim_company: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.dim_company"} */
drop view if exists "sales_database"."main"."dim_company__dbt_backup" cascade
[0m10:04:38.698112 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m10:04:38.709125 [debug] [Thread-1 (]: On model.my_dbt_project.dim_company: Close
[0m10:04:38.807249 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84fd1154-cc46-4a13-8e17-39fe487977f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08526ef170>]}
[0m10:04:38.810105 [info ] [Thread-1 (]: 1 of 7 OK created sql view model main.dim_company .............................. [[32mOK[0m in 24.61s]
[0m10:04:38.813377 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_company
[0m10:04:38.818576 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_currency
[0m10:04:38.821975 [info ] [Thread-1 (]: 2 of 7 START sql view model main.dim_currency .................................. [RUN]
[0m10:04:38.826214 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_company, now model.my_dbt_project.dim_currency)
[0m10:04:38.829332 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_currency
[0m10:04:38.849277 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_currency"
[0m10:04:38.895510 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_currency
[0m10:04:38.927977 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_currency"
[0m10:04:38.985571 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_currency"
[0m10:04:38.990081 [debug] [Thread-1 (]: On model.my_dbt_project.dim_currency: BEGIN
[0m10:04:38.998490 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:04:39.365037 [debug] [Thread-1 (]: SQL status: OK in 0.366 seconds
[0m10:04:39.376145 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_currency"
[0m10:04:39.391379 [debug] [Thread-1 (]: On model.my_dbt_project.dim_currency: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.dim_currency"} */

  
  create view "sales_database"."main"."dim_currency__dbt_tmp" as (
    WITH currency_data AS (
    SELECT DISTINCT
        currency AS currency_id,
        currency,
        conversion_rate
    FROM "sales_database"."main"."sales"
)

SELECT * FROM currency_data
  );

[0m10:04:39.408024 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m10:04:39.458984 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_currency"
[0m10:04:39.471501 [debug] [Thread-1 (]: On model.my_dbt_project.dim_currency: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.dim_currency"} */
alter view "sales_database"."main"."dim_currency__dbt_tmp" rename to "dim_currency"
[0m10:04:39.478903 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:04:39.539662 [debug] [Thread-1 (]: On model.my_dbt_project.dim_currency: COMMIT
[0m10:04:39.548335 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_currency"
[0m10:04:39.552643 [debug] [Thread-1 (]: On model.my_dbt_project.dim_currency: COMMIT
[0m10:04:39.596944 [debug] [Thread-1 (]: SQL status: OK in 0.074 seconds
[0m10:04:39.655211 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_currency"
[0m10:04:39.661677 [debug] [Thread-1 (]: On model.my_dbt_project.dim_currency: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.dim_currency"} */
drop view if exists "sales_database"."main"."dim_currency__dbt_backup" cascade
[0m10:04:39.664959 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:04:39.697233 [debug] [Thread-1 (]: On model.my_dbt_project.dim_currency: Close
[0m10:04:40.005243 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84fd1154-cc46-4a13-8e17-39fe487977f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0850099400>]}
[0m10:04:40.025481 [info ] [Thread-1 (]: 2 of 7 OK created sql view model main.dim_currency ............................. [[32mOK[0m in 1.18s]
[0m10:04:40.071908 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_currency
[0m10:04:40.075070 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_customer
[0m10:04:40.108441 [info ] [Thread-1 (]: 3 of 7 START sql view model main.dim_customer .................................. [RUN]
[0m10:04:40.131041 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_currency, now model.my_dbt_project.dim_customer)
[0m10:04:40.140049 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_customer
[0m10:04:40.275709 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_customer"
[0m10:04:40.402110 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_customer
[0m10:04:40.488669 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_customer"
[0m10:04:40.546849 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_customer"
[0m10:04:40.557439 [debug] [Thread-1 (]: On model.my_dbt_project.dim_customer: BEGIN
[0m10:04:40.561684 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:04:40.829141 [debug] [Thread-1 (]: SQL status: OK in 0.267 seconds
[0m10:04:40.857999 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_customer"
[0m10:04:40.861069 [debug] [Thread-1 (]: On model.my_dbt_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.dim_customer"} */

  
  create view "sales_database"."main"."dim_customer__dbt_tmp" as (
    -- WITH sales AS (
--     SELECT * FROM "sales_database"."main"."sales"
-- )

-- SELECT
--     DISTINCT
--     customer AS customer_id,
--     customer_name,
--     customer_address,
--     customer_group,
--     territory,
--     language AS customer_language
-- FROM sales
-- WHERE customer IS NOT NULL




WITH customers AS (
    SELECT DISTINCT
        customer AS customer_id,
        customer_name,
        customer_group,
        territory
    FROM "sales_database"."main"."sales"
)

SELECT * FROM customers
  );

[0m10:04:40.903616 [debug] [Thread-1 (]: SQL status: OK in 0.026 seconds
[0m10:04:41.074200 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_customer"
[0m10:04:41.092089 [debug] [Thread-1 (]: On model.my_dbt_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.dim_customer"} */
alter view "sales_database"."main"."dim_customer__dbt_tmp" rename to "dim_customer"
[0m10:04:41.123429 [debug] [Thread-1 (]: SQL status: OK in 0.019 seconds
[0m10:04:41.159463 [debug] [Thread-1 (]: On model.my_dbt_project.dim_customer: COMMIT
[0m10:04:41.195966 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_customer"
[0m10:04:41.199627 [debug] [Thread-1 (]: On model.my_dbt_project.dim_customer: COMMIT
[0m10:04:41.366803 [debug] [Thread-1 (]: SQL status: OK in 0.160 seconds
[0m10:04:41.403333 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_customer"
[0m10:04:41.450704 [debug] [Thread-1 (]: On model.my_dbt_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.dim_customer"} */
drop view if exists "sales_database"."main"."dim_customer__dbt_backup" cascade
[0m10:04:41.497639 [debug] [Thread-1 (]: SQL status: OK in 0.044 seconds
[0m10:04:41.504640 [debug] [Thread-1 (]: On model.my_dbt_project.dim_customer: Close
[0m10:04:42.537137 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84fd1154-cc46-4a13-8e17-39fe487977f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0853a30230>]}
[0m10:04:42.677022 [info ] [Thread-1 (]: 3 of 7 OK created sql view model main.dim_customer ............................. [[32mOK[0m in 2.29s]
[0m10:04:42.690548 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_customer
[0m10:04:42.706209 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_date
[0m10:04:42.726216 [info ] [Thread-1 (]: 4 of 7 START sql view model main.dim_date ...................................... [RUN]
[0m10:04:42.739957 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_customer, now model.my_dbt_project.dim_date)
[0m10:04:42.756621 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_date
[0m10:04:42.845134 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_date"
[0m10:04:43.033047 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_date
[0m10:04:43.145825 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_date"
[0m10:04:43.284630 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_date"
[0m10:04:43.315598 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: BEGIN
[0m10:04:43.323085 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:04:44.919205 [debug] [Thread-1 (]: SQL status: OK in 1.581 seconds
[0m10:04:44.954262 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_date"
[0m10:04:44.959044 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.dim_date"} */

  
  create view "sales_database"."main"."dim_date__dbt_tmp" as (
    -- WITH sales AS (
--     SELECT * FROM "sales_database"."main"."sales"
-- )
-- SELECT
--     transaction_date,
--     strftime(transaction_date, '%Y-%m-%d') AS date_id,  -- Change the format to YYYY-MM-DD
--     strftime(transaction_date, '%A') AS weekday_name,
--     strftime(transaction_date, '%m') AS month,
--     strftime(transaction_date, '%Y') AS year,
--     strftime(transaction_date, '%d') AS day,
--     EXTRACT(QUARTER FROM transaction_date) AS quarter
-- FROM sales
-- WHERE transaction_date IS NOT NULL


WITH date_data AS (
    SELECT DISTINCT
        transaction_date AS date_id,
        EXTRACT(YEAR FROM transaction_date) AS year,
        EXTRACT(MONTH FROM transaction_date) AS month,
        EXTRACT(DAY FROM transaction_date) AS day,
        EXTRACT(WEEK FROM transaction_date) AS week_of_year,
        EXTRACT(QUARTER FROM transaction_date) AS quarter
    FROM "sales_database"."main"."sales"
)

SELECT * FROM date_data
  );

[0m10:04:45.536190 [debug] [Thread-1 (]: SQL status: OK in 0.547 seconds
[0m10:04:45.592653 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_date"
[0m10:04:45.606550 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.dim_date"} */
alter view "sales_database"."main"."dim_date__dbt_tmp" rename to "dim_date"
[0m10:04:46.827925 [debug] [Thread-1 (]: SQL status: OK in 0.883 seconds
[0m10:04:47.262019 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: COMMIT
[0m10:04:47.266348 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_date"
[0m10:04:47.271022 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: COMMIT
[0m10:04:49.016472 [debug] [Thread-1 (]: SQL status: OK in 1.727 seconds
[0m10:04:49.178324 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_date"
[0m10:04:49.225233 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.dim_date"} */
drop view if exists "sales_database"."main"."dim_date__dbt_backup" cascade
[0m10:04:50.106172 [debug] [Thread-1 (]: SQL status: OK in 0.840 seconds
[0m10:04:50.165115 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: Close
[0m10:04:54.246353 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84fd1154-cc46-4a13-8e17-39fe487977f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0853118470>]}
[0m10:04:54.256111 [info ] [Thread-1 (]: 4 of 7 OK created sql view model main.dim_date ................................. [[32mOK[0m in 11.49s]
[0m10:04:54.261157 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_date
[0m10:04:54.271873 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_produt
[0m10:04:54.286044 [info ] [Thread-1 (]: 5 of 7 START sql view model main.dim_produt .................................... [RUN]
[0m10:04:54.291324 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_date, now model.my_dbt_project.dim_produt)
[0m10:04:54.302403 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_produt
[0m10:04:54.385537 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_produt"
[0m10:04:54.473191 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_produt
[0m10:04:54.524976 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_produt"
[0m10:04:54.589638 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_produt"
[0m10:04:54.599206 [debug] [Thread-1 (]: On model.my_dbt_project.dim_produt: BEGIN
[0m10:04:54.618268 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:04:54.954032 [debug] [Thread-1 (]: SQL status: OK in 0.335 seconds
[0m10:04:54.958135 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_produt"
[0m10:04:54.969984 [debug] [Thread-1 (]: On model.my_dbt_project.dim_produt: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.dim_produt"} */

  
  create view "sales_database"."main"."dim_produt__dbt_tmp" as (
    -- WITH sales AS (
--     SELECT * 
--     FROM "sales_database"."main"."sales"
-- )

-- SELECT 
--     sales.name,
--     json_extract(items, '$[0].name') AS product_name,  -- Example to extract the first element's "name" field from JSON array
--     json_extract(items, '$[0].item_code') AS product_item_code
-- FROM sales
-- WHERE json_extract(items, '$[0].name') IS NOT NULL  -- Filter to only keep rows with a non-null product name



WITH exploded_items AS (
    SELECT
        name AS sales_order_id,
        JSON_EXTRACT(items, '$[*].item_code') AS product_code,
        JSON_EXTRACT(items, '$[*].item_name') AS product_name,
        JSON_EXTRACT(items, '$[*].qty') AS quantity_sold,
        JSON_EXTRACT(items, '$[*].rate') AS unit_price
    FROM "sales_database"."main"."sales"
)

SELECT 
    sales_order_id,
    UNNEST(product_code) AS product_id,
    UNNEST(product_name) AS product_name,
    UNNEST(quantity_sold) AS quantity_sold,
    UNNEST(unit_price) AS unit_price
FROM exploded_items
  );

[0m10:04:54.994758 [debug] [Thread-1 (]: SQL status: OK in 0.020 seconds
[0m10:04:55.033629 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_produt"
[0m10:04:55.036103 [debug] [Thread-1 (]: On model.my_dbt_project.dim_produt: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.dim_produt"} */
alter view "sales_database"."main"."dim_produt__dbt_tmp" rename to "dim_produt"
[0m10:04:55.043419 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m10:04:55.061035 [debug] [Thread-1 (]: On model.my_dbt_project.dim_produt: COMMIT
[0m10:04:55.063211 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_produt"
[0m10:04:55.067074 [debug] [Thread-1 (]: On model.my_dbt_project.dim_produt: COMMIT
[0m10:04:55.151719 [debug] [Thread-1 (]: SQL status: OK in 0.082 seconds
[0m10:04:55.159287 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_produt"
[0m10:04:55.162467 [debug] [Thread-1 (]: On model.my_dbt_project.dim_produt: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.dim_produt"} */
drop view if exists "sales_database"."main"."dim_produt__dbt_backup" cascade
[0m10:04:55.165911 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:04:55.169811 [debug] [Thread-1 (]: On model.my_dbt_project.dim_produt: Close
[0m10:04:55.481708 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84fd1154-cc46-4a13-8e17-39fe487977f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08500c6240>]}
[0m10:04:55.498643 [info ] [Thread-1 (]: 5 of 7 OK created sql view model main.dim_produt ............................... [[32mOK[0m in 1.07s]
[0m10:04:55.502058 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_produt
[0m10:04:55.520058 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_sales_team
[0m10:04:55.522394 [info ] [Thread-1 (]: 6 of 7 START sql view model main.dim_sales_team ................................ [RUN]
[0m10:04:55.524252 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_produt, now model.my_dbt_project.dim_sales_team)
[0m10:04:55.526192 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_sales_team
[0m10:04:55.548330 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_sales_team"
[0m10:04:55.671423 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_sales_team
[0m10:04:55.684418 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_sales_team"
[0m10:04:55.706480 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_sales_team"
[0m10:04:55.708334 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_team: BEGIN
[0m10:04:55.710095 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:04:55.925552 [debug] [Thread-1 (]: SQL status: OK in 0.215 seconds
[0m10:04:55.932008 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_sales_team"
[0m10:04:55.936474 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_team: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sales_team"} */

  
  create view "sales_database"."main"."dim_sales_team__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
    DISTINCT
    sales_team->>'name' AS sales_team_id,
    sales_team->>'region' AS sales_team_region
FROM sales
WHERE sales_team IS NOT NULL
  );

[0m10:04:55.948232 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m10:04:55.972898 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_sales_team"
[0m10:04:55.975494 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_team: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sales_team"} */
alter view "sales_database"."main"."dim_sales_team__dbt_tmp" rename to "dim_sales_team"
[0m10:04:55.989021 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:04:56.011688 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_team: COMMIT
[0m10:04:56.016958 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_sales_team"
[0m10:04:56.033607 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_team: COMMIT
[0m10:04:56.141672 [debug] [Thread-1 (]: SQL status: OK in 0.083 seconds
[0m10:04:56.206959 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_sales_team"
[0m10:04:56.215284 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_team: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sales_team"} */
drop view if exists "sales_database"."main"."dim_sales_team__dbt_backup" cascade
[0m10:04:56.220846 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:04:56.237217 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_team: Close
[0m10:04:56.568532 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84fd1154-cc46-4a13-8e17-39fe487977f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08500c6f90>]}
[0m10:04:56.588367 [info ] [Thread-1 (]: 6 of 7 OK created sql view model main.dim_sales_team ........................... [[32mOK[0m in 1.03s]
[0m10:04:56.606534 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_sales_team
[0m10:04:56.616042 [debug] [Thread-1 (]: Began running node model.my_dbt_project.fact_sales
[0m10:04:56.627223 [info ] [Thread-1 (]: 7 of 7 START sql table model main.fact_sales ................................... [RUN]
[0m10:04:56.629638 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_sales_team, now model.my_dbt_project.fact_sales)
[0m10:04:56.643441 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.fact_sales
[0m10:04:56.660826 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.fact_sales"
[0m10:04:56.710931 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.fact_sales
[0m10:04:56.979914 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.fact_sales"
[0m10:04:57.023332 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.fact_sales"
[0m10:04:57.026506 [debug] [Thread-1 (]: On model.my_dbt_project.fact_sales: BEGIN
[0m10:04:57.028924 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:04:58.257654 [debug] [Thread-1 (]: SQL status: OK in 1.220 seconds
[0m10:04:58.281960 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.fact_sales"
[0m10:04:58.296626 [debug] [Thread-1 (]: On model.my_dbt_project.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.fact_sales"} */

  
    
    

    create  table
      "sales_database"."main"."fact_sales__dbt_tmp"
  
    as (
      WITH sales_data AS (
    SELECT
        name AS sales_order_id,
        transaction_date,
        customer,
        company,
        total AS sales_amount,
        net_total,
        discount_amount,
        base_total_taxes_and_charges AS tax_amount,
        grand_total,
        currency,
        conversion_rate,
        items, -- JSON field with product details
        taxes -- JSON field with tax details
    FROM "sales_database"."main"."sales"
)

SELECT * FROM sales_data
    );
  
  
[0m10:04:58.563360 [debug] [Thread-1 (]: SQL status: OK in 0.264 seconds
[0m10:04:58.599285 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.fact_sales"
[0m10:04:58.602593 [debug] [Thread-1 (]: On model.my_dbt_project.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.fact_sales"} */
alter table "sales_database"."main"."fact_sales__dbt_tmp" rename to "fact_sales"
[0m10:04:58.646357 [debug] [Thread-1 (]: SQL status: OK in 0.041 seconds
[0m10:04:58.710299 [debug] [Thread-1 (]: On model.my_dbt_project.fact_sales: COMMIT
[0m10:04:58.713578 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.fact_sales"
[0m10:04:58.723019 [debug] [Thread-1 (]: On model.my_dbt_project.fact_sales: COMMIT
[0m10:04:58.778131 [debug] [Thread-1 (]: SQL status: OK in 0.052 seconds
[0m10:04:58.797456 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.fact_sales"
[0m10:04:58.803470 [debug] [Thread-1 (]: On model.my_dbt_project.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.fact_sales"} */
drop table if exists "sales_database"."main"."fact_sales__dbt_backup" cascade
[0m10:04:58.814136 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m10:04:58.826248 [debug] [Thread-1 (]: On model.my_dbt_project.fact_sales: Close
[0m10:04:59.094213 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84fd1154-cc46-4a13-8e17-39fe487977f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08500ad3d0>]}
[0m10:04:59.106900 [info ] [Thread-1 (]: 7 of 7 OK created sql table model main.fact_sales .............................. [[32mOK[0m in 2.45s]
[0m10:04:59.110494 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.fact_sales
[0m10:04:59.124250 [debug] [MainThread]: Using duckdb connection "master"
[0m10:04:59.126923 [debug] [MainThread]: On master: BEGIN
[0m10:04:59.130942 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:04:59.475788 [debug] [MainThread]: SQL status: OK in 0.333 seconds
[0m10:04:59.493065 [debug] [MainThread]: On master: COMMIT
[0m10:04:59.495383 [debug] [MainThread]: Using duckdb connection "master"
[0m10:04:59.498460 [debug] [MainThread]: On master: COMMIT
[0m10:04:59.508760 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m10:04:59.511152 [debug] [MainThread]: On master: Close
[0m10:04:59.538328 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:04:59.540412 [debug] [MainThread]: Connection 'create_sales_database_main' was properly closed.
[0m10:04:59.544246 [debug] [MainThread]: Connection 'list_sales_database_main' was properly closed.
[0m10:04:59.546176 [debug] [MainThread]: Connection 'model.my_dbt_project.fact_sales' was properly closed.
[0m10:04:59.556856 [info ] [MainThread]: 
[0m10:04:59.559504 [info ] [MainThread]: Finished running 1 table model, 6 view models in 0 hours 0 minutes and 49.15 seconds (49.15s).
[0m10:04:59.573941 [debug] [MainThread]: Command end result
[0m10:04:59.743853 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m10:04:59.775653 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m10:04:59.825136 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dags/dbt_models/target/run_results.json
[0m10:04:59.827174 [info ] [MainThread]: 
[0m10:04:59.829216 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:04:59.831157 [info ] [MainThread]: 
[0m10:04:59.835966 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m10:04:59.869323 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 78.836716, "process_in_blocks": "4235176", "process_kernel_time": 13.633219, "process_mem_max_rss": "124824", "process_out_blocks": "456", "process_user_time": 19.515009}
[0m10:04:59.873043 [debug] [MainThread]: Command `dbt run` succeeded at 10:04:59.872678 after 78.85 seconds
[0m10:04:59.876816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08616a75f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f085d996720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f085d9960c0>]}
[0m10:04:59.880159 [debug] [MainThread]: Flushing usage events
[0m10:05:09.956485 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:35:33.582015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe81ad7350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe838c0410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe81c8e630>]}


============================== 10:35:33.668120 | 372291d9-b02e-496f-a726-a3b573915c3c ==============================
[0m10:35:33.668120 [info ] [MainThread]: Running with dbt=1.9.2
[0m10:35:33.670691 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/profiles.yml', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dags/dbt_models/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt/profiles.yml --target dev', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:35:35.378020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '372291d9-b02e-496f-a726-a3b573915c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe8167be00>]}
[0m10:35:35.703495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '372291d9-b02e-496f-a726-a3b573915c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe81558500>]}
[0m10:35:35.769977 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m10:35:36.903250 [debug] [MainThread]: checksum: eea1a9e9f56a74d304aa4a9e5e9c8fc1dea4ccd2b0ec98e366756009c99c5c94, vars: {}, profile: , target: dev, version: 1.9.2
[0m10:35:38.530690 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:35:38.532286 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:35:38.675560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '372291d9-b02e-496f-a726-a3b573915c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe7bbf82f0>]}
[0m10:35:39.241602 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m10:35:39.359661 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m10:35:40.230188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '372291d9-b02e-496f-a726-a3b573915c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe7b6d40e0>]}
[0m10:35:40.232024 [info ] [MainThread]: Found 7 models, 1 source, 424 macros
[0m10:35:40.234622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '372291d9-b02e-496f-a726-a3b573915c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe836b9dc0>]}
[0m10:35:40.244665 [info ] [MainThread]: 
[0m10:35:40.247493 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:35:40.251929 [info ] [MainThread]: 
[0m10:35:40.259298 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m10:35:40.295246 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_sales_database'
[0m10:35:40.509144 [debug] [ThreadPool]: Using duckdb connection "list_sales_database"
[0m10:35:40.511040 [debug] [ThreadPool]: On list_sales_database: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "list_sales_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"sales_database"'
    
  
  
[0m10:35:40.512789 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:35:40.553017 [debug] [ThreadPool]: SQL status: OK in 0.040 seconds
[0m10:35:40.570846 [debug] [ThreadPool]: On list_sales_database: Close
[0m10:35:40.577400 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_database, now create_sales_database_main)
[0m10:35:40.579799 [debug] [ThreadPool]: Creating schema "database: "sales_database"
schema: "main"
"
[0m10:35:40.631174 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m10:35:40.662806 [debug] [ThreadPool]: On create_sales_database_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "create_sales_database_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='sales_database'
        and type='sqlite'
    
  
[0m10:35:40.664866 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:35:40.835344 [debug] [ThreadPool]: SQL status: OK in 0.170 seconds
[0m10:35:40.859646 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m10:35:40.864488 [debug] [ThreadPool]: On create_sales_database_main: BEGIN
[0m10:35:40.891240 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:35:40.892828 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m10:35:40.898130 [debug] [ThreadPool]: On create_sales_database_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "create_sales_database_main"} */

    
    
        create schema if not exists "sales_database"."main"
    
[0m10:35:40.900770 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:35:40.909184 [debug] [ThreadPool]: On create_sales_database_main: COMMIT
[0m10:35:40.911047 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m10:35:40.912763 [debug] [ThreadPool]: On create_sales_database_main: COMMIT
[0m10:35:40.929804 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:35:40.932163 [debug] [ThreadPool]: On create_sales_database_main: Close
[0m10:35:40.954114 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_sales_database_main, now list_sales_database_main)
[0m10:35:41.002076 [debug] [ThreadPool]: Using duckdb connection "list_sales_database_main"
[0m10:35:41.003797 [debug] [ThreadPool]: On list_sales_database_main: BEGIN
[0m10:35:41.005524 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:35:41.043124 [debug] [ThreadPool]: SQL status: OK in 0.038 seconds
[0m10:35:41.044812 [debug] [ThreadPool]: Using duckdb connection "list_sales_database_main"
[0m10:35:41.049250 [debug] [ThreadPool]: On list_sales_database_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "list_sales_database_main"} */
select
      'sales_database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'sales_database'
  
[0m10:35:41.179117 [debug] [ThreadPool]: SQL status: OK in 0.111 seconds
[0m10:35:41.192973 [debug] [ThreadPool]: On list_sales_database_main: ROLLBACK
[0m10:35:41.216191 [debug] [ThreadPool]: Failed to rollback 'list_sales_database_main'
[0m10:35:41.219295 [debug] [ThreadPool]: On list_sales_database_main: Close
[0m10:35:41.247704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '372291d9-b02e-496f-a726-a3b573915c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe7aa83860>]}
[0m10:35:41.250003 [debug] [MainThread]: Using duckdb connection "master"
[0m10:35:41.259092 [debug] [MainThread]: On master: BEGIN
[0m10:35:41.260858 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:35:41.306271 [debug] [MainThread]: SQL status: OK in 0.045 seconds
[0m10:35:41.330212 [debug] [MainThread]: On master: COMMIT
[0m10:35:41.334774 [debug] [MainThread]: Using duckdb connection "master"
[0m10:35:41.336675 [debug] [MainThread]: On master: COMMIT
[0m10:35:41.349899 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m10:35:41.351626 [debug] [MainThread]: On master: Close
[0m10:35:41.421255 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_company
[0m10:35:41.433984 [info ] [Thread-1 (]: 1 of 7 START sql view model main.dim_company ................................... [RUN]
[0m10:35:41.440362 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.my_dbt_project.dim_company'
[0m10:35:41.444549 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_company
[0m10:35:41.468589 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_company"
[0m10:35:41.488368 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_company
[0m10:35:41.797823 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_company"
[0m10:35:41.880288 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_company"
[0m10:35:41.882203 [debug] [Thread-1 (]: On model.my_dbt_project.dim_company: BEGIN
[0m10:35:41.884647 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:35:42.018687 [debug] [Thread-1 (]: SQL status: OK in 0.134 seconds
[0m10:35:42.031726 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_company"
[0m10:35:42.064659 [debug] [Thread-1 (]: On model.my_dbt_project.dim_company: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.dim_company"} */

  
  create view "sales_database"."main"."dim_company__dbt_tmp" as (
    WITH companies AS (
    SELECT DISTINCT
        company AS company_id,
        company
    FROM "sales_database"."main"."sales"
)

SELECT * FROM companies
  );

[0m10:35:42.069748 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:35:42.093607 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_company"
[0m10:35:42.094914 [debug] [Thread-1 (]: On model.my_dbt_project.dim_company: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.dim_company"} */
alter view "sales_database"."main"."dim_company__dbt_tmp" rename to "dim_company"
[0m10:35:42.097033 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:35:42.128141 [debug] [Thread-1 (]: On model.my_dbt_project.dim_company: COMMIT
[0m10:35:42.130115 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_company"
[0m10:35:42.131921 [debug] [Thread-1 (]: On model.my_dbt_project.dim_company: COMMIT
[0m10:35:42.141929 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m10:35:42.161292 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_company"
[0m10:35:42.163146 [debug] [Thread-1 (]: On model.my_dbt_project.dim_company: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.dim_company"} */
drop view if exists "sales_database"."main"."dim_company__dbt_backup" cascade
[0m10:35:42.165800 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:35:42.174073 [debug] [Thread-1 (]: On model.my_dbt_project.dim_company: Close
[0m10:35:42.224030 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '372291d9-b02e-496f-a726-a3b573915c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe8202cda0>]}
[0m10:35:42.227169 [info ] [Thread-1 (]: 1 of 7 OK created sql view model main.dim_company .............................. [[32mOK[0m in 0.78s]
[0m10:35:42.232583 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_company
[0m10:35:42.234526 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_currency
[0m10:35:42.236676 [info ] [Thread-1 (]: 2 of 7 START sql view model main.dim_currency .................................. [RUN]
[0m10:35:42.239635 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_company, now model.my_dbt_project.dim_currency)
[0m10:35:42.246966 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_currency
[0m10:35:42.271318 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_currency"
[0m10:35:42.331929 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_currency
[0m10:35:42.368646 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_currency"
[0m10:35:42.418119 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_currency"
[0m10:35:42.420879 [debug] [Thread-1 (]: On model.my_dbt_project.dim_currency: BEGIN
[0m10:35:42.428096 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:35:42.521028 [debug] [Thread-1 (]: SQL status: OK in 0.093 seconds
[0m10:35:42.527522 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_currency"
[0m10:35:42.529878 [debug] [Thread-1 (]: On model.my_dbt_project.dim_currency: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.dim_currency"} */

  
  create view "sales_database"."main"."dim_currency__dbt_tmp" as (
    WITH currency_data AS (
    SELECT DISTINCT
        currency AS currency_id,
        currency,
        conversion_rate
    FROM "sales_database"."main"."sales"
)

SELECT * FROM currency_data
  );

[0m10:35:42.538027 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m10:35:42.552647 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_currency"
[0m10:35:42.555367 [debug] [Thread-1 (]: On model.my_dbt_project.dim_currency: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.dim_currency"} */
alter view "sales_database"."main"."dim_currency__dbt_tmp" rename to "dim_currency"
[0m10:35:42.557929 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:35:42.563830 [debug] [Thread-1 (]: On model.my_dbt_project.dim_currency: COMMIT
[0m10:35:42.569516 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_currency"
[0m10:35:42.574115 [debug] [Thread-1 (]: On model.my_dbt_project.dim_currency: COMMIT
[0m10:35:42.593019 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m10:35:42.601295 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_currency"
[0m10:35:42.603115 [debug] [Thread-1 (]: On model.my_dbt_project.dim_currency: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.dim_currency"} */
drop view if exists "sales_database"."main"."dim_currency__dbt_backup" cascade
[0m10:35:42.605752 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:35:42.610592 [debug] [Thread-1 (]: On model.my_dbt_project.dim_currency: Close
[0m10:35:42.651483 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '372291d9-b02e-496f-a726-a3b573915c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe7a869c10>]}
[0m10:35:42.653829 [info ] [Thread-1 (]: 2 of 7 OK created sql view model main.dim_currency ............................. [[32mOK[0m in 0.41s]
[0m10:35:42.657796 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_currency
[0m10:35:42.659751 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_customer
[0m10:35:42.662992 [info ] [Thread-1 (]: 3 of 7 START sql view model main.dim_customer .................................. [RUN]
[0m10:35:42.666491 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_currency, now model.my_dbt_project.dim_customer)
[0m10:35:42.668996 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_customer
[0m10:35:42.679529 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_customer"
[0m10:35:42.702066 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_customer
[0m10:35:42.717038 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_customer"
[0m10:35:42.740395 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_customer"
[0m10:35:42.742863 [debug] [Thread-1 (]: On model.my_dbt_project.dim_customer: BEGIN
[0m10:35:42.744682 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:35:42.819623 [debug] [Thread-1 (]: SQL status: OK in 0.075 seconds
[0m10:35:42.827057 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_customer"
[0m10:35:42.833278 [debug] [Thread-1 (]: On model.my_dbt_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.dim_customer"} */

  
  create view "sales_database"."main"."dim_customer__dbt_tmp" as (
    -- WITH sales AS (
--     SELECT * FROM "sales_database"."main"."sales"
-- )

-- SELECT
--     DISTINCT
--     customer AS customer_id,
--     customer_name,
--     customer_address,
--     customer_group,
--     territory,
--     language AS customer_language
-- FROM sales
-- WHERE customer IS NOT NULL




WITH customers AS (
    SELECT DISTINCT
        customer AS customer_id,
        customer_name,
        customer_group,
        territory
    FROM "sales_database"."main"."sales"
)

SELECT * FROM customers
  );

[0m10:35:42.836920 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:35:42.856457 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_customer"
[0m10:35:42.870363 [debug] [Thread-1 (]: On model.my_dbt_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.dim_customer"} */
alter view "sales_database"."main"."dim_customer__dbt_tmp" rename to "dim_customer"
[0m10:35:42.874109 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:35:42.882339 [debug] [Thread-1 (]: On model.my_dbt_project.dim_customer: COMMIT
[0m10:35:42.891834 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_customer"
[0m10:35:42.893663 [debug] [Thread-1 (]: On model.my_dbt_project.dim_customer: COMMIT
[0m10:35:42.925641 [debug] [Thread-1 (]: SQL status: OK in 0.030 seconds
[0m10:35:42.974346 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_customer"
[0m10:35:42.989010 [debug] [Thread-1 (]: On model.my_dbt_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.dim_customer"} */
drop view if exists "sales_database"."main"."dim_customer__dbt_backup" cascade
[0m10:35:42.992192 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:35:43.020209 [debug] [Thread-1 (]: On model.my_dbt_project.dim_customer: Close
[0m10:35:43.132234 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '372291d9-b02e-496f-a726-a3b573915c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe7a89ca70>]}
[0m10:35:43.135565 [info ] [Thread-1 (]: 3 of 7 OK created sql view model main.dim_customer ............................. [[32mOK[0m in 0.47s]
[0m10:35:43.144956 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_customer
[0m10:35:43.148340 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_date
[0m10:35:43.152023 [info ] [Thread-1 (]: 4 of 7 START sql view model main.dim_date ...................................... [RUN]
[0m10:35:43.169969 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_customer, now model.my_dbt_project.dim_date)
[0m10:35:43.177412 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_date
[0m10:35:43.190876 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_date"
[0m10:35:43.223655 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_date
[0m10:35:43.247871 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_date"
[0m10:35:43.331539 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_date"
[0m10:35:43.342290 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: BEGIN
[0m10:35:43.346409 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:35:43.421718 [debug] [Thread-1 (]: SQL status: OK in 0.076 seconds
[0m10:35:43.429514 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_date"
[0m10:35:43.440884 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.dim_date"} */

  
  create view "sales_database"."main"."dim_date__dbt_tmp" as (
    -- WITH sales AS (
--     SELECT * FROM "sales_database"."main"."sales"
-- )
-- SELECT
--     transaction_date,
--     strftime(transaction_date, '%Y-%m-%d') AS date_id,  -- Change the format to YYYY-MM-DD
--     strftime(transaction_date, '%A') AS weekday_name,
--     strftime(transaction_date, '%m') AS month,
--     strftime(transaction_date, '%Y') AS year,
--     strftime(transaction_date, '%d') AS day,
--     EXTRACT(QUARTER FROM transaction_date) AS quarter
-- FROM sales
-- WHERE transaction_date IS NOT NULL


WITH date_data AS (
    SELECT DISTINCT
        transaction_date AS date_id,
        EXTRACT(YEAR FROM transaction_date) AS year,
        EXTRACT(MONTH FROM transaction_date) AS month,
        EXTRACT(DAY FROM transaction_date) AS day,
        EXTRACT(WEEK FROM transaction_date) AS week_of_year,
        EXTRACT(QUARTER FROM transaction_date) AS quarter
    FROM "sales_database"."main"."sales"
)

SELECT * FROM date_data
  );

[0m10:35:43.457939 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m10:35:43.476312 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_date"
[0m10:35:43.480133 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.dim_date"} */
alter view "sales_database"."main"."dim_date__dbt_tmp" rename to "dim_date"
[0m10:35:43.484442 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:35:43.503187 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: COMMIT
[0m10:35:43.504584 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_date"
[0m10:35:43.505900 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: COMMIT
[0m10:35:43.514341 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m10:35:43.525857 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_date"
[0m10:35:43.527386 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.dim_date"} */
drop view if exists "sales_database"."main"."dim_date__dbt_backup" cascade
[0m10:35:43.530163 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:35:43.536208 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: Close
[0m10:35:43.583797 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '372291d9-b02e-496f-a726-a3b573915c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe7a8eff50>]}
[0m10:35:43.586239 [info ] [Thread-1 (]: 4 of 7 OK created sql view model main.dim_date ................................. [[32mOK[0m in 0.42s]
[0m10:35:43.590006 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_date
[0m10:35:43.592325 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_produt
[0m10:35:43.594373 [info ] [Thread-1 (]: 5 of 7 START sql view model main.dim_produt .................................... [RUN]
[0m10:35:43.596404 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_date, now model.my_dbt_project.dim_produt)
[0m10:35:43.599868 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_produt
[0m10:35:43.615242 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_produt"
[0m10:35:43.636397 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_produt
[0m10:35:43.660487 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_produt"
[0m10:35:43.691732 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_produt"
[0m10:35:43.693727 [debug] [Thread-1 (]: On model.my_dbt_project.dim_produt: BEGIN
[0m10:35:43.695479 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:35:43.733705 [debug] [Thread-1 (]: SQL status: OK in 0.038 seconds
[0m10:35:43.737115 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_produt"
[0m10:35:43.739373 [debug] [Thread-1 (]: On model.my_dbt_project.dim_produt: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.dim_produt"} */

  
  create view "sales_database"."main"."dim_produt__dbt_tmp" as (
    -- WITH sales AS (
--     SELECT * 
--     FROM "sales_database"."main"."sales"
-- )

-- SELECT 
--     sales.name,
--     json_extract(items, '$[0].name') AS product_name,  -- Example to extract the first element's "name" field from JSON array
--     json_extract(items, '$[0].item_code') AS product_item_code
-- FROM sales
-- WHERE json_extract(items, '$[0].name') IS NOT NULL  -- Filter to only keep rows with a non-null product name



WITH exploded_items AS (
    SELECT
        name AS sales_order_id,
        JSON_EXTRACT(items, '$[*].item_code') AS product_code,
        JSON_EXTRACT(items, '$[*].item_name') AS product_name,
        JSON_EXTRACT(items, '$[*].qty') AS quantity_sold,
        JSON_EXTRACT(items, '$[*].rate') AS unit_price
    FROM "sales_database"."main"."sales"
)

SELECT 
    sales_order_id,
    UNNEST(product_code) AS product_id,
    UNNEST(product_name) AS product_name,
    UNNEST(quantity_sold) AS quantity_sold,
    UNNEST(unit_price) AS unit_price
FROM exploded_items
  );

[0m10:35:43.747828 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m10:35:43.761257 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_produt"
[0m10:35:43.765365 [debug] [Thread-1 (]: On model.my_dbt_project.dim_produt: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.dim_produt"} */
alter view "sales_database"."main"."dim_produt__dbt_tmp" rename to "dim_produt"
[0m10:35:43.780550 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:35:43.801109 [debug] [Thread-1 (]: On model.my_dbt_project.dim_produt: COMMIT
[0m10:35:43.805301 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_produt"
[0m10:35:43.807367 [debug] [Thread-1 (]: On model.my_dbt_project.dim_produt: COMMIT
[0m10:35:43.831080 [debug] [Thread-1 (]: SQL status: OK in 0.020 seconds
[0m10:35:43.844638 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_produt"
[0m10:35:43.847813 [debug] [Thread-1 (]: On model.my_dbt_project.dim_produt: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.dim_produt"} */
drop view if exists "sales_database"."main"."dim_produt__dbt_backup" cascade
[0m10:35:43.850735 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:35:43.863558 [debug] [Thread-1 (]: On model.my_dbt_project.dim_produt: Close
[0m10:35:43.946255 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '372291d9-b02e-496f-a726-a3b573915c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe7a9385c0>]}
[0m10:35:43.949067 [info ] [Thread-1 (]: 5 of 7 OK created sql view model main.dim_produt ............................... [[32mOK[0m in 0.35s]
[0m10:35:43.960995 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_produt
[0m10:35:43.963312 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_sales_team
[0m10:35:43.965769 [info ] [Thread-1 (]: 6 of 7 START sql view model main.dim_sales_team ................................ [RUN]
[0m10:35:43.975631 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_produt, now model.my_dbt_project.dim_sales_team)
[0m10:35:43.978413 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_sales_team
[0m10:35:43.993261 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_sales_team"
[0m10:35:44.035625 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_sales_team
[0m10:35:44.068001 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_sales_team"
[0m10:35:44.118506 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_sales_team"
[0m10:35:44.120844 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_team: BEGIN
[0m10:35:44.123248 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:35:44.168547 [debug] [Thread-1 (]: SQL status: OK in 0.045 seconds
[0m10:35:44.174802 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_sales_team"
[0m10:35:44.177235 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_team: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sales_team"} */

  
  create view "sales_database"."main"."dim_sales_team__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
    DISTINCT
    sales_team->>'name' AS sales_team_id,
    sales_team->>'region' AS sales_team_region
FROM sales
WHERE sales_team IS NOT NULL
  );

[0m10:35:44.182919 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m10:35:44.194624 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_sales_team"
[0m10:35:44.196037 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_team: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sales_team"} */
alter view "sales_database"."main"."dim_sales_team__dbt_tmp" rename to "dim_sales_team"
[0m10:35:44.198990 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:35:44.204088 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_team: COMMIT
[0m10:35:44.206201 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_sales_team"
[0m10:35:44.208309 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_team: COMMIT
[0m10:35:44.223240 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m10:35:44.232134 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_sales_team"
[0m10:35:44.233848 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_team: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sales_team"} */
drop view if exists "sales_database"."main"."dim_sales_team__dbt_backup" cascade
[0m10:35:44.249506 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m10:35:44.254538 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_team: Close
[0m10:35:44.306427 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '372291d9-b02e-496f-a726-a3b573915c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe7a8816d0>]}
[0m10:35:44.308263 [info ] [Thread-1 (]: 6 of 7 OK created sql view model main.dim_sales_team ........................... [[32mOK[0m in 0.33s]
[0m10:35:44.311947 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_sales_team
[0m10:35:44.313640 [debug] [Thread-1 (]: Began running node model.my_dbt_project.fact_sales
[0m10:35:44.315857 [info ] [Thread-1 (]: 7 of 7 START sql table model main.fact_sales ................................... [RUN]
[0m10:35:44.318086 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_sales_team, now model.my_dbt_project.fact_sales)
[0m10:35:44.320118 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.fact_sales
[0m10:35:44.333308 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.fact_sales"
[0m10:35:44.350393 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.fact_sales
[0m10:35:44.426776 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.fact_sales"
[0m10:35:44.460251 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.fact_sales"
[0m10:35:44.462329 [debug] [Thread-1 (]: On model.my_dbt_project.fact_sales: BEGIN
[0m10:35:44.464718 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:35:44.505190 [debug] [Thread-1 (]: SQL status: OK in 0.041 seconds
[0m10:35:44.507405 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.fact_sales"
[0m10:35:44.509421 [debug] [Thread-1 (]: On model.my_dbt_project.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.fact_sales"} */

  
    
    

    create  table
      "sales_database"."main"."fact_sales__dbt_tmp"
  
    as (
      WITH sales_data AS (
    SELECT
        name AS sales_order_id,
        transaction_date,
        customer,
        company,
        total AS sales_amount,
        net_total,
        discount_amount,
        base_total_taxes_and_charges AS tax_amount,
        grand_total,
        currency,
        conversion_rate,
        items, -- JSON field with product details
        taxes -- JSON field with tax details
    FROM "sales_database"."main"."sales"
)

SELECT * FROM sales_data
    );
  
  
[0m10:35:44.521227 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m10:35:44.534118 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.fact_sales"
[0m10:35:44.536397 [debug] [Thread-1 (]: On model.my_dbt_project.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.fact_sales"} */
alter table "sales_database"."main"."fact_sales__dbt_tmp" rename to "fact_sales"
[0m10:35:44.540968 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:35:44.557370 [debug] [Thread-1 (]: On model.my_dbt_project.fact_sales: COMMIT
[0m10:35:44.559313 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.fact_sales"
[0m10:35:44.561227 [debug] [Thread-1 (]: On model.my_dbt_project.fact_sales: COMMIT
[0m10:35:44.593953 [debug] [Thread-1 (]: SQL status: OK in 0.031 seconds
[0m10:35:44.607099 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.fact_sales"
[0m10:35:44.609125 [debug] [Thread-1 (]: On model.my_dbt_project.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.fact_sales"} */
drop table if exists "sales_database"."main"."fact_sales__dbt_backup" cascade
[0m10:35:44.611902 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:35:44.616884 [debug] [Thread-1 (]: On model.my_dbt_project.fact_sales: Close
[0m10:35:44.673479 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '372291d9-b02e-496f-a726-a3b573915c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe7a8b06b0>]}
[0m10:35:44.676107 [info ] [Thread-1 (]: 7 of 7 OK created sql table model main.fact_sales .............................. [[32mOK[0m in 0.36s]
[0m10:35:44.679192 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.fact_sales
[0m10:35:44.683107 [debug] [MainThread]: Using duckdb connection "master"
[0m10:35:44.684870 [debug] [MainThread]: On master: BEGIN
[0m10:35:44.687054 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:35:44.721533 [debug] [MainThread]: SQL status: OK in 0.034 seconds
[0m10:35:44.724206 [debug] [MainThread]: On master: COMMIT
[0m10:35:44.728633 [debug] [MainThread]: Using duckdb connection "master"
[0m10:35:44.731730 [debug] [MainThread]: On master: COMMIT
[0m10:35:44.734096 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m10:35:44.738127 [debug] [MainThread]: On master: Close
[0m10:35:44.747513 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:35:44.748821 [debug] [MainThread]: Connection 'list_sales_database_main' was properly closed.
[0m10:35:44.750694 [debug] [MainThread]: Connection 'model.my_dbt_project.fact_sales' was properly closed.
[0m10:35:44.753555 [info ] [MainThread]: 
[0m10:35:44.755401 [info ] [MainThread]: Finished running 1 table model, 6 view models in 0 hours 0 minutes and 4.49 seconds (4.49s).
[0m10:35:44.760784 [debug] [MainThread]: Command end result
[0m10:35:44.884808 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m10:35:44.901874 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m10:35:44.944466 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dags/dbt_models/target/run_results.json
[0m10:35:44.946277 [info ] [MainThread]: 
[0m10:35:44.948716 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:35:44.951391 [info ] [MainThread]: 
[0m10:35:44.953825 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m10:35:44.956934 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.286221, "process_in_blocks": "41544", "process_kernel_time": 2.423064, "process_mem_max_rss": "151132", "process_out_blocks": "1968", "process_user_time": 10.280283}
[0m10:35:44.962380 [debug] [MainThread]: Command `dbt run` succeeded at 10:35:44.960987 after 12.29 seconds
[0m10:35:44.979177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe81e2a450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe8202f650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe815ec350>]}
[0m10:35:44.990582 [debug] [MainThread]: Flushing usage events
[0m10:35:46.668616 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:41:45.667881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc88c732ab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc88c4412e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc88e30bec0>]}


============================== 10:41:45.836566 | 246ec6aa-cdfe-405f-8db1-6a2d0349a631 ==============================
[0m10:41:45.836566 [info ] [MainThread]: Running with dbt=1.9.2
[0m10:41:45.842544 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dags/dbt_models/logs', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt/profiles.yml', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt/profiles.yml --target dev', 'send_anonymous_usage_stats': 'True'}
[0m10:41:48.099507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '246ec6aa-cdfe-405f-8db1-6a2d0349a631', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc88bf25190>]}
[0m10:41:48.378993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '246ec6aa-cdfe-405f-8db1-6a2d0349a631', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc88c817ef0>]}
[0m10:41:48.400064 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m10:41:49.286976 [debug] [MainThread]: checksum: eea1a9e9f56a74d304aa4a9e5e9c8fc1dea4ccd2b0ec98e366756009c99c5c94, vars: {}, profile: , target: dev, version: 1.9.2
[0m10:41:50.079153 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:41:50.080931 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:41:50.243759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '246ec6aa-cdfe-405f-8db1-6a2d0349a631', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc886355880>]}
[0m10:41:50.578303 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m10:41:50.605694 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m10:41:50.808473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '246ec6aa-cdfe-405f-8db1-6a2d0349a631', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8867a2d50>]}
[0m10:41:50.810629 [info ] [MainThread]: Found 7 models, 1 source, 424 macros
[0m10:41:50.827573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '246ec6aa-cdfe-405f-8db1-6a2d0349a631', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8861dccb0>]}
[0m10:41:50.843161 [info ] [MainThread]: 
[0m10:41:50.877911 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:41:50.885040 [info ] [MainThread]: 
[0m10:41:50.887593 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m10:41:50.928855 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_sales_database'
[0m10:41:51.260909 [debug] [ThreadPool]: Using duckdb connection "list_sales_database"
[0m10:41:51.266861 [debug] [ThreadPool]: On list_sales_database: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "list_sales_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"sales_database"'
    
  
  
[0m10:41:51.270941 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:41:51.496469 [debug] [ThreadPool]: SQL status: OK in 0.225 seconds
[0m10:41:51.501368 [debug] [ThreadPool]: On list_sales_database: Close
[0m10:41:51.509542 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_database, now create_sales_database_main)
[0m10:41:51.514729 [debug] [ThreadPool]: Creating schema "database: "sales_database"
schema: "main"
"
[0m10:41:51.538258 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m10:41:51.540227 [debug] [ThreadPool]: On create_sales_database_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "create_sales_database_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='sales_database'
        and type='sqlite'
    
  
[0m10:41:51.542149 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:41:51.579450 [debug] [ThreadPool]: SQL status: OK in 0.037 seconds
[0m10:41:51.583323 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m10:41:51.584803 [debug] [ThreadPool]: On create_sales_database_main: BEGIN
[0m10:41:51.587418 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:41:51.590879 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m10:41:51.592255 [debug] [ThreadPool]: On create_sales_database_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "create_sales_database_main"} */

    
    
        create schema if not exists "sales_database"."main"
    
[0m10:41:51.595155 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:41:51.598526 [debug] [ThreadPool]: On create_sales_database_main: COMMIT
[0m10:41:51.600561 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m10:41:51.602288 [debug] [ThreadPool]: On create_sales_database_main: COMMIT
[0m10:41:51.605358 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:41:51.607041 [debug] [ThreadPool]: On create_sales_database_main: Close
[0m10:41:51.616029 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_sales_database_main'
[0m10:41:51.636473 [debug] [ThreadPool]: Using duckdb connection "list_sales_database_main"
[0m10:41:51.649122 [debug] [ThreadPool]: On list_sales_database_main: BEGIN
[0m10:41:51.650633 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:41:51.694806 [debug] [ThreadPool]: SQL status: OK in 0.044 seconds
[0m10:41:51.696551 [debug] [ThreadPool]: Using duckdb connection "list_sales_database_main"
[0m10:41:51.698440 [debug] [ThreadPool]: On list_sales_database_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "list_sales_database_main"} */
select
      'sales_database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'sales_database'
  
[0m10:41:51.838890 [debug] [ThreadPool]: SQL status: OK in 0.137 seconds
[0m10:41:51.844590 [debug] [ThreadPool]: On list_sales_database_main: ROLLBACK
[0m10:41:51.849837 [debug] [ThreadPool]: Failed to rollback 'list_sales_database_main'
[0m10:41:51.851674 [debug] [ThreadPool]: On list_sales_database_main: Close
[0m10:41:51.864960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '246ec6aa-cdfe-405f-8db1-6a2d0349a631', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8867a3a10>]}
[0m10:41:51.867263 [debug] [MainThread]: Using duckdb connection "master"
[0m10:41:51.869308 [debug] [MainThread]: On master: BEGIN
[0m10:41:51.871014 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:41:51.921824 [debug] [MainThread]: SQL status: OK in 0.051 seconds
[0m10:41:51.925356 [debug] [MainThread]: On master: COMMIT
[0m10:41:51.927188 [debug] [MainThread]: Using duckdb connection "master"
[0m10:41:51.929698 [debug] [MainThread]: On master: COMMIT
[0m10:41:51.932043 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m10:41:51.933811 [debug] [MainThread]: On master: Close
[0m10:41:51.947519 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_company
[0m10:41:51.949881 [info ] [Thread-1 (]: 1 of 7 START sql view model main.dim_company ................................... [RUN]
[0m10:41:51.953814 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.my_dbt_project.dim_company'
[0m10:41:51.956215 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_company
[0m10:41:51.982076 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_company"
[0m10:41:51.998775 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_company
[0m10:41:52.104195 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_company"
[0m10:41:52.135365 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_company"
[0m10:41:52.137256 [debug] [Thread-1 (]: On model.my_dbt_project.dim_company: BEGIN
[0m10:41:52.138935 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:41:52.182858 [debug] [Thread-1 (]: SQL status: OK in 0.044 seconds
[0m10:41:52.184417 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_company"
[0m10:41:52.186288 [debug] [Thread-1 (]: On model.my_dbt_project.dim_company: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.dim_company"} */

  
  create view "sales_database"."main"."dim_company__dbt_tmp" as (
    WITH companies AS (
    SELECT DISTINCT
        company AS company_id,
        company
    FROM "sales_database"."main"."sales"
)

SELECT * FROM companies
  );

[0m10:41:52.189514 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:41:52.205126 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_company"
[0m10:41:52.207030 [debug] [Thread-1 (]: On model.my_dbt_project.dim_company: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.dim_company"} */
alter view "sales_database"."main"."dim_company" rename to "dim_company__dbt_backup"
[0m10:41:52.209878 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:41:52.219873 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_company"
[0m10:41:52.221880 [debug] [Thread-1 (]: On model.my_dbt_project.dim_company: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.dim_company"} */
alter view "sales_database"."main"."dim_company__dbt_tmp" rename to "dim_company"
[0m10:41:52.225061 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:41:52.260248 [debug] [Thread-1 (]: On model.my_dbt_project.dim_company: COMMIT
[0m10:41:52.262155 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_company"
[0m10:41:52.264013 [debug] [Thread-1 (]: On model.my_dbt_project.dim_company: COMMIT
[0m10:41:52.289322 [debug] [Thread-1 (]: SQL status: OK in 0.023 seconds
[0m10:41:52.307010 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_company"
[0m10:41:52.309178 [debug] [Thread-1 (]: On model.my_dbt_project.dim_company: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.dim_company"} */
drop view if exists "sales_database"."main"."dim_company__dbt_backup" cascade
[0m10:41:52.332351 [debug] [Thread-1 (]: SQL status: OK in 0.021 seconds
[0m10:41:52.339387 [debug] [Thread-1 (]: On model.my_dbt_project.dim_company: Close
[0m10:41:52.489402 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '246ec6aa-cdfe-405f-8db1-6a2d0349a631', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc88cc784a0>]}
[0m10:41:52.492602 [info ] [Thread-1 (]: 1 of 7 OK created sql view model main.dim_company .............................. [[32mOK[0m in 0.53s]
[0m10:41:52.495836 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_company
[0m10:41:52.498087 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_currency
[0m10:41:52.500505 [info ] [Thread-1 (]: 2 of 7 START sql view model main.dim_currency .................................. [RUN]
[0m10:41:52.503000 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_company, now model.my_dbt_project.dim_currency)
[0m10:41:52.505666 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_currency
[0m10:41:52.515354 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_currency"
[0m10:41:52.537226 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_currency
[0m10:41:52.563415 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_currency"
[0m10:41:52.582122 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_currency"
[0m10:41:52.584574 [debug] [Thread-1 (]: On model.my_dbt_project.dim_currency: BEGIN
[0m10:41:52.586762 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:41:52.636629 [debug] [Thread-1 (]: SQL status: OK in 0.050 seconds
[0m10:41:52.640411 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_currency"
[0m10:41:52.643246 [debug] [Thread-1 (]: On model.my_dbt_project.dim_currency: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.dim_currency"} */

  
  create view "sales_database"."main"."dim_currency__dbt_tmp" as (
    WITH currency_data AS (
    SELECT DISTINCT
        currency AS currency_id,
        currency,
        conversion_rate
    FROM "sales_database"."main"."sales"
)

SELECT * FROM currency_data
  );

[0m10:41:52.647913 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:41:52.661255 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_currency"
[0m10:41:52.663921 [debug] [Thread-1 (]: On model.my_dbt_project.dim_currency: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.dim_currency"} */
alter view "sales_database"."main"."dim_currency" rename to "dim_currency__dbt_backup"
[0m10:41:52.675636 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:41:52.687964 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_currency"
[0m10:41:52.690205 [debug] [Thread-1 (]: On model.my_dbt_project.dim_currency: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.dim_currency"} */
alter view "sales_database"."main"."dim_currency__dbt_tmp" rename to "dim_currency"
[0m10:41:52.693504 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:41:52.700375 [debug] [Thread-1 (]: On model.my_dbt_project.dim_currency: COMMIT
[0m10:41:52.702722 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_currency"
[0m10:41:52.705137 [debug] [Thread-1 (]: On model.my_dbt_project.dim_currency: COMMIT
[0m10:41:52.733299 [debug] [Thread-1 (]: SQL status: OK in 0.026 seconds
[0m10:41:52.742564 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_currency"
[0m10:41:52.744821 [debug] [Thread-1 (]: On model.my_dbt_project.dim_currency: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.dim_currency"} */
drop view if exists "sales_database"."main"."dim_currency__dbt_backup" cascade
[0m10:41:52.777186 [debug] [Thread-1 (]: SQL status: OK in 0.030 seconds
[0m10:41:52.780637 [debug] [Thread-1 (]: On model.my_dbt_project.dim_currency: Close
[0m10:41:52.888959 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '246ec6aa-cdfe-405f-8db1-6a2d0349a631', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc885577c20>]}
[0m10:41:52.896699 [info ] [Thread-1 (]: 2 of 7 OK created sql view model main.dim_currency ............................. [[32mOK[0m in 0.38s]
[0m10:41:52.901121 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_currency
[0m10:41:52.903206 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_customer
[0m10:41:52.906708 [info ] [Thread-1 (]: 3 of 7 START sql view model main.dim_customer .................................. [RUN]
[0m10:41:52.919583 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_currency, now model.my_dbt_project.dim_customer)
[0m10:41:52.937038 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_customer
[0m10:41:52.975568 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_customer"
[0m10:41:53.017309 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_customer
[0m10:41:53.030438 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_customer"
[0m10:41:53.052964 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_customer"
[0m10:41:53.056832 [debug] [Thread-1 (]: On model.my_dbt_project.dim_customer: BEGIN
[0m10:41:53.058928 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:41:53.104141 [debug] [Thread-1 (]: SQL status: OK in 0.045 seconds
[0m10:41:53.106007 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_customer"
[0m10:41:53.108045 [debug] [Thread-1 (]: On model.my_dbt_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.dim_customer"} */

  
  create view "sales_database"."main"."dim_customer__dbt_tmp" as (
    -- WITH sales AS (
--     SELECT * FROM "sales_database"."main"."sales"
-- )

-- SELECT
--     DISTINCT
--     customer AS customer_id,
--     customer_name,
--     customer_address,
--     customer_group,
--     territory,
--     language AS customer_language
-- FROM sales
-- WHERE customer IS NOT NULL




WITH customers AS (
    SELECT DISTINCT
        customer AS customer_id,
        customer_name,
        customer_group,
        territory
    FROM "sales_database"."main"."sales"
)

SELECT * FROM customers
  );

[0m10:41:53.112315 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:41:53.124393 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_customer"
[0m10:41:53.125741 [debug] [Thread-1 (]: On model.my_dbt_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.dim_customer"} */
alter view "sales_database"."main"."dim_customer" rename to "dim_customer__dbt_backup"
[0m10:41:53.128145 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:41:53.136369 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_customer"
[0m10:41:53.137732 [debug] [Thread-1 (]: On model.my_dbt_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.dim_customer"} */
alter view "sales_database"."main"."dim_customer__dbt_tmp" rename to "dim_customer"
[0m10:41:53.140411 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:41:53.145365 [debug] [Thread-1 (]: On model.my_dbt_project.dim_customer: COMMIT
[0m10:41:53.146745 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_customer"
[0m10:41:53.148017 [debug] [Thread-1 (]: On model.my_dbt_project.dim_customer: COMMIT
[0m10:41:53.187716 [debug] [Thread-1 (]: SQL status: OK in 0.037 seconds
[0m10:41:53.198722 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_customer"
[0m10:41:53.201150 [debug] [Thread-1 (]: On model.my_dbt_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.dim_customer"} */
drop view if exists "sales_database"."main"."dim_customer__dbt_backup" cascade
[0m10:41:53.222126 [debug] [Thread-1 (]: SQL status: OK in 0.019 seconds
[0m10:41:53.227028 [debug] [Thread-1 (]: On model.my_dbt_project.dim_customer: Close
[0m10:41:53.317593 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '246ec6aa-cdfe-405f-8db1-6a2d0349a631', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8854bd520>]}
[0m10:41:53.320457 [info ] [Thread-1 (]: 3 of 7 OK created sql view model main.dim_customer ............................. [[32mOK[0m in 0.40s]
[0m10:41:53.351925 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_customer
[0m10:41:53.353802 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_date
[0m10:41:53.355924 [info ] [Thread-1 (]: 4 of 7 START sql view model main.dim_date ...................................... [RUN]
[0m10:41:53.361710 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_customer, now model.my_dbt_project.dim_date)
[0m10:41:53.373714 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_date
[0m10:41:53.394165 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_date"
[0m10:41:53.432266 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_date
[0m10:41:53.450032 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_date"
[0m10:41:53.473069 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_date"
[0m10:41:53.474928 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: BEGIN
[0m10:41:53.476790 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:41:53.528610 [debug] [Thread-1 (]: SQL status: OK in 0.052 seconds
[0m10:41:53.530837 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_date"
[0m10:41:53.533298 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.dim_date"} */

  
  create view "sales_database"."main"."dim_date__dbt_tmp" as (
    -- WITH sales AS (
--     SELECT * FROM "sales_database"."main"."sales"
-- )
-- SELECT
--     transaction_date,
--     strftime(transaction_date, '%Y-%m-%d') AS date_id,  -- Change the format to YYYY-MM-DD
--     strftime(transaction_date, '%A') AS weekday_name,
--     strftime(transaction_date, '%m') AS month,
--     strftime(transaction_date, '%Y') AS year,
--     strftime(transaction_date, '%d') AS day,
--     EXTRACT(QUARTER FROM transaction_date) AS quarter
-- FROM sales
-- WHERE transaction_date IS NOT NULL


WITH date_data AS (
    SELECT DISTINCT
        transaction_date AS date_id,
        EXTRACT(YEAR FROM transaction_date) AS year,
        EXTRACT(MONTH FROM transaction_date) AS month,
        EXTRACT(DAY FROM transaction_date) AS day,
        EXTRACT(WEEK FROM transaction_date) AS week_of_year,
        EXTRACT(QUARTER FROM transaction_date) AS quarter
    FROM "sales_database"."main"."sales"
)

SELECT * FROM date_data
  );

[0m10:41:53.540481 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m10:41:53.550906 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_date"
[0m10:41:53.553324 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.dim_date"} */
alter view "sales_database"."main"."dim_date" rename to "dim_date__dbt_backup"
[0m10:41:53.556643 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:41:53.569823 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_date"
[0m10:41:53.571983 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.dim_date"} */
alter view "sales_database"."main"."dim_date__dbt_tmp" rename to "dim_date"
[0m10:41:53.575043 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:41:53.582471 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: COMMIT
[0m10:41:53.585513 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_date"
[0m10:41:53.587417 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: COMMIT
[0m10:41:53.615678 [debug] [Thread-1 (]: SQL status: OK in 0.026 seconds
[0m10:41:53.627039 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_date"
[0m10:41:53.629272 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.dim_date"} */
drop view if exists "sales_database"."main"."dim_date__dbt_backup" cascade
[0m10:41:53.653882 [debug] [Thread-1 (]: SQL status: OK in 0.020 seconds
[0m10:41:53.659528 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: Close
[0m10:41:53.755374 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '246ec6aa-cdfe-405f-8db1-6a2d0349a631', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc88546ef90>]}
[0m10:41:53.757817 [info ] [Thread-1 (]: 4 of 7 OK created sql view model main.dim_date ................................. [[32mOK[0m in 0.39s]
[0m10:41:53.760909 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_date
[0m10:41:53.762462 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_produt
[0m10:41:53.764528 [info ] [Thread-1 (]: 5 of 7 START sql view model main.dim_produt .................................... [RUN]
[0m10:41:53.768097 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_date, now model.my_dbt_project.dim_produt)
[0m10:41:53.769935 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_produt
[0m10:41:53.780288 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_produt"
[0m10:41:53.800190 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_produt
[0m10:41:53.819968 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_produt"
[0m10:41:53.845870 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_produt"
[0m10:41:53.848477 [debug] [Thread-1 (]: On model.my_dbt_project.dim_produt: BEGIN
[0m10:41:53.850550 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:41:53.881548 [debug] [Thread-1 (]: SQL status: OK in 0.031 seconds
[0m10:41:53.883372 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_produt"
[0m10:41:53.885738 [debug] [Thread-1 (]: On model.my_dbt_project.dim_produt: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.dim_produt"} */

  
  create view "sales_database"."main"."dim_produt__dbt_tmp" as (
    -- WITH sales AS (
--     SELECT * 
--     FROM "sales_database"."main"."sales"
-- )

-- SELECT 
--     sales.name,
--     json_extract(items, '$[0].name') AS product_name,  -- Example to extract the first element's "name" field from JSON array
--     json_extract(items, '$[0].item_code') AS product_item_code
-- FROM sales
-- WHERE json_extract(items, '$[0].name') IS NOT NULL  -- Filter to only keep rows with a non-null product name



WITH exploded_items AS (
    SELECT
        name AS sales_order_id,
        JSON_EXTRACT(items, '$[*].item_code') AS product_code,
        JSON_EXTRACT(items, '$[*].item_name') AS product_name,
        JSON_EXTRACT(items, '$[*].qty') AS quantity_sold,
        JSON_EXTRACT(items, '$[*].rate') AS unit_price
    FROM "sales_database"."main"."sales"
)

SELECT 
    sales_order_id,
    UNNEST(product_code) AS product_id,
    UNNEST(product_name) AS product_name,
    UNNEST(quantity_sold) AS quantity_sold,
    UNNEST(unit_price) AS unit_price
FROM exploded_items
  );

[0m10:41:53.889762 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:41:53.899673 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_produt"
[0m10:41:53.904568 [debug] [Thread-1 (]: On model.my_dbt_project.dim_produt: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.dim_produt"} */
alter view "sales_database"."main"."dim_produt" rename to "dim_produt__dbt_backup"
[0m10:41:53.909924 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:41:53.920152 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_produt"
[0m10:41:53.921718 [debug] [Thread-1 (]: On model.my_dbt_project.dim_produt: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.dim_produt"} */
alter view "sales_database"."main"."dim_produt__dbt_tmp" rename to "dim_produt"
[0m10:41:53.924534 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:41:53.930470 [debug] [Thread-1 (]: On model.my_dbt_project.dim_produt: COMMIT
[0m10:41:53.932334 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_produt"
[0m10:41:53.934355 [debug] [Thread-1 (]: On model.my_dbt_project.dim_produt: COMMIT
[0m10:41:53.963216 [debug] [Thread-1 (]: SQL status: OK in 0.027 seconds
[0m10:41:53.988743 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_produt"
[0m10:41:54.004316 [debug] [Thread-1 (]: On model.my_dbt_project.dim_produt: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.dim_produt"} */
drop view if exists "sales_database"."main"."dim_produt__dbt_backup" cascade
[0m10:41:54.082022 [debug] [Thread-1 (]: SQL status: OK in 0.046 seconds
[0m10:41:54.133458 [debug] [Thread-1 (]: On model.my_dbt_project.dim_produt: Close
[0m10:41:54.261206 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '246ec6aa-cdfe-405f-8db1-6a2d0349a631', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8854e3b30>]}
[0m10:41:54.265014 [info ] [Thread-1 (]: 5 of 7 OK created sql view model main.dim_produt ............................... [[32mOK[0m in 0.49s]
[0m10:41:54.269092 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_produt
[0m10:41:54.271277 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_sales_team
[0m10:41:54.278552 [info ] [Thread-1 (]: 6 of 7 START sql view model main.dim_sales_team ................................ [RUN]
[0m10:41:54.281249 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_produt, now model.my_dbt_project.dim_sales_team)
[0m10:41:54.283490 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_sales_team
[0m10:41:54.299493 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_sales_team"
[0m10:41:54.434195 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_sales_team
[0m10:41:54.470705 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_sales_team"
[0m10:41:54.547819 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_sales_team"
[0m10:41:54.554075 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_team: BEGIN
[0m10:41:54.557887 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:41:54.605621 [debug] [Thread-1 (]: SQL status: OK in 0.048 seconds
[0m10:41:54.610442 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_sales_team"
[0m10:41:54.626591 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_team: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sales_team"} */

  
  create view "sales_database"."main"."dim_sales_team__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
    DISTINCT
    sales_team->>'name' AS sales_team_id,
    sales_team->>'region' AS sales_team_region
FROM sales
WHERE sales_team IS NOT NULL
  );

[0m10:41:54.636872 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m10:41:54.661579 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_sales_team"
[0m10:41:54.666705 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_team: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sales_team"} */
alter view "sales_database"."main"."dim_sales_team" rename to "dim_sales_team__dbt_backup"
[0m10:41:54.675153 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:41:54.703099 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_sales_team"
[0m10:41:54.707879 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_team: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sales_team"} */
alter view "sales_database"."main"."dim_sales_team__dbt_tmp" rename to "dim_sales_team"
[0m10:41:54.712024 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:41:54.726422 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_team: COMMIT
[0m10:41:54.728450 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_sales_team"
[0m10:41:54.730436 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_team: COMMIT
[0m10:41:54.757048 [debug] [Thread-1 (]: SQL status: OK in 0.023 seconds
[0m10:41:54.766337 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_sales_team"
[0m10:41:54.768206 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_team: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sales_team"} */
drop view if exists "sales_database"."main"."dim_sales_team__dbt_backup" cascade
[0m10:41:54.788481 [debug] [Thread-1 (]: SQL status: OK in 0.018 seconds
[0m10:41:54.793203 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_team: Close
[0m10:41:54.889490 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '246ec6aa-cdfe-405f-8db1-6a2d0349a631', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc885422d80>]}
[0m10:41:54.898433 [info ] [Thread-1 (]: 6 of 7 OK created sql view model main.dim_sales_team ........................... [[32mOK[0m in 0.61s]
[0m10:41:54.902191 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_sales_team
[0m10:41:54.921135 [debug] [Thread-1 (]: Began running node model.my_dbt_project.fact_sales
[0m10:41:54.935462 [info ] [Thread-1 (]: 7 of 7 START sql table model main.fact_sales ................................... [RUN]
[0m10:41:54.938411 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_sales_team, now model.my_dbt_project.fact_sales)
[0m10:41:54.941534 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.fact_sales
[0m10:41:54.957832 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.fact_sales"
[0m10:41:54.993016 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.fact_sales
[0m10:41:55.092691 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.fact_sales"
[0m10:41:55.121250 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.fact_sales"
[0m10:41:55.122752 [debug] [Thread-1 (]: On model.my_dbt_project.fact_sales: BEGIN
[0m10:41:55.124200 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:41:55.155937 [debug] [Thread-1 (]: SQL status: OK in 0.032 seconds
[0m10:41:55.158163 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.fact_sales"
[0m10:41:55.162009 [debug] [Thread-1 (]: On model.my_dbt_project.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.fact_sales"} */

  
    
    

    create  table
      "sales_database"."main"."fact_sales__dbt_tmp"
  
    as (
      WITH sales_data AS (
    SELECT
        name AS sales_order_id,
        transaction_date,
        customer,
        company,
        total AS sales_amount,
        net_total,
        discount_amount,
        base_total_taxes_and_charges AS tax_amount,
        grand_total,
        currency,
        conversion_rate,
        items, -- JSON field with product details
        taxes -- JSON field with tax details
    FROM "sales_database"."main"."sales"
)

SELECT * FROM sales_data
    );
  
  
[0m10:41:55.199635 [debug] [Thread-1 (]: SQL status: OK in 0.035 seconds
[0m10:41:55.226809 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.fact_sales"
[0m10:41:55.228719 [debug] [Thread-1 (]: On model.my_dbt_project.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.fact_sales"} */
alter table "sales_database"."main"."fact_sales" rename to "fact_sales__dbt_backup"
[0m10:41:55.235485 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m10:41:55.256119 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.fact_sales"
[0m10:41:55.258890 [debug] [Thread-1 (]: On model.my_dbt_project.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.fact_sales"} */
alter table "sales_database"."main"."fact_sales__dbt_tmp" rename to "fact_sales"
[0m10:41:55.262054 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:41:55.275071 [debug] [Thread-1 (]: On model.my_dbt_project.fact_sales: COMMIT
[0m10:41:55.276570 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.fact_sales"
[0m10:41:55.277884 [debug] [Thread-1 (]: On model.my_dbt_project.fact_sales: COMMIT
[0m10:41:55.303816 [debug] [Thread-1 (]: SQL status: OK in 0.024 seconds
[0m10:41:55.309713 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.fact_sales"
[0m10:41:55.310977 [debug] [Thread-1 (]: On model.my_dbt_project.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.fact_sales"} */
drop table if exists "sales_database"."main"."fact_sales__dbt_backup" cascade
[0m10:41:55.332962 [debug] [Thread-1 (]: SQL status: OK in 0.020 seconds
[0m10:41:55.339531 [debug] [Thread-1 (]: On model.my_dbt_project.fact_sales: Close
[0m10:41:55.433382 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '246ec6aa-cdfe-405f-8db1-6a2d0349a631', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc88547bbc0>]}
[0m10:41:55.435632 [info ] [Thread-1 (]: 7 of 7 OK created sql table model main.fact_sales .............................. [[32mOK[0m in 0.49s]
[0m10:41:55.437883 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.fact_sales
[0m10:41:55.441747 [debug] [MainThread]: Using duckdb connection "master"
[0m10:41:55.443383 [debug] [MainThread]: On master: BEGIN
[0m10:41:55.444904 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:41:55.475835 [debug] [MainThread]: SQL status: OK in 0.031 seconds
[0m10:41:55.477468 [debug] [MainThread]: On master: COMMIT
[0m10:41:55.478848 [debug] [MainThread]: Using duckdb connection "master"
[0m10:41:55.480508 [debug] [MainThread]: On master: COMMIT
[0m10:41:55.482609 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m10:41:55.484373 [debug] [MainThread]: On master: Close
[0m10:41:55.491869 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:41:55.493872 [debug] [MainThread]: Connection 'create_sales_database_main' was properly closed.
[0m10:41:55.495234 [debug] [MainThread]: Connection 'list_sales_database_main' was properly closed.
[0m10:41:55.497357 [debug] [MainThread]: Connection 'model.my_dbt_project.fact_sales' was properly closed.
[0m10:41:55.499410 [info ] [MainThread]: 
[0m10:41:55.501435 [info ] [MainThread]: Finished running 1 table model, 6 view models in 0 hours 0 minutes and 4.61 seconds (4.61s).
[0m10:41:55.505192 [debug] [MainThread]: Command end result
[0m10:41:55.598205 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m10:41:55.609067 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m10:41:55.632599 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dags/dbt_models/target/run_results.json
[0m10:41:55.633901 [info ] [MainThread]: 
[0m10:41:55.635432 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:41:55.636603 [info ] [MainThread]: 
[0m10:41:55.637841 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m10:41:55.641427 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.575998, "process_in_blocks": "156024", "process_kernel_time": 2.664404, "process_mem_max_rss": "133556", "process_out_blocks": "0", "process_user_time": 11.016865}
[0m10:41:55.642878 [debug] [MainThread]: Command `dbt run` succeeded at 10:41:55.642667 after 10.58 seconds
[0m10:41:55.644122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc88ca6cda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc88bfd3740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc88be65160>]}
[0m10:41:55.645511 [debug] [MainThread]: Flushing usage events
[0m10:41:57.240619 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:07:37.818609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8efdb935c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8efe286720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8efdc5b0b0>]}


============================== 07:07:37.911017 | 3fcd8eab-a5ae-4eb5-8135-b1649ac9f07a ==============================
[0m07:07:37.911017 [info ] [MainThread]: Running with dbt=1.9.2
[0m07:07:37.932231 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dags/dbt_models/logs', 'profiles_dir': '/opt/airflow/dbt/profiles.yml', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt/profiles.yml --target dev', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:07:42.729265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3fcd8eab-a5ae-4eb5-8135-b1649ac9f07a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ef9eeb650>]}
[0m07:07:43.295175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3fcd8eab-a5ae-4eb5-8135-b1649ac9f07a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8efd563d10>]}
[0m07:07:43.350701 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m07:07:45.209957 [debug] [MainThread]: checksum: eea1a9e9f56a74d304aa4a9e5e9c8fc1dea4ccd2b0ec98e366756009c99c5c94, vars: {}, profile: , target: dev, version: 1.9.2
[0m07:07:46.906979 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:07:46.910499 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:07:47.086579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3fcd8eab-a5ae-4eb5-8135-b1649ac9f07a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ef9f38350>]}
[0m07:07:47.615334 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m07:07:47.656286 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m07:07:47.975022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3fcd8eab-a5ae-4eb5-8135-b1649ac9f07a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ef79c3da0>]}
[0m07:07:47.984718 [info ] [MainThread]: Found 7 models, 1 source, 424 macros
[0m07:07:47.990623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3fcd8eab-a5ae-4eb5-8135-b1649ac9f07a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ef77140e0>]}
[0m07:07:48.000169 [info ] [MainThread]: 
[0m07:07:48.010665 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:07:48.020750 [info ] [MainThread]: 
[0m07:07:48.029804 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m07:07:48.112338 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_sales_database'
[0m07:07:48.640674 [debug] [ThreadPool]: Using duckdb connection "list_sales_database"
[0m07:07:48.656216 [debug] [ThreadPool]: On list_sales_database: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "list_sales_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"sales_database"'
    
  
  
[0m07:07:48.658267 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:08:33.537344 [debug] [ThreadPool]: SQL status: OK in 44.862 seconds
[0m07:08:33.636690 [debug] [ThreadPool]: On list_sales_database: Close
[0m07:08:33.825780 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_database, now create_sales_database_main)
[0m07:08:33.840341 [debug] [ThreadPool]: Creating schema "database: "sales_database"
schema: "main"
"
[0m07:08:34.121698 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m07:08:34.141444 [debug] [ThreadPool]: On create_sales_database_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "create_sales_database_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='sales_database'
        and type='sqlite'
    
  
[0m07:08:34.145052 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:08:38.507046 [debug] [ThreadPool]: SQL status: OK in 4.354 seconds
[0m07:08:38.595841 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m07:08:38.612315 [debug] [ThreadPool]: On create_sales_database_main: BEGIN
[0m07:08:38.803839 [debug] [ThreadPool]: SQL status: OK in 0.177 seconds
[0m07:08:38.815540 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m07:08:38.824513 [debug] [ThreadPool]: On create_sales_database_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "create_sales_database_main"} */

    
    
        create schema if not exists "sales_database"."main"
    
[0m07:08:39.001114 [debug] [ThreadPool]: SQL status: OK in 0.150 seconds
[0m07:08:39.021896 [debug] [ThreadPool]: On create_sales_database_main: COMMIT
[0m07:08:39.026350 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m07:08:39.030368 [debug] [ThreadPool]: On create_sales_database_main: COMMIT
[0m07:08:39.228334 [debug] [ThreadPool]: SQL status: OK in 0.174 seconds
[0m07:08:39.241395 [debug] [ThreadPool]: On create_sales_database_main: Close
[0m07:08:39.357994 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_sales_database_main, now list_sales_database_main)
[0m07:08:39.431784 [debug] [ThreadPool]: Using duckdb connection "list_sales_database_main"
[0m07:08:39.503842 [debug] [ThreadPool]: On list_sales_database_main: BEGIN
[0m07:08:39.517384 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:09:14.460583 [debug] [ThreadPool]: SQL status: OK in 34.938 seconds
[0m07:09:14.463300 [debug] [ThreadPool]: Using duckdb connection "list_sales_database_main"
[0m07:09:14.467825 [debug] [ThreadPool]: On list_sales_database_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "list_sales_database_main"} */
select
      'sales_database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'sales_database'
  
[0m07:09:15.106973 [debug] [ThreadPool]: SQL status: OK in 0.642 seconds
[0m07:09:15.115354 [debug] [ThreadPool]: On list_sales_database_main: ROLLBACK
[0m07:09:15.127622 [debug] [ThreadPool]: Failed to rollback 'list_sales_database_main'
[0m07:09:15.129568 [debug] [ThreadPool]: On list_sales_database_main: Close
[0m07:09:15.152981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3fcd8eab-a5ae-4eb5-8135-b1649ac9f07a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8eff35f0b0>]}
[0m07:09:15.158906 [debug] [MainThread]: Using duckdb connection "master"
[0m07:09:15.164139 [debug] [MainThread]: On master: BEGIN
[0m07:09:15.172815 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:09:15.390625 [debug] [MainThread]: SQL status: OK in 0.209 seconds
[0m07:09:15.392831 [debug] [MainThread]: On master: COMMIT
[0m07:09:15.400442 [debug] [MainThread]: Using duckdb connection "master"
[0m07:09:15.413453 [debug] [MainThread]: On master: COMMIT
[0m07:09:15.417741 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m07:09:15.435675 [debug] [MainThread]: On master: Close
[0m07:09:15.502967 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_company
[0m07:09:15.517638 [info ] [Thread-1 (]: 1 of 7 START sql view model main.dim_company ................................... [RUN]
[0m07:09:15.537008 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.my_dbt_project.dim_company'
[0m07:09:15.539846 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_company
[0m07:09:15.607276 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_company"
[0m07:09:15.704118 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_company
[0m07:09:16.069858 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_company"
[0m07:09:16.107377 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_company"
[0m07:09:16.110308 [debug] [Thread-1 (]: On model.my_dbt_project.dim_company: BEGIN
[0m07:09:16.131431 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m07:09:16.393928 [debug] [Thread-1 (]: SQL status: OK in 0.263 seconds
[0m07:09:16.405996 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_company"
[0m07:09:16.414222 [debug] [Thread-1 (]: On model.my_dbt_project.dim_company: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.dim_company"} */

  
  create view "sales_database"."main"."dim_company__dbt_tmp" as (
    WITH companies AS (
    SELECT DISTINCT
        company AS company_id,
        company
    FROM "sales_database"."main"."sales"
)

SELECT * FROM companies
  );

[0m07:09:16.434776 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m07:09:16.584830 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_company"
[0m07:09:16.594826 [debug] [Thread-1 (]: On model.my_dbt_project.dim_company: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.dim_company"} */
alter view "sales_database"."main"."dim_company__dbt_tmp" rename to "dim_company"
[0m07:09:16.616545 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m07:09:16.742101 [debug] [Thread-1 (]: On model.my_dbt_project.dim_company: COMMIT
[0m07:09:16.744239 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_company"
[0m07:09:16.746519 [debug] [Thread-1 (]: On model.my_dbt_project.dim_company: COMMIT
[0m07:09:16.793283 [debug] [Thread-1 (]: SQL status: OK in 0.044 seconds
[0m07:09:16.836124 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_company"
[0m07:09:16.838046 [debug] [Thread-1 (]: On model.my_dbt_project.dim_company: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.dim_company"} */
drop view if exists "sales_database"."main"."dim_company__dbt_backup" cascade
[0m07:09:16.852024 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:09:16.883078 [debug] [Thread-1 (]: On model.my_dbt_project.dim_company: Close
[0m07:09:17.116487 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3fcd8eab-a5ae-4eb5-8135-b1649ac9f07a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ef9e8e720>]}
[0m07:09:17.119714 [info ] [Thread-1 (]: 1 of 7 OK created sql view model main.dim_company .............................. [[32mOK[0m in 1.54s]
[0m07:09:17.133488 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_company
[0m07:09:17.135736 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_currency
[0m07:09:17.138603 [info ] [Thread-1 (]: 2 of 7 START sql view model main.dim_currency .................................. [RUN]
[0m07:09:17.140995 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_company, now model.my_dbt_project.dim_currency)
[0m07:09:17.143254 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_currency
[0m07:09:17.158835 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_currency"
[0m07:09:17.196606 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_currency
[0m07:09:17.227337 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_currency"
[0m07:09:17.270786 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_currency"
[0m07:09:17.272918 [debug] [Thread-1 (]: On model.my_dbt_project.dim_currency: BEGIN
[0m07:09:17.275312 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:09:17.351642 [debug] [Thread-1 (]: SQL status: OK in 0.076 seconds
[0m07:09:17.354807 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_currency"
[0m07:09:17.357111 [debug] [Thread-1 (]: On model.my_dbt_project.dim_currency: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.dim_currency"} */

  
  create view "sales_database"."main"."dim_currency__dbt_tmp" as (
    WITH currency_data AS (
    SELECT DISTINCT
        currency AS currency_id,
        currency,
        conversion_rate
    FROM "sales_database"."main"."sales"
)

SELECT * FROM currency_data
  );

[0m07:09:17.360252 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:09:17.380818 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_currency"
[0m07:09:17.382754 [debug] [Thread-1 (]: On model.my_dbt_project.dim_currency: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.dim_currency"} */
alter view "sales_database"."main"."dim_currency__dbt_tmp" rename to "dim_currency"
[0m07:09:17.392074 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m07:09:17.401221 [debug] [Thread-1 (]: On model.my_dbt_project.dim_currency: COMMIT
[0m07:09:17.403621 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_currency"
[0m07:09:17.423481 [debug] [Thread-1 (]: On model.my_dbt_project.dim_currency: COMMIT
[0m07:09:17.500162 [debug] [Thread-1 (]: SQL status: OK in 0.061 seconds
[0m07:09:17.541503 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_currency"
[0m07:09:17.554947 [debug] [Thread-1 (]: On model.my_dbt_project.dim_currency: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.dim_currency"} */
drop view if exists "sales_database"."main"."dim_currency__dbt_backup" cascade
[0m07:09:17.628995 [debug] [Thread-1 (]: SQL status: OK in 0.047 seconds
[0m07:09:17.648549 [debug] [Thread-1 (]: On model.my_dbt_project.dim_currency: Close
[0m07:09:17.784708 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3fcd8eab-a5ae-4eb5-8135-b1649ac9f07a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ef6bb0860>]}
[0m07:09:17.788002 [info ] [Thread-1 (]: 2 of 7 OK created sql view model main.dim_currency ............................. [[32mOK[0m in 0.64s]
[0m07:09:17.792130 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_currency
[0m07:09:17.795506 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_customer
[0m07:09:17.806449 [info ] [Thread-1 (]: 3 of 7 START sql view model main.dim_customer .................................. [RUN]
[0m07:09:17.810089 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_currency, now model.my_dbt_project.dim_customer)
[0m07:09:17.812256 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_customer
[0m07:09:17.834208 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_customer"
[0m07:09:18.097488 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_customer
[0m07:09:18.137031 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_customer"
[0m07:09:18.222846 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_customer"
[0m07:09:18.224569 [debug] [Thread-1 (]: On model.my_dbt_project.dim_customer: BEGIN
[0m07:09:18.226255 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:09:18.455064 [debug] [Thread-1 (]: SQL status: OK in 0.229 seconds
[0m07:09:18.463923 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_customer"
[0m07:09:18.515420 [debug] [Thread-1 (]: On model.my_dbt_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.dim_customer"} */

  
  create view "sales_database"."main"."dim_customer__dbt_tmp" as (
    -- WITH sales AS (
--     SELECT * FROM "sales_database"."main"."sales"
-- )

-- SELECT
--     DISTINCT
--     customer AS customer_id,
--     customer_name,
--     customer_address,
--     customer_group,
--     territory,
--     language AS customer_language
-- FROM sales
-- WHERE customer IS NOT NULL




WITH customers AS (
    SELECT DISTINCT
        customer AS customer_id,
        customer_name,
        customer_group,
        territory
    FROM "sales_database"."main"."sales"
)

SELECT * FROM customers
  );

[0m07:09:18.522692 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m07:09:18.561414 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_customer"
[0m07:09:18.578538 [debug] [Thread-1 (]: On model.my_dbt_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.dim_customer"} */
alter view "sales_database"."main"."dim_customer__dbt_tmp" rename to "dim_customer"
[0m07:09:18.613654 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m07:09:18.643348 [debug] [Thread-1 (]: On model.my_dbt_project.dim_customer: COMMIT
[0m07:09:18.659069 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_customer"
[0m07:09:18.664199 [debug] [Thread-1 (]: On model.my_dbt_project.dim_customer: COMMIT
[0m07:09:18.694578 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m07:09:18.706543 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_customer"
[0m07:09:18.747016 [debug] [Thread-1 (]: On model.my_dbt_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.dim_customer"} */
drop view if exists "sales_database"."main"."dim_customer__dbt_backup" cascade
[0m07:09:18.756186 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:09:18.783353 [debug] [Thread-1 (]: On model.my_dbt_project.dim_customer: Close
[0m07:09:18.947731 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3fcd8eab-a5ae-4eb5-8135-b1649ac9f07a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ef6cb4ce0>]}
[0m07:09:18.967875 [info ] [Thread-1 (]: 3 of 7 OK created sql view model main.dim_customer ............................. [[32mOK[0m in 1.13s]
[0m07:09:18.975933 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_customer
[0m07:09:19.013882 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_date
[0m07:09:19.040482 [info ] [Thread-1 (]: 4 of 7 START sql view model main.dim_date ...................................... [RUN]
[0m07:09:19.095479 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_customer, now model.my_dbt_project.dim_date)
[0m07:09:19.121517 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_date
[0m07:09:19.280144 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_date"
[0m07:09:19.347867 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_date
[0m07:09:19.406668 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_date"
[0m07:09:19.525400 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_date"
[0m07:09:19.540049 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: BEGIN
[0m07:09:19.565060 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:09:20.052707 [debug] [Thread-1 (]: SQL status: OK in 0.494 seconds
[0m07:09:20.072893 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_date"
[0m07:09:20.075601 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.dim_date"} */

  
  create view "sales_database"."main"."dim_date__dbt_tmp" as (
    -- WITH sales AS (
--     SELECT * FROM "sales_database"."main"."sales"
-- )
-- SELECT
--     transaction_date,
--     strftime(transaction_date, '%Y-%m-%d') AS date_id,  -- Change the format to YYYY-MM-DD
--     strftime(transaction_date, '%A') AS weekday_name,
--     strftime(transaction_date, '%m') AS month,
--     strftime(transaction_date, '%Y') AS year,
--     strftime(transaction_date, '%d') AS day,
--     EXTRACT(QUARTER FROM transaction_date) AS quarter
-- FROM sales
-- WHERE transaction_date IS NOT NULL


WITH date_data AS (
    SELECT DISTINCT
        transaction_date AS date_id,
        EXTRACT(YEAR FROM transaction_date) AS year,
        EXTRACT(MONTH FROM transaction_date) AS month,
        EXTRACT(DAY FROM transaction_date) AS day,
        EXTRACT(WEEK FROM transaction_date) AS week_of_year,
        EXTRACT(QUARTER FROM transaction_date) AS quarter
    FROM "sales_database"."main"."sales"
)

SELECT * FROM date_data
  );

[0m07:09:20.318049 [debug] [Thread-1 (]: SQL status: OK in 0.222 seconds
[0m07:09:20.446518 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_date"
[0m07:09:20.504968 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.dim_date"} */
alter view "sales_database"."main"."dim_date__dbt_tmp" rename to "dim_date"
[0m07:09:20.606666 [debug] [Thread-1 (]: SQL status: OK in 0.072 seconds
[0m07:09:20.615012 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: COMMIT
[0m07:09:20.680624 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_date"
[0m07:09:20.698108 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: COMMIT
[0m07:09:20.829069 [debug] [Thread-1 (]: SQL status: OK in 0.123 seconds
[0m07:09:20.883159 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_date"
[0m07:09:20.897239 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.dim_date"} */
drop view if exists "sales_database"."main"."dim_date__dbt_backup" cascade
[0m07:09:20.939555 [debug] [Thread-1 (]: SQL status: OK in 0.031 seconds
[0m07:09:20.965820 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: Close
[0m07:09:21.224902 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3fcd8eab-a5ae-4eb5-8135-b1649ac9f07a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ed7704fb0>]}
[0m07:09:21.256755 [info ] [Thread-1 (]: 4 of 7 OK created sql view model main.dim_date ................................. [[32mOK[0m in 2.13s]
[0m07:09:21.274805 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_date
[0m07:09:21.303385 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_produt
[0m07:09:21.329979 [info ] [Thread-1 (]: 5 of 7 START sql view model main.dim_produt .................................... [RUN]
[0m07:09:21.346528 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_date, now model.my_dbt_project.dim_produt)
[0m07:09:21.364797 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_produt
[0m07:09:21.435343 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_produt"
[0m07:09:21.722853 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_produt
[0m07:09:21.760579 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_produt"
[0m07:09:21.805681 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_produt"
[0m07:09:21.807919 [debug] [Thread-1 (]: On model.my_dbt_project.dim_produt: BEGIN
[0m07:09:21.810062 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:09:22.119874 [debug] [Thread-1 (]: SQL status: OK in 0.310 seconds
[0m07:09:22.128120 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_produt"
[0m07:09:22.139118 [debug] [Thread-1 (]: On model.my_dbt_project.dim_produt: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.dim_produt"} */

  
  create view "sales_database"."main"."dim_produt__dbt_tmp" as (
    -- WITH sales AS (
--     SELECT * 
--     FROM "sales_database"."main"."sales"
-- )

-- SELECT 
--     sales.name,
--     json_extract(items, '$[0].name') AS product_name,  -- Example to extract the first element's "name" field from JSON array
--     json_extract(items, '$[0].item_code') AS product_item_code
-- FROM sales
-- WHERE json_extract(items, '$[0].name') IS NOT NULL  -- Filter to only keep rows with a non-null product name



WITH exploded_items AS (
    SELECT
        name AS sales_order_id,
        JSON_EXTRACT(items, '$[*].item_code') AS product_code,
        JSON_EXTRACT(items, '$[*].item_name') AS product_name,
        JSON_EXTRACT(items, '$[*].qty') AS quantity_sold,
        JSON_EXTRACT(items, '$[*].rate') AS unit_price
    FROM "sales_database"."main"."sales"
)

SELECT 
    sales_order_id,
    UNNEST(product_code) AS product_id,
    UNNEST(product_name) AS product_name,
    UNNEST(quantity_sold) AS quantity_sold,
    UNNEST(unit_price) AS unit_price
FROM exploded_items
  );

[0m07:09:22.154730 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m07:09:22.188082 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_produt"
[0m07:09:22.200843 [debug] [Thread-1 (]: On model.my_dbt_project.dim_produt: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.dim_produt"} */
alter view "sales_database"."main"."dim_produt__dbt_tmp" rename to "dim_produt"
[0m07:09:22.214251 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:09:22.227152 [debug] [Thread-1 (]: On model.my_dbt_project.dim_produt: COMMIT
[0m07:09:22.230423 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_produt"
[0m07:09:22.238026 [debug] [Thread-1 (]: On model.my_dbt_project.dim_produt: COMMIT
[0m07:09:22.294268 [debug] [Thread-1 (]: SQL status: OK in 0.026 seconds
[0m07:09:22.303916 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_produt"
[0m07:09:22.306874 [debug] [Thread-1 (]: On model.my_dbt_project.dim_produt: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.dim_produt"} */
drop view if exists "sales_database"."main"."dim_produt__dbt_backup" cascade
[0m07:09:22.318584 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m07:09:22.328830 [debug] [Thread-1 (]: On model.my_dbt_project.dim_produt: Close
[0m07:09:22.437029 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3fcd8eab-a5ae-4eb5-8135-b1649ac9f07a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ef6bc73b0>]}
[0m07:09:22.448171 [info ] [Thread-1 (]: 5 of 7 OK created sql view model main.dim_produt ............................... [[32mOK[0m in 1.08s]
[0m07:09:22.465141 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_produt
[0m07:09:22.467907 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_sales_team
[0m07:09:22.470253 [info ] [Thread-1 (]: 6 of 7 START sql view model main.dim_sales_team ................................ [RUN]
[0m07:09:22.485265 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_produt, now model.my_dbt_project.dim_sales_team)
[0m07:09:22.497465 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_sales_team
[0m07:09:22.515273 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_sales_team"
[0m07:09:22.549852 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_sales_team
[0m07:09:22.590506 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_sales_team"
[0m07:09:22.641866 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_sales_team"
[0m07:09:22.644211 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_team: BEGIN
[0m07:09:22.646895 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:09:22.790127 [debug] [Thread-1 (]: SQL status: OK in 0.143 seconds
[0m07:09:22.810700 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_sales_team"
[0m07:09:22.826775 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_team: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sales_team"} */

  
  create view "sales_database"."main"."dim_sales_team__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
    DISTINCT
    sales_team->>'name' AS sales_team_id,
    sales_team->>'region' AS sales_team_region
FROM sales
WHERE sales_team IS NOT NULL
  );

[0m07:09:22.854596 [debug] [Thread-1 (]: SQL status: OK in 0.018 seconds
[0m07:09:22.893496 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_sales_team"
[0m07:09:22.900225 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_team: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sales_team"} */
alter view "sales_database"."main"."dim_sales_team__dbt_tmp" rename to "dim_sales_team"
[0m07:09:22.917057 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:09:22.935762 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_team: COMMIT
[0m07:09:22.968224 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_sales_team"
[0m07:09:22.989693 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_team: COMMIT
[0m07:09:23.072333 [debug] [Thread-1 (]: SQL status: OK in 0.072 seconds
[0m07:09:23.124115 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_sales_team"
[0m07:09:23.138909 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_team: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sales_team"} */
drop view if exists "sales_database"."main"."dim_sales_team__dbt_backup" cascade
[0m07:09:23.144171 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:09:23.163201 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_team: Close
[0m07:09:23.255568 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3fcd8eab-a5ae-4eb5-8135-b1649ac9f07a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ef6ca7110>]}
[0m07:09:23.266345 [info ] [Thread-1 (]: 6 of 7 OK created sql view model main.dim_sales_team ........................... [[32mOK[0m in 0.77s]
[0m07:09:23.283113 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_sales_team
[0m07:09:23.285615 [debug] [Thread-1 (]: Began running node model.my_dbt_project.fact_sales
[0m07:09:23.298949 [info ] [Thread-1 (]: 7 of 7 START sql table model main.fact_sales ................................... [RUN]
[0m07:09:23.304244 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_sales_team, now model.my_dbt_project.fact_sales)
[0m07:09:23.306948 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.fact_sales
[0m07:09:23.343715 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.fact_sales"
[0m07:09:23.477399 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.fact_sales
[0m07:09:23.637231 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.fact_sales"
[0m07:09:23.668496 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.fact_sales"
[0m07:09:23.670595 [debug] [Thread-1 (]: On model.my_dbt_project.fact_sales: BEGIN
[0m07:09:23.672609 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:09:23.772872 [debug] [Thread-1 (]: SQL status: OK in 0.100 seconds
[0m07:09:23.781719 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.fact_sales"
[0m07:09:23.788814 [debug] [Thread-1 (]: On model.my_dbt_project.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.fact_sales"} */

  
    
    

    create  table
      "sales_database"."main"."fact_sales__dbt_tmp"
  
    as (
      WITH sales_data AS (
    SELECT
        name AS sales_order_id,
        transaction_date,
        customer,
        company,
        total AS sales_amount,
        net_total,
        discount_amount,
        base_total_taxes_and_charges AS tax_amount,
        grand_total,
        currency,
        conversion_rate,
        items, -- JSON field with product details
        taxes -- JSON field with tax details
    FROM "sales_database"."main"."sales"
)

SELECT * FROM sales_data
    );
  
  
[0m07:09:23.848712 [debug] [Thread-1 (]: SQL status: OK in 0.057 seconds
[0m07:09:23.879658 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.fact_sales"
[0m07:09:23.885334 [debug] [Thread-1 (]: On model.my_dbt_project.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.fact_sales"} */
alter table "sales_database"."main"."fact_sales__dbt_tmp" rename to "fact_sales"
[0m07:09:23.888607 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:09:23.923120 [debug] [Thread-1 (]: On model.my_dbt_project.fact_sales: COMMIT
[0m07:09:23.925268 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.fact_sales"
[0m07:09:23.927594 [debug] [Thread-1 (]: On model.my_dbt_project.fact_sales: COMMIT
[0m07:09:23.964979 [debug] [Thread-1 (]: SQL status: OK in 0.035 seconds
[0m07:09:23.987631 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.fact_sales"
[0m07:09:24.010063 [debug] [Thread-1 (]: On model.my_dbt_project.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.fact_sales"} */
drop table if exists "sales_database"."main"."fact_sales__dbt_backup" cascade
[0m07:09:24.014075 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:09:24.031635 [debug] [Thread-1 (]: On model.my_dbt_project.fact_sales: Close
[0m07:09:24.131570 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3fcd8eab-a5ae-4eb5-8135-b1649ac9f07a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ef6bd9ee0>]}
[0m07:09:24.136062 [info ] [Thread-1 (]: 7 of 7 OK created sql table model main.fact_sales .............................. [[32mOK[0m in 0.82s]
[0m07:09:24.139389 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.fact_sales
[0m07:09:24.143766 [debug] [MainThread]: Using duckdb connection "master"
[0m07:09:24.146262 [debug] [MainThread]: On master: BEGIN
[0m07:09:24.151866 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:09:24.256802 [debug] [MainThread]: SQL status: OK in 0.106 seconds
[0m07:09:24.258825 [debug] [MainThread]: On master: COMMIT
[0m07:09:24.261689 [debug] [MainThread]: Using duckdb connection "master"
[0m07:09:24.263984 [debug] [MainThread]: On master: COMMIT
[0m07:09:24.266340 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m07:09:24.276207 [debug] [MainThread]: On master: Close
[0m07:09:24.285643 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:09:24.295481 [debug] [MainThread]: Connection 'list_sales_database_main' was properly closed.
[0m07:09:24.297638 [debug] [MainThread]: Connection 'model.my_dbt_project.fact_sales' was properly closed.
[0m07:09:24.300233 [info ] [MainThread]: 
[0m07:09:24.302323 [info ] [MainThread]: Finished running 1 table model, 6 view models in 0 hours 1 minutes and 36.27 seconds (96.27s).
[0m07:09:24.318028 [debug] [MainThread]: Command end result
[0m07:09:24.613386 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m07:09:24.629917 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m07:09:24.667836 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dags/dbt_models/target/run_results.json
[0m07:09:24.670617 [info ] [MainThread]: 
[0m07:09:24.672389 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:09:24.674278 [info ] [MainThread]: 
[0m07:09:24.678449 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m07:09:24.685015 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 135.43434, "process_in_blocks": "8312640", "process_kernel_time": 15.833759, "process_mem_max_rss": "124776", "process_out_blocks": "1968", "process_user_time": 16.76689}
[0m07:09:24.691021 [debug] [MainThread]: Command `dbt run` succeeded at 07:09:24.689638 after 135.44 seconds
[0m07:09:24.693309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8efdd618b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ef9f38620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ef9f3bbc0>]}
[0m07:09:24.696179 [debug] [MainThread]: Flushing usage events
[0m07:09:26.672300 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:13:18.060918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc82e691e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc82d6dee10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc82e4bf680>]}


============================== 07:13:18.086923 | 841a554e-5b61-4a15-949e-e082caff141c ==============================
[0m07:13:18.086923 [info ] [MainThread]: Running with dbt=1.9.2
[0m07:13:18.089097 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt/profiles.yml', 'log_path': '/opt/airflow/dags/dbt_models/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt/profiles.yml --target dev', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m07:13:19.076643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '841a554e-5b61-4a15-949e-e082caff141c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc82cc2e900>]}
[0m07:13:19.454077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '841a554e-5b61-4a15-949e-e082caff141c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc82f2eeb40>]}
[0m07:13:19.471070 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m07:13:19.855493 [debug] [MainThread]: checksum: eea1a9e9f56a74d304aa4a9e5e9c8fc1dea4ccd2b0ec98e366756009c99c5c94, vars: {}, profile: , target: dev, version: 1.9.2
[0m07:13:22.115558 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:13:22.117182 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:13:22.308327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '841a554e-5b61-4a15-949e-e082caff141c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc827123cb0>]}
[0m07:13:23.060250 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m07:13:23.230676 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m07:13:24.147641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '841a554e-5b61-4a15-949e-e082caff141c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc826b1c110>]}
[0m07:13:24.149961 [info ] [MainThread]: Found 7 models, 1 source, 424 macros
[0m07:13:24.165021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '841a554e-5b61-4a15-949e-e082caff141c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc826b1c230>]}
[0m07:13:24.171047 [info ] [MainThread]: 
[0m07:13:24.204618 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:13:24.254268 [info ] [MainThread]: 
[0m07:13:24.273663 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m07:13:24.416115 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_sales_database'
[0m07:13:24.863605 [debug] [ThreadPool]: Using duckdb connection "list_sales_database"
[0m07:13:24.865312 [debug] [ThreadPool]: On list_sales_database: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "list_sales_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"sales_database"'
    
  
  
[0m07:13:24.866982 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:13:25.106737 [debug] [ThreadPool]: SQL status: OK in 0.240 seconds
[0m07:13:25.120242 [debug] [ThreadPool]: On list_sales_database: Close
[0m07:13:25.143229 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_database, now create_sales_database_main)
[0m07:13:25.151513 [debug] [ThreadPool]: Creating schema "database: "sales_database"
schema: "main"
"
[0m07:13:25.227418 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m07:13:25.243283 [debug] [ThreadPool]: On create_sales_database_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "create_sales_database_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='sales_database'
        and type='sqlite'
    
  
[0m07:13:25.249975 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:13:25.350127 [debug] [ThreadPool]: SQL status: OK in 0.100 seconds
[0m07:13:25.358578 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m07:13:25.361370 [debug] [ThreadPool]: On create_sales_database_main: BEGIN
[0m07:13:25.366123 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m07:13:25.370521 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m07:13:25.380943 [debug] [ThreadPool]: On create_sales_database_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "create_sales_database_main"} */

    
    
        create schema if not exists "sales_database"."main"
    
[0m07:13:25.386266 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m07:13:25.389501 [debug] [ThreadPool]: On create_sales_database_main: COMMIT
[0m07:13:25.391471 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m07:13:25.395690 [debug] [ThreadPool]: On create_sales_database_main: COMMIT
[0m07:13:25.398035 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m07:13:25.401772 [debug] [ThreadPool]: On create_sales_database_main: Close
[0m07:13:25.413010 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_sales_database_main'
[0m07:13:25.477240 [debug] [ThreadPool]: Using duckdb connection "list_sales_database_main"
[0m07:13:25.482044 [debug] [ThreadPool]: On list_sales_database_main: BEGIN
[0m07:13:25.487736 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:13:25.780214 [debug] [ThreadPool]: SQL status: OK in 0.293 seconds
[0m07:13:25.781915 [debug] [ThreadPool]: Using duckdb connection "list_sales_database_main"
[0m07:13:25.784852 [debug] [ThreadPool]: On list_sales_database_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "list_sales_database_main"} */
select
      'sales_database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'sales_database'
  
[0m07:13:26.049673 [debug] [ThreadPool]: SQL status: OK in 0.230 seconds
[0m07:13:26.064123 [debug] [ThreadPool]: On list_sales_database_main: ROLLBACK
[0m07:13:26.083896 [debug] [ThreadPool]: Failed to rollback 'list_sales_database_main'
[0m07:13:26.087761 [debug] [ThreadPool]: On list_sales_database_main: Close
[0m07:13:26.101320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '841a554e-5b61-4a15-949e-e082caff141c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc82cc2c6b0>]}
[0m07:13:26.103835 [debug] [MainThread]: Using duckdb connection "master"
[0m07:13:26.106130 [debug] [MainThread]: On master: BEGIN
[0m07:13:26.107759 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:13:26.200325 [debug] [MainThread]: SQL status: OK in 0.093 seconds
[0m07:13:26.203666 [debug] [MainThread]: On master: COMMIT
[0m07:13:26.205418 [debug] [MainThread]: Using duckdb connection "master"
[0m07:13:26.213790 [debug] [MainThread]: On master: COMMIT
[0m07:13:26.224565 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m07:13:26.235038 [debug] [MainThread]: On master: Close
[0m07:13:26.308100 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_company
[0m07:13:26.310514 [info ] [Thread-1 (]: 1 of 7 START sql view model main.dim_company ................................... [RUN]
[0m07:13:26.316660 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.my_dbt_project.dim_company'
[0m07:13:26.318553 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_company
[0m07:13:26.375725 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_company"
[0m07:13:26.469092 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_company
[0m07:13:26.708418 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_company"
[0m07:13:26.751988 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_company"
[0m07:13:26.781623 [debug] [Thread-1 (]: On model.my_dbt_project.dim_company: BEGIN
[0m07:13:26.798486 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m07:13:26.974674 [debug] [Thread-1 (]: SQL status: OK in 0.176 seconds
[0m07:13:27.003410 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_company"
[0m07:13:27.014661 [debug] [Thread-1 (]: On model.my_dbt_project.dim_company: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.dim_company"} */

  
  create view "sales_database"."main"."dim_company__dbt_tmp" as (
    WITH companies AS (
    SELECT DISTINCT
        company AS company_id,
        company
    FROM "sales_database"."main"."sales"
)

SELECT * FROM companies
  );

[0m07:13:27.313226 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.dim_company"} */

  
  create view "sales_database"."main"."dim_company__dbt_tmp" as (
    WITH companies AS (
    SELECT DISTINCT
        company AS company_id,
        company
    FROM "sales_database"."main"."sales"
)

SELECT * FROM companies
  );

[0m07:13:27.315379 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m07:13:27.318940 [debug] [Thread-1 (]: On model.my_dbt_project.dim_company: ROLLBACK
[0m07:13:27.368145 [debug] [Thread-1 (]: Failed to rollback 'model.my_dbt_project.dim_company'
[0m07:13:27.371806 [debug] [Thread-1 (]: On model.my_dbt_project.dim_company: Close
[0m07:13:27.401953 [debug] [Thread-1 (]: Runtime Error in model dim_company (models/dimensions/dim_company.sql)
  Catalog Error: Table with name sales does not exist!
  Did you mean "sqlite_master"?
  LINE 9:     FROM "sales_database"."main"."sales"
                   ^
[0m07:13:27.452980 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '841a554e-5b61-4a15-949e-e082caff141c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc826b1f5f0>]}
[0m07:13:27.456454 [error] [Thread-1 (]: 1 of 7 ERROR creating sql view model main.dim_company .......................... [[31mERROR[0m in 1.10s]
[0m07:13:27.469012 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_company
[0m07:13:27.486126 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_currency
[0m07:13:27.490910 [debug] [Thread-4 (]: Marking all children of 'model.my_dbt_project.dim_company' to be skipped because of status 'error'.  Reason: Runtime Error in model dim_company (models/dimensions/dim_company.sql)
  Catalog Error: Table with name sales does not exist!
  Did you mean "sqlite_master"?
  LINE 9:     FROM "sales_database"."main"."sales"
                   ^.
[0m07:13:27.488440 [info ] [Thread-1 (]: 2 of 7 START sql view model main.dim_currency .................................. [RUN]
[0m07:13:27.502830 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_company, now model.my_dbt_project.dim_currency)
[0m07:13:27.506650 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_currency
[0m07:13:27.523094 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_currency"
[0m07:13:27.615039 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_currency
[0m07:13:27.633938 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_currency"
[0m07:13:27.676037 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_currency"
[0m07:13:27.680977 [debug] [Thread-1 (]: On model.my_dbt_project.dim_currency: BEGIN
[0m07:13:27.685168 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:13:27.731805 [debug] [Thread-1 (]: SQL status: OK in 0.047 seconds
[0m07:13:27.735567 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_currency"
[0m07:13:27.739576 [debug] [Thread-1 (]: On model.my_dbt_project.dim_currency: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.dim_currency"} */

  
  create view "sales_database"."main"."dim_currency__dbt_tmp" as (
    WITH currency_data AS (
    SELECT DISTINCT
        currency AS currency_id,
        currency,
        conversion_rate
    FROM "sales_database"."main"."sales"
)

SELECT * FROM currency_data
  );

[0m07:13:27.914097 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.dim_currency"} */

  
  create view "sales_database"."main"."dim_currency__dbt_tmp" as (
    WITH currency_data AS (
    SELECT DISTINCT
        currency AS currency_id,
        currency,
        conversion_rate
    FROM "sales_database"."main"."sales"
)

SELECT * FROM currency_data
  );

[0m07:13:27.936629 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m07:13:27.939109 [debug] [Thread-1 (]: On model.my_dbt_project.dim_currency: ROLLBACK
[0m07:13:27.948322 [debug] [Thread-1 (]: Failed to rollback 'model.my_dbt_project.dim_currency'
[0m07:13:27.965967 [debug] [Thread-1 (]: On model.my_dbt_project.dim_currency: Close
[0m07:13:27.981057 [debug] [Thread-1 (]: Runtime Error in model dim_currency (models/dimensions/dim_currency.sql)
  Catalog Error: Table with name sales does not exist!
  Did you mean "sqlite_master"?
  LINE 10:     FROM "sales_database"."main"."sales"
                    ^
[0m07:13:27.986307 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '841a554e-5b61-4a15-949e-e082caff141c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8243ff8f0>]}
[0m07:13:28.006560 [error] [Thread-1 (]: 2 of 7 ERROR creating sql view model main.dim_currency ......................... [[31mERROR[0m in 0.48s]
[0m07:13:28.010205 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_currency
[0m07:13:28.021899 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_customer
[0m07:13:28.024278 [debug] [Thread-4 (]: Marking all children of 'model.my_dbt_project.dim_currency' to be skipped because of status 'error'.  Reason: Runtime Error in model dim_currency (models/dimensions/dim_currency.sql)
  Catalog Error: Table with name sales does not exist!
  Did you mean "sqlite_master"?
  LINE 10:     FROM "sales_database"."main"."sales"
                    ^.
[0m07:13:28.036155 [info ] [Thread-1 (]: 3 of 7 START sql view model main.dim_customer .................................. [RUN]
[0m07:13:28.039940 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_currency, now model.my_dbt_project.dim_customer)
[0m07:13:28.042456 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_customer
[0m07:13:28.053495 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_customer"
[0m07:13:28.104331 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_customer
[0m07:13:28.134563 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_customer"
[0m07:13:28.211087 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_customer"
[0m07:13:28.221886 [debug] [Thread-1 (]: On model.my_dbt_project.dim_customer: BEGIN
[0m07:13:28.227026 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:13:28.501320 [debug] [Thread-1 (]: SQL status: OK in 0.275 seconds
[0m07:13:28.515896 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_customer"
[0m07:13:28.518183 [debug] [Thread-1 (]: On model.my_dbt_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.dim_customer"} */

  
  create view "sales_database"."main"."dim_customer__dbt_tmp" as (
    -- WITH sales AS (
--     SELECT * FROM "sales_database"."main"."sales"
-- )

-- SELECT
--     DISTINCT
--     customer AS customer_id,
--     customer_name,
--     customer_address,
--     customer_group,
--     territory,
--     language AS customer_language
-- FROM sales
-- WHERE customer IS NOT NULL




WITH customers AS (
    SELECT DISTINCT
        customer AS customer_id,
        customer_name,
        customer_group,
        territory
    FROM "sales_database"."main"."sales"
)

SELECT * FROM customers
  );

[0m07:13:28.946216 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.dim_customer"} */

  
  create view "sales_database"."main"."dim_customer__dbt_tmp" as (
    -- WITH sales AS (
--     SELECT * FROM "sales_database"."main"."sales"
-- )

-- SELECT
--     DISTINCT
--     customer AS customer_id,
--     customer_name,
--     customer_address,
--     customer_group,
--     territory,
--     language AS customer_language
-- FROM sales
-- WHERE customer IS NOT NULL




WITH customers AS (
    SELECT DISTINCT
        customer AS customer_id,
        customer_name,
        customer_group,
        territory
    FROM "sales_database"."main"."sales"
)

SELECT * FROM customers
  );

[0m07:13:28.954614 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m07:13:28.959246 [debug] [Thread-1 (]: On model.my_dbt_project.dim_customer: ROLLBACK
[0m07:13:28.976434 [debug] [Thread-1 (]: Failed to rollback 'model.my_dbt_project.dim_customer'
[0m07:13:28.980600 [debug] [Thread-1 (]: On model.my_dbt_project.dim_customer: Close
[0m07:13:29.108203 [debug] [Thread-1 (]: Runtime Error in model dim_customer (models/dimensions/dim_customer.sql)
  Catalog Error: Table with name sales does not exist!
  Did you mean "sqlite_master"?
  LINE 29:     FROM "sales_database"."main"."sales"
                    ^
[0m07:13:29.155445 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '841a554e-5b61-4a15-949e-e082caff141c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8243ff3e0>]}
[0m07:13:29.201175 [error] [Thread-1 (]: 3 of 7 ERROR creating sql view model main.dim_customer ......................... [[31mERROR[0m in 1.12s]
[0m07:13:29.206041 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_customer
[0m07:13:29.226786 [debug] [Thread-4 (]: Marking all children of 'model.my_dbt_project.dim_customer' to be skipped because of status 'error'.  Reason: Runtime Error in model dim_customer (models/dimensions/dim_customer.sql)
  Catalog Error: Table with name sales does not exist!
  Did you mean "sqlite_master"?
  LINE 29:     FROM "sales_database"."main"."sales"
                    ^.
[0m07:13:29.213560 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_date
[0m07:13:29.236246 [info ] [Thread-1 (]: 4 of 7 START sql view model main.dim_date ...................................... [RUN]
[0m07:13:29.240120 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_customer, now model.my_dbt_project.dim_date)
[0m07:13:29.241948 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_date
[0m07:13:29.266653 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_date"
[0m07:13:29.287509 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_date
[0m07:13:29.343273 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_date"
[0m07:13:29.877948 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_date"
[0m07:13:29.879868 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: BEGIN
[0m07:13:29.881615 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:13:29.935821 [debug] [Thread-1 (]: SQL status: OK in 0.054 seconds
[0m07:13:29.951876 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_date"
[0m07:13:29.964363 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.dim_date"} */

  
  create view "sales_database"."main"."dim_date__dbt_tmp" as (
    -- WITH sales AS (
--     SELECT * FROM "sales_database"."main"."sales"
-- )
-- SELECT
--     transaction_date,
--     strftime(transaction_date, '%Y-%m-%d') AS date_id,  -- Change the format to YYYY-MM-DD
--     strftime(transaction_date, '%A') AS weekday_name,
--     strftime(transaction_date, '%m') AS month,
--     strftime(transaction_date, '%Y') AS year,
--     strftime(transaction_date, '%d') AS day,
--     EXTRACT(QUARTER FROM transaction_date) AS quarter
-- FROM sales
-- WHERE transaction_date IS NOT NULL


WITH date_data AS (
    SELECT DISTINCT
        transaction_date AS date_id,
        EXTRACT(YEAR FROM transaction_date) AS year,
        EXTRACT(MONTH FROM transaction_date) AS month,
        EXTRACT(DAY FROM transaction_date) AS day,
        EXTRACT(WEEK FROM transaction_date) AS week_of_year,
        EXTRACT(QUARTER FROM transaction_date) AS quarter
    FROM "sales_database"."main"."sales"
)

SELECT * FROM date_data
  );

[0m07:13:30.364871 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.dim_date"} */

  
  create view "sales_database"."main"."dim_date__dbt_tmp" as (
    -- WITH sales AS (
--     SELECT * FROM "sales_database"."main"."sales"
-- )
-- SELECT
--     transaction_date,
--     strftime(transaction_date, '%Y-%m-%d') AS date_id,  -- Change the format to YYYY-MM-DD
--     strftime(transaction_date, '%A') AS weekday_name,
--     strftime(transaction_date, '%m') AS month,
--     strftime(transaction_date, '%Y') AS year,
--     strftime(transaction_date, '%d') AS day,
--     EXTRACT(QUARTER FROM transaction_date) AS quarter
-- FROM sales
-- WHERE transaction_date IS NOT NULL


WITH date_data AS (
    SELECT DISTINCT
        transaction_date AS date_id,
        EXTRACT(YEAR FROM transaction_date) AS year,
        EXTRACT(MONTH FROM transaction_date) AS month,
        EXTRACT(DAY FROM transaction_date) AS day,
        EXTRACT(WEEK FROM transaction_date) AS week_of_year,
        EXTRACT(QUARTER FROM transaction_date) AS quarter
    FROM "sales_database"."main"."sales"
)

SELECT * FROM date_data
  );

[0m07:13:30.395910 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m07:13:30.425911 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: ROLLBACK
[0m07:13:30.462642 [debug] [Thread-1 (]: Failed to rollback 'model.my_dbt_project.dim_date'
[0m07:13:30.499927 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: Close
[0m07:13:30.570243 [debug] [Thread-1 (]: Runtime Error in model dim_date (models/dimensions/dim_date.sql)
  Catalog Error: Table with name sales does not exist!
  Did you mean "sqlite_master"?
  LINE 28:     FROM "sales_database"."main"."sales"
                    ^
[0m07:13:30.608112 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '841a554e-5b61-4a15-949e-e082caff141c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8260cef00>]}
[0m07:13:30.610626 [error] [Thread-1 (]: 4 of 7 ERROR creating sql view model main.dim_date ............................. [[31mERROR[0m in 1.37s]
[0m07:13:30.637270 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_date
[0m07:13:30.655469 [debug] [Thread-4 (]: Marking all children of 'model.my_dbt_project.dim_date' to be skipped because of status 'error'.  Reason: Runtime Error in model dim_date (models/dimensions/dim_date.sql)
  Catalog Error: Table with name sales does not exist!
  Did you mean "sqlite_master"?
  LINE 28:     FROM "sales_database"."main"."sales"
                    ^.
[0m07:13:30.639483 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_produt
[0m07:13:30.665215 [info ] [Thread-1 (]: 5 of 7 START sql view model main.dim_produt .................................... [RUN]
[0m07:13:30.682618 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_date, now model.my_dbt_project.dim_produt)
[0m07:13:30.709791 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_produt
[0m07:13:30.736487 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_produt"
[0m07:13:30.825046 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_produt
[0m07:13:30.897744 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_produt"
[0m07:13:30.935020 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_produt"
[0m07:13:30.936866 [debug] [Thread-1 (]: On model.my_dbt_project.dim_produt: BEGIN
[0m07:13:30.940441 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:13:30.991163 [debug] [Thread-1 (]: SQL status: OK in 0.051 seconds
[0m07:13:30.996002 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_produt"
[0m07:13:31.012213 [debug] [Thread-1 (]: On model.my_dbt_project.dim_produt: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.dim_produt"} */

  
  create view "sales_database"."main"."dim_produt__dbt_tmp" as (
    -- WITH sales AS (
--     SELECT * 
--     FROM "sales_database"."main"."sales"
-- )

-- SELECT 
--     sales.name,
--     json_extract(items, '$[0].name') AS product_name,  -- Example to extract the first element's "name" field from JSON array
--     json_extract(items, '$[0].item_code') AS product_item_code
-- FROM sales
-- WHERE json_extract(items, '$[0].name') IS NOT NULL  -- Filter to only keep rows with a non-null product name



WITH exploded_items AS (
    SELECT
        name AS sales_order_id,
        JSON_EXTRACT(items, '$[*].item_code') AS product_code,
        JSON_EXTRACT(items, '$[*].item_name') AS product_name,
        JSON_EXTRACT(items, '$[*].qty') AS quantity_sold,
        JSON_EXTRACT(items, '$[*].rate') AS unit_price
    FROM "sales_database"."main"."sales"
)

SELECT 
    sales_order_id,
    UNNEST(product_code) AS product_id,
    UNNEST(product_name) AS product_name,
    UNNEST(quantity_sold) AS quantity_sold,
    UNNEST(unit_price) AS unit_price
FROM exploded_items
  );

[0m07:13:31.233734 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.dim_produt"} */

  
  create view "sales_database"."main"."dim_produt__dbt_tmp" as (
    -- WITH sales AS (
--     SELECT * 
--     FROM "sales_database"."main"."sales"
-- )

-- SELECT 
--     sales.name,
--     json_extract(items, '$[0].name') AS product_name,  -- Example to extract the first element's "name" field from JSON array
--     json_extract(items, '$[0].item_code') AS product_item_code
-- FROM sales
-- WHERE json_extract(items, '$[0].name') IS NOT NULL  -- Filter to only keep rows with a non-null product name



WITH exploded_items AS (
    SELECT
        name AS sales_order_id,
        JSON_EXTRACT(items, '$[*].item_code') AS product_code,
        JSON_EXTRACT(items, '$[*].item_name') AS product_name,
        JSON_EXTRACT(items, '$[*].qty') AS quantity_sold,
        JSON_EXTRACT(items, '$[*].rate') AS unit_price
    FROM "sales_database"."main"."sales"
)

SELECT 
    sales_order_id,
    UNNEST(product_code) AS product_id,
    UNNEST(product_name) AS product_name,
    UNNEST(quantity_sold) AS quantity_sold,
    UNNEST(unit_price) AS unit_price
FROM exploded_items
  );

[0m07:13:31.236248 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m07:13:31.256282 [debug] [Thread-1 (]: On model.my_dbt_project.dim_produt: ROLLBACK
[0m07:13:31.265622 [debug] [Thread-1 (]: Failed to rollback 'model.my_dbt_project.dim_produt'
[0m07:13:31.267500 [debug] [Thread-1 (]: On model.my_dbt_project.dim_produt: Close
[0m07:13:31.319910 [debug] [Thread-1 (]: Runtime Error in model dim_produt (models/dimensions/dim_produt.sql)
  Catalog Error: Table with name sales does not exist!
  Did you mean "sqlite_master"?
  LINE 26:     FROM "sales_database"."main"."sales"
                    ^
[0m07:13:31.336180 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '841a554e-5b61-4a15-949e-e082caff141c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc825f7e060>]}
[0m07:13:31.339939 [error] [Thread-1 (]: 5 of 7 ERROR creating sql view model main.dim_produt ........................... [[31mERROR[0m in 0.65s]
[0m07:13:31.346584 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_produt
[0m07:13:31.368964 [debug] [Thread-4 (]: Marking all children of 'model.my_dbt_project.dim_produt' to be skipped because of status 'error'.  Reason: Runtime Error in model dim_produt (models/dimensions/dim_produt.sql)
  Catalog Error: Table with name sales does not exist!
  Did you mean "sqlite_master"?
  LINE 26:     FROM "sales_database"."main"."sales"
                    ^.
[0m07:13:31.349135 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_sales_team
[0m07:13:31.373380 [info ] [Thread-1 (]: 6 of 7 START sql view model main.dim_sales_team ................................ [RUN]
[0m07:13:31.376528 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_produt, now model.my_dbt_project.dim_sales_team)
[0m07:13:31.395859 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_sales_team
[0m07:13:31.408914 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_sales_team"
[0m07:13:31.458672 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_sales_team
[0m07:13:31.474449 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_sales_team"
[0m07:13:31.555712 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_sales_team"
[0m07:13:31.566573 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_team: BEGIN
[0m07:13:31.572279 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:13:31.623021 [debug] [Thread-1 (]: SQL status: OK in 0.051 seconds
[0m07:13:31.626076 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_sales_team"
[0m07:13:31.629239 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_team: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sales_team"} */

  
  create view "sales_database"."main"."dim_sales_team__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
    DISTINCT
    sales_team->>'name' AS sales_team_id,
    sales_team->>'region' AS sales_team_region
FROM sales
WHERE sales_team IS NOT NULL
  );

[0m07:13:31.889339 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sales_team"} */

  
  create view "sales_database"."main"."dim_sales_team__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
    DISTINCT
    sales_team->>'name' AS sales_team_id,
    sales_team->>'region' AS sales_team_region
FROM sales
WHERE sales_team IS NOT NULL
  );

[0m07:13:31.895264 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m07:13:31.897937 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_team: ROLLBACK
[0m07:13:31.908262 [debug] [Thread-1 (]: Failed to rollback 'model.my_dbt_project.dim_sales_team'
[0m07:13:31.910603 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_team: Close
[0m07:13:31.931364 [debug] [Thread-1 (]: Runtime Error in model dim_sales_team (models/dimensions/dim_sales_team.sql)
  Catalog Error: Table with name sales does not exist!
  Did you mean "sqlite_master"?
  LINE 6:     SELECT * FROM "sales_database"."main"."sales"
                            ^
[0m07:13:31.933689 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '841a554e-5b61-4a15-949e-e082caff141c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8244053d0>]}
[0m07:13:31.936264 [error] [Thread-1 (]: 6 of 7 ERROR creating sql view model main.dim_sales_team ....................... [[31mERROR[0m in 0.56s]
[0m07:13:31.939849 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_sales_team
[0m07:13:31.941890 [debug] [Thread-1 (]: Began running node model.my_dbt_project.fact_sales
[0m07:13:31.944068 [debug] [Thread-4 (]: Marking all children of 'model.my_dbt_project.dim_sales_team' to be skipped because of status 'error'.  Reason: Runtime Error in model dim_sales_team (models/dimensions/dim_sales_team.sql)
  Catalog Error: Table with name sales does not exist!
  Did you mean "sqlite_master"?
  LINE 6:     SELECT * FROM "sales_database"."main"."sales"
                            ^.
[0m07:13:31.945596 [info ] [Thread-1 (]: 7 of 7 START sql table model main.fact_sales ................................... [RUN]
[0m07:13:31.949188 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_sales_team, now model.my_dbt_project.fact_sales)
[0m07:13:31.951138 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.fact_sales
[0m07:13:31.961940 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.fact_sales"
[0m07:13:32.005306 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.fact_sales
[0m07:13:32.111698 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.fact_sales"
[0m07:13:32.169860 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.fact_sales"
[0m07:13:32.172423 [debug] [Thread-1 (]: On model.my_dbt_project.fact_sales: BEGIN
[0m07:13:32.174189 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:13:32.245691 [debug] [Thread-1 (]: SQL status: OK in 0.069 seconds
[0m07:13:32.255638 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.fact_sales"
[0m07:13:32.268490 [debug] [Thread-1 (]: On model.my_dbt_project.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.fact_sales"} */

  
    
    

    create  table
      "sales_database"."main"."fact_sales__dbt_tmp"
  
    as (
      WITH sales_data AS (
    SELECT
        name AS sales_order_id,
        transaction_date,
        customer,
        company,
        total AS sales_amount,
        net_total,
        discount_amount,
        base_total_taxes_and_charges AS tax_amount,
        grand_total,
        currency,
        conversion_rate,
        items, -- JSON field with product details
        taxes -- JSON field with tax details
    FROM "sales_database"."main"."sales"
)

SELECT * FROM sales_data
    );
  
  
[0m07:13:32.430110 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.fact_sales"} */

  
    
    

    create  table
      "sales_database"."main"."fact_sales__dbt_tmp"
  
    as (
      WITH sales_data AS (
    SELECT
        name AS sales_order_id,
        transaction_date,
        customer,
        company,
        total AS sales_amount,
        net_total,
        discount_amount,
        base_total_taxes_and_charges AS tax_amount,
        grand_total,
        currency,
        conversion_rate,
        items, -- JSON field with product details
        taxes -- JSON field with tax details
    FROM "sales_database"."main"."sales"
)

SELECT * FROM sales_data
    );
  
  
[0m07:13:32.432020 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m07:13:32.434722 [debug] [Thread-1 (]: On model.my_dbt_project.fact_sales: ROLLBACK
[0m07:13:32.442180 [debug] [Thread-1 (]: Failed to rollback 'model.my_dbt_project.fact_sales'
[0m07:13:32.444326 [debug] [Thread-1 (]: On model.my_dbt_project.fact_sales: Close
[0m07:13:32.458495 [debug] [Thread-1 (]: Runtime Error in model fact_sales (models/facts/fact_sales.sql)
  Catalog Error: Table with name sales does not exist!
  Did you mean "sqlite_master"?
  LINE 26:     FROM "sales_database"."main"."sales"
                    ^
[0m07:13:32.461621 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '841a554e-5b61-4a15-949e-e082caff141c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc824445d90>]}
[0m07:13:32.464506 [error] [Thread-1 (]: 7 of 7 ERROR creating sql table model main.fact_sales .......................... [[31mERROR[0m in 0.51s]
[0m07:13:32.468223 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.fact_sales
[0m07:13:32.474768 [debug] [Thread-4 (]: Marking all children of 'model.my_dbt_project.fact_sales' to be skipped because of status 'error'.  Reason: Runtime Error in model fact_sales (models/facts/fact_sales.sql)
  Catalog Error: Table with name sales does not exist!
  Did you mean "sqlite_master"?
  LINE 26:     FROM "sales_database"."main"."sales"
                    ^.
[0m07:13:32.480820 [debug] [MainThread]: Using duckdb connection "master"
[0m07:13:32.493172 [debug] [MainThread]: On master: BEGIN
[0m07:13:32.494939 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:13:32.519820 [debug] [MainThread]: SQL status: OK in 0.025 seconds
[0m07:13:32.521421 [debug] [MainThread]: On master: COMMIT
[0m07:13:32.523156 [debug] [MainThread]: Using duckdb connection "master"
[0m07:13:32.526215 [debug] [MainThread]: On master: COMMIT
[0m07:13:32.528801 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m07:13:32.530482 [debug] [MainThread]: On master: Close
[0m07:13:32.536176 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:13:32.537863 [debug] [MainThread]: Connection 'create_sales_database_main' was properly closed.
[0m07:13:32.539570 [debug] [MainThread]: Connection 'list_sales_database_main' was properly closed.
[0m07:13:32.541093 [debug] [MainThread]: Connection 'model.my_dbt_project.fact_sales' was properly closed.
[0m07:13:32.542868 [info ] [MainThread]: 
[0m07:13:32.545585 [info ] [MainThread]: Finished running 1 table model, 6 view models in 0 hours 0 minutes and 8.27 seconds (8.27s).
[0m07:13:32.552562 [debug] [MainThread]: Command end result
[0m07:13:32.669225 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m07:13:32.682456 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m07:13:32.717426 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dags/dbt_models/target/run_results.json
[0m07:13:32.719155 [info ] [MainThread]: 
[0m07:13:32.722063 [info ] [MainThread]: [31mCompleted with 7 errors, 0 partial successes, and 0 warnings:[0m
[0m07:13:32.724788 [info ] [MainThread]: 
[0m07:13:32.727702 [error] [MainThread]:   Runtime Error in model dim_company (models/dimensions/dim_company.sql)
  Catalog Error: Table with name sales does not exist!
  Did you mean "sqlite_master"?
  LINE 9:     FROM "sales_database"."main"."sales"
                   ^
[0m07:13:32.737372 [info ] [MainThread]: 
[0m07:13:32.740352 [error] [MainThread]:   Runtime Error in model dim_currency (models/dimensions/dim_currency.sql)
  Catalog Error: Table with name sales does not exist!
  Did you mean "sqlite_master"?
  LINE 10:     FROM "sales_database"."main"."sales"
                    ^
[0m07:13:32.746413 [info ] [MainThread]: 
[0m07:13:32.749204 [error] [MainThread]:   Runtime Error in model dim_customer (models/dimensions/dim_customer.sql)
  Catalog Error: Table with name sales does not exist!
  Did you mean "sqlite_master"?
  LINE 29:     FROM "sales_database"."main"."sales"
                    ^
[0m07:13:32.755632 [info ] [MainThread]: 
[0m07:13:32.758588 [error] [MainThread]:   Runtime Error in model dim_date (models/dimensions/dim_date.sql)
  Catalog Error: Table with name sales does not exist!
  Did you mean "sqlite_master"?
  LINE 28:     FROM "sales_database"."main"."sales"
                    ^
[0m07:13:32.765033 [info ] [MainThread]: 
[0m07:13:32.768065 [error] [MainThread]:   Runtime Error in model dim_produt (models/dimensions/dim_produt.sql)
  Catalog Error: Table with name sales does not exist!
  Did you mean "sqlite_master"?
  LINE 26:     FROM "sales_database"."main"."sales"
                    ^
[0m07:13:32.774568 [info ] [MainThread]: 
[0m07:13:32.778186 [error] [MainThread]:   Runtime Error in model dim_sales_team (models/dimensions/dim_sales_team.sql)
  Catalog Error: Table with name sales does not exist!
  Did you mean "sqlite_master"?
  LINE 6:     SELECT * FROM "sales_database"."main"."sales"
                            ^
[0m07:13:32.784660 [info ] [MainThread]: 
[0m07:13:32.787555 [error] [MainThread]:   Runtime Error in model fact_sales (models/facts/fact_sales.sql)
  Catalog Error: Table with name sales does not exist!
  Did you mean "sqlite_master"?
  LINE 26:     FROM "sales_database"."main"."sales"
                    ^
[0m07:13:32.790866 [info ] [MainThread]: 
[0m07:13:32.794734 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=7 SKIP=0 TOTAL=7
[0m07:13:32.799994 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 14.968543, "process_in_blocks": "65392", "process_kernel_time": 3.442988, "process_mem_max_rss": "148948", "process_out_blocks": "1968", "process_user_time": 11.895775}
[0m07:13:32.802169 [debug] [MainThread]: Command `dbt run` failed at 07:13:32.801825 after 14.97 seconds
[0m07:13:32.803934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc82ce1b8c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc82cfafa70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc82e4ccf80>]}
[0m07:13:32.805747 [debug] [MainThread]: Flushing usage events
[0m07:13:34.467910 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:19:15.067850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecc44dad50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecc442d400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecc62bc2f0>]}


============================== 07:19:15.080561 | efa21a7e-0b62-404b-a6d7-983fad127fa5 ==============================
[0m07:19:15.080561 [info ] [MainThread]: Running with dbt=1.9.2
[0m07:19:15.082486 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt/profiles.yml', 'log_path': '/opt/airflow/dags/dbt_models/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt/profiles.yml --target dev', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:19:17.588605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'efa21a7e-0b62-404b-a6d7-983fad127fa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecc3c2dbe0>]}
[0m07:19:18.041063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'efa21a7e-0b62-404b-a6d7-983fad127fa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecc3d01940>]}
[0m07:19:18.110867 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m07:19:19.513110 [debug] [MainThread]: checksum: eea1a9e9f56a74d304aa4a9e5e9c8fc1dea4ccd2b0ec98e366756009c99c5c94, vars: {}, profile: , target: dev, version: 1.9.2
[0m07:19:20.592014 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:19:20.614648 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:19:20.889750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'efa21a7e-0b62-404b-a6d7-983fad127fa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecbe5d6840>]}
[0m07:19:21.545114 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m07:19:21.592473 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m07:19:21.984172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'efa21a7e-0b62-404b-a6d7-983fad127fa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecbe5a2db0>]}
[0m07:19:22.005991 [info ] [MainThread]: Found 7 models, 1 source, 424 macros
[0m07:19:22.008765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'efa21a7e-0b62-404b-a6d7-983fad127fa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecc3d7e900>]}
[0m07:19:22.020331 [info ] [MainThread]: 
[0m07:19:22.040883 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:19:22.043638 [info ] [MainThread]: 
[0m07:19:22.059033 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m07:19:22.152817 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_sales_database'
[0m07:19:22.731141 [debug] [ThreadPool]: Using duckdb connection "list_sales_database"
[0m07:19:22.758086 [debug] [ThreadPool]: On list_sales_database: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "list_sales_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"sales_database"'
    
  
  
[0m07:19:22.761283 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:19:25.309136 [debug] [ThreadPool]: SQL status: OK in 2.539 seconds
[0m07:19:25.336211 [debug] [ThreadPool]: On list_sales_database: Close
[0m07:19:25.407036 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_database, now create_sales_database_main)
[0m07:19:25.419272 [debug] [ThreadPool]: Creating schema "database: "sales_database"
schema: "main"
"
[0m07:19:25.473488 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m07:19:25.479904 [debug] [ThreadPool]: On create_sales_database_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "create_sales_database_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='sales_database'
        and type='sqlite'
    
  
[0m07:19:25.482036 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:19:32.317457 [debug] [ThreadPool]: SQL status: OK in 6.826 seconds
[0m07:19:32.420285 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m07:19:32.444695 [debug] [ThreadPool]: On create_sales_database_main: BEGIN
[0m07:19:33.529299 [debug] [ThreadPool]: SQL status: OK in 1.078 seconds
[0m07:19:33.538802 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m07:19:33.546211 [debug] [ThreadPool]: On create_sales_database_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "create_sales_database_main"} */

    
    
        create schema if not exists "sales_database"."main"
    
[0m07:19:33.885505 [debug] [ThreadPool]: SQL status: OK in 0.321 seconds
[0m07:19:33.914045 [debug] [ThreadPool]: On create_sales_database_main: COMMIT
[0m07:19:33.919209 [debug] [ThreadPool]: Using duckdb connection "create_sales_database_main"
[0m07:19:33.928147 [debug] [ThreadPool]: On create_sales_database_main: COMMIT
[0m07:19:34.194825 [debug] [ThreadPool]: SQL status: OK in 0.241 seconds
[0m07:19:34.206880 [debug] [ThreadPool]: On create_sales_database_main: Close
[0m07:19:34.513200 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_sales_database_main'
[0m07:19:34.623311 [debug] [ThreadPool]: Using duckdb connection "list_sales_database_main"
[0m07:19:34.640516 [debug] [ThreadPool]: On list_sales_database_main: BEGIN
[0m07:19:34.643198 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:20:09.605142 [debug] [ThreadPool]: SQL status: OK in 34.985 seconds
[0m07:20:09.608541 [debug] [ThreadPool]: Using duckdb connection "list_sales_database_main"
[0m07:20:09.611712 [debug] [ThreadPool]: On list_sales_database_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "connection_name": "list_sales_database_main"} */
select
      'sales_database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'sales_database'
  
[0m07:20:09.865630 [debug] [ThreadPool]: SQL status: OK in 0.243 seconds
[0m07:20:09.881384 [debug] [ThreadPool]: On list_sales_database_main: ROLLBACK
[0m07:20:09.898769 [debug] [ThreadPool]: Failed to rollback 'list_sales_database_main'
[0m07:20:09.900996 [debug] [ThreadPool]: On list_sales_database_main: Close
[0m07:20:09.948216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'efa21a7e-0b62-404b-a6d7-983fad127fa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecbe54a720>]}
[0m07:20:09.957940 [debug] [MainThread]: Using duckdb connection "master"
[0m07:20:09.965878 [debug] [MainThread]: On master: BEGIN
[0m07:20:09.973397 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:20:10.243656 [debug] [MainThread]: SQL status: OK in 0.270 seconds
[0m07:20:10.247868 [debug] [MainThread]: On master: COMMIT
[0m07:20:10.270501 [debug] [MainThread]: Using duckdb connection "master"
[0m07:20:10.307259 [debug] [MainThread]: On master: COMMIT
[0m07:20:10.338848 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m07:20:10.357658 [debug] [MainThread]: On master: Close
[0m07:20:10.415224 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_company
[0m07:20:10.449224 [info ] [Thread-1 (]: 1 of 7 START sql view model main.dim_company ................................... [RUN]
[0m07:20:10.488886 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.my_dbt_project.dim_company'
[0m07:20:10.508474 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_company
[0m07:20:10.638072 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_company"
[0m07:20:10.793217 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_company
[0m07:20:11.483454 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_company"
[0m07:20:11.532469 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_company"
[0m07:20:11.535069 [debug] [Thread-1 (]: On model.my_dbt_project.dim_company: BEGIN
[0m07:20:11.544787 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m07:20:11.668882 [debug] [Thread-1 (]: SQL status: OK in 0.126 seconds
[0m07:20:11.686351 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_company"
[0m07:20:11.689642 [debug] [Thread-1 (]: On model.my_dbt_project.dim_company: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.dim_company"} */

  
  create view "sales_database"."main"."dim_company__dbt_tmp" as (
    WITH companies AS (
    SELECT DISTINCT
        company AS company_id,
        company
    FROM "sales_database"."main"."sales"
)

SELECT * FROM companies
  );

[0m07:20:12.265968 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.dim_company"} */

  
  create view "sales_database"."main"."dim_company__dbt_tmp" as (
    WITH companies AS (
    SELECT DISTINCT
        company AS company_id,
        company
    FROM "sales_database"."main"."sales"
)

SELECT * FROM companies
  );

[0m07:20:12.268746 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m07:20:12.284118 [debug] [Thread-1 (]: On model.my_dbt_project.dim_company: ROLLBACK
[0m07:20:12.392140 [debug] [Thread-1 (]: Failed to rollback 'model.my_dbt_project.dim_company'
[0m07:20:12.409231 [debug] [Thread-1 (]: On model.my_dbt_project.dim_company: Close
[0m07:20:12.471207 [debug] [Thread-1 (]: Runtime Error in model dim_company (models/dimensions/dim_company.sql)
  Catalog Error: Table with name sales does not exist!
  Did you mean "sqlite_master"?
  LINE 9:     FROM "sales_database"."main"."sales"
                   ^
[0m07:20:12.508927 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'efa21a7e-0b62-404b-a6d7-983fad127fa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecc4a24380>]}
[0m07:20:12.555483 [error] [Thread-1 (]: 1 of 7 ERROR creating sql view model main.dim_company .......................... [[31mERROR[0m in 2.00s]
[0m07:20:12.562322 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_company
[0m07:20:12.585509 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_currency
[0m07:20:12.592842 [debug] [Thread-4 (]: Marking all children of 'model.my_dbt_project.dim_company' to be skipped because of status 'error'.  Reason: Runtime Error in model dim_company (models/dimensions/dim_company.sql)
  Catalog Error: Table with name sales does not exist!
  Did you mean "sqlite_master"?
  LINE 9:     FROM "sales_database"."main"."sales"
                   ^.
[0m07:20:12.599220 [info ] [Thread-1 (]: 2 of 7 START sql view model main.dim_currency .................................. [RUN]
[0m07:20:12.619323 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_company, now model.my_dbt_project.dim_currency)
[0m07:20:12.622879 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_currency
[0m07:20:12.657051 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_currency"
[0m07:20:12.716982 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_currency
[0m07:20:12.747696 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_currency"
[0m07:20:12.795425 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_currency"
[0m07:20:12.807283 [debug] [Thread-1 (]: On model.my_dbt_project.dim_currency: BEGIN
[0m07:20:12.809783 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:20:12.889713 [debug] [Thread-1 (]: SQL status: OK in 0.076 seconds
[0m07:20:12.892770 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_currency"
[0m07:20:12.895849 [debug] [Thread-1 (]: On model.my_dbt_project.dim_currency: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.dim_currency"} */

  
  create view "sales_database"."main"."dim_currency__dbt_tmp" as (
    WITH currency_data AS (
    SELECT DISTINCT
        currency AS currency_id,
        currency,
        conversion_rate
    FROM "sales_database"."main"."sales"
)

SELECT * FROM currency_data
  );

[0m07:20:13.244081 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.dim_currency"} */

  
  create view "sales_database"."main"."dim_currency__dbt_tmp" as (
    WITH currency_data AS (
    SELECT DISTINCT
        currency AS currency_id,
        currency,
        conversion_rate
    FROM "sales_database"."main"."sales"
)

SELECT * FROM currency_data
  );

[0m07:20:13.285812 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m07:20:13.335703 [debug] [Thread-1 (]: On model.my_dbt_project.dim_currency: ROLLBACK
[0m07:20:13.360262 [debug] [Thread-1 (]: Failed to rollback 'model.my_dbt_project.dim_currency'
[0m07:20:13.373851 [debug] [Thread-1 (]: On model.my_dbt_project.dim_currency: Close
[0m07:20:13.407412 [debug] [Thread-1 (]: Runtime Error in model dim_currency (models/dimensions/dim_currency.sql)
  Catalog Error: Table with name sales does not exist!
  Did you mean "sqlite_master"?
  LINE 10:     FROM "sales_database"."main"."sales"
                    ^
[0m07:20:13.418684 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'efa21a7e-0b62-404b-a6d7-983fad127fa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecbd3877d0>]}
[0m07:20:13.422191 [error] [Thread-1 (]: 2 of 7 ERROR creating sql view model main.dim_currency ......................... [[31mERROR[0m in 0.80s]
[0m07:20:13.425402 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_currency
[0m07:20:13.427731 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_customer
[0m07:20:13.443225 [debug] [Thread-4 (]: Marking all children of 'model.my_dbt_project.dim_currency' to be skipped because of status 'error'.  Reason: Runtime Error in model dim_currency (models/dimensions/dim_currency.sql)
  Catalog Error: Table with name sales does not exist!
  Did you mean "sqlite_master"?
  LINE 10:     FROM "sales_database"."main"."sales"
                    ^.
[0m07:20:13.454166 [info ] [Thread-1 (]: 3 of 7 START sql view model main.dim_customer .................................. [RUN]
[0m07:20:13.460971 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_currency, now model.my_dbt_project.dim_customer)
[0m07:20:13.463192 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_customer
[0m07:20:13.483378 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_customer"
[0m07:20:13.575456 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_customer
[0m07:20:13.611688 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_customer"
[0m07:20:13.741371 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_customer"
[0m07:20:13.743765 [debug] [Thread-1 (]: On model.my_dbt_project.dim_customer: BEGIN
[0m07:20:13.746664 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:20:13.830973 [debug] [Thread-1 (]: SQL status: OK in 0.084 seconds
[0m07:20:13.844585 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_customer"
[0m07:20:13.853099 [debug] [Thread-1 (]: On model.my_dbt_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.dim_customer"} */

  
  create view "sales_database"."main"."dim_customer__dbt_tmp" as (
    -- WITH sales AS (
--     SELECT * FROM "sales_database"."main"."sales"
-- )

-- SELECT
--     DISTINCT
--     customer AS customer_id,
--     customer_name,
--     customer_address,
--     customer_group,
--     territory,
--     language AS customer_language
-- FROM sales
-- WHERE customer IS NOT NULL




WITH customers AS (
    SELECT DISTINCT
        customer AS customer_id,
        customer_name,
        customer_group,
        territory
    FROM "sales_database"."main"."sales"
)

SELECT * FROM customers
  );

[0m07:20:14.156217 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.dim_customer"} */

  
  create view "sales_database"."main"."dim_customer__dbt_tmp" as (
    -- WITH sales AS (
--     SELECT * FROM "sales_database"."main"."sales"
-- )

-- SELECT
--     DISTINCT
--     customer AS customer_id,
--     customer_name,
--     customer_address,
--     customer_group,
--     territory,
--     language AS customer_language
-- FROM sales
-- WHERE customer IS NOT NULL




WITH customers AS (
    SELECT DISTINCT
        customer AS customer_id,
        customer_name,
        customer_group,
        territory
    FROM "sales_database"."main"."sales"
)

SELECT * FROM customers
  );

[0m07:20:14.158909 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m07:20:14.190849 [debug] [Thread-1 (]: On model.my_dbt_project.dim_customer: ROLLBACK
[0m07:20:14.212936 [debug] [Thread-1 (]: Failed to rollback 'model.my_dbt_project.dim_customer'
[0m07:20:14.228402 [debug] [Thread-1 (]: On model.my_dbt_project.dim_customer: Close
[0m07:20:14.269601 [debug] [Thread-1 (]: Runtime Error in model dim_customer (models/dimensions/dim_customer.sql)
  Catalog Error: Table with name sales does not exist!
  Did you mean "sqlite_master"?
  LINE 29:     FROM "sales_database"."main"."sales"
                    ^
[0m07:20:14.283818 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'efa21a7e-0b62-404b-a6d7-983fad127fa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecbd296300>]}
[0m07:20:14.300758 [error] [Thread-1 (]: 3 of 7 ERROR creating sql view model main.dim_customer ......................... [[31mERROR[0m in 0.82s]
[0m07:20:14.329509 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_customer
[0m07:20:14.332650 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_date
[0m07:20:14.334834 [debug] [Thread-4 (]: Marking all children of 'model.my_dbt_project.dim_customer' to be skipped because of status 'error'.  Reason: Runtime Error in model dim_customer (models/dimensions/dim_customer.sql)
  Catalog Error: Table with name sales does not exist!
  Did you mean "sqlite_master"?
  LINE 29:     FROM "sales_database"."main"."sales"
                    ^.
[0m07:20:14.349794 [info ] [Thread-1 (]: 4 of 7 START sql view model main.dim_date ...................................... [RUN]
[0m07:20:14.366360 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_customer, now model.my_dbt_project.dim_date)
[0m07:20:14.370880 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_date
[0m07:20:14.403693 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_date"
[0m07:20:14.494184 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_date
[0m07:20:14.520416 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_date"
[0m07:20:14.639493 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_date"
[0m07:20:14.641769 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: BEGIN
[0m07:20:14.654958 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:20:14.735786 [debug] [Thread-1 (]: SQL status: OK in 0.081 seconds
[0m07:20:14.750055 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_date"
[0m07:20:14.754945 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.dim_date"} */

  
  create view "sales_database"."main"."dim_date__dbt_tmp" as (
    -- WITH sales AS (
--     SELECT * FROM "sales_database"."main"."sales"
-- )
-- SELECT
--     transaction_date,
--     strftime(transaction_date, '%Y-%m-%d') AS date_id,  -- Change the format to YYYY-MM-DD
--     strftime(transaction_date, '%A') AS weekday_name,
--     strftime(transaction_date, '%m') AS month,
--     strftime(transaction_date, '%Y') AS year,
--     strftime(transaction_date, '%d') AS day,
--     EXTRACT(QUARTER FROM transaction_date) AS quarter
-- FROM sales
-- WHERE transaction_date IS NOT NULL


WITH date_data AS (
    SELECT DISTINCT
        transaction_date AS date_id,
        EXTRACT(YEAR FROM transaction_date) AS year,
        EXTRACT(MONTH FROM transaction_date) AS month,
        EXTRACT(DAY FROM transaction_date) AS day,
        EXTRACT(WEEK FROM transaction_date) AS week_of_year,
        EXTRACT(QUARTER FROM transaction_date) AS quarter
    FROM "sales_database"."main"."sales"
)

SELECT * FROM date_data
  );

[0m07:20:15.038637 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.dim_date"} */

  
  create view "sales_database"."main"."dim_date__dbt_tmp" as (
    -- WITH sales AS (
--     SELECT * FROM "sales_database"."main"."sales"
-- )
-- SELECT
--     transaction_date,
--     strftime(transaction_date, '%Y-%m-%d') AS date_id,  -- Change the format to YYYY-MM-DD
--     strftime(transaction_date, '%A') AS weekday_name,
--     strftime(transaction_date, '%m') AS month,
--     strftime(transaction_date, '%Y') AS year,
--     strftime(transaction_date, '%d') AS day,
--     EXTRACT(QUARTER FROM transaction_date) AS quarter
-- FROM sales
-- WHERE transaction_date IS NOT NULL


WITH date_data AS (
    SELECT DISTINCT
        transaction_date AS date_id,
        EXTRACT(YEAR FROM transaction_date) AS year,
        EXTRACT(MONTH FROM transaction_date) AS month,
        EXTRACT(DAY FROM transaction_date) AS day,
        EXTRACT(WEEK FROM transaction_date) AS week_of_year,
        EXTRACT(QUARTER FROM transaction_date) AS quarter
    FROM "sales_database"."main"."sales"
)

SELECT * FROM date_data
  );

[0m07:20:15.054964 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m07:20:15.057366 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: ROLLBACK
[0m07:20:15.103483 [debug] [Thread-1 (]: Failed to rollback 'model.my_dbt_project.dim_date'
[0m07:20:15.107499 [debug] [Thread-1 (]: On model.my_dbt_project.dim_date: Close
[0m07:20:15.183708 [debug] [Thread-1 (]: Runtime Error in model dim_date (models/dimensions/dim_date.sql)
  Catalog Error: Table with name sales does not exist!
  Did you mean "sqlite_master"?
  LINE 28:     FROM "sales_database"."main"."sales"
                    ^
[0m07:20:15.202395 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'efa21a7e-0b62-404b-a6d7-983fad127fa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecbd2c0860>]}
[0m07:20:15.221567 [error] [Thread-1 (]: 4 of 7 ERROR creating sql view model main.dim_date ............................. [[31mERROR[0m in 0.84s]
[0m07:20:15.237457 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_date
[0m07:20:15.247417 [debug] [Thread-4 (]: Marking all children of 'model.my_dbt_project.dim_date' to be skipped because of status 'error'.  Reason: Runtime Error in model dim_date (models/dimensions/dim_date.sql)
  Catalog Error: Table with name sales does not exist!
  Did you mean "sqlite_master"?
  LINE 28:     FROM "sales_database"."main"."sales"
                    ^.
[0m07:20:15.241235 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_produt
[0m07:20:15.257133 [info ] [Thread-1 (]: 5 of 7 START sql view model main.dim_produt .................................... [RUN]
[0m07:20:15.270323 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_date, now model.my_dbt_project.dim_produt)
[0m07:20:15.274657 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_produt
[0m07:20:15.312738 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_produt"
[0m07:20:15.443674 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_produt
[0m07:20:15.479630 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_produt"
[0m07:20:15.650955 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_produt"
[0m07:20:15.667257 [debug] [Thread-1 (]: On model.my_dbt_project.dim_produt: BEGIN
[0m07:20:15.669871 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:20:15.804447 [debug] [Thread-1 (]: SQL status: OK in 0.135 seconds
[0m07:20:15.809868 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_produt"
[0m07:20:15.839023 [debug] [Thread-1 (]: On model.my_dbt_project.dim_produt: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.dim_produt"} */

  
  create view "sales_database"."main"."dim_produt__dbt_tmp" as (
    -- WITH sales AS (
--     SELECT * 
--     FROM "sales_database"."main"."sales"
-- )

-- SELECT 
--     sales.name,
--     json_extract(items, '$[0].name') AS product_name,  -- Example to extract the first element's "name" field from JSON array
--     json_extract(items, '$[0].item_code') AS product_item_code
-- FROM sales
-- WHERE json_extract(items, '$[0].name') IS NOT NULL  -- Filter to only keep rows with a non-null product name



WITH exploded_items AS (
    SELECT
        name AS sales_order_id,
        JSON_EXTRACT(items, '$[*].item_code') AS product_code,
        JSON_EXTRACT(items, '$[*].item_name') AS product_name,
        JSON_EXTRACT(items, '$[*].qty') AS quantity_sold,
        JSON_EXTRACT(items, '$[*].rate') AS unit_price
    FROM "sales_database"."main"."sales"
)

SELECT 
    sales_order_id,
    UNNEST(product_code) AS product_id,
    UNNEST(product_name) AS product_name,
    UNNEST(quantity_sold) AS quantity_sold,
    UNNEST(unit_price) AS unit_price
FROM exploded_items
  );

[0m07:20:16.312432 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.dim_produt"} */

  
  create view "sales_database"."main"."dim_produt__dbt_tmp" as (
    -- WITH sales AS (
--     SELECT * 
--     FROM "sales_database"."main"."sales"
-- )

-- SELECT 
--     sales.name,
--     json_extract(items, '$[0].name') AS product_name,  -- Example to extract the first element's "name" field from JSON array
--     json_extract(items, '$[0].item_code') AS product_item_code
-- FROM sales
-- WHERE json_extract(items, '$[0].name') IS NOT NULL  -- Filter to only keep rows with a non-null product name



WITH exploded_items AS (
    SELECT
        name AS sales_order_id,
        JSON_EXTRACT(items, '$[*].item_code') AS product_code,
        JSON_EXTRACT(items, '$[*].item_name') AS product_name,
        JSON_EXTRACT(items, '$[*].qty') AS quantity_sold,
        JSON_EXTRACT(items, '$[*].rate') AS unit_price
    FROM "sales_database"."main"."sales"
)

SELECT 
    sales_order_id,
    UNNEST(product_code) AS product_id,
    UNNEST(product_name) AS product_name,
    UNNEST(quantity_sold) AS quantity_sold,
    UNNEST(unit_price) AS unit_price
FROM exploded_items
  );

[0m07:20:16.322267 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m07:20:16.325779 [debug] [Thread-1 (]: On model.my_dbt_project.dim_produt: ROLLBACK
[0m07:20:16.347281 [debug] [Thread-1 (]: Failed to rollback 'model.my_dbt_project.dim_produt'
[0m07:20:16.366791 [debug] [Thread-1 (]: On model.my_dbt_project.dim_produt: Close
[0m07:20:16.420722 [debug] [Thread-1 (]: Runtime Error in model dim_produt (models/dimensions/dim_produt.sql)
  Catalog Error: Table with name sales does not exist!
  Did you mean "sqlite_master"?
  LINE 26:     FROM "sales_database"."main"."sales"
                    ^
[0m07:20:16.423693 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'efa21a7e-0b62-404b-a6d7-983fad127fa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecbd2dd670>]}
[0m07:20:16.437060 [error] [Thread-1 (]: 5 of 7 ERROR creating sql view model main.dim_produt ........................... [[31mERROR[0m in 1.15s]
[0m07:20:16.441622 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_produt
[0m07:20:16.471836 [debug] [Thread-4 (]: Marking all children of 'model.my_dbt_project.dim_produt' to be skipped because of status 'error'.  Reason: Runtime Error in model dim_produt (models/dimensions/dim_produt.sql)
  Catalog Error: Table with name sales does not exist!
  Did you mean "sqlite_master"?
  LINE 26:     FROM "sales_database"."main"."sales"
                    ^.
[0m07:20:16.475592 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_sales_team
[0m07:20:16.478765 [info ] [Thread-1 (]: 6 of 7 START sql view model main.dim_sales_team ................................ [RUN]
[0m07:20:16.481573 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_produt, now model.my_dbt_project.dim_sales_team)
[0m07:20:16.487920 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_sales_team
[0m07:20:16.509269 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_sales_team"
[0m07:20:16.604934 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_sales_team
[0m07:20:16.650666 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_sales_team"
[0m07:20:16.737373 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_sales_team"
[0m07:20:16.744261 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_team: BEGIN
[0m07:20:16.758172 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:20:16.844816 [debug] [Thread-1 (]: SQL status: OK in 0.087 seconds
[0m07:20:16.847416 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.dim_sales_team"
[0m07:20:16.865078 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_team: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sales_team"} */

  
  create view "sales_database"."main"."dim_sales_team__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
    DISTINCT
    sales_team->>'name' AS sales_team_id,
    sales_team->>'region' AS sales_team_region
FROM sales
WHERE sales_team IS NOT NULL
  );

[0m07:20:17.112934 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.dim_sales_team"} */

  
  create view "sales_database"."main"."dim_sales_team__dbt_tmp" as (
    WITH sales AS (
    SELECT * FROM "sales_database"."main"."sales"
)

SELECT
    DISTINCT
    sales_team->>'name' AS sales_team_id,
    sales_team->>'region' AS sales_team_region
FROM sales
WHERE sales_team IS NOT NULL
  );

[0m07:20:17.117843 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m07:20:17.122272 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_team: ROLLBACK
[0m07:20:17.168295 [debug] [Thread-1 (]: Failed to rollback 'model.my_dbt_project.dim_sales_team'
[0m07:20:17.184348 [debug] [Thread-1 (]: On model.my_dbt_project.dim_sales_team: Close
[0m07:20:17.243503 [debug] [Thread-1 (]: Runtime Error in model dim_sales_team (models/dimensions/dim_sales_team.sql)
  Catalog Error: Table with name sales does not exist!
  Did you mean "sqlite_master"?
  LINE 6:     SELECT * FROM "sales_database"."main"."sales"
                            ^
[0m07:20:17.257313 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'efa21a7e-0b62-404b-a6d7-983fad127fa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecbd2e47a0>]}
[0m07:20:17.260108 [error] [Thread-1 (]: 6 of 7 ERROR creating sql view model main.dim_sales_team ....................... [[31mERROR[0m in 0.78s]
[0m07:20:17.270933 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_sales_team
[0m07:20:17.278542 [debug] [Thread-1 (]: Began running node model.my_dbt_project.fact_sales
[0m07:20:17.292269 [debug] [Thread-4 (]: Marking all children of 'model.my_dbt_project.dim_sales_team' to be skipped because of status 'error'.  Reason: Runtime Error in model dim_sales_team (models/dimensions/dim_sales_team.sql)
  Catalog Error: Table with name sales does not exist!
  Did you mean "sqlite_master"?
  LINE 6:     SELECT * FROM "sales_database"."main"."sales"
                            ^.
[0m07:20:17.283889 [info ] [Thread-1 (]: 7 of 7 START sql table model main.fact_sales ................................... [RUN]
[0m07:20:17.301025 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_sales_team, now model.my_dbt_project.fact_sales)
[0m07:20:17.306295 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.fact_sales
[0m07:20:17.336375 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.fact_sales"
[0m07:20:17.411312 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.fact_sales
[0m07:20:17.620381 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.fact_sales"
[0m07:20:17.686666 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.fact_sales"
[0m07:20:17.689190 [debug] [Thread-1 (]: On model.my_dbt_project.fact_sales: BEGIN
[0m07:20:17.693656 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:20:17.844190 [debug] [Thread-1 (]: SQL status: OK in 0.150 seconds
[0m07:20:17.861179 [debug] [Thread-1 (]: Using duckdb connection "model.my_dbt_project.fact_sales"
[0m07:20:17.868838 [debug] [Thread-1 (]: On model.my_dbt_project.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.fact_sales"} */

  
    
    

    create  table
      "sales_database"."main"."fact_sales__dbt_tmp"
  
    as (
      WITH sales_data AS (
    SELECT
        name AS sales_order_id,
        transaction_date,
        customer,
        company,
        total AS sales_amount,
        net_total,
        discount_amount,
        base_total_taxes_and_charges AS tax_amount,
        grand_total,
        currency,
        conversion_rate,
        items, -- JSON field with product details
        taxes -- JSON field with tax details
    FROM "sales_database"."main"."sales"
)

SELECT * FROM sales_data
    );
  
  
[0m07:20:18.136571 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_profile", "target_name": "dev", "node_id": "model.my_dbt_project.fact_sales"} */

  
    
    

    create  table
      "sales_database"."main"."fact_sales__dbt_tmp"
  
    as (
      WITH sales_data AS (
    SELECT
        name AS sales_order_id,
        transaction_date,
        customer,
        company,
        total AS sales_amount,
        net_total,
        discount_amount,
        base_total_taxes_and_charges AS tax_amount,
        grand_total,
        currency,
        conversion_rate,
        items, -- JSON field with product details
        taxes -- JSON field with tax details
    FROM "sales_database"."main"."sales"
)

SELECT * FROM sales_data
    );
  
  
[0m07:20:18.150156 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m07:20:18.154140 [debug] [Thread-1 (]: On model.my_dbt_project.fact_sales: ROLLBACK
[0m07:20:18.188024 [debug] [Thread-1 (]: Failed to rollback 'model.my_dbt_project.fact_sales'
[0m07:20:18.190618 [debug] [Thread-1 (]: On model.my_dbt_project.fact_sales: Close
[0m07:20:18.241960 [debug] [Thread-1 (]: Runtime Error in model fact_sales (models/facts/fact_sales.sql)
  Catalog Error: Table with name sales does not exist!
  Did you mean "sqlite_master"?
  LINE 26:     FROM "sales_database"."main"."sales"
                    ^
[0m07:20:18.246463 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'efa21a7e-0b62-404b-a6d7-983fad127fa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecbd2e5610>]}
[0m07:20:18.258879 [error] [Thread-1 (]: 7 of 7 ERROR creating sql table model main.fact_sales .......................... [[31mERROR[0m in 0.95s]
[0m07:20:18.263211 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.fact_sales
[0m07:20:18.271949 [debug] [Thread-4 (]: Marking all children of 'model.my_dbt_project.fact_sales' to be skipped because of status 'error'.  Reason: Runtime Error in model fact_sales (models/facts/fact_sales.sql)
  Catalog Error: Table with name sales does not exist!
  Did you mean "sqlite_master"?
  LINE 26:     FROM "sales_database"."main"."sales"
                    ^.
[0m07:20:18.311133 [debug] [MainThread]: Using duckdb connection "master"
[0m07:20:18.330113 [debug] [MainThread]: On master: BEGIN
[0m07:20:18.348583 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:20:18.434737 [debug] [MainThread]: SQL status: OK in 0.073 seconds
[0m07:20:18.437702 [debug] [MainThread]: On master: COMMIT
[0m07:20:18.440198 [debug] [MainThread]: Using duckdb connection "master"
[0m07:20:18.442039 [debug] [MainThread]: On master: COMMIT
[0m07:20:18.447021 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m07:20:18.458676 [debug] [MainThread]: On master: Close
[0m07:20:18.479193 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:20:18.482288 [debug] [MainThread]: Connection 'create_sales_database_main' was properly closed.
[0m07:20:18.497055 [debug] [MainThread]: Connection 'list_sales_database_main' was properly closed.
[0m07:20:18.499964 [debug] [MainThread]: Connection 'model.my_dbt_project.fact_sales' was properly closed.
[0m07:20:18.507283 [info ] [MainThread]: 
[0m07:20:18.553385 [info ] [MainThread]: Finished running 1 table model, 6 view models in 0 hours 0 minutes and 56.46 seconds (56.46s).
[0m07:20:18.613578 [debug] [MainThread]: Command end result
[0m07:20:18.953495 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt_models/target/manifest.json
[0m07:20:19.001725 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt_models/target/semantic_manifest.json
[0m07:20:19.082523 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dags/dbt_models/target/run_results.json
[0m07:20:19.084894 [info ] [MainThread]: 
[0m07:20:19.098748 [info ] [MainThread]: [31mCompleted with 7 errors, 0 partial successes, and 0 warnings:[0m
[0m07:20:19.101374 [info ] [MainThread]: 
[0m07:20:19.103986 [error] [MainThread]:   Runtime Error in model dim_company (models/dimensions/dim_company.sql)
  Catalog Error: Table with name sales does not exist!
  Did you mean "sqlite_master"?
  LINE 9:     FROM "sales_database"."main"."sales"
                   ^
[0m07:20:19.106523 [info ] [MainThread]: 
[0m07:20:19.118762 [error] [MainThread]:   Runtime Error in model dim_currency (models/dimensions/dim_currency.sql)
  Catalog Error: Table with name sales does not exist!
  Did you mean "sqlite_master"?
  LINE 10:     FROM "sales_database"."main"."sales"
                    ^
[0m07:20:19.121538 [info ] [MainThread]: 
[0m07:20:19.125051 [error] [MainThread]:   Runtime Error in model dim_customer (models/dimensions/dim_customer.sql)
  Catalog Error: Table with name sales does not exist!
  Did you mean "sqlite_master"?
  LINE 29:     FROM "sales_database"."main"."sales"
                    ^
[0m07:20:19.127167 [info ] [MainThread]: 
[0m07:20:19.139001 [error] [MainThread]:   Runtime Error in model dim_date (models/dimensions/dim_date.sql)
  Catalog Error: Table with name sales does not exist!
  Did you mean "sqlite_master"?
  LINE 28:     FROM "sales_database"."main"."sales"
                    ^
[0m07:20:19.141204 [info ] [MainThread]: 
[0m07:20:19.144437 [error] [MainThread]:   Runtime Error in model dim_produt (models/dimensions/dim_produt.sql)
  Catalog Error: Table with name sales does not exist!
  Did you mean "sqlite_master"?
  LINE 26:     FROM "sales_database"."main"."sales"
                    ^
[0m07:20:19.146899 [info ] [MainThread]: 
[0m07:20:19.159386 [error] [MainThread]:   Runtime Error in model dim_sales_team (models/dimensions/dim_sales_team.sql)
  Catalog Error: Table with name sales does not exist!
  Did you mean "sqlite_master"?
  LINE 6:     SELECT * FROM "sales_database"."main"."sales"
                            ^
[0m07:20:19.167971 [info ] [MainThread]: 
[0m07:20:19.179830 [error] [MainThread]:   Runtime Error in model fact_sales (models/facts/fact_sales.sql)
  Catalog Error: Table with name sales does not exist!
  Did you mean "sqlite_master"?
  LINE 26:     FROM "sales_database"."main"."sales"
                    ^
[0m07:20:19.182007 [info ] [MainThread]: 
[0m07:20:19.220250 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=7 SKIP=0 TOTAL=7
[0m07:20:19.231470 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 64.466705, "process_in_blocks": "3071840", "process_kernel_time": 7.50065, "process_mem_max_rss": "130180", "process_out_blocks": "0", "process_user_time": 12.307476}
[0m07:20:19.237238 [debug] [MainThread]: Command `dbt run` failed at 07:20:19.236777 after 64.47 seconds
[0m07:20:19.241335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecc7a8b5f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecc4815040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecc48b7980>]}
[0m07:20:19.243476 [debug] [MainThread]: Flushing usage events
[0m07:20:21.804543 [debug] [MainThread]: An error was encountered while trying to flush usage events
